{"version":3,"sources":["webpack://canvasDatagrid/webpack/universalModuleDefinition","webpack://canvasDatagrid/./lib/component.js","webpack://canvasDatagrid/./lib/contextMenu.js","webpack://canvasDatagrid/./lib/defaults.js","webpack://canvasDatagrid/./lib/dom.js","webpack://canvasDatagrid/./lib/draw.js","webpack://canvasDatagrid/./lib/events.js","webpack://canvasDatagrid/./lib/intf.js","webpack://canvasDatagrid/./lib/main.js","webpack://canvasDatagrid/./lib/publicMethods.js","webpack://canvasDatagrid/./lib/touch.js","webpack://canvasDatagrid/./node_modules/is-printable-key-event/dist/index.js","webpack://canvasDatagrid/webpack/bootstrap","webpack://canvasDatagrid/webpack/runtime/compat get default export","webpack://canvasDatagrid/webpack/runtime/define property getters","webpack://canvasDatagrid/webpack/runtime/hasOwnProperty shorthand","webpack://canvasDatagrid/webpack/runtime/make namespace object","webpack://canvasDatagrid/webpack/startup"],"names":["typeMap","component","dehyphenateProperty","hyphenateProperty","prop","replace","p","nextLetterCap","Array","prototype","forEach","call","char","toUpperCase","cust","toLowerCase","getDefaultItem","base","item","i","r","defaults","filter","applyComponentStyle","supressChangeAndDrawEvents","intf","isComponent","cStyle","window","getComputedStyle","tagName","canvas","defs","computedStyle","styles","def","val","getPropertyValue","setStyleProperty","dispatchEvent","requestAnimationFrame","resize","style","data","strData","JSON","parse","e","Error","schema","strSchema","number","strNum","n","parseInt","isNaN","strBool","test","string","str","getObservableAttributes","attrs","attributes","attr","push","disconnectedCallback","connected","connectedCallback","parentDOMNode","innerHTML","appendChild","observe","adoptedCallback","attributeChangedCallback","attrName","oldVal","newVal","tfn","dataType","name","addEventListener","Function","observer","MutationObserver","mutations","checkInnerHTML","checkStyle","mutation","attributeName","target","nodeName","parentNode","addedNodes","length","type","characterData","childList","subtree","document","querySelectorAll","el","self","zIndexTop","hoverScrollTimeout","autoCompleteContext","applyContextItemStyle","contextItemContainer","createInlineStyle","mobile","createContextMenu","ev","pos","items","parentContextMenu","container","createElement","upArrow","downArrow","children","selectedIndex","rect","isArray","createItems","childMenuArrow","removeChildContext","relatedTarget","contextMenu","contains","dispose","splice","indexOf","undefined","removeEventListener","setAttribute","contextAddCallback","getAttribute","cPos","getBoundingClientRect","left","childContextMenuMarginLeft","offsetWidth","top","childContextMenuMarginTop","bottom","right","createChildContext","apply","addItem","addContent","content","title","childContextMenuArrowHTML","click","clickIndex","idx","Event","checkArrowVisibility","scrollTop","removeChild","scrollHeight","offsetHeight","startHoverScroll","t","a","contextHoverScrollAmount","setTimeout","contextHoverScrollRateMs","endHoverScroll","clearTimeout","init","loc","s","scrollOffset","contextMenuZIndex","x","y","height","position","color","contextMenuArrowColor","textAlign","zIndex","inputDropdown","maxHeight","innerHeight","autocompleteBottomMargin","minWidth","width","hasFocus","deltaY","scrollLeft","deltaX","contextMenuArrowUpHTML","contextMenuArrowDownHTML","body","contextMenuWindowMargin","innerWidth","parentGrid","c","Object","defineProperty","get","set","value","isFinite","index","createFilterContextMenuItems","filterContainer","filterLabel","filterAutoCompleteButton","filterInput","cell","header","iRect","checkRegExpErrorState","background","contextFilterInputBackground","contextFilterInputColor","invalidFilterRegEx","contextFilterInvalidRegExpBackground","contextFilterInvalidRegExpColor","fillAutoComplete","count","blanksItem","viewData","row","cellValue","String","trim","blankValues","includes","blanksText","maxAutoCompleteItems","formatters","stopPropagation","disposeAutocomplete","keys","concat","map","key","createAutoCompleteContext","autoCompleteItems","onclick","disposeContextMenu","preventDefault","setFilter","en","columnFilters","filterOptionText","contextFilterButtonHTML","cf","h","getHeaderByName","removeFilterOptionText","removeFilterClick","controlInput","focus","addDefaultContextMenuItem","isNormalCell","isBackground","isColumnHeaderCellCap","isScrollBar","isCorner","isRowHeader","showFilter","showCopy","selections","reduce","copyText","execCommand","showPaste","clipBoardData","pasteText","paste","columnIndex","rowIndex","draw","showColumnSelector","columnSelectorText","d","getSchema","column","toggleColumnVisibility","hidden","setStorageData","columnSelectorHiddenText","columnSelectorVisibleText","hideColumnText","saveAppearance","showClearSettingsOption","sizes","rows","columns","clearSettingsOptionText","createRowOrders","createColumnOrders","storedSettings","columnWidth","cellWidth","cellHeight","allowSorting","showOrderByOption","showOrderByOptionTextAsc","order","showOrderByOptionTextDesc","contextmenuEvent","overridePos","createDiposeEvent","contextPosition","getLayerPos","NativeEvent","getCellAt","isGrid","contextMenuMarginLeft","canvasOffsetLeft","contextMenuMarginTop","canvasOffsetTop","mobileContextMenuMargin","getClippingRect","ele","boundingRect","eleRect","clipRect","w","parentRect","Infinity","columnHeaderCellHeight","getColumnHeaderCellHeight","rowHeaderCellWidth","getRowHeaderCellWidth","offsetTop","scrollBarWidth","offsetLeft","clipElement","clip","scrollingElement","nodeType","resizeEditInput","input","editCell","bm","gridBorderCollapse","borderWidth","cellBorderWidth","getVisibleCellByIndex","mobileEditInputHeight","cellPaddingLeft","ignoreScrollOffset","offsetParent","clientX","clientY","isChildGrid","endEdit","abort","abortEdit","newValue","oldValue","objValue","changes","originalData","boundRowIndex","ev2","defaultValue","aborted","addRow","createNewRowData","beginEditAt","inEnterMode","editable","adjacentCells","enumItems","enu","option","valueInEnum","scrollIntoView","setActiveCell","getAdjacentCells","multiLine","editCellZIndex","fontSize","editCellFontSize","scale","cellValueIsEmpty","shouldClearCellValue","endCap","event","f","nx","ny","altKey","nextRowIndex","shiftKey","Math","max","min","last","first","className","css","verticalAlign","marginLeft","padding","border","contextFilterInputBorder","borderRadius","contextFilterInputBorderRadius","lineHeight","fontWeight","fontFamily","contextFilterInputFontFamily","contextFilterInputFontSize","contextMenuBackground","contextMenuColor","contextFilterButtonBorder","contextFilterButtonBorderRadius","contextMenuFilterButtonFontFamily","contextMenuFilterButtonFontSize","cssFloat","childContextMenuArrowColor","contextMenuChildArrowFontSize","contextMenuFontFamily","contextMenuFontSize","contextMenuBorder","contextMenuPadding","contextMenuBorderRadius","opacity","contextMenuOpacity","overflow","contextMenuHoverBackground","contextMenuHoverColor","display","cursor","boxSizing","outline","margin","mobileEditFontFamily","mobileEditFontSize","editCellBorder","editCellColor","editCellBackgroundColor","appearance","webkitAppearance","mozAppearance","editCellPaddingLeft","editCellFontFamily","boxShadow","editCellBoxShadow","contextMenuItemMargin","contextMenuItemBorderRadius","contextMenuLabelMargin","contextMenuLabelDisplay","contextMenuLabelMinWidth","maxWidth","contextMenuLabelMaxWidth","whiteSpace","contextMenuCursor","contextMenuFilterInvalidExpresion","appendTo","setDom","ctx","context","eventParent","onblur","blur","parentIsCanvas","getContext","textBaseline","parentNodeStyle","touchstart","mouseup","mousedown","dblclick","mousemove","scrollWheel","copy","cut","keypress","keyup","keydown","perfCounters","cachedImagesDrawn","drawCount","perfWindowSize","entityCount","hiddenFrozenColumnCount","scrollDebugCounters","touchPPSCounters","htmlImageCache","fillArray","low","high","step","drawPerfLine","perfArr","arrIndex","useAbs","beginPath","moveTo","cx","cy","abs","lineTo","strokeStyle","stroke","drawOnAllImagesLoaded","loaded","html","img","complete","drawHtml","v","formattedValue","cacheKey","toString","round","drawImage","Image","onload","src","btoa","drawOrderByArrow","mt","columnHeaderOrderByArrowMarginTop","ml","columnHeaderOrderByArrowMarginLeft","mr","columnHeaderOrderByArrowMarginRight","aw","columnHeaderOrderByArrowWidth","ah","columnHeaderOrderByArrowHeight","fillStyle","columnHeaderOrderByArrowColor","columnHeaderOrderByArrowBorderColor","orderDirection","fill","drawTreeArrow","treeArrowMarginTop","treeArrowMarginRight","treeArrowMarginLeft","treeArrowWidth","treeArrowHeight","treeArrowColor","treeArrowBorderColor","openChildren","radiusRect","radius","b","quadraticCurveTo","fillRect","strokeRect","fillText","text","fillCircle","arc","PI","strokeCircle","clipFrozenArea","mode","lastFrozenColumnPixel","lastFrozenRowPixel","fillHandle","selectionHandleType","strokeHandle","addselectionHandle","hw","selectionHandleSize","tr","br","tl","bl","addBorderLine","l","addEllipsis","ellipsisCache","measureText","wrapText","splitChar","lines","calculatedLineHeight","word","words","split","textHeight","out","wrap","cellWhiteSpace","autoResize","autoResizeRows","elWidth","et","ellipsisText","elClipLength","plWidth","clippedVal","ogWordWidth","previousLine","line","cHeight","paddedHeight","measure","paddedWidth","originText","stepLength","direction","substr","drawText","ll","fontHeight","vPos","hPos","paddingLeft","orderByArrowWidth","horizontalAlignment","paddingRight","verticalAlignment","paddingBottom","lineSpacing","debug","active","font","debugFont","debugColor","stringify","pw","idx_ord","sortColumnIndex","getFrozenColumnsWidth","frozenColumn","getColumnWidth","internal","visible","checkScrollHeight","rowHeaderCell","treeGrid","rowOpen","rowHeight","cornerCell","rowData","aCell","bc","selectionBorders","moveBorders","selectionHandles","rowHeaders","u","currentCell","performance","now","visibleRowHeights","orders","drawScrollBars","drawCorner","scrollBox","entities","m","scrollBarBoxMargin","scrollBarBorderColor","lineWidth","scrollBarBorderWidth","horizontalBox","horizontalBar","scrollBoxWidth","scrollWidth","verticalBox","verticalBar","scrollBoxHeight","horizontalBarVisible","scrollBarBackgroundColor","scrollBarBoxColor","horizontalBoxVisible","scrollBarActiveColor","scrollBarBoxBorderRadius","visibleCells","unshift","verticalBarVisible","verticalBoxVisible","scrollBarCornerBorderColor","scrollBarCornerBackgroundColor","corner","createHandlesOverlayArray","allowMovingSelection","selectionBorderTop","selectionBorderRight","selectionHandle","selectionBorderLeft","selectionBorderBottom","selectionHandleBehavior","createBorderOverlayArray","drawArray","propPrefix","offsetPoint","selectionBorder","isHeader","drawCell","rowOrderIndex","drawEach","headerIndex","columnOrderIndex","cellStyle","cellGridAttributes","isColumnHeader","selected","hovered","hovers","hoverMode","activeCell","rawValue","activeHeader","orderByArrowSize","treeArrowSize","visibleRows","paddingTop","cellLineHeight","cellLineSpacing","viewRowIndex","viewColumnIndex","getBoundRowIndexFromViewRowIndex","boundColumnIndex","sortRowIndex","isNormal","gridId","userHeight","userWidth","cellHeightWithChildGrid","cellWidthWithChildGrid","save","tree","showRowNumbers","childGrids","createGrid","cellGridHeight","grid","orderBy","console","warn","filterTextPrefix","movingSelection","moveOffset","restore","showRowNumberGaps","previousRowNumber","hasRowGap","barHeight","rowHeaderCellRowNumberGapHeight","barColor","rowHeaderCellRowNumberGapColor","drawRowHeader","showRowHeaders","filteredRowNumber","rowHeaderValue","hasActiveFilters","headerDescription","drawHeaders","g","o","columnHeaderCell","nonFrozenHeaderWidth","drawHeaderColumnRange","start","end","rArgs","rhIndex","frozenRow","showColumnHeaders","scrollPixelLeft","columnHeaderCellBorderWidth","scrollIndexLeft","isColumnHeaderCell","drawRow","treeHeight","rowSansTreeHeight","trees","scrollIndexRight","scrollPixelRight","initDraw","drawBackground","gridBackgroundColor","drawFrozenRows","ln","allowFreezingRows","frozenMarkerBorderWidth","frozenMarkerWidth","drawRows","snapToRow","scrollPixelTop","scrollIndexTop","scrollIndexBottom","scrollPixelBottom","showNewRow","newRow","drawMoveMarkers","moveOverlayBorderWidth","moveOverlayBorderColor","setLineDash","moveOverlayBorderSegments","drawReorderMarkers","reorderObject","dragOffset","reorderMarkerBackgroundColor","reorderMarkerBorderWidth","reorderMarkerBorderColor","dragMode","reorderMarkerIndexBorderWidth","reorderMarkerIndexBorderColor","reorderTarget","drawBorder","gridBorderWidth","gridBorderColor","drawSelectionBorders","selectionOverlayBorderWidth","selectionOverlayBorderColor","dsb","drawSelectionHandles","selectionHandleBorderWidth","selectionHandleBorderColor","selectionHandleColor","az","touchSelectHandleZone","ax","ay","drawActiveCell","cl","acx","acy","acw","ach","selectionMode","activeCellOverlayBorderWidth","activeCellOverlayBorderColor","getHeaderWidth","drawFrozenMarkers","my","mx","xHover","yHover","allowFreezingColumns","frozenMarkerHoverColor","frozenMarkerColor","frozenMarkerHoverBorderColor","frozenMarkerBorderColor","freezeMarkerPosition","frozenMarkerActiveColor","frozenMarkerActiveBorderColor","drawPerfLines","showPerformance","px","py","ph","dpl","debugPerfChartTextColor","toFixed","debugPerfChartBackground","debugScrollHeightColor","debugScrollWidthColor","debugPerformanceColor","debugEntitiesColor","debugTouchPPSXColor","debugTouchPPSYColor","pop","yPPS","xPPS","drawDebug","perf","perfDelta","frozenColumnsWidth","htmlImages","startScale","scaleDelta","zoomDeltaStart","touchLength","touches","touchPosition","touchPosition1","scrollIndex","scrollPixel","canvasOffset","touchDelta","touchAnimateTo","scrollAnimation","touchPPS","touchPPST","xPPST","yPPST","touchDuration","pointerLockPosition","size","mouse","touch","touchStart","dragContext","debugBackgroundColor","lh","wheeling","fn","events","removeEachListener","sfn","defaultPrevented","dispatchEachEvent","getRatio","maxPixelRatio","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","drawAfterResize","vb","nb","co","isScrollBoxCorner","sbw","ratio","cellBorder","columnHeaderCellBorder","dataHeight","dataWidth","dims","ch","checkScrollBoxVisibility","overflowX","overflowY","setScrollBoxSize","setCanvasSize","dim","appliedInlineStyles","scrollCache","reduceSchema","accumulator","va","args","widthBoxRatio","heightBoxRatio","scrollBarBoxMinSize","scrollBarBoxWidth","bar","box","page","pageUpDownOverlap","scroll","dontDraw","floor","ctrl","ctrlKey","metaKey","persistantSelectionMode","singleSelectionMode","dragBounds","sBounds","delta","previousCell","scrollTimer","isInGrid","rowBoundaryCrossed","columnBoundaryCrossed","cellBoundaryCrossed","prefix","draggingItem","scrollModes","dragItem","selecting","dragStart","dragStartObject","getSelectionBounds","ignoreNextClick","selectRow","dragAddToSelection","selectedData","getSelectedData","selectionBounds","selectArea","autoScrollZone","startingBounds","checkSelectionChange","sb","selectAll","columnHeaderClickBehavior","selectColumn","treeArrowClickRadius","toggleTree","dragResizeColumn","resizingStartingWidth","resizingStartingHeight","minColumnWidth","minRowHeight","resizeScrollZone","resizeChildGrids","globalRowResize","stopDragResize","scrollGrid","scrollPointerLock","scrollStartMode","movementX","movementY","scrollMode","scrollStart","scrollRepeatRate","selectionScrollIncrement","stopScrollGrid","exitPointerLock","dragReorder","columReorder","rowReorder","allowColumnReordering","allowRowReordering","source","reorderDeadZone","stopDragReorder","oIndex","tIndex","cr","dragMove","stopDragMove","moveSelection","freezeMove","stopFreezeMove","startFreezeMove","lastMouseDownTarget","button","move","freeze","requestPointerLock","dragging","cols","isPrintableKeyEvent","selectNone","Number","isArrowKey","selectionFollowsActiveCell","fitColumnToValues","autosize","deltaMode","touchHaltAnimation","scrollTo","pasteData","pasteValue","mimeType","startRowIndex","startColIndex","getVisibleSchema","isSupportedHtmlTable","htmlString","parseData","cleanedHtmlData","substring","match","cellData","forEachSelectedCell","colName","realRowIndex","cells","existingRowData","newRowData","assign","colIndex","columnName","affectedCells","refresh","getNextVisibleColumnIndex","visibleColumnIndex","getVisibleColumnIndexOf","clipboardItems","Map","from","clipboardData","supportedMimeTypes","pasteableItems","join","itemToPaste","pasteType","getAsString","tableRows","textRows","outputHeaders","outputHeaderKeys","sData","htmlSafe","fCopyCell","addHeaders","headers","useHtml","hVal","addCellValue","trRow","textRow","rowKeys","sSorted","setData","ctor","treeGridAttributes","storageName","invalidSearchExpClass","localStyleLibraryStorageKey","orderings","add","sortFunction","col","sort","filters","sorters","parsers","schemaHashes","componentL1Events","eventNames","expandToRow","viewDataLength","orderedIndex","boundRowIndexMap","has","visibility","localStorage","setItem","tempSchema","applyDefaultValue","newRowIndex","forEachHeader","getSchemaNameHash","getFilteredAndSortedViewData","newViewData","originalRowIndex","headerName","filterText","currentFilterFunction","shouldIncludeRow","entries","sortFn","rowA","rowB","_row","getBestGuessDataType","drawChildGrids","gridKey","setTimer","selectionScrollZone","validateColumn","setDefaults","obj1","obj2","setAttributes","eachAttribute","setStyle","eachStyle","findColumnMaxTextLength","contextmenu","disconnect","tryLoadStoredSettings","reloadStoredValues","getDomRoot","shadowRoot","host","getFontName","fontStyle","getFontHeight","parseFloat","parseStyleValue","initProp","propName","getStyleProperty","styleKeys","supressDrawAndEvent","isDim","getItem","message","initialized","addStyleKeyIfNoneExists","publicStyleKeyIntf","initScrollBox","ie","navigator","userAgent","edge","webKit","moz","cursorGrab","cursorGrabing","cursorGrabbing","clearChangeLog","gotoCell","gotoRow","findColumnScrollLeft","findRowScrollTop","isCellVisible","isRowVisible","isColumnVisible","getSchemaFromData","expandTree","collapseTree","insertRow","deleteRow","insertColumn","deleteColumn","addColumn","setRowHeight","setColumnWidth","resetColumnWidths","resetRowHeights","assertPxColor","clearPxColorAssertions","integerToAlpha","DOMStyles","valueObject","filterFor","filterRegExp","regEnd","pattern","exec","flags","flagLength","RegExp","toLocaleUpperCase","innerText","textContent","TypeError","currentCursor","find","eventName","RangeError","eachDataRow","setTreeGridAttributes","setCellGridAttributes","schemaGetter","schemaSetter","eachSchemaColumn","hideEachSchemaColumn","getTypes","parseInnerHtml","callback","etl","autoGenerateSchema","dataGetter","dataSetter","autoResizeColumns","sHeight","sWidth","setScrollTop","preventScrollEvent","setScrollLeft","supressDrawEvent","webComponent","modules","dom","publicMethods","Grid","eval","module","attachShadow","HTMLElement","create","customElements","observedAttributes","define","canvasDatagrid","require","EXCLUDE_GLOBAL","tKeys","argKey","tKey","sKey","ordA","charCodeAt","ordZ","len","fromCharCode","offsetX","offsetY","targetX","targetY","sbh","isColumnSelected","colIsSelected","shift","supressEvent","addCol","removeCol","st","de","ri","dragObject","childGrid","trArgs","treeGridHeight","dontSetStorageData","sorter","sel","visibleSchema","selectionLength","xi","maxRowLength","minXi","yi","lastSourceIndex","cidx","useTouchScrollZones","getBorder","entitiy","borderResizeZone","tsz","touchScrollZone","moveMode","borderDragBehavior","moveBorder","xBorderBehavior","yBorderBehavior","isVerticalScrollBar","isHorizontalScrollBar","allowColumnResize","allowColumnResizeFromCell","allowRowHeaderResize","allowRowResize","allowRowResizeFromCell","rowGrabZoneSize","maxCol","minCol","mapEachSchemaColumn","bounds","rowHeaderCellFont","autosizePadding","autosizeHeaderCellPadding","rowHeaderCellPaddingRight","rowHeaderCellPaddingLeft","formatter","columnHeaderCellFont","headerCellPaddingRight","headerCellPaddingLeft","cellFont","cellPaddingRight","cellAutoResizePadding","total","getRowHeight","cellFormatterString","headerCell","asc","localeCompare","date","Date","getTime","touchTimerMs","debounceTouchMove","touchMoving","touchScrollTimeout","animationFrames","getTouchPos","touchIndex","easingFunctions","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easing","touchEasingMethod","calculatePPSTimed","touchSigmaTimed","calculatePPS","touchSigma","touchEndAnimation","touchReleaseAnimationDurationMs","stopAnimation","touchEditCell","touchCell","clearInterval","calculatePPSTimer","touchDeadZone","touchingCell","changedTouches","startingCell","touchContextTimeout","touchStartEvent","zoomAltered","touchStart1","touchScrollStart","touchContextMenuTimeMs","setInterval","touchEndEvents","touchmove","passive","touchend","touchcancel","touchSelect","handleType","touchSelecting","touchMove","rw","rScrollZone","lScrollZone","bScrollZone","tScrollZone","t1","t2","touchZoomSensitivity","touchZoomMin","touchZoomMax","touchScroll","dz","touchReleaseAcceleration","scrollAnimationPPSThreshold"],"mappings":"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","file":"canvas-datagrid.debug.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"canvasDatagrid\"] = factory();\n\telse\n\t\troot[\"canvasDatagrid\"] = factory();\n})(self, function() {\nreturn ","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport defaults from './defaults';\r\n\r\nexport default function () {\r\n  var typeMap,\r\n    component = {};\r\n  component.dehyphenateProperty = function hyphenateProperty(prop) {\r\n    prop = prop.replace('--cdg-', '');\r\n    var p = '',\r\n      nextLetterCap;\r\n    Array.prototype.forEach.call(prop, function (char) {\r\n      if (nextLetterCap) {\r\n        nextLetterCap = false;\r\n        p += char.toUpperCase();\r\n        return;\r\n      }\r\n      if (char === '-') {\r\n        nextLetterCap = true;\r\n        return;\r\n      }\r\n      p += char;\r\n    });\r\n    return p;\r\n  };\r\n  component.hyphenateProperty = function hyphenateProperty(prop, cust) {\r\n    var p = '';\r\n    Array.prototype.forEach.call(prop, function (char) {\r\n      if (char === char.toUpperCase()) {\r\n        p += '-' + char.toLowerCase();\r\n        return;\r\n      }\r\n      p += char;\r\n    });\r\n    return (cust ? '--cdg-' : '') + p;\r\n  };\r\n  function getDefaultItem(base, item) {\r\n    var i = {},\r\n      r;\r\n    defaults(i);\r\n    r = i.defaults[base].filter(function (i) {\r\n      return (\r\n        i[0].toLowerCase() === item.toLowerCase() ||\r\n        component.hyphenateProperty(i[0]) === item.toLowerCase() ||\r\n        component.hyphenateProperty(i[0], true) === item.toLowerCase()\r\n      );\r\n    })[0];\r\n    return r;\r\n  }\r\n  component.applyComponentStyle = function (supressChangeAndDrawEvents, intf) {\r\n    if (!intf.isComponent) {\r\n      return;\r\n    }\r\n    var cStyle = window.getComputedStyle(\r\n        intf.tagName === 'CANVAS-DATAGRID' ? intf : intf.canvas,\r\n        null,\r\n      ),\r\n      defs = {};\r\n    intf.computedStyle = cStyle;\r\n    defaults(defs);\r\n    defs = defs.defaults.styles;\r\n    defs.forEach(function (def) {\r\n      var val;\r\n      val = cStyle.getPropertyValue(component.hyphenateProperty(def[0], true));\r\n      if (val === '') {\r\n        val = cStyle.getPropertyValue(\r\n          component.hyphenateProperty(def[0], false),\r\n        );\r\n      }\r\n      if (val !== '' && typeof val === 'string') {\r\n        intf.setStyleProperty(\r\n          def[0],\r\n          typeMap[typeof def[1]](\r\n            val.replace(/^\\s+/, '').replace(/\\s+$/, ''),\r\n            def[1],\r\n          ),\r\n          true,\r\n        );\r\n      }\r\n    });\r\n    if (!supressChangeAndDrawEvents && intf.dispatchEvent) {\r\n      requestAnimationFrame(function () {\r\n        intf.resize(true);\r\n      });\r\n      intf.dispatchEvent('stylechanged', intf.style);\r\n    }\r\n  };\r\n  typeMap = {\r\n    data: function (strData) {\r\n      try {\r\n        return JSON.parse(strData);\r\n      } catch (e) {\r\n        throw new Error('Cannot read JSON data in canvas-datagrid data.');\r\n      }\r\n    },\r\n    schema: function (strSchema) {\r\n      try {\r\n        return JSON.parse(strSchema);\r\n      } catch (e) {\r\n        throw new Error(\r\n          'Cannot read JSON data in canvas-datagrid schema attribute.',\r\n        );\r\n      }\r\n    },\r\n    number: function (strNum, def) {\r\n      var n = parseInt(strNum, 10);\r\n      return isNaN(n) ? def : n;\r\n    },\r\n    boolean: function (strBool) {\r\n      return /true/i.test(strBool);\r\n    },\r\n    string: function (str) {\r\n      return str;\r\n    },\r\n  };\r\n  component.getObservableAttributes = function () {\r\n    var i = {},\r\n      attrs = ['data', 'schema', 'style', 'className', 'name'];\r\n    defaults(i);\r\n    i.defaults.attributes.forEach(function (attr) {\r\n      attrs.push(attr[0].toLowerCase());\r\n    });\r\n    return attrs;\r\n  };\r\n  component.disconnectedCallback = function () {\r\n    this.connected = false;\r\n  };\r\n  component.connectedCallback = function () {\r\n    var intf = this;\r\n    intf.parentDOMNode.innerHTML = '';\r\n    intf.parentDOMNode.appendChild(intf.canvas);\r\n    intf.connected = true;\r\n    component.observe(intf);\r\n    component.applyComponentStyle(true, intf);\r\n    intf.resize(true);\r\n  };\r\n  component.adoptedCallback = function () {\r\n    this.resize();\r\n  };\r\n  component.attributeChangedCallback = function (attrName, oldVal, newVal) {\r\n    var tfn,\r\n      intf = this,\r\n      def;\r\n    if (attrName === 'style') {\r\n      component.applyComponentStyle(false, intf);\r\n      return;\r\n    }\r\n    if (attrName === 'data') {\r\n      if (intf.dataType === 'application/x-canvas-datagrid') {\r\n        intf.dataType = 'application/json+x-canvas-datagrid';\r\n      }\r\n      intf.data = newVal;\r\n      return;\r\n    }\r\n    if (attrName === 'schema') {\r\n      intf.schema = typeMap.schema(newVal);\r\n      return;\r\n    }\r\n    if (attrName === 'name') {\r\n      intf.name = newVal;\r\n      return;\r\n    }\r\n    if (attrName === 'class' || attrName === 'className') {\r\n      return;\r\n    }\r\n    def = getDefaultItem('attributes', attrName);\r\n    if (def) {\r\n      tfn = typeMap[typeof def[1]];\r\n      intf.attributes[def[0]] = tfn(newVal);\r\n      return;\r\n    }\r\n    if (/^on/.test(attrName)) {\r\n      intf.addEventListener('on' + attrName, Function('e', newVal));\r\n    }\r\n    return;\r\n  };\r\n  component.observe = function (intf) {\r\n    var observer;\r\n    if (!window.MutationObserver) {\r\n      return;\r\n    }\r\n    intf.applyComponentStyle = function () {\r\n      component.applyComponentStyle(false, intf);\r\n      intf.resize();\r\n    };\r\n    /**\r\n     * Applies the computed css styles to the grid.  In some browsers, changing directives in attached style sheets does not automatically update the styles in this component.  It is necessary to call this method to update in these cases.\r\n     * @memberof canvasDatagrid\r\n     * @name applyComponentStyle\r\n     * @method\r\n     */\r\n    observer = new window.MutationObserver(function (mutations) {\r\n      var checkInnerHTML, checkStyle;\r\n      Array.prototype.forEach.call(mutations, function (mutation) {\r\n        if (\r\n          mutation.attributeName === 'class' ||\r\n          mutation.attributeName === 'style'\r\n        ) {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (mutation.target.nodeName === 'STYLE') {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (\r\n          mutation.target.parentNode &&\r\n          mutation.target.parentNode.nodeName === 'STYLE'\r\n        ) {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (\r\n          mutation.target === intf &&\r\n          (mutation.addedNodes.length > 0 || mutation.type === 'characterData')\r\n        ) {\r\n          checkInnerHTML = true;\r\n        }\r\n      });\r\n      if (checkStyle) {\r\n        intf.applyComponentStyle(false, intf);\r\n      }\r\n      if (checkInnerHTML) {\r\n        if (intf.dataType === 'application/x-canvas-datagrid') {\r\n          intf.dataType = 'application/json+x-canvas-datagrid';\r\n        }\r\n        intf.data = intf.innerHTML;\r\n      }\r\n    });\r\n    observer.observe(intf, {\r\n      characterData: true,\r\n      childList: true,\r\n      attributes: true,\r\n      subtree: true,\r\n    });\r\n    Array.prototype.forEach.call(\r\n      document.querySelectorAll('style'),\r\n      function (el) {\r\n        observer.observe(el, {\r\n          characterData: true,\r\n          childList: true,\r\n          attributes: true,\r\n          subtree: true,\r\n        });\r\n      },\r\n    );\r\n  };\r\n  return component;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false, Event: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var zIndexTop, hoverScrollTimeout, autoCompleteContext;\r\n  function applyContextItemStyle(contextItemContainer) {\r\n    self.createInlineStyle(\r\n      contextItemContainer,\r\n      'canvas-datagrid-context-menu-item' + (self.mobile ? '-mobile' : ''),\r\n    );\r\n    contextItemContainer.addEventListener('mouseover', function () {\r\n      self.createInlineStyle(\r\n        contextItemContainer,\r\n        'canvas-datagrid-context-menu-item:hover',\r\n      );\r\n    });\r\n    contextItemContainer.addEventListener('mouseout', function () {\r\n      self.createInlineStyle(\r\n        contextItemContainer,\r\n        'canvas-datagrid-context-menu-item',\r\n      );\r\n    });\r\n  }\r\n  function createContextMenu(ev, pos, items, parentContextMenu) {\r\n    var container = document.createElement('div'),\r\n      upArrow = document.createElement('div'),\r\n      downArrow = document.createElement('div'),\r\n      children = [],\r\n      selectedIndex = -1,\r\n      intf = {},\r\n      rect;\r\n    if (!Array.isArray(items)) {\r\n      throw new Error('createContextMenu expects an array.');\r\n    }\r\n    function createItems() {\r\n      items.forEach(function (item) {\r\n        var contextItemContainer = document.createElement('div'),\r\n          childMenuArrow;\r\n        function removeChildContext(e) {\r\n          if (\r\n            e.relatedTarget === container ||\r\n            item.contextMenu.container === e.relatedTarget ||\r\n            childMenuArrow === e.relatedTarget ||\r\n            contextItemContainer === e.relatedTarget ||\r\n            item.contextMenu.container.contains(e.relatedTarget)\r\n          ) {\r\n            return;\r\n          }\r\n          item.contextMenu.dispose();\r\n          children.splice(children.indexOf(item.contextMenu), 1);\r\n          item.contextMenu = undefined;\r\n          contextItemContainer.removeEventListener(\r\n            'mouseout',\r\n            removeChildContext,\r\n          );\r\n          container.removeEventListener('mouseout', removeChildContext);\r\n          contextItemContainer.setAttribute('contextOpen', '0');\r\n          contextItemContainer.setAttribute('opening', '0');\r\n        }\r\n        function contextAddCallback(items) {\r\n          // check yet again if the user hasn't moved off\r\n          if (\r\n            contextItemContainer.getAttribute('opening') !== '1' ||\r\n            contextItemContainer.getAttribute('contextOpen') === '1'\r\n          ) {\r\n            return;\r\n          }\r\n          var cPos = contextItemContainer.getBoundingClientRect();\r\n          cPos = {\r\n            left:\r\n              cPos.left +\r\n              self.style.childContextMenuMarginLeft +\r\n              container.offsetWidth,\r\n            top: cPos.top + self.style.childContextMenuMarginTop,\r\n            bottom: cPos.bottom,\r\n            right: cPos.right,\r\n          };\r\n          item.contextMenu = createContextMenu(ev, cPos, items, intf);\r\n          contextItemContainer.setAttribute('contextOpen', '1');\r\n          contextItemContainer.addEventListener('mouseout', removeChildContext);\r\n          container.addEventListener('mouseout', removeChildContext);\r\n          children.push(item.contextMenu);\r\n        }\r\n        function createChildContext() {\r\n          var i;\r\n          if (contextItemContainer.getAttribute('contextOpen') === '1') {\r\n            return;\r\n          }\r\n          contextItemContainer.setAttribute('opening', '1');\r\n          if (typeof item.items === 'function') {\r\n            i = item.items.apply(intf, [\r\n              function (items) {\r\n                contextAddCallback(items);\r\n              },\r\n            ]);\r\n            if (i !== undefined && Array.isArray(i)) {\r\n              contextAddCallback(i);\r\n            }\r\n            return;\r\n          }\r\n          contextAddCallback(item.items);\r\n        }\r\n        function addItem(item) {\r\n          function addContent(content) {\r\n            if (content === null) {\r\n              return;\r\n            }\r\n            if (typeof content === 'function') {\r\n              return addContent(content(ev));\r\n            }\r\n            if (typeof content === 'object') {\r\n              contextItemContainer.appendChild(content);\r\n              return;\r\n            }\r\n            applyContextItemStyle(contextItemContainer);\r\n            contextItemContainer.innerHTML = content;\r\n            return;\r\n          }\r\n          addContent(item.title);\r\n          item.contextItemContainer = contextItemContainer;\r\n          if (\r\n            (item.items && item.items.length > 0) ||\r\n            typeof item.items === 'function'\r\n          ) {\r\n            childMenuArrow = document.createElement('div');\r\n            self.createInlineStyle(\r\n              childMenuArrow,\r\n              'canvas-datagrid-context-child-arrow',\r\n            );\r\n            childMenuArrow.innerHTML = self.style.childContextMenuArrowHTML;\r\n            contextItemContainer.appendChild(childMenuArrow);\r\n            contextItemContainer.addEventListener(\r\n              'mouseover',\r\n              createChildContext,\r\n            );\r\n            contextItemContainer.addEventListener('mouseout', function () {\r\n              contextItemContainer.setAttribute('opening', '0');\r\n            });\r\n          }\r\n          if (item.click) {\r\n            contextItemContainer.addEventListener('click', function (ev) {\r\n              item.click.apply(self, [ev]);\r\n            });\r\n          }\r\n        }\r\n        addItem(item);\r\n        container.appendChild(contextItemContainer);\r\n      });\r\n    }\r\n    function clickIndex(idx) {\r\n      items[idx].contextItemContainer.dispatchEvent(new Event('click'));\r\n    }\r\n    function checkArrowVisibility() {\r\n      if (container.scrollTop > 0) {\r\n        self.parentDOMNode.appendChild(upArrow);\r\n      } else if (upArrow.parentNode) {\r\n        upArrow.parentNode.removeChild(upArrow);\r\n      }\r\n      if (\r\n        container.scrollTop >=\r\n          container.scrollHeight - container.offsetHeight &&\r\n        downArrow.parentNode\r\n      ) {\r\n        downArrow.parentNode.removeChild(downArrow);\r\n      } else if (\r\n        container.scrollHeight - container.offsetHeight > 0 &&\r\n        !(\r\n          container.scrollTop >=\r\n          container.scrollHeight - container.offsetHeight\r\n        )\r\n      ) {\r\n        self.parentDOMNode.appendChild(downArrow);\r\n      }\r\n    }\r\n    function startHoverScroll(type) {\r\n      return function t() {\r\n        var a = self.attributes.contextHoverScrollAmount;\r\n        if (type === 'up' && container.scrollTop === 0) {\r\n          return;\r\n        }\r\n        if (type === 'down' && container.scrollTop === container.scrollHeight) {\r\n          return;\r\n        }\r\n        container.scrollTop += type === 'up' ? -a : a;\r\n        hoverScrollTimeout = setTimeout(\r\n          t,\r\n          self.attributes.contextHoverScrollRateMs,\r\n          type,\r\n        );\r\n      };\r\n    }\r\n    function endHoverScroll(type) {\r\n      return function () {\r\n        clearTimeout(hoverScrollTimeout);\r\n      };\r\n    }\r\n    function init() {\r\n      var loc = {},\r\n        s = self.scrollOffset(self.canvas);\r\n      if (zIndexTop === undefined) {\r\n        zIndexTop = self.style.contextMenuZIndex;\r\n      }\r\n      createItems();\r\n      self.createInlineStyle(\r\n        container,\r\n        'canvas-datagrid-context-menu' + (self.mobile ? '-mobile' : ''),\r\n      );\r\n      loc.x = pos.left - s.left;\r\n      loc.y = pos.top - s.top;\r\n      loc.height = 0;\r\n      zIndexTop += 1;\r\n      container.style.position = 'absolute';\r\n      upArrow.style.color = self.style.contextMenuArrowColor;\r\n      downArrow.style.color = self.style.contextMenuArrowColor;\r\n      [upArrow, downArrow].forEach(function (el) {\r\n        el.style.textAlign = 'center';\r\n        el.style.position = 'absolute';\r\n        el.style.zIndex = zIndexTop + 1;\r\n      });\r\n      container.style.zIndex = zIndexTop;\r\n      if (parentContextMenu && parentContextMenu.inputDropdown) {\r\n        container.style.maxHeight =\r\n          window.innerHeight -\r\n          loc.y -\r\n          self.style.autocompleteBottomMargin +\r\n          'px';\r\n        container.style.minWidth = pos.width + 'px';\r\n        loc.y += pos.height;\r\n      }\r\n      if (self.mobile) {\r\n        container.style.width = pos.width + 'px';\r\n      }\r\n      container.style.left = loc.x + 'px';\r\n      container.style.top = loc.y + 'px';\r\n      container.addEventListener('scroll', checkArrowVisibility);\r\n      container.addEventListener('wheel', function (e) {\r\n        if (self.hasFocus) {\r\n          container.scrollTop += e.deltaY;\r\n          container.scrollLeft += e.deltaX;\r\n        }\r\n        checkArrowVisibility();\r\n      });\r\n      upArrow.innerHTML = self.style.contextMenuArrowUpHTML;\r\n      downArrow.innerHTML = self.style.contextMenuArrowDownHTML;\r\n      container.appendChild(upArrow);\r\n      document.body.appendChild(downArrow);\r\n      document.body.appendChild(container);\r\n      rect = container.getBoundingClientRect();\r\n      // TODO: fix !(parentContextMenu && parentContextMenu.inputDropdown) state (autocomplete)\r\n      if (rect.bottom > window.innerHeight) {\r\n        if (!(parentContextMenu && parentContextMenu.inputDropdown)) {\r\n          loc.y -=\r\n            rect.bottom +\r\n            self.style.contextMenuWindowMargin -\r\n            window.innerHeight;\r\n        }\r\n        if (loc.y < 0) {\r\n          loc.y = self.style.contextMenuWindowMargin;\r\n        }\r\n        if (\r\n          container.offsetHeight >\r\n          window.innerHeight - self.style.contextMenuWindowMargin\r\n        ) {\r\n          container.style.height =\r\n            window.innerHeight - self.style.contextMenuWindowMargin * 2 + 'px';\r\n        }\r\n      }\r\n      if (rect.right > window.innerWidth) {\r\n        loc.x -=\r\n          rect.right - window.innerWidth + self.style.contextMenuWindowMargin;\r\n      }\r\n      if (loc.x < 0) {\r\n        loc.x = self.style.contextMenuWindowMargin;\r\n      }\r\n      if (loc.y < 0) {\r\n        loc.y = self.style.contextMenuWindowMargin;\r\n      }\r\n      container.style.left = loc.x + 'px';\r\n      container.style.top = loc.y + 'px';\r\n      rect = container.getBoundingClientRect();\r\n      upArrow.style.top = rect.top + 'px';\r\n      downArrow.style.top =\r\n        rect.top + rect.height - downArrow.offsetHeight + 'px';\r\n      upArrow.style.left = rect.left + 'px';\r\n      downArrow.style.left = rect.left + 'px';\r\n      downArrow.style.width = container.offsetWidth + 'px';\r\n      upArrow.style.width = container.offsetWidth + 'px';\r\n      downArrow.addEventListener('mouseover', startHoverScroll('down'));\r\n      downArrow.addEventListener('mouseout', endHoverScroll('down'));\r\n      upArrow.addEventListener('mouseover', startHoverScroll('up'));\r\n      upArrow.addEventListener('mouseout', endHoverScroll('up'));\r\n      checkArrowVisibility();\r\n    }\r\n    intf.parentGrid = self.intf;\r\n    intf.parentContextMenu = parentContextMenu;\r\n    intf.container = container;\r\n    init();\r\n    intf.clickIndex = clickIndex;\r\n    intf.rect = rect;\r\n    intf.items = items;\r\n    intf.upArrow = upArrow;\r\n    intf.downArrow = downArrow;\r\n    intf.dispose = function () {\r\n      clearTimeout(hoverScrollTimeout);\r\n      children.forEach(function (c) {\r\n        c.dispose();\r\n      });\r\n      [downArrow, upArrow, container].forEach(function (el) {\r\n        if (el.parentNode) {\r\n          el.parentNode.removeChild(el);\r\n        }\r\n      });\r\n    };\r\n    Object.defineProperty(intf, 'selectedIndex', {\r\n      get: function () {\r\n        return selectedIndex;\r\n      },\r\n      set: function (value) {\r\n        if (typeof value !== 'number' || isNaN(value || !isFinite(value))) {\r\n          throw new Error('Context menu selected index must be a sane number.');\r\n        }\r\n        selectedIndex = value;\r\n        if (selectedIndex > items.length - 1) {\r\n          selectedIndex = items.length - 1;\r\n        }\r\n        if (selectedIndex < 0) {\r\n          selectedIndex = 0;\r\n        }\r\n        items.forEach(function (item, index) {\r\n          if (index === selectedIndex) {\r\n            return self.createInlineStyle(\r\n              item.contextItemContainer,\r\n              'canvas-datagrid-context-menu-item:hover',\r\n            );\r\n          }\r\n          self.createInlineStyle(\r\n            item.contextItemContainer,\r\n            'canvas-datagrid-context-menu-item',\r\n          );\r\n        });\r\n      },\r\n    });\r\n    return intf;\r\n  }\r\n  function createFilterContextMenuItems(e) {\r\n    var filterContainer = document.createElement('div'),\r\n      filterLabel = document.createElement('div'),\r\n      filterAutoCompleteButton = document.createElement('button'),\r\n      filterInput = document.createElement('input'),\r\n      n =\r\n        e.cell && e.cell.header\r\n          ? e.cell.header.title || e.cell.header.name\r\n          : '',\r\n      iRect;\r\n    function checkRegExpErrorState() {\r\n      filterInput.style.background = self.style.contextFilterInputBackground;\r\n      filterInput.style.color = self.style.contextFilterInputColor;\r\n      if (self.invalidFilterRegEx) {\r\n        filterInput.style.background =\r\n          self.style.contextFilterInvalidRegExpBackground;\r\n        filterInput.style.color = self.style.contextFilterInvalidRegExpColor;\r\n      }\r\n    }\r\n    function fillAutoComplete() {\r\n      var count = 0;\r\n      var items = {};\r\n      var blanksItem = [];\r\n\r\n      self.viewData.forEach(function (row) {\r\n        var cellValue =\r\n          row[e.cell.header.name] == null\r\n            ? row[e.cell.header.name]\r\n            : String(row[e.cell.header.name]).trim();\r\n        var value = self.blankValues.includes(cellValue)\r\n          ? self.attributes.blanksText\r\n          : cellValue;\r\n\r\n        if (items[value] || count > self.attributes.maxAutoCompleteItems) {\r\n          return;\r\n        }\r\n        count += 1;\r\n        items[value] = {\r\n          title: self.formatters[e.cell.header.type || 'string']({\r\n            cell: { value: value },\r\n          }),\r\n          click: function (e) {\r\n            filterInput.value = value;\r\n            e.stopPropagation();\r\n            filterInput.dispatchEvent(new Event('keyup'));\r\n            self.disposeAutocomplete();\r\n            return;\r\n          },\r\n        };\r\n      });\r\n\r\n      if (Object.keys(items).indexOf(self.attributes.blanksText) !== -1) {\r\n        blanksItem.push(items[self.attributes.blanksText]);\r\n        delete items[self.attributes.blanksText];\r\n      }\r\n\r\n      return blanksItem.concat(\r\n        Object.keys(items).map(function (key) {\r\n          return items[key];\r\n        }),\r\n      );\r\n    }\r\n\r\n    function createAutoCompleteContext(ev) {\r\n      if (ev && ['ArrowDown', 'ArrowUp', 'Enter', 'Tab'].includes(ev.key)) {\r\n        return;\r\n      }\r\n\r\n      var autoCompleteItems = fillAutoComplete();\r\n\r\n      iRect = filterInput.getBoundingClientRect();\r\n      if (autoCompleteContext) {\r\n        autoCompleteContext.dispose();\r\n        autoCompleteContext = undefined;\r\n      }\r\n      autoCompleteContext = createContextMenu(\r\n        e,\r\n        {\r\n          left: iRect.left,\r\n          top: iRect.top,\r\n          right: iRect.right,\r\n          bottom: iRect.bottom,\r\n          height: iRect.height,\r\n          width: iRect.width,\r\n        },\r\n        autoCompleteItems,\r\n        { inputDropdown: true },\r\n      );\r\n      autoCompleteContext.selectedIndex = 0;\r\n    }\r\n    self.createInlineStyle(filterLabel, 'canvas-datagrid-context-menu-label');\r\n    self.createInlineStyle(\r\n      filterAutoCompleteButton,\r\n      'canvas-datagrid-context-menu-filter-button',\r\n    );\r\n    self.createInlineStyle(\r\n      filterInput,\r\n      'canvas-datagrid-context-menu-filter-input',\r\n    );\r\n    checkRegExpErrorState();\r\n    filterInput.onclick = self.disposeAutocomplete;\r\n    filterInput.addEventListener('keydown', function (e) {\r\n      if (e.key === 'ArrowDown') {\r\n        autoCompleteContext.selectedIndex += 1;\r\n      }\r\n\r\n      if (e.key === 'ArrowUp') {\r\n        autoCompleteContext.selectedIndex -= 1;\r\n      }\r\n\r\n      if (e.key === 'Enter') {\r\n        autoCompleteContext.clickIndex(autoCompleteContext.selectedIndex);\r\n        self.disposeContextMenu();\r\n      }\r\n\r\n      if (e.key === 'Tab') {\r\n        autoCompleteContext.clickIndex(autoCompleteContext.selectedIndex);\r\n        e.preventDefault();\r\n      }\r\n\r\n      if (e.key === 'Escape') {\r\n        self.disposeContextMenu();\r\n      }\r\n    });\r\n    filterInput.addEventListener('keyup', function () {\r\n      self.setFilter(e.cell.header.name, filterInput.value);\r\n    });\r\n    filterInput.addEventListener('keyup', createAutoCompleteContext);\r\n    ['focus', 'blur', 'keydown', 'keyup', 'change'].forEach(function (en) {\r\n      filterInput.addEventListener(en, checkRegExpErrorState);\r\n    });\r\n    filterInput.value = e.cell.header\r\n      ? self.columnFilters[e.cell.header.name] || ''\r\n      : '';\r\n    filterLabel.innerHTML = self.attributes.filterOptionText.replace(/%s/g, n);\r\n    filterAutoCompleteButton.onclick = function () {\r\n      if (autoCompleteContext) {\r\n        return self.disposeAutocomplete();\r\n      }\r\n      createAutoCompleteContext();\r\n    };\r\n    filterAutoCompleteButton.innerHTML = self.style.contextFilterButtonHTML;\r\n    filterContainer.addEventListener('click', function (e) {\r\n      return e.stopPropagation();\r\n    });\r\n    filterContainer.appendChild(filterLabel);\r\n    filterContainer.appendChild(filterInput);\r\n    filterContainer.appendChild(filterAutoCompleteButton);\r\n    e.items.push({\r\n      title: filterContainer,\r\n    });\r\n    if (Object.keys(self.columnFilters).length) {\r\n      Object.keys(self.columnFilters).forEach(function (cf) {\r\n        var h = self.getHeaderByName(cf);\r\n        e.items.push({\r\n          title: self.attributes.removeFilterOptionText.replace(\r\n            /%s/g,\r\n            h.title || h.name,\r\n          ),\r\n          click: function removeFilterClick(e) {\r\n            e.preventDefault();\r\n            self.setFilter(cf, '');\r\n            self.controlInput.focus();\r\n          },\r\n        });\r\n      });\r\n    }\r\n  }\r\n  function addDefaultContextMenuItem(e) {\r\n    var isNormalCell =\r\n      !(\r\n        e.cell.isBackground ||\r\n        e.cell.isColumnHeaderCellCap ||\r\n        e.cell.isScrollBar ||\r\n        e.cell.isCorner ||\r\n        e.cell.isRowHeader\r\n      ) && e.cell.header;\r\n    if (self.attributes.showFilter && isNormalCell) {\r\n      createFilterContextMenuItems(e);\r\n    }\r\n    if (\r\n      self.attributes.showCopy &&\r\n      self.selections.reduce(function (p, r) {\r\n        return p + r.length;\r\n      }, 0) > 0\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.copyText,\r\n        click: function () {\r\n          document.execCommand('copy');\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n    if (self.attributes.showPaste && self.clipBoardData) {\r\n      e.items.push({\r\n        title: self.attributes.pasteText,\r\n        click: function () {\r\n          self.paste(self.clipBoardData, e.cell.columnIndex, e.cell.rowIndex);\r\n          self.draw();\r\n        },\r\n      });\r\n    }\r\n    if (self.attributes.showColumnSelector) {\r\n      e.items.push({\r\n        title: self.attributes.columnSelectorText,\r\n        items: function () {\r\n          var d = [];\r\n          self.getSchema().forEach(function (column) {\r\n            function toggleColumnVisibility(e) {\r\n              column.hidden = !column.hidden;\r\n              self.dispatchEvent('togglecolumn', {\r\n                column: column,\r\n                hidden: column.hidden,\r\n              });\r\n              e.preventDefault();\r\n              self.stopPropagation(e);\r\n              self.disposeContextMenu();\r\n              self.resize(true);\r\n              self.setStorageData();\r\n            }\r\n            var el = document.createElement('div');\r\n            applyContextItemStyle(el);\r\n            el.addEventListener('touchstart', toggleColumnVisibility);\r\n            el.addEventListener('click', toggleColumnVisibility);\r\n            el.innerHTML =\r\n              (column.hidden\r\n                ? self.attributes.columnSelectorHiddenText\r\n                : self.attributes.columnSelectorVisibleText) +\r\n              (column.title || column.name);\r\n            d.push({\r\n              title: el,\r\n            });\r\n          });\r\n          return d;\r\n        },\r\n      });\r\n      if (e.cell && e.cell.header && e.cell.columnIndex > -1) {\r\n        e.items.push({\r\n          title: self.attributes.hideColumnText.replace(\r\n            /%s/gi,\r\n            e.cell.header.title || e.cell.header.name,\r\n          ),\r\n          click: function (ev) {\r\n            self.getSchema()[e.cell.columnIndex].hidden = true;\r\n            ev.preventDefault();\r\n            self.stopPropagation(ev);\r\n            self.disposeContextMenu();\r\n            self.setStorageData();\r\n            setTimeout(function () {\r\n              self.resize(true);\r\n            }, 10);\r\n          },\r\n        });\r\n      }\r\n    }\r\n    if (\r\n      self.attributes.saveAppearance &&\r\n      self.attributes.showClearSettingsOption &&\r\n      (Object.keys(self.sizes.rows).length > 0 ||\r\n        Object.keys(self.sizes.columns).length > 0)\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.clearSettingsOptionText,\r\n        click: function (e) {\r\n          e.preventDefault();\r\n          self.sizes.rows = {};\r\n          self.sizes.columns = {};\r\n          self.createRowOrders();\r\n          self.createColumnOrders();\r\n          self.storedSettings = undefined;\r\n          self.dispatchEvent('resizecolumn', {\r\n            columnWidth: self.style.cellWidth,\r\n          });\r\n          self.dispatchEvent('resizerow', {\r\n            cellHeight: self.style.cellHeight,\r\n          });\r\n          self.setStorageData();\r\n          self.resize(true);\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n    if (\r\n      self.attributes.allowSorting &&\r\n      self.attributes.showOrderByOption &&\r\n      isNormalCell\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.showOrderByOptionTextAsc.replace(\r\n          '%s',\r\n          e.cell.header.title || e.cell.header.name,\r\n        ),\r\n        click: function (ev) {\r\n          ev.preventDefault();\r\n          self.order(e.cell.header.name, 'asc');\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n      e.items.push({\r\n        title: self.attributes.showOrderByOptionTextDesc.replace(\r\n          '%s',\r\n          e.cell.header.title || e.cell.header.name,\r\n        ),\r\n        click: function (ev) {\r\n          ev.preventDefault();\r\n          self.order(e.cell.header.name, 'desc');\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n  }\r\n  self.disposeAutocomplete = function () {\r\n    if (autoCompleteContext) {\r\n      autoCompleteContext.dispose();\r\n      autoCompleteContext = undefined;\r\n    }\r\n  };\r\n  self.disposeContextMenu = function () {\r\n    document.removeEventListener('click', self.disposeContextMenu);\r\n    zIndexTop = self.style.contextMenuZIndex;\r\n    self.disposeAutocomplete();\r\n    if (self.contextMenu) {\r\n      self.contextMenu.dispose();\r\n    }\r\n    self.contextMenu = undefined;\r\n  };\r\n  self.contextmenuEvent = function (e, overridePos) {\r\n    if (!self.hasFocus && e.target !== self.canvas) {\r\n      return;\r\n    }\r\n    function createDiposeEvent() {\r\n      requestAnimationFrame(function () {\r\n        document.addEventListener('click', self.disposeContextMenu);\r\n        document.removeEventListener('mouseup', createDiposeEvent);\r\n      });\r\n    }\r\n    var contextPosition,\r\n      items = [],\r\n      pos = overridePos || self.getLayerPos(e),\r\n      ev = {\r\n        NativeEvent: e,\r\n        cell: self.getCellAt(pos.x, pos.y),\r\n        items: items,\r\n      };\r\n    if (!ev.cell.isGrid) {\r\n      addDefaultContextMenuItem(ev);\r\n    }\r\n    if (self.dispatchEvent('contextmenu', ev)) {\r\n      return;\r\n    }\r\n    if (!ev.cell.isGrid) {\r\n      if (self.contextMenu) {\r\n        self.disposeContextMenu();\r\n      }\r\n      contextPosition = {\r\n        left:\r\n          pos.x +\r\n          pos.rect.left +\r\n          self.style.contextMenuMarginLeft +\r\n          self.canvasOffsetLeft,\r\n        top:\r\n          pos.y +\r\n          pos.rect.top +\r\n          self.style.contextMenuMarginTop +\r\n          self.canvasOffsetTop,\r\n        right: ev.cell.width + ev.cell.x + pos.rect.left,\r\n        bottom: ev.cell.height + ev.cell.y + pos.rect.top,\r\n        height: ev.cell.height,\r\n        width: ev.cell.width,\r\n      };\r\n      if (self.mobile) {\r\n        contextPosition.left = self.style.mobileContextMenuMargin + 'px';\r\n        contextPosition.width =\r\n          self.width - self.style.mobileContextMenuMargin * 2 + 'px';\r\n      }\r\n      self.contextMenu = createContextMenu(ev, contextPosition, items);\r\n      document.addEventListener('mouseup', createDiposeEvent);\r\n      e.preventDefault();\r\n    }\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n\r\n'use strict';\r\nexport default function (self) {\r\n  self.defaults = {\r\n    attributes: [\r\n      ['allowColumnReordering', true],\r\n      ['allowColumnResize', true],\r\n      ['allowColumnResizeFromCell', false],\r\n      ['allowFreezingRows', false],\r\n      ['allowFreezingColumns', false],\r\n      ['allowMovingSelection', true],\r\n      ['allowRowHeaderResize', true],\r\n      ['allowRowReordering', false],\r\n      ['allowRowResize', true],\r\n      ['allowRowResizeFromCell', false],\r\n      ['allowSorting', true],\r\n      ['autoGenerateSchema', false],\r\n      ['autoResizeColumns', false],\r\n      ['autoResizeRows', false],\r\n      ['blanksText', '(Blanks)'],\r\n      ['borderDragBehavior', 'none'],\r\n      ['borderResizeZone', 10],\r\n      ['clearSettingsOptionText', 'Clear saved settings'],\r\n      ['columnHeaderClickBehavior', 'sort'],\r\n      ['columnSelectorHiddenText', '&nbsp;&nbsp;&nbsp;'],\r\n      ['columnSelectorText', 'Add/Remove columns'],\r\n      ['columnSelectorVisibleText', '\\u2713'],\r\n      ['contextHoverScrollAmount', 2],\r\n      ['contextHoverScrollRateMs', 5],\r\n      ['copyHeadersOnSelectAll', true],\r\n      ['copyText', 'Copy'],\r\n      ['debug', false],\r\n      ['editable', true],\r\n      ['ellipsisText', '...'],\r\n      ['filterOptionText', 'Filter %s'],\r\n      ['filterTextPrefix', '(filtered) '],\r\n      ['globalRowResize', false],\r\n      ['hideColumnText', 'Hide %s'],\r\n      ['hoverMode', 'cell'],\r\n      ['maxAutoCompleteItems', 200],\r\n      ['multiLine', false],\r\n      ['name', ''],\r\n      ['pageUpDownOverlap', 1],\r\n      ['pasteText', 'Paste'],\r\n      ['persistantSelectionMode', false],\r\n      ['removeFilterOptionText', 'Remove filter on %s'],\r\n      ['reorderDeadZone', 3],\r\n      ['resizeScrollZone', 20],\r\n      ['rowGrabZoneSize', 5],\r\n      ['saveAppearance', true],\r\n      ['scrollAnimationPPSThreshold', 0.75],\r\n      ['scrollPointerLock', false],\r\n      ['scrollRepeatRate', 75],\r\n      ['selectionFollowsActiveCell', false],\r\n      ['selectionHandleBehavior', 'none'],\r\n      ['selectionMode', 'cell'],\r\n      ['selectionScrollIncrement', 20],\r\n      ['selectionScrollZone', 20],\r\n      ['showClearSettingsOption', true],\r\n      ['showColumnHeaders', true],\r\n      ['showColumnSelector', true],\r\n      ['showCopy', false],\r\n      ['showFilter', true],\r\n      ['showNewRow', false],\r\n      ['showOrderByOption', true],\r\n      ['showOrderByOptionTextAsc', 'Order by %s ascending'],\r\n      ['showOrderByOptionTextDesc', 'Order by %s descending'],\r\n      ['showPaste', false],\r\n      ['showPerformance', false],\r\n      ['showRowHeaders', true],\r\n      ['showRowNumbers', true],\r\n      ['showRowNumberGaps', true],\r\n      ['singleSelectionMode', false],\r\n      ['snapToRow', false],\r\n      ['touchContextMenuTimeMs', 800],\r\n      ['touchDeadZone', 3],\r\n      ['touchEasingMethod', 'easeOutQuad'],\r\n      ['touchReleaseAcceleration', 1000],\r\n      ['touchReleaseAnimationDurationMs', 2000],\r\n      ['touchScrollZone', 20],\r\n      ['touchSelectHandleZone', 20],\r\n      ['touchZoomSensitivity', 0.005],\r\n      ['touchZoomMin', 0.5],\r\n      ['touchZoomMax', 1.75],\r\n      ['maxPixelRatio', 2],\r\n      ['tree', false],\r\n      ['treeHorizontalScroll', false],\r\n    ],\r\n    styles: [\r\n      ['activeCellBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['activeCellBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['activeCellBorderWidth', 1],\r\n      ['activeCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellFont', '16px sans-serif'],\r\n      ['activeCellHoverBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['activeCellHorizontalAlignment', 'left'],\r\n      ['activeCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['activeCellOverlayBorderWidth', 1],\r\n      ['activeCellPaddingBottom', 5],\r\n      ['activeCellPaddingLeft', 5],\r\n      ['activeCellPaddingRight', 5],\r\n      ['activeCellPaddingTop', 5],\r\n      ['activeCellSelectedBackgroundColor', 'rgba(236, 243, 255, 1)'],\r\n      ['activeCellSelectedColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellVerticalAlignment', 'center'],\r\n      ['activeColumnHeaderCellBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['activeColumnHeaderCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeRowHeaderCellBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['activeRowHeaderCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['autocompleteBottomMargin', 60],\r\n      ['autosizeHeaderCellPadding', 8],\r\n      ['autosizePadding', 5],\r\n      ['cellAutoResizePadding', 13],\r\n      ['cellBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['cellBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['cellBorderWidth', 1],\r\n      ['cellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellFont', '16px sans-serif'],\r\n      ['cellGridHeight', 250],\r\n      ['cellHeight', 24],\r\n      ['cellHeightWithChildGrid', 150],\r\n      ['cellHorizontalAlignment', 'left'],\r\n      ['cellHoverBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['cellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellPaddingBottom', 5],\r\n      ['cellPaddingLeft', 5],\r\n      ['cellPaddingRight', 5],\r\n      ['cellPaddingTop', 5],\r\n      ['cellSelectedBackgroundColor', 'rgba(236, 243, 255, 1)'],\r\n      ['cellSelectedColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellVerticalAlignment', 'center'],\r\n      ['cellWidth', 250],\r\n      ['cellWidthWithChildGrid', 250],\r\n      ['cellWhiteSpace', 'nowrap'],\r\n      ['cellLineHeight', 1],\r\n      ['cellLineSpacing', 3],\r\n      ['childContextMenuArrowColor', 'rgba(43, 48, 43, 1)'],\r\n      ['childContextMenuArrowHTML', '&#x25BA;'],\r\n      ['childContextMenuMarginLeft', -11],\r\n      ['childContextMenuMarginTop', -6],\r\n      ['columnHeaderCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['columnHeaderCellBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['columnHeaderCellBorderWidth', 1],\r\n      ['columnHeaderCellCapBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['columnHeaderCellCapBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['columnHeaderCellCapBorderWidth', 1],\r\n      ['columnHeaderCellColor', 'rgba(50, 50, 50, 1)'],\r\n      ['columnHeaderCellFont', '16px sans-serif'],\r\n      ['columnHeaderCellHeight', 25],\r\n      ['columnHeaderCellHorizontalAlignment', 'left'],\r\n      ['columnHeaderCellHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['columnHeaderCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['columnHeaderCellPaddingBottom', 5],\r\n      ['columnHeaderCellPaddingLeft', 5],\r\n      ['columnHeaderCellPaddingRight', 5],\r\n      ['columnHeaderCellPaddingTop', 5],\r\n      ['columnHeaderCellVerticalAlignment', 'center'],\r\n      ['columnHeaderOrderByArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['columnHeaderOrderByArrowBorderWidth', 1],\r\n      ['columnHeaderOrderByArrowColor', 'rgba(155, 155, 155, 1)'],\r\n      ['columnHeaderOrderByArrowHeight', 8],\r\n      ['columnHeaderOrderByArrowMarginLeft', 0],\r\n      ['columnHeaderOrderByArrowMarginRight', 5],\r\n      ['columnHeaderOrderByArrowMarginTop', 6],\r\n      ['columnHeaderOrderByArrowWidth', 13],\r\n      ['contextFilterButtonBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextFilterButtonBorderRadius', '3px'],\r\n      ['contextFilterButtonHTML', '&#x25BC;'],\r\n      ['contextFilterInputBackground', 'rgba(255,255,255,1)'],\r\n      ['contextFilterInputBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextFilterInputBorderRadius', '0'],\r\n      ['contextFilterInputColor', 'rgba(0,0,0,1)'],\r\n      ['contextFilterInputFontFamily', 'sans-serif'],\r\n      ['contextFilterInputFontSize', '14px'],\r\n      ['contextFilterInvalidRegExpBackground', 'rgba(180, 6, 1, 1)'],\r\n      ['contextFilterInvalidRegExpColor', 'rgba(255, 255, 255, 1)'],\r\n      ['contextMenuArrowColor', 'rgba(43, 48, 43, 1)'],\r\n      ['contextMenuArrowDownHTML', '&#x25BC;'],\r\n      ['contextMenuArrowUpHTML', '&#x25B2;'],\r\n      ['contextMenuBackground', 'rgba(240, 240, 240, 1)'],\r\n      ['contextMenuBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextMenuBorderRadius', '3px'],\r\n      ['contextMenuChildArrowFontSize', '12px'],\r\n      ['contextMenuColor', 'rgba(43, 48, 43, 1)'],\r\n      ['contextMenuCursor', 'default'],\r\n      ['contextMenuFilterButtonFontFamily', 'sans-serif'],\r\n      ['contextMenuFilterButtonFontSize', '10px'],\r\n      ['contextMenuFilterInvalidExpresion', 'rgba(237, 155, 156, 1)'],\r\n      ['contextMenuFontFamily', 'sans-serif'],\r\n      ['contextMenuFontSize', '16px'],\r\n      ['contextMenuHoverBackground', 'rgba(182, 205, 250, 1)'],\r\n      ['contextMenuHoverColor', 'rgba(43, 48, 153, 1)'],\r\n      ['contextMenuItemBorderRadius', '3px'],\r\n      ['contextMenuItemMargin', '2px'],\r\n      ['contextMenuLabelDisplay', 'inline-block'],\r\n      ['contextMenuLabelMargin', '0 3px 0 0'],\r\n      ['contextMenuLabelMaxWidth', '700px'],\r\n      ['contextMenuLabelMinWidth', '75px'],\r\n      ['contextMenuMarginLeft', 3],\r\n      ['contextMenuMarginTop', -3],\r\n      ['contextMenuOpacity', '0.98'],\r\n      ['contextMenuPadding', '2px'],\r\n      ['contextMenuWindowMargin', 30],\r\n      ['contextMenuZIndex', 10000],\r\n      ['cornerCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['cornerCellBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['debugBackgroundColor', 'rgba(0, 0, 0, .0)'],\r\n      ['debugColor', 'rgba(255, 15, 24, 1)'],\r\n      ['debugEntitiesColor', 'rgba(76, 231, 239, 1.00)'],\r\n      ['debugFont', '11px sans-serif'],\r\n      ['debugPerfChartBackground', 'rgba(29, 25, 26, 1.00)'],\r\n      ['debugPerfChartTextColor', 'rgba(255, 255, 255, 0.8)'],\r\n      ['debugPerformanceColor', 'rgba(252, 255, 37, 1.00)'],\r\n      ['debugScrollHeightColor', 'rgba(248, 33, 103, 1.00)'],\r\n      ['debugScrollWidthColor', 'rgba(66, 255, 27, 1.00)'],\r\n      ['debugTouchPPSXColor', 'rgba(246, 102, 24, 1.00)'],\r\n      ['debugTouchPPSYColor', 'rgba(186, 0, 255, 1.00)'],\r\n      ['display', 'inline-block'],\r\n      ['editCellBackgroundColor', 'white'],\r\n      ['editCellBorder', 'solid 1px rgba(110, 168, 255, 1)'],\r\n      ['editCellBoxShadow', '0 2px 5px rgba(0,0,0,0.4)'],\r\n      ['editCellColor', 'black'],\r\n      ['editCellFontFamily', 'sans-serif'],\r\n      ['editCellFontSize', '16px'],\r\n      ['editCellPaddingLeft', 4],\r\n      ['editCellZIndex', 10000],\r\n      ['frozenMarkerHoverColor', 'rgba(236, 243, 255, 1)'],\r\n      ['frozenMarkerHoverBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['frozenMarkerActiveColor', 'rgba(236, 243, 255, 1)'],\r\n      ['frozenMarkerActiveBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['frozenMarkerColor', 'rgba(222, 222, 222, 1)'],\r\n      ['frozenMarkerBorderColor', 'rgba(168, 168, 168, 1)'],\r\n      ['frozenMarkerBorderWidth', 1],\r\n      ['frozenMarkerWidth', 2],\r\n      ['gridBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['gridBorderCollapse', 'collapse'],\r\n      ['gridBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['gridBorderWidth', 1],\r\n      ['height', 'auto'],\r\n      ['maxHeight', 'inherit'],\r\n      ['maxWidth', 'inherit'],\r\n      ['minColumnWidth', 45],\r\n      ['minHeight', 'inherit'],\r\n      ['minRowHeight', 24],\r\n      ['minWidth', 'inherit'],\r\n      ['mobileContextMenuMargin', 10],\r\n      ['mobileEditInputHeight', 30],\r\n      ['mobileEditFontFamily', 'sans-serif'],\r\n      ['mobileEditFontSize', '16px'],\r\n      ['moveOverlayBorderWidth', 1],\r\n      ['moveOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['moveOverlayBorderSegments', '12, 7'],\r\n      ['name', 'default'],\r\n      ['overflowY', 'auto'],\r\n      ['overflowX', 'auto'],\r\n      ['reorderMarkerBackgroundColor', 'rgba(0, 0, 0, 0.1)'],\r\n      ['reorderMarkerBorderColor', 'rgba(0, 0, 0, 0.2)'],\r\n      ['reorderMarkerBorderWidth', 1.25],\r\n      ['reorderMarkerIndexBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['reorderMarkerIndexBorderWidth', 2.75],\r\n      ['rowHeaderCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['rowHeaderCellBorderColor', 'rgba(200, 200, 200, 1)'],\r\n      ['rowHeaderCellBorderWidth', 1],\r\n      ['rowHeaderCellColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellFont', '16px sans-serif'],\r\n      ['rowHeaderCellHeight', 25],\r\n      ['rowHeaderCellHorizontalAlignment', 'left'],\r\n      ['rowHeaderCellHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['rowHeaderCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['rowHeaderCellPaddingBottom', 5],\r\n      ['rowHeaderCellPaddingLeft', 5],\r\n      ['rowHeaderCellPaddingRight', 5],\r\n      ['rowHeaderCellPaddingTop', 5],\r\n      ['rowHeaderCellRowNumberGapHeight', 5],\r\n      ['rowHeaderCellRowNumberGapColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellSelectedBackgroundColor', 'rgba(217, 217, 217, 1)'],\r\n      ['rowHeaderCellSelectedColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellVerticalAlignment', 'center'],\r\n      ['rowHeaderCellWidth', 57],\r\n      ['scrollBarActiveColor', 'rgba(125, 125, 125, 1)'],\r\n      ['scrollBarBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['scrollBarBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['scrollBarBorderWidth', 0.5],\r\n      ['scrollBarBoxBorderRadius', 4.125],\r\n      ['scrollBarBoxColor', 'rgba(192, 192, 192, 1)'],\r\n      ['scrollBarBoxMargin', 2],\r\n      ['scrollBarBoxMinSize', 15],\r\n      ['scrollBarBoxWidth', 8],\r\n      ['scrollBarCornerBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['scrollBarCornerBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['scrollBarWidth', 11],\r\n      ['selectionHandleBorderColor', 'rgba(255, 255, 255, 1)'],\r\n      ['selectionHandleBorderWidth', 1.5],\r\n      ['selectionHandleColor', 'rgba(66, 133, 244, 1)'],\r\n      ['selectionHandleSize', 8],\r\n      ['selectionHandleType', 'square'],\r\n      ['selectionOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['selectionOverlayBorderWidth', 1],\r\n      ['treeArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['treeArrowBorderWidth', 1],\r\n      ['treeArrowClickRadius', 5],\r\n      ['treeArrowColor', 'rgba(155, 155, 155, 1)'],\r\n      ['treeArrowHeight', 8],\r\n      ['treeArrowMarginLeft', 0],\r\n      ['treeArrowMarginRight', 5],\r\n      ['treeArrowMarginTop', 6],\r\n      ['treeArrowWidth', 13],\r\n      ['treeGridHeight', 250],\r\n      ['width', 'auto'],\r\n    ],\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\n'use strict';\n\nexport default function (self) {\n  self.getClippingRect = function (ele) {\n    var boundingRect = self.position(self.parentNode),\n      eleRect = self.position(ele),\n      s = self.scrollOffset(self.canvas),\n      clipRect = {\n        x: 0,\n        y: 0,\n        h: 0,\n        w: 0,\n      },\n      parentRect = {\n        x: -Infinity,\n        y: -Infinity,\n        h: Infinity,\n        w: Infinity,\n      },\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\n      rowHeaderCellWidth = self.getRowHeaderCellWidth();\n    boundingRect.top -= s.top;\n    boundingRect.left -= s.left;\n    eleRect.top -= s.top;\n    eleRect.left -= s.left;\n    clipRect.h =\n      boundingRect.top +\n      boundingRect.height -\n      ele.offsetTop -\n      self.style.scrollBarWidth;\n    clipRect.w =\n      boundingRect.left +\n      boundingRect.width -\n      ele.offsetLeft -\n      self.style.scrollBarWidth;\n    clipRect.x = boundingRect.left + eleRect.left * -1 + rowHeaderCellWidth;\n    clipRect.y = boundingRect.top + eleRect.top * -1 + columnHeaderCellHeight;\n    return {\n      x: clipRect.x > parentRect.x ? clipRect.x : parentRect.x,\n      y: clipRect.y > parentRect.y ? clipRect.y : parentRect.y,\n      h: clipRect.h < parentRect.h ? clipRect.h : parentRect.h,\n      w: clipRect.w < parentRect.w ? clipRect.w : parentRect.w,\n    };\n  };\n  self.clipElement = function (ele) {\n    var clipRect = self.getClippingRect(ele);\n    if (clipRect.w < 0) {\n      clipRect.w = 0;\n    }\n    if (clipRect.h < 0) {\n      clipRect.h = 0;\n    }\n    ele.style.clip =\n      'rect(' +\n      clipRect.y +\n      'px,' +\n      clipRect.w +\n      'px,' +\n      clipRect.h +\n      'px,' +\n      clipRect.x +\n      'px' +\n      ')';\n    // INFO https://developer.mozilla.org/en-US/docs/Web/CSS/clip\n    // clip has been \"deprecated\" for clipPath.  Of course nothing but chrome\n    // supports clip path, so we'll keep using clip until someday clipPath becomes\n    // more widely support.  The code below works correctly, but setting clipPath and clip\n    // at the same time has undesirable results.\n    // ele.style.clipPath = 'polygon('\n    //     + clipRect.x + 'px ' + clipRect.y + 'px,'\n    //     + clipRect.x + 'px ' + clipRect.h + 'px,'\n    //     + clipRect.w + 'px ' + clipRect.h + 'px,'\n    //     + clipRect.w + 'px ' + clipRect.y + 'px'\n    //     + ')';\n  };\n  self.scrollOffset = function (e) {\n    var x = 0,\n      y = 0,\n      scrollingElement = document.scrollingElement || {\n        scrollLeft: 0,\n        scrollTop: 0,\n      };\n    while (\n      e.parentNode &&\n      e.nodeName !== 'CANVAS-DATAGRID' &&\n      e !== self.intf\n    ) {\n      if (\n        e.nodeType !== 'canvas-datagrid-tree' &&\n        e.nodeType !== 'canvas-datagrid-cell'\n      ) {\n        x -= e.scrollLeft;\n        y -= e.scrollTop;\n      }\n      e = e.parentNode;\n    }\n    return {\n      left: x - scrollingElement.scrollLeft,\n      top: y - scrollingElement.scrollTop,\n    };\n  };\n  self.resizeEditInput = function () {\n    if (self.input && self.input.editCell) {\n      var pos = self.canvas.getBoundingClientRect(),\n        s = self.scrollOffset(self.intf),\n        bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\n        borderWidth = self.style.cellBorderWidth * bm,\n        cell = self.getVisibleCellByIndex(\n          self.input.editCell.columnIndex,\n          self.input.editCell.rowIndex,\n        ) || { x: -100, y: -100, height: 0, width: 0 };\n      if (self.mobile) {\n        self.input.style.left = '0';\n        self.input.style.top =\n          self.height -\n          self.style.mobileEditInputHeight -\n          borderWidth -\n          1 +\n          'px';\n        self.input.style.height = self.style.mobileEditInputHeight + 'px';\n        self.input.style.width = self.width - borderWidth - 1 + 'px';\n        return;\n      }\n      self.input.style.left =\n        pos.left + cell.x + self.canvasOffsetLeft - s.left + 'px';\n      self.input.style.top =\n        pos.top +\n        cell.y -\n        self.style.cellBorderWidth +\n        self.canvasOffsetTop -\n        s.top +\n        'px';\n      self.input.style.height = cell.height - borderWidth + 'px';\n      self.input.style.width = cell.width - self.style.cellPaddingLeft + 'px';\n      self.clipElement(self.input);\n    }\n  };\n  self.position = function (e, ignoreScrollOffset) {\n    var x = 0,\n      y = 0,\n      s = e,\n      h,\n      w;\n    while (e.offsetParent && e.nodeName !== 'CANVAS-DATAGRID') {\n      x += e.offsetLeft;\n      y += e.offsetTop;\n      h = e.offsetHeight;\n      w = e.offsetWidth;\n      e = e.offsetParent;\n    }\n    if (ignoreScrollOffset) {\n      return { left: x, top: y, height: h, width: w };\n    }\n    e = s;\n    s = self.scrollOffset(e);\n    return { left: x + s.left, top: y + s.top, height: h, width: w };\n  };\n  self.getLayerPos = function (e) {\n    var rect = self.canvas.getBoundingClientRect(),\n      pos = {\n        x: e.clientX - rect.left,\n        y: e.clientY - rect.top,\n      };\n    if (self.isChildGrid) {\n      pos.x -= self.canvasOffsetLeft;\n      pos.y -= self.canvasOffsetTop;\n    }\n    return {\n      x: pos.x,\n      y: pos.y,\n      rect: rect,\n    };\n  };\n  /**\n   * Ends editing, optionally aborting the edit.\n   * @memberof canvasDatagrid\n   * @name endEdit\n   * @method\n   * @param {boolean} abort When true, abort the edit.\n   */\n  self.endEdit = function (abort) {\n    var cell = self.input.editCell,\n      y = cell.rowIndex;\n    function abortEdit() {\n      abort = true;\n    }\n    var ev = {\n        cell: cell,\n        newValue: self.input.value,\n        oldValue: cell.value,\n        abort: abortEdit,\n        input: self.input,\n      };\n    if (\n      self.dispatchEvent('beforeendedit', ev)\n    ) {\n      return false;\n    }\n    if (ev.objValue != undefined && typeof ev.objValue === 'object' && !abort) {\n      self.changes[y] = self.changes[y] || {};\n      self.changes[y][cell.header.name] = ev.objValue;\n      if (!cell.data) {\n        self.originalData[cell.boundRowIndex] = {};\n        cell.data = self.originalData[cell.boundRowIndex];\n      }\n      cell.data[cell.header.name] = ev.objValue;\n      if (y === self.viewData.length) {\n        var ev2={\n            value: self.input.value,\n            defaultValue: cell.value,\n            aborted: abort,\n            cell: cell,\n            input: self.input,\n            objValue: ev.objValue\n          };\n        if (\n          self.dispatchEvent('newrow', ev2)\n        ) {\n          return false;\n        }\n        self.addRow(cell.data);\n        self.createNewRowData();\n      }\n      self.draw(true);\n\n    }\n    else {\n     if (self.input.value !== cell.value && !abort) {\n      self.changes[y] = self.changes[y] || {};\n      self.changes[y][cell.header.name] = self.input.value;\n      if (!cell.data) {\n        self.originalData[cell.boundRowIndex] = {};\n        cell.data = self.originalData[cell.boundRowIndex];\n      }\n      cell.data[cell.header.name] = self.input.value;\n      if (y === self.viewData.length) {\n        if (\n          self.dispatchEvent('newrow', {\n            value: self.input.value,\n            defaultValue: cell.value,\n            aborted: abort,\n            cell: cell,\n            input: self.input,\n          })\n        ) {\n          return false;\n        }\n        self.addRow(cell.data);\n        self.createNewRowData();\n      }\n      self.draw(true);\n     }\n    }\n    if (self.input.parentNode) {\n      self.input.parentNode.removeChild(self.input);\n    }\n    self.intf.focus();\n    self.dispatchEvent('endedit', {\n      cell: cell,\n      value: self.input.value,\n      aborted: abort,\n      input: self.input,\n    });\n    self.input = undefined;\n    return true;\n  };\n  /**\n   * Begins editing at cell x, row y.\n   * @memberof canvasDatagrid\n   * @name beginEditAt\n   * @method\n   * @param {number} x The column index of the cell to edit.\n   * @param {number} y The row index of the cell to edit.\n   * @param {boolean} inEnterMode If true, starting to type in cell will replace the\n   * cell's previous value instead of appending, and using the arrow keys will allow\n   * the user to navigate to adjacent cells instead of moving the text cursor around\n   * (default is false, and means user is in 'edit' mode).\n   */\n  self.beginEditAt = function (x, y, NativeEvent, inEnterMode = false) {\n    if (!self.attributes.editable) {\n      return;\n    }\n    if (self.input) {\n      self.endEdit();\n    }\n    var cell = self.getVisibleCellByIndex(x, y),\n      s = self.getSchema(),\n      adjacentCells,\n      enumItems,\n      enu,\n      option,\n      valueInEnum;\n    if (!(cell && cell.header)) {\n      return;\n    }\n    //HACK for IE10, does not like literal enum\n    enu = cell.header['enum'];\n    if (\n      self.dispatchEvent('beforebeginedit', {\n        cell: cell,\n        NativeEvent: NativeEvent,\n      })\n    ) {\n      return false;\n    }\n    self.scrollIntoView(x, y);\n    self.setActiveCell(x, y);\n    adjacentCells = self.getAdjacentCells();\n    if (enu) {\n      self.input = document.createElement('select');\n    } else {\n      self.input = document.createElement(\n        self.attributes.multiLine ? 'textarea' : 'input',\n      );\n    }\n    cell = self.getVisibleCellByIndex(x, y);\n    //HACK on mobile devices sometimes edit can begin without the cell being in view, I don't know how.\n    if (!cell) {\n      return;\n    }\n    if (enu) {\n      // add enums\n      if (typeof enu === 'function') {\n        enumItems = enu.apply(self.intf, [{ cell: cell }]);\n      } else if (Array.isArray(enu)) {\n        enumItems = enu;\n      }\n      enumItems.forEach(function (e) {\n        var i = document.createElement('option'),\n          val,\n          title;\n        if (Array.isArray(e)) {\n          val = e[0];\n          title = e[1];\n        } else {\n          val = e;\n          title = e;\n        }\n        if (val === cell.value) {\n          valueInEnum = true;\n        }\n        i.value = val;\n        i.innerHTML = title;\n        self.input.appendChild(i);\n      });\n      if (!valueInEnum) {\n        option = document.createElement('option');\n        option.value = cell.value;\n        option.innerHTML = cell.value;\n        self.input.appendChild(option);\n      }\n      self.input.addEventListener('change', function () {\n        self.endEdit();\n        self.draw(true);\n      });\n    }\n    // if the user has not prevented the default action, append to the body\n    if (\n      !self.dispatchEvent('appendeditinput', { cell: cell, input: self.input })\n    ) {\n      document.body.appendChild(self.input);\n    }\n    self.createInlineStyle(\n      self.input,\n      self.mobile\n        ? 'canvas-datagrid-edit-mobile-input'\n        : 'canvas-datagrid-edit-input',\n    );\n    self.input.style.position = 'absolute';\n    self.input.editCell = cell;\n    self.resizeEditInput();\n    self.input.style.zIndex = self.style.editCellZIndex;\n    self.input.style.fontSize =\n      parseInt(self.style.editCellFontSize, 10) * self.scale + 'px';\n\n    var cellValueIsEmpty = [null, undefined].indexOf(cell.value) !== -1;\n    var shouldClearCellValue = cellValueIsEmpty || inEnterMode;\n\n    if (typeof cell.value === 'object') {\n      var ev = {\n        value: cell.value,\n        row: { endCap: '' },\n        header: cell.header,\n        cell: cell,\n        event: 'beginedit',\n      };\n      var f = self.formatters[cell.header.type || 'string'];\n      if (f) {\n        self.input.value = shouldClearCellValue ? '' : f(ev);\n      }\n    } else {\n      self.input.value = shouldClearCellValue ? '' : cell.value;\n    }\n    self.input.focus();\n    self.input.addEventListener('click', self.stopPropagation);\n    self.input.addEventListener('dblclick', self.stopPropagation);\n    self.input.addEventListener('mouseup', self.stopPropagation);\n    self.input.addEventListener('mousedown', self.stopPropagation);\n    self.input.addEventListener('keydown', function (e) {\n      var nx = cell.columnIndex,\n        ny = cell.rowIndex;\n\n      if (e.key === 'Escape') {\n        self.endEdit(true); // end edit and abort the value change\n        self.draw(true);\n      } else if (e.key === 'Enter' && self.attributes.multiLine && e.altKey) {\n        self.input.value = self.input.value + '\\n';\n        self.input.scrollTop = self.input.scrollHeight;\n      } else if (e.key === 'Enter') {\n        self.endEdit();\n\n        // Move to cell in next or previous row\n        var nextRowIndex = e.shiftKey\n          ? Math.max(0, ny - 1)\n          : Math.min(ny + 1, self.viewData.length - 1);\n\n        if (nextRowIndex !== ny) {\n          self.scrollIntoView(nx, nextRowIndex);\n          self.setActiveCell(nx, nextRowIndex);\n        }\n\n        self.draw(true);\n      } else if (\n        ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key) &&\n        inEnterMode\n      ) {\n        switch (e.key) {\n          case 'ArrowUp':\n            ny = Math.max(0, ny - 1);\n            break;\n          case 'ArrowDown':\n            ny = Math.min(ny + 1, self.viewData.length - 1);\n            break;\n          case 'ArrowLeft':\n            nx = Math.max(nx - 1, 0);\n            break;\n          case 'ArrowRight':\n            nx = adjacentCells.right;\n            break;\n        }\n\n        self.endEdit();\n\n        self.scrollIntoView(nx, ny);\n        self.setActiveCell(nx, ny);\n\n        self.draw(true);\n      } else if (e.key === 'Tab') {\n        e.preventDefault();\n        if (!self.endEdit()) {\n          return;\n        }\n        if (e.shiftKey) {\n          nx = adjacentCells.left;\n        } else {\n          nx = adjacentCells.right;\n        }\n        if (adjacentCells.left === x && e.shiftKey) {\n          nx = adjacentCells.last;\n          ny -= 1;\n        }\n        if (adjacentCells.right === x && !e.shiftKey) {\n          nx = adjacentCells.first;\n          ny += 1;\n        }\n        if (ny < 0) {\n          ny = self.viewData.length - 1;\n        }\n        if (ny > self.viewData.length - 1) {\n          ny = 0;\n        }\n        self.scrollIntoView(nx, ny);\n        self.beginEditAt(nx, ny, e);\n      }\n    });\n\n    self.dispatchEvent('beginedit', { cell: cell, input: self.input });\n  };\n  self.createInlineStyle = function (el, className) {\n    var css = {\n      'canvas-datagrid-context-menu-filter-input': {\n        height: '19px',\n        verticalAlign: 'bottom',\n        marginLeft: '2px',\n        padding: '0',\n        background: self.style.contextFilterInputBackground,\n        color: self.style.contextFilterInputColor,\n        border: self.style.contextFilterInputBorder,\n        borderRadius: self.style.contextFilterInputBorderRadius,\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextFilterInputFontFamily,\n        fontSize: self.style.contextFilterInputFontSize,\n      },\n      'canvas-datagrid-context-menu-filter-button': {\n        height: '19px',\n        verticalAlign: 'bottom',\n        marginLeft: '2px',\n        padding: '0',\n        background: self.style.contextMenuBackground,\n        color: self.style.contextMenuColor,\n        border: self.style.contextFilterButtonBorder,\n        borderRadius: self.style.contextFilterButtonBorderRadius,\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextMenuFilterButtonFontFamily,\n        fontSize: self.style.contextMenuFilterButtonFontSize,\n      },\n      'canvas-datagrid-context-child-arrow': {\n        cssFloat: 'right',\n        color: self.style.childContextMenuArrowColor,\n        fontSize: self.style.contextMenuChildArrowFontSize,\n        fontFamily: self.style.contextMenuFontFamily,\n        verticalAlign: 'middle',\n      },\n      'canvas-datagrid-autocomplete': {\n        fontFamily: self.style.contextMenuFontFamily,\n        fontSize: self.style.contextMenuFontSize,\n        background: self.style.contextMenuBackground,\n        color: self.style.contextMenuColor,\n        border: self.style.contextMenuBorder,\n        padding: self.style.contextMenuPadding,\n        borderRadius: self.style.contextMenuBorderRadius,\n        opacity: self.style.contextMenuOpacity,\n        position: 'absolute',\n        zIndex: 9999,\n        overflow: 'hidden',\n      },\n      'canvas-datagrid-autocomplete-item': {\n        background: self.style.contextMenuBackground,\n        color: self.style.contextMenuColor,\n      },\n      'canvas-datagrid-autocomplete-item:hover': {\n        background: self.style.contextMenuHoverBackground,\n        color: self.style.contextMenuHoverColor,\n      },\n      'canvas-datagrid-canvas': {\n        position: 'absolute',\n        zIndex: '-1',\n      },\n      'canvas-datagrid': {\n        display: 'block',\n      },\n      'canvas-datagrid-control-input': {\n        position: 'fixed',\n        top: '-5px',\n        left: '-5px',\n        border: 'none',\n        opacity: '0',\n        cursor: 'pointer',\n        width: '1px',\n        height: '1px',\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextMenuFontFamily,\n        fontSize: self.style.contextMenuFontSize,\n      },\n      'canvas-datagrid-edit-mobile-input': {\n        boxSizing: 'content-box',\n        outline: 'none',\n        margin: '0',\n        padding: '0 0 0 0',\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.mobileEditFontFamily,\n        fontSize: self.style.mobileEditFontSize,\n        border: self.style.editCellBorder,\n        color: self.style.editCellColor,\n        background: self.style.editCellBackgroundColor,\n        appearance: 'none',\n        webkitAppearance: 'none',\n        mozAppearance: 'none',\n        borderRadius: '0',\n      },\n      'canvas-datagrid-edit-input': {\n        boxSizing: 'content-box',\n        outline: 'none',\n        margin: '0',\n        padding: '0 0 0 ' + self.style.editCellPaddingLeft + 'px',\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.editCellFontFamily,\n        fontSize: self.style.editCellFontSize,\n        boxShadow: self.style.editCellBoxShadow,\n        border: self.style.editCellBorder,\n        color: self.style.editCellColor,\n        background: self.style.editCellBackgroundColor,\n        appearance: 'none',\n        webkitAppearance: 'none',\n        mozAppearance: 'none',\n        borderRadius: '0',\n      },\n      'canvas-datagrid-context-menu-item-mobile': {\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextMenuFontFamily,\n        fontSize: self.style.contextMenuFontSize,\n        color: 'inherit',\n        background: 'inherit',\n        margin: self.style.contextMenuItemMargin,\n        borderRadius: self.style.contextMenuItemBorderRadius,\n        verticalAlign: 'middle',\n      },\n      'canvas-datagrid-context-menu-item': {\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextMenuFontFamily,\n        fontSize: self.style.contextMenuFontSize,\n        color: 'inherit',\n        background: 'inherit',\n        margin: self.style.contextMenuItemMargin,\n        borderRadius: self.style.contextMenuItemBorderRadius,\n        verticalAlign: 'middle',\n      },\n      'canvas-datagrid-context-menu-item:hover': {\n        background: self.style.contextMenuHoverBackground,\n        color: self.style.contextMenuHoverColor,\n      },\n      'canvas-datagrid-context-menu-label': {\n        margin: self.style.contextMenuLabelMargin,\n        display: self.style.contextMenuLabelDisplay,\n        minWidth: self.style.contextMenuLabelMinWidth,\n        maxWidth: self.style.contextMenuLabelMaxWidth,\n      },\n      'canvas-datagrid-context-menu-mobile': {\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextMenuFontFamily,\n        fontSize: self.style.contextMenuFontSize,\n        background: self.style.contextMenuBackground,\n        color: self.style.contextMenuColor,\n        border: self.style.contextMenuBorder,\n        padding: self.style.contextMenuPadding,\n        borderRadius: self.style.contextMenuBorderRadius,\n        opacity: self.style.contextMenuOpacity,\n        overflow: 'hidden',\n        whiteSpace: 'nowrap',\n      },\n      'canvas-datagrid-context-menu': {\n        lineHeight: 'normal',\n        fontWeight: 'normal',\n        fontFamily: self.style.contextMenuFontFamily,\n        fontSize: self.style.contextMenuFontSize,\n        background: self.style.contextMenuBackground,\n        color: self.style.contextMenuColor,\n        border: self.style.contextMenuBorder,\n        padding: self.style.contextMenuPadding,\n        borderRadius: self.style.contextMenuBorderRadius,\n        opacity: self.style.contextMenuOpacity,\n        overflow: 'hidden',\n        whiteSpace: 'nowrap',\n        cursor: self.style.contextMenuCursor,\n      },\n      'canvas-datagrid-invalid-search-regExp': {\n        background: self.style.contextMenuFilterInvalidExpresion,\n      },\n    };\n    if (css[className]) {\n      Object.keys(css[className]).map(function (prop) {\n        el.style[prop] = css[className][prop];\n      });\n    }\n    return;\n  };\n  self.appendTo = function (e) {\n    self.parentNode = e;\n    self.setDom();\n  };\n  self.setDom = function () {\n    if (self.isChildGrid) {\n      self.parentGrid = self.parentNode.parentGrid;\n      self.ctx = self.parentGrid.context;\n      self.canvas = self.parentGrid.canvas;\n      self.controlInput = self.parentGrid.controlInput;\n      self.eventParent = self.canvas;\n    } else {\n      self.controlInput = self.controlInput || document.createElement('input');\n      self.controlInput.onblur = self.intf.blur;\n      self.createInlineStyle(\n        self.controlInput,\n        'canvas-datagrid-control-input',\n      );\n      self.isChildGrid = false;\n      self.parentDOMNode = self.parentNode;\n      self.parentIsCanvas = /^canvas$/i.test(self.parentDOMNode.tagName);\n      if (self.parentIsCanvas) {\n        self.canvas = self.parentDOMNode;\n      } else {\n        self.canvas = document.createElement('canvas');\n        self.parentDOMNode.appendChild(self.canvas);\n      }\n      document.body.appendChild(self.controlInput);\n      self.createInlineStyle(self.canvas, 'canvas-datagrid');\n      self.ctx = self.canvas.getContext('2d');\n      self.ctx.textBaseline = 'alphabetic';\n      self.eventParent = self.canvas;\n    }\n    self.parentNodeStyle = self.canvas.style;\n    self.controlInput.setAttribute('readonly', true);\n    self.controlInput.addEventListener('blur', function (e) {\n      if (e.target !== self.canvas) {\n        self.hasFocus = false;\n      }\n    });\n    self.eventParent.addEventListener('scroll', self.resize, false);\n    self.eventParent.addEventListener('touchstart', self.touchstart, false);\n    self.eventParent.addEventListener('mouseup', self.mouseup, false);\n    self.eventParent.addEventListener('mousedown', self.mousedown, false);\n    self.eventParent.addEventListener('dblclick', self.dblclick, false);\n    self.eventParent.addEventListener('click', self.click, false);\n    self.eventParent.addEventListener('mousemove', self.mousemove);\n    self[self.isChildGrid ? 'parentGrid' : 'eventParent'].addEventListener(\n      'wheel',\n      self.scrollWheel,\n      false,\n    );\n    self.canvas.addEventListener('contextmenu', self.contextmenuEvent, false);\n    self.controlInput.addEventListener('copy', self.copy);\n    self.controlInput.addEventListener('cut', self.cut);\n    self.controlInput.addEventListener('paste', self.paste);\n    self.controlInput.addEventListener('keypress', self.keypress, false);\n    self.controlInput.addEventListener('keyup', self.keyup, false);\n    self.controlInput.addEventListener('keydown', self.keydown, false);\n    window.addEventListener('resize', self.resize);\n  };\n}\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals XMLSerializer: false, define: true, Blob: false, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var perfCounters = [],\r\n    cachedImagesDrawn = false,\r\n    drawCount = 0,\r\n    perfWindowSize = 300,\r\n    entityCount = [],\r\n    hiddenFrozenColumnCount = 0,\r\n    scrollDebugCounters = [],\r\n    touchPPSCounters = [];\r\n  self.htmlImageCache = {};\r\n  // more heavyweight version than fillArray defined in intf.js\r\n  function fillArray(low, high, step, def) {\r\n    step = step || 1;\r\n    var i = [],\r\n      x;\r\n    for (x = low; x <= high; x += step) {\r\n      i[x] = def === undefined ? x : typeof def === 'function' ? def(x) : def;\r\n    }\r\n    return i;\r\n  }\r\n  function drawPerfLine(w, h, x, y, perfArr, arrIndex, max, color, useAbs) {\r\n    var i = w / perfArr.length,\r\n      r = h / max;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.moveTo(x, y + h);\r\n    perfArr.forEach(function (n) {\r\n      var val = arrIndex === undefined ? n : n[arrIndex],\r\n        cx,\r\n        cy;\r\n      if (useAbs) {\r\n        val = Math.abs(val);\r\n      }\r\n      cx = x + i;\r\n      cy = y + h - val * r;\r\n      self.ctx.lineTo(cx, cy);\r\n      x += i;\r\n    });\r\n    self.ctx.moveTo(x + w, y + h);\r\n    self.ctx.strokeStyle = color;\r\n    self.ctx.stroke();\r\n  }\r\n  function drawOnAllImagesLoaded() {\r\n    var loaded = true;\r\n    Object.keys(self.htmlImageCache).forEach(function (html) {\r\n      if (!self.htmlImageCache[html].img.complete) {\r\n        loaded = false;\r\n      }\r\n    });\r\n    if (loaded && !cachedImagesDrawn) {\r\n      cachedImagesDrawn = true;\r\n      self.draw();\r\n    }\r\n  }\r\n  function drawHtml(cell) {\r\n    var img,\r\n      v = cell.innerHTML || cell.formattedValue,\r\n      cacheKey =\r\n        v.toString() + cell.rowIndex.toString() + cell.columnIndex.toString(),\r\n      x = Math.round(cell.x + self.canvasOffsetLeft),\r\n      y = Math.round(cell.y + self.canvasOffsetTop);\r\n    if (self.htmlImageCache[cacheKey]) {\r\n      img = self.htmlImageCache[cacheKey].img;\r\n      if (\r\n        self.htmlImageCache[cacheKey].height !== cell.height ||\r\n        self.htmlImageCache[cacheKey].width !== cell.width\r\n      ) {\r\n        // height and width of the cell has changed, invalidate cache\r\n        self.htmlImageCache[cacheKey] = undefined;\r\n      } else {\r\n        if (!img.complete) {\r\n          return;\r\n        }\r\n        return self.ctx.drawImage(img, x, y);\r\n      }\r\n    } else {\r\n      cachedImagesDrawn = false;\r\n    }\r\n    img = new Image(cell.width, cell.height);\r\n    self.htmlImageCache[cacheKey] = {\r\n      img,\r\n      width: cell.width,\r\n      height: cell.height,\r\n    };\r\n    img.onload = function () {\r\n      self.ctx.drawImage(img, x, y);\r\n      drawOnAllImagesLoaded();\r\n    };\r\n    img.src =\r\n      'data:image/svg+xml;base64,' +\r\n      btoa(\r\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' +\r\n          cell.width +\r\n          '\" height=\"' +\r\n          cell.height +\r\n          '\">\\n' +\r\n          '<foreignObject class=\"node\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\\n' +\r\n          '<body xmlns=\"http://www.w3.org/1999/xhtml\" style=\"margin:0;padding:0;\">\\n' +\r\n          v +\r\n          '\\n' +\r\n          '</body>' +\r\n          '</foreignObject>\\n' +\r\n          '</svg>\\n',\r\n      );\r\n  }\r\n  function drawOrderByArrow(x, y) {\r\n    var mt = self.style.columnHeaderOrderByArrowMarginTop * self.scale,\r\n      ml = self.style.columnHeaderOrderByArrowMarginLeft * self.scale,\r\n      mr = self.style.columnHeaderOrderByArrowMarginRight * self.scale,\r\n      aw = self.style.columnHeaderOrderByArrowWidth * self.scale,\r\n      ah = self.style.columnHeaderOrderByArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.columnHeaderOrderByArrowColor;\r\n    self.ctx.strokeStyle = self.style.columnHeaderOrderByArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n    if (self.orderDirection === 'asc') {\r\n      self.ctx.moveTo(x, y);\r\n      self.ctx.lineTo(x + aw, y);\r\n      self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n      self.ctx.moveTo(x, y);\r\n    } else {\r\n      self.ctx.lineTo(x, y + ah);\r\n      self.ctx.lineTo(x + aw, y + ah);\r\n      self.ctx.lineTo(x + aw * 0.5, y);\r\n      self.ctx.lineTo(x, y + ah);\r\n    }\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw + mr;\r\n  }\r\n  function drawTreeArrow(cell, x, y) {\r\n    var mt = self.style.treeArrowMarginTop * self.scale,\r\n      mr = self.style.treeArrowMarginRight * self.scale,\r\n      ml = self.style.treeArrowMarginLeft * self.scale,\r\n      aw = self.style.treeArrowWidth * self.scale,\r\n      ah = self.style.treeArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.treeArrowColor;\r\n    self.ctx.strokeStyle = self.style.treeArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n    if (self.openChildren[cell.rowIndex]) {\r\n      self.ctx.moveTo(x, y);\r\n      self.ctx.lineTo(x + aw, y);\r\n      self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n      self.ctx.moveTo(x, y);\r\n    } else {\r\n      self.ctx.lineTo(x, y);\r\n      self.ctx.lineTo(x + ah, y + aw * 0.5);\r\n      self.ctx.lineTo(x, y + aw);\r\n      self.ctx.lineTo(x, y);\r\n    }\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw + mr;\r\n  }\r\n  function radiusRect(x, y, w, h, radius) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    var r = x + w,\r\n      b = y + h;\r\n    self.ctx.beginPath();\r\n    self.ctx.moveTo(x + radius, y);\r\n    self.ctx.lineTo(r - radius, y);\r\n    self.ctx.quadraticCurveTo(r, y, r, y + radius);\r\n    self.ctx.lineTo(r, y + h - radius);\r\n    self.ctx.quadraticCurveTo(r, b, r - radius, b);\r\n    self.ctx.lineTo(x + radius, b);\r\n    self.ctx.quadraticCurveTo(x, b, x, b - radius);\r\n    self.ctx.lineTo(x, y + radius);\r\n    self.ctx.quadraticCurveTo(x, y, x + radius, y);\r\n  }\r\n  function fillRect(x, y, w, h) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillRect(x, y, w, h);\r\n  }\r\n  function strokeRect(x, y, w, h) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.strokeRect(x, y, w, h);\r\n  }\r\n  function fillText(text, x, y) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillText(text, x, y);\r\n  }\r\n  function fillCircle(x, y, r) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    self.ctx.fill();\r\n  }\r\n  function strokeCircle(x, y, r) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    self.ctx.stroke();\r\n  }\r\n  function clipFrozenArea(mode) {\r\n    // 0 both, 1 rows, 2 cols\r\n    // self.lastFrozenColumnPixel;\r\n    // self.lastFrozenRowPixel;\r\n    self.ctx.beginPath();\r\n    if (mode === 0) {\r\n      self.ctx.moveTo(self.lastFrozenColumnPixel, self.lastFrozenRowPixel);\r\n      self.ctx.lineTo(self.lastFrozenColumnPixel, self.height);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.width, self.lastFrozenRowPixel);\r\n    }\r\n    if (mode === 1) {\r\n      self.ctx.moveTo(0, self.lastFrozenRowPixel);\r\n      self.ctx.lineTo(0, self.height);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.width, self.lastFrozenRowPixel);\r\n    }\r\n    if (mode === 2) {\r\n      self.ctx.moveTo(self.lastFrozenColumnPixel, 0);\r\n      self.ctx.lineTo(self.width, 0);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.lastFrozenColumnPixel, self.height);\r\n    }\r\n    self.ctx.clip();\r\n  }\r\n  function fillHandle(x, y, r) {\r\n    if (self.style.selectionHandleType === 'circle') {\r\n      return fillCircle(x, y, r * 0.5);\r\n    }\r\n    fillRect(x - r * 0.5, y - r * 0.5, r, r);\r\n  }\r\n  function strokeHandle(x, y, r) {\r\n    if (self.style.selectionHandleType === 'circle') {\r\n      return strokeCircle(x, y, r * 0.5);\r\n    }\r\n    strokeRect(x - r * 0.5, y - r * 0.5, r, r);\r\n  }\r\n  function addselectionHandle(c, pos) {\r\n    var hw = self.style.selectionHandleSize,\r\n      p = {\r\n        tr: function () {\r\n          fillHandle(c.x + c.width, c.y, hw);\r\n          strokeHandle(c.x + c.width, c.y, hw);\r\n        },\r\n        br: function () {\r\n          fillHandle(c.x + c.width, c.y + c.height, hw);\r\n          strokeHandle(c.x + c.width, c.y + c.height, hw);\r\n        },\r\n        tl: function () {\r\n          fillHandle(c.x, c.y, hw);\r\n          strokeHandle(c.x, c.y, hw);\r\n        },\r\n        bl: function () {\r\n          fillHandle(c.x, c.y + c.height, hw);\r\n          strokeHandle(c.x, c.y + c.height, hw);\r\n        },\r\n      };\r\n    p[pos]();\r\n  }\r\n  function addBorderLine(c, pos) {\r\n    self.ctx.beginPath();\r\n    var p = {\r\n      t: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n      },\r\n      r: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n      b: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n      l: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n    };\r\n    p[pos]();\r\n    self.ctx.stroke();\r\n  }\r\n  function addEllipsis(text, width) {\r\n    var c,\r\n      w = 0;\r\n    if (self.ellipsisCache[text] && self.ellipsisCache[text][width]) {\r\n      return self.ellipsisCache[text][width];\r\n    }\r\n    //TODO Add ellipsis back when there is a fast way to do it\r\n    w = self.ctx.measureText(text).width;\r\n    self.ellipsisCache[text] = self.ellipsisCache[text] || {};\r\n    c = { value: text, width: w };\r\n    self.ellipsisCache[text][width] = c;\r\n    return c;\r\n  }\r\n  function wrapText(cell, splitChar) {\r\n    if (!cell.formattedValue) {\r\n      return {\r\n        lines: [{ width: 0, value: '' }],\r\n        width: 0,\r\n        height: cell.calculatedLineHeight,\r\n      };\r\n    }\r\n    var max = 0,\r\n      n = '\\n',\r\n      x,\r\n      word,\r\n      words = cell.formattedValue.split(splitChar),\r\n      textHeight = cell.calculatedLineHeight,\r\n      lines = [],\r\n      out = [],\r\n      wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n      autoResize = self.attributes.autoResizeRows && wrap,\r\n      elWidth,\r\n      et = self.attributes.ellipsisText,\r\n      elClipLength,\r\n      plWidth,\r\n      clippedVal,\r\n      ogWordWidth,\r\n      previousLine,\r\n      line = {\r\n        width: 0,\r\n        value: '',\r\n      },\r\n      cHeight = wrap ? cell.paddedHeight : cell.calculatedLineHeight;\r\n    lines.push(line);\r\n    elWidth = self.ctx.measureText(' ' + et).width;\r\n    for (x = 0; x < words.length; x += 1) {\r\n      word = words[x];\r\n      var measure = self.ctx.measureText(word + splitChar);\r\n      if (line.width + measure.width + elWidth < cell.paddedWidth) {\r\n        line.value += word + splitChar;\r\n        line.width += measure.width;\r\n        continue;\r\n      }\r\n      // if there is a hyphenated word that is too long\r\n      // split it and add the split set to the array\r\n      // then back up and re-read new split set\r\n      // this behavior seems right, it might not be\r\n      if (/\\w-\\w/.test(word) && cell.paddedWidth < measure.width) {\r\n        words.splice(x, 1, word.split('-')[0] + '-', word.split('-')[1]);\r\n        x -= 1;\r\n        continue;\r\n      }\r\n      line = {\r\n        width: measure.width,\r\n        value: word + splitChar,\r\n      };\r\n      if (x === 0) {\r\n        lines = [];\r\n        lines.push(line);\r\n      }\r\n      textHeight += cell.calculatedLineHeight;\r\n      if (textHeight > cHeight && !autoResize) {\r\n        if (lines.length === 0) {\r\n          break;\r\n        }\r\n        elClipLength = 1;\r\n        previousLine = lines[lines.length - 1];\r\n        if (previousLine.width < cell.paddedWidth && words.length === 1) {\r\n          break;\r\n        }\r\n        clippedVal = previousLine.value + word;\r\n        plWidth = self.ctx.measureText(clippedVal + et).width;\r\n        var originText = clippedVal;\r\n        if (plWidth > cell.paddedWidth) {\r\n          var stepLength = parseInt(clippedVal.length / 2);\r\n          var direction = -1;\r\n          while (stepLength > 0) {\r\n            clippedVal = originText.substr(\r\n              0,\r\n              stepLength * direction + clippedVal.length,\r\n            );\r\n            plWidth = self.ctx.measureText(clippedVal + et).width;\r\n            direction = plWidth > cell.paddedWidth ? -1 : 1;\r\n            stepLength = parseInt(stepLength / 2);\r\n          }\r\n        }\r\n        clippedVal =\r\n          clippedVal + (originText.length != clippedVal.length ? et : '');\r\n        previousLine.value = clippedVal;\r\n        previousLine.width = plWidth;\r\n        break;\r\n      }\r\n      if (x > 0) {\r\n        lines.push(line);\r\n      }\r\n    }\r\n    return {\r\n      lines: lines,\r\n      width: max,\r\n      height: cell.calculatedLineHeight * lines.length,\r\n    };\r\n  }\r\n  function drawText(cell) {\r\n    var ll = cell.text.lines.length,\r\n      h = cell.fontHeight * cell.lineHeight,\r\n      x,\r\n      line,\r\n      wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n      textHeight = 0;\r\n    for (x = 0; x < cell.text.lines.length; x += 1) {\r\n      line = cell.text.lines[x];\r\n      var vPos =\r\n          Math.max(\r\n            (cell.height -\r\n              (wrap ? cell.text.height : cell.calculatedLineHeight)) *\r\n              0.5,\r\n            0,\r\n          ) + h,\r\n        hPos = cell.paddingLeft + cell.treeArrowWidth + cell.orderByArrowWidth;\r\n      if (cell.horizontalAlignment === 'right') {\r\n        hPos = cell.paddingLeft + cell.paddedWidth - line.width;\r\n      } else if (cell.horizontalAlignment === 'center') {\r\n        hPos =\r\n          cell.paddingLeft +\r\n          (cell.paddedWidth + cell.paddingRight) / 2 -\r\n          line.width / 2;\r\n      }\r\n      if (cell.verticalAlignment === 'top') {\r\n        vPos = cell.calculatedLineHeight;\r\n      } else if (cell.verticalAlignment === 'bottom') {\r\n        vPos = cell.height - cell.paddingBottom - cell.text.height;\r\n      }\r\n      line.height = h + cell.lineSpacing;\r\n      line.offsetLeft = hPos;\r\n      line.offsetTop = vPos;\r\n      line.x = cell.x + hPos;\r\n      line.y = cell.y + textHeight + vPos;\r\n      textHeight += line.height;\r\n      fillText(line.value, line.x, line.y);\r\n    }\r\n    if (self.attributes.debug && cell.active) {\r\n      requestAnimationFrame(function () {\r\n        self.ctx.font = self.style.debugFont;\r\n        self.ctx.fillStyle = self.style.debugColor;\r\n        fillText(\r\n          JSON.stringify(\r\n            {\r\n              x: cell.x,\r\n              y: cell.y,\r\n              h: cell.height,\r\n              w: cell.width,\r\n              pw: cell.paddedWidth,\r\n              idx: cell.columnIndex,\r\n              idx_ord: cell.sortColumnIndex,\r\n            },\r\n            null,\r\n            '\\t',\r\n          ),\r\n          cell.x + 14,\r\n          cell.y + 14,\r\n        );\r\n        fillText(\r\n          JSON.stringify(\r\n            cell.text.lines.map(function (l) {\r\n              return { w: l.width, v: l.value.length };\r\n            }),\r\n            null,\r\n            '\\t',\r\n          ),\r\n          cell.x + 14,\r\n          cell.y + 30,\r\n        );\r\n      });\r\n    }\r\n  }\r\n  function getFrozenColumnsWidth() {\r\n    var w = 0,\r\n      s = self.getSchema(),\r\n      x = 0,\r\n      n = Math.min(self.frozenColumn, s.length),\r\n      column;\r\n    hiddenFrozenColumnCount = 0;\r\n    while (x < n) {\r\n      column = s[x];\r\n      if (column.hidden) {\r\n        hiddenFrozenColumnCount += 1;\r\n      } else {\r\n        w += self.getColumnWidth(x);\r\n      }\r\n      x += 1;\r\n    }\r\n    return w;\r\n  }\r\n  /**\r\n   * Redraws the grid. No matter what the change, this is the only method required to refresh everything.\r\n   * @memberof canvasDatagrid\r\n   * @name draw\r\n   * @method\r\n   */\r\n  // r = literal row index\r\n  // rd = row data array\r\n  // i = user order index\r\n  // o = literal data index\r\n  // y = y drawing cursor\r\n  // x = x drawing cursor\r\n  // s = visible schema array\r\n  // cx = current x drawing cursor sub calculation var\r\n  // cy = current y drawing cursor sub calculation var\r\n  // a = static cell (like corner cell)\r\n  // p = perf counter\r\n  // l = data length\r\n  // u = current cell\r\n  // h = current height\r\n  // w = current width\r\n  self.draw = function (internal) {\r\n    if (self.dispatchEvent('beforedraw', {})) {\r\n      return;\r\n    }\r\n    if (!self.isChildGrid && (!self.height || !self.width)) {\r\n      return;\r\n    }\r\n    if (self.isChildGrid && internal) {\r\n      requestAnimationFrame(self.parentGrid.draw);\r\n      return;\r\n    }\r\n    if (self.intf.visible === false) {\r\n      return;\r\n    }\r\n    // initial values\r\n    var checkScrollHeight,\r\n      rowHeaderCell,\r\n      p,\r\n      cx,\r\n      cy,\r\n      treeGrid,\r\n      rowOpen,\r\n      rowHeight,\r\n      cornerCell,\r\n      y,\r\n      x,\r\n      c,\r\n      h,\r\n      w,\r\n      schema,\r\n      rowIndex,\r\n      rowData,\r\n      aCell,\r\n      viewData = self.viewData || [],\r\n      bc = self.style.gridBorderCollapse === 'collapse',\r\n      selectionBorders = [],\r\n      moveBorders = [],\r\n      selectionHandles = [],\r\n      rowHeaders = [],\r\n      l = viewData.length,\r\n      u = self.currentCell || {},\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      cellHeight = self.style.cellHeight;\r\n    drawCount += 1;\r\n    p = performance.now();\r\n    self.visibleRowHeights = [];\r\n    // if data length has changed, there is no way to know\r\n    if (viewData.length > self.orders.rows.length) {\r\n      self.createRowOrders();\r\n    }\r\n    function drawScrollBars() {\r\n      var drawCorner,\r\n        en = self.scrollBox.entities,\r\n        m = self.style.scrollBarBoxMargin * 2;\r\n      self.ctx.strokeStyle = self.style.scrollBarBorderColor;\r\n      self.ctx.lineWidth = self.style.scrollBarBorderWidth;\r\n      en.horizontalBox.x =\r\n        rowHeaderCellWidth +\r\n        self.style.scrollBarBoxMargin +\r\n        (en.horizontalBar.width - self.scrollBox.scrollBoxWidth) *\r\n          (self.scrollBox.scrollLeft / self.scrollBox.scrollWidth);\r\n      en.verticalBox.y =\r\n        columnHeaderCellHeight +\r\n        self.style.scrollBarBoxMargin +\r\n        (en.verticalBar.height - self.scrollBox.scrollBoxHeight) *\r\n          (self.scrollBox.scrollTop / self.scrollBox.scrollHeight);\r\n      if (self.scrollBox.horizontalBarVisible) {\r\n        self.ctx.fillStyle = self.style.scrollBarBackgroundColor;\r\n        fillRect(\r\n          en.horizontalBar.x,\r\n          en.horizontalBar.y,\r\n          en.horizontalBar.width + m,\r\n          en.horizontalBar.height,\r\n        );\r\n        strokeRect(\r\n          en.horizontalBar.x,\r\n          en.horizontalBar.y,\r\n          en.horizontalBar.width + m,\r\n          en.horizontalBar.height,\r\n        );\r\n        self.ctx.fillStyle = self.style.scrollBarBoxColor;\r\n        if (self.scrollBox.horizontalBoxVisible) {\r\n          if (/horizontal/.test(u.context)) {\r\n            self.ctx.fillStyle = self.style.scrollBarActiveColor;\r\n          }\r\n          radiusRect(\r\n            en.horizontalBox.x,\r\n            en.horizontalBox.y,\r\n            en.horizontalBox.width,\r\n            en.horizontalBox.height,\r\n            self.style.scrollBarBoxBorderRadius,\r\n          );\r\n          self.ctx.stroke();\r\n          self.ctx.fill();\r\n        }\r\n        drawCorner = true;\r\n        self.visibleCells.unshift(en.horizontalBar);\r\n        self.visibleCells.unshift(en.horizontalBox);\r\n      }\r\n      if (self.scrollBox.verticalBarVisible) {\r\n        self.ctx.fillStyle = self.style.scrollBarBackgroundColor;\r\n        fillRect(\r\n          en.verticalBar.x,\r\n          en.verticalBar.y,\r\n          en.verticalBar.width,\r\n          en.verticalBar.height + m,\r\n        );\r\n        strokeRect(\r\n          en.verticalBar.x,\r\n          en.verticalBar.y,\r\n          en.verticalBar.width,\r\n          en.verticalBar.height + m,\r\n        );\r\n        if (self.scrollBox.verticalBoxVisible) {\r\n          self.ctx.fillStyle = self.style.scrollBarBoxColor;\r\n          if (/vertical/.test(u.context)) {\r\n            self.ctx.fillStyle = self.style.scrollBarActiveColor;\r\n          }\r\n          radiusRect(\r\n            en.verticalBox.x,\r\n            en.verticalBox.y,\r\n            en.verticalBox.width,\r\n            en.verticalBox.height,\r\n            self.style.scrollBarBoxBorderRadius,\r\n          );\r\n          self.ctx.stroke();\r\n          self.ctx.fill();\r\n        }\r\n        drawCorner = true;\r\n        self.visibleCells.unshift(en.verticalBar);\r\n        self.visibleCells.unshift(en.verticalBox);\r\n      }\r\n      if (drawCorner) {\r\n        //corner\r\n        self.ctx.strokeStyle = self.style.scrollBarCornerBorderColor;\r\n        self.ctx.fillStyle = self.style.scrollBarCornerBackgroundColor;\r\n        radiusRect(\r\n          en.corner.x,\r\n          en.corner.y,\r\n          en.corner.width,\r\n          en.corner.height,\r\n          0,\r\n        );\r\n        self.ctx.stroke();\r\n        self.ctx.fill();\r\n        self.visibleCells.unshift(en.corner);\r\n      }\r\n    }\r\n    function createHandlesOverlayArray(cell) {\r\n      if (self.attributes.allowMovingSelection || self.mobile) {\r\n        if (\r\n          cell.selectionBorderTop &&\r\n          cell.selectionBorderRight &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'tr']);\r\n          cell.selectionHandle = 'tr';\r\n        }\r\n        if (\r\n          cell.selectionBorderTop &&\r\n          cell.selectionBorderLeft &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'tl']);\r\n          cell.selectionHandle = 'tl';\r\n        }\r\n        if (\r\n          cell.selectionBorderBottom &&\r\n          cell.selectionBorderLeft &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'bl']);\r\n          cell.selectionHandle = 'bl';\r\n        }\r\n        if (\r\n          cell.selectionBorderBottom &&\r\n          cell.selectionBorderRight &&\r\n          (self.attributes.selectionHandleBehavior !== 'none' || self.mobile)\r\n        ) {\r\n          selectionHandles.push([cell, 'br']);\r\n          cell.selectionHandle = 'br';\r\n        }\r\n      }\r\n    }\r\n    function createBorderOverlayArray(\r\n      cell,\r\n      drawArray,\r\n      propPrefix,\r\n      offsetPoint,\r\n    ) {\r\n      offsetPoint = offsetPoint || { x: 0, y: 0 };\r\n      cell.selectionBorder = '';\r\n      if (\r\n        !cell.isRowHeader &&\r\n        self.selections[cell.rowIndex + -offsetPoint.y] &&\r\n        self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n          cell.columnIndex + -offsetPoint.x,\r\n        ) !== -1\r\n      ) {\r\n        if (\r\n          (!self.selections[cell.rowIndex - 1 + -offsetPoint.y] ||\r\n            self.selections[cell.rowIndex - 1 + -offsetPoint.y].indexOf(\r\n              cell.columnIndex + -offsetPoint.x,\r\n            ) === -1 ||\r\n            cell.rowIndex === 0) &&\r\n          !cell.isHeader\r\n        ) {\r\n          drawArray.push([cell, 't']);\r\n          cell[propPrefix + 'BorderTop'] = true;\r\n          cell[propPrefix + 'Border'] += 't';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + 1 + -offsetPoint.y] ||\r\n          self.selections[cell.rowIndex + 1 + -offsetPoint.y].indexOf(\r\n            cell.columnIndex + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'b']);\r\n          cell[propPrefix + 'BorderBottom'] = true;\r\n          cell[propPrefix + 'Border'] += 'b';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + -offsetPoint.y] ||\r\n          cell.columnIndex === 0 ||\r\n          self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n            cell.columnIndex - 1 + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'l']);\r\n          cell[propPrefix + 'BorderLeft'] = true;\r\n          cell[propPrefix + 'Border'] += 'l';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + -offsetPoint.y] ||\r\n          cell.columnIndex === schema.length ||\r\n          self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n            cell.columnIndex + 1 + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'r']);\r\n          cell[propPrefix + 'BorderRight'] = true;\r\n          cell[propPrefix + 'Border'] += 'r';\r\n        }\r\n      }\r\n    }\r\n    function drawCell(rowData, rowOrderIndex, rowIndex) {\r\n      return function drawEach(header, headerIndex, columnOrderIndex) {\r\n        if (header.hidden) {\r\n          return 0;\r\n        }\r\n        var cellStyle = header.style || 'cell',\r\n          cellGridAttributes,\r\n          cell,\r\n          isHeader = /HeaderCell/.test(cellStyle),\r\n          isCorner = /cornerCell/.test(cellStyle),\r\n          isRowHeader = 'rowHeaderCell' === cellStyle,\r\n          isColumnHeader = 'columnHeaderCell' === cellStyle,\r\n          wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n          selected =\r\n            self.selections[rowOrderIndex] &&\r\n            self.selections[rowOrderIndex].indexOf(columnOrderIndex) !== -1,\r\n          hovered =\r\n            self.hovers.rowIndex === rowOrderIndex &&\r\n            (self.attributes.hoverMode === 'row' ||\r\n              self.hovers.columnIndex === columnOrderIndex),\r\n          active =\r\n            self.activeCell.rowIndex === rowOrderIndex &&\r\n            self.activeCell.columnIndex === columnOrderIndex,\r\n          isColumnHeaderCellCap = cellStyle === 'columnHeaderCellCap',\r\n          rawValue = rowData ? rowData[header.name] : undefined,\r\n          isGrid = header.type === 'canvas-datagrid',\r\n          activeHeader =\r\n            (self.orders.rows[self.activeCell.rowIndex] === rowOrderIndex ||\r\n              self.orders.columns[self.activeCell.columnIndex] ===\r\n                headerIndex) &&\r\n            (columnOrderIndex === -1 || rowOrderIndex === -1)\r\n              ? isRowHeader\r\n                ? 'activeRowHeaderCell'\r\n                : 'activeColumnHeaderCell'\r\n              : false,\r\n          val,\r\n          f = self.formatters[header.type || 'string'],\r\n          orderByArrowSize = 0,\r\n          treeArrowSize = 0,\r\n          cellWidth = self.sizes.columns[headerIndex] || header.width,\r\n          ev = {\r\n            value: rawValue,\r\n            row: rowData,\r\n            header: header,\r\n          };\r\n        if (isColumnHeaderCellCap) {\r\n          cellWidth = w - x;\r\n        }\r\n        // if no data or schema are defined, a width is provided to the stub column\r\n        if (cellWidth === undefined) {\r\n          cellWidth = self.style.cellWidth;\r\n        }\r\n        cellWidth = cellWidth * self.scale;\r\n        if (x + cellWidth + self.style.cellBorderWidth < 0) {\r\n          x += cellWidth + self.style.cellBorderWidth;\r\n        }\r\n        if (active && cellStyle !== 'cornerCell') {\r\n          cellStyle = 'activeCell';\r\n        }\r\n        if (self.visibleRows.indexOf(rowIndex) === -1 && !isHeader) {\r\n          self.visibleRows.push(rowIndex);\r\n        }\r\n        val = self.dispatchEvent('formatcellvalue', ev);\r\n        cx = x;\r\n        cy = y;\r\n        if (cellStyle === 'cornerCell') {\r\n          cx = 0;\r\n          cy = 0;\r\n        } else if (isRowHeader) {\r\n          cx = 0;\r\n        } else if (isHeader) {\r\n          cy = 0;\r\n        }\r\n        cell = {\r\n          type: isGrid ? 'canvas-datagrid-cell' : header.type,\r\n          style: cellStyle,\r\n          nodeType: 'canvas-datagrid-cell',\r\n          x: cx,\r\n          y: cy,\r\n          fontHeight: (self.style[cellStyle + 'FontHeight'] || 0) * self.scale,\r\n          horizontalAlignment: self.style[cellStyle + 'HorizontalAlignment'],\r\n          verticalAlignment: self.style[cellStyle + 'VerticalAlignment'],\r\n          paddingLeft:\r\n            (self.style[cellStyle + 'PaddingLeft'] || 0) * self.scale,\r\n          paddingTop: (self.style[cellStyle + 'PaddingTop'] || 0) * self.scale,\r\n          paddingRight:\r\n            (self.style[cellStyle + 'PaddingRight'] || 0) * self.scale,\r\n          paddingBottom:\r\n            (self.style[cellStyle + 'PaddingBottom'] || 0) * self.scale,\r\n          whiteSpace: self.style.cellWhiteSpace,\r\n          lineHeight: self.style.cellLineHeight,\r\n          lineSpacing: self.style.cellLineSpacing,\r\n          offsetTop: self.canvasOffsetTop + cy,\r\n          offsetLeft: self.canvasOffsetLeft + cx,\r\n          scrollTop: self.scrollBox.scrollTop,\r\n          scrollLeft: self.scrollBox.scrollLeft,\r\n          active: active || activeHeader,\r\n          hovered: hovered,\r\n          selected: selected,\r\n          width: cellWidth,\r\n          height: cellHeight,\r\n          offsetWidth: cellWidth,\r\n          offsetHeight: cellHeight,\r\n          parentNode: self.intf.parentNode,\r\n          offsetParent: self.intf.parentNode,\r\n          data: rowData,\r\n          isCorner: isCorner,\r\n          isHeader: isHeader,\r\n          isColumnHeader: isColumnHeader,\r\n          isColumnHeaderCellCap: isColumnHeaderCellCap,\r\n          isRowHeader: isRowHeader,\r\n          rowOpen: rowOpen,\r\n          header: header,\r\n\r\n          columnIndex: columnOrderIndex,\r\n          rowIndex: rowOrderIndex,\r\n\r\n          viewRowIndex: rowOrderIndex,\r\n          viewColumnIndex: columnOrderIndex,\r\n\r\n          boundRowIndex: self.getBoundRowIndexFromViewRowIndex(rowOrderIndex),\r\n          boundColumnIndex: columnOrderIndex,\r\n\r\n          sortColumnIndex: headerIndex,\r\n          sortRowIndex: rowIndex,\r\n\r\n          isGrid: isGrid,\r\n          isNormal: !isGrid && !isCorner && !isHeader,\r\n          gridId: (self.attributes.name || '') + rowIndex + ':' + headerIndex,\r\n          parentGrid: self.intf,\r\n          innerHTML: '',\r\n          activeHeader: activeHeader,\r\n          value:\r\n            isHeader && !isRowHeader ? header.title || header.name : rawValue,\r\n        };\r\n        cell.calculatedLineHeight =\r\n          cell.fontHeight * cell.lineHeight + cell.lineSpacing;\r\n        cell.paddedWidth = cell.width - cell.paddingRight - cell.paddingLeft;\r\n        cell.paddedHeight = cell.height - cell.paddingTop - cell.paddingBottom;\r\n        ev.cell = cell;\r\n        cell.userHeight = cell.isHeader ? self.sizes.rows[-1] : rowHeight;\r\n        cell.userWidth = cell.isHeader\r\n          ? self.sizes.columns.cornerCell\r\n          : self.sizes.columns[headerIndex];\r\n        self.visibleCells.unshift(cell);\r\n        if (self.dispatchEvent('beforerendercell', ev)) {\r\n          return;\r\n        }\r\n        self.ctx.fillStyle = self.style[cellStyle + 'BackgroundColor'];\r\n        self.ctx.strokeStyle = self.style[cellStyle + 'BorderColor'];\r\n        self.ctx.lineWidth = self.style[cellStyle + 'BorderWidth'];\r\n        if (hovered) {\r\n          self.ctx.fillStyle = self.style[cellStyle + 'HoverBackgroundColor'];\r\n          self.ctx.strokeStyle = self.style[cellStyle + 'HoverBorderColor'];\r\n        }\r\n        if (selected) {\r\n          self.ctx.fillStyle =\r\n            self.style[cellStyle + 'SelectedBackgroundColor'];\r\n          self.ctx.strokeStyle = self.style[cellStyle + 'SelectedBorderColor'];\r\n        }\r\n        if (activeHeader) {\r\n          self.ctx.fillStyle = self.style[activeHeader + 'BackgroundColor'];\r\n        }\r\n        self.dispatchEvent('rendercell', ev);\r\n        if (cell.isGrid) {\r\n          if (cell.height !== rowHeight) {\r\n            cell.height = rowHeight || self.style.cellHeightWithChildGrid;\r\n            checkScrollHeight = true;\r\n          }\r\n          cell.width =\r\n            self.sizes.columns[headerIndex] ||\r\n            self.style.cellWidthWithChildGrid;\r\n        }\r\n        if (rowOpen && !cell.isRowHeader) {\r\n          cell.height = self.sizes.rows[rowIndex] || self.style.cellHeight;\r\n        }\r\n        if (!cell.isGrid) {\r\n          fillRect(cx, cy, cell.width, cell.height);\r\n          strokeRect(cx, cy, cell.width, cell.height);\r\n        }\r\n        self.ctx.save();\r\n        radiusRect(cell.x, cell.y, cell.width, cell.height, 0);\r\n        self.ctx.clip();\r\n        self.dispatchEvent('afterrendercell', ev);\r\n        if (cell.height !== cellHeight && !(rowOpen && !cell.isRowHeader)) {\r\n          self.sizes.rows[isHeader ? -1 : rowIndex] = cell.height;\r\n          checkScrollHeight = true;\r\n        }\r\n        if (cell.width !== cellWidth) {\r\n          self.sizes.columns[headerIndex] = cell.width;\r\n          checkScrollHeight = true;\r\n        }\r\n        if (isRowHeader && self.attributes.tree) {\r\n          if (!self.dispatchEvent('rendertreearrow', ev)) {\r\n            treeArrowSize = drawTreeArrow(\r\n              cell,\r\n              self.style[cellStyle + 'PaddingLeft'],\r\n              cy,\r\n              0,\r\n            );\r\n          }\r\n        }\r\n        if ((self.attributes.showRowNumbers && isRowHeader) || !isRowHeader) {\r\n          if (cell.isGrid && !self.dispatchEvent('beforerendercellgrid', ev)) {\r\n            if (!self.childGrids[cell.gridId]) {\r\n              // HACK: this only allows setting of the child grids styles if data is set _after_\r\n              // this is less than desirable.  An interface needs to be made to effect the\r\n              // style of all cell grids.  One for individual grids already exists.\r\n              cellGridAttributes = self.cellGridAttributes;\r\n              cellGridAttributes.name = self.attributes.saveAppearance\r\n                ? cell.gridId\r\n                : undefined;\r\n              cellGridAttributes.component = false;\r\n              cellGridAttributes.parentNode = cell;\r\n              cellGridAttributes.data = rawValue;\r\n              ev.cellGridAttributes = cellGridAttributes;\r\n              if (self.dispatchEvent('beforecreatecellgrid', ev)) {\r\n                return;\r\n              }\r\n              self.childGrids[cell.gridId] = self.createGrid(\r\n                cellGridAttributes,\r\n              );\r\n              self.sizes.rows[rowIndex] =\r\n                self.sizes.rows[rowIndex] || self.style.cellGridHeight;\r\n              checkScrollHeight = true;\r\n            }\r\n            cell.grid = self.childGrids[cell.gridId];\r\n            cell.grid.parentNode = cell;\r\n            cell.grid.visible = true;\r\n            cell.grid.draw();\r\n            self.dispatchEvent('rendercellgrid', ev);\r\n          } else if (!cell.isGrid) {\r\n            if (self.childGrids[cell.gridId]) {\r\n              self.childGrids[cell.gridId].parentNode.offsetHeight = 0;\r\n            }\r\n            if (isHeader && self.orderBy === header.name) {\r\n              if (!self.dispatchEvent('renderorderbyarrow', ev)) {\r\n                orderByArrowSize = drawOrderByArrow(\r\n                  cx + self.style[cellStyle + 'PaddingLeft'],\r\n                  0,\r\n                );\r\n              }\r\n            }\r\n            self.ctx.fillStyle = self.style[cellStyle + 'Color'];\r\n            if (hovered) {\r\n              self.ctx.fillStyle = self.style[cellStyle + 'HoverColor'];\r\n            }\r\n            if (selected) {\r\n              self.ctx.fillStyle = self.style[cellStyle + 'SelectedColor'];\r\n            }\r\n            if (activeHeader) {\r\n              self.ctx.fillStyle = self.style[activeHeader + 'Color'];\r\n            }\r\n            cell.treeArrowWidth = treeArrowSize;\r\n            cell.orderByArrowWidth = orderByArrowSize;\r\n            // create text ref to see if height needs to expand\r\n            val = val !== undefined ? val : f ? f(ev) : '';\r\n            if (val === undefined && !f) {\r\n              val = '';\r\n              console.warn(\r\n                'canvas-datagrid: Unknown format ' +\r\n                  header.type +\r\n                  ' add a cellFormater',\r\n              );\r\n            }\r\n            cell.formattedValue = (val !== undefined && val !== null\r\n              ? val\r\n              : ''\r\n            ).toString();\r\n            if (\r\n              self.columnFilters &&\r\n              self.columnFilters[val] !== undefined &&\r\n              isHeader\r\n            ) {\r\n              cell.formattedValue = self.attributes.filterTextPrefix + val;\r\n            }\r\n            self.ctx.font =\r\n              self.style[cellStyle + 'FontHeight'] * self.scale +\r\n              'px ' +\r\n              self.style[cellStyle + 'FontName'];\r\n            if (!self.dispatchEvent('formattext', ev)) {\r\n              cell.text = wrapText(cell, ' ');\r\n            }\r\n            if (!self.dispatchEvent('rendertext', ev)) {\r\n              if (cell.innerHTML || header.type === 'html') {\r\n                drawHtml(cell);\r\n              } else {\r\n                drawText(cell);\r\n              }\r\n\r\n              if (wrap && cell.text && cell.text.height > rowHeight) {\r\n                self.sizes.rows[isHeader ? -1 : rowIndex] = cell.text.height;\r\n                checkScrollHeight = true;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (active) {\r\n          aCell = cell;\r\n        }\r\n        createBorderOverlayArray(cell, selectionBorders, 'selection');\r\n        // createBorderOverlayArray calculates data for createHandlesOverlayArray so it must go 2nd\r\n        createHandlesOverlayArray(cell);\r\n        if (self.movingSelection) {\r\n          createBorderOverlayArray(cell, moveBorders, 'move', self.moveOffset);\r\n        }\r\n        self.ctx.restore();\r\n\r\n        // Gaps may occur in row numbers between consecutively rendered rows\r\n        // when we are filtering. We draw attention to this by drawing a thick\r\n        // border overlapping the two consecutive row headers.\r\n        if (\r\n          isRowHeader &&\r\n          self.attributes.showRowNumbers &&\r\n          self.attributes.showRowNumberGaps\r\n        ) {\r\n          const previousRowNumber = self.getBoundRowIndexFromViewRowIndex(\r\n            rowOrderIndex - 1,\r\n          );\r\n          const hasRowGap =\r\n            previousRowNumber !== undefined &&\r\n            cell.boundRowIndex > 0 &&\r\n            cell.boundRowIndex - previousRowNumber > 1;\r\n\r\n          if (hasRowGap) {\r\n            const barHeight = self.style.rowHeaderCellRowNumberGapHeight;\r\n            const barColor = self.style.rowHeaderCellRowNumberGapColor;\r\n\r\n            self.ctx.save();\r\n\r\n            self.ctx.fillStyle = barColor;\r\n\r\n            fillRect(cell.x, cell.y - barHeight / 2, cell.width, barHeight);\r\n\r\n            self.ctx.restore();\r\n          }\r\n        }\r\n\r\n        x += cell.width + (bc ? 0 : self.style.cellBorderWidth);\r\n        return cell.width;\r\n      };\r\n    }\r\n    function drawRowHeader(rowData, rowIndex, rowOrderIndex) {\r\n      if (self.attributes.showRowHeaders) {\r\n        x = 0;\r\n\r\n        // When filtering we'd like to display the actual row numbers,\r\n        // as it is in the unfiltered data, instead of simply the viewed\r\n        // row index + 1. If rowIndex > viewData.length, it's a new row\r\n        // added to the end, and we want to render that new row's number\r\n        const filteredRowNumber =\r\n          self.viewData && rowIndex < self.viewData.length\r\n            ? self.getBoundRowIndexFromViewRowIndex(rowIndex) + 1\r\n            : self.originalData\r\n            ? self.originalData.length + 1\r\n            : rowOrderIndex + 1;\r\n\r\n        const rowHeaderValue = self.hasActiveFilters()\r\n          ? filteredRowNumber\r\n          : rowIndex + 1;\r\n\r\n        const rowHeaderCell = { rowHeaderCell: rowHeaderValue };\r\n        const headerDescription = {\r\n          name: 'rowHeaderCell',\r\n          width: self.sizes.columns[-1] || self.style.rowHeaderCellWidth,\r\n          style: 'rowHeaderCell',\r\n          type: 'string',\r\n          data: rowHeaderValue,\r\n          index: -1,\r\n        };\r\n        rowOpen = self.openChildren[rowIndex];\r\n        drawCell(rowHeaderCell, rowOrderIndex, rowIndex)(\r\n          headerDescription,\r\n          -1,\r\n          -1,\r\n        );\r\n      }\r\n    }\r\n    function drawHeaders() {\r\n      var d,\r\n        g = schema.length,\r\n        i,\r\n        o,\r\n        columnHeaderCell,\r\n        header,\r\n        nonFrozenHeaderWidth;\r\n      function drawHeaderColumnRange(start, end) {\r\n        end = Math.min(end, g);\r\n        for (o = start; o < end; o += 1) {\r\n          i = self.orders.columns[o];\r\n          header = schema[i];\r\n          if (!header.hidden) {\r\n            d = {\r\n              title: header.title,\r\n              name: header.name,\r\n              width: header.width || self.style.cellWidth,\r\n              style: 'columnHeaderCell',\r\n              type: 'string',\r\n              index: o,\r\n              order: i,\r\n            };\r\n            columnHeaderCell = {\r\n              columnHeaderCell: header.title || header.name,\r\n            };\r\n            x += drawCell(columnHeaderCell, -1, -1)(d, i, o);\r\n            if (x > self.width + self.scrollBox.scrollLeft) {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      rowHeaders.forEach(function (rArgs, rhIndex) {\r\n        y = rArgs[3];\r\n        cellHeight = rArgs[4];\r\n        if (rhIndex === self.frozenRow) {\r\n          self.ctx.save();\r\n          radiusRect(\r\n            0,\r\n            self.lastFrozenRowPixel,\r\n            self.width,\r\n            self.height - self.lastFrozenRowPixel,\r\n            0,\r\n          );\r\n          self.ctx.clip();\r\n        }\r\n        drawRowHeader(rArgs[0], rArgs[1], rArgs[2]);\r\n      });\r\n      self.ctx.restore();\r\n      if (self.attributes.showColumnHeaders) {\r\n        x =\r\n          -self.scrollBox.scrollLeft +\r\n          self.scrollPixelLeft +\r\n          self.style.columnHeaderCellBorderWidth;\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        y = 0;\r\n        // cell height might have changed during drawing\r\n        cellHeight = self.getColumnHeaderCellHeight();\r\n        drawHeaderColumnRange(self.scrollIndexLeft, g);\r\n        nonFrozenHeaderWidth = x;\r\n        x = self.style.columnHeaderCellBorderWidth;\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        drawHeaderColumnRange(0, self.frozenColumn);\r\n        // fill in the space right of the headers\r\n        x = nonFrozenHeaderWidth;\r\n        if (x < w) {\r\n          c = {\r\n            name: '',\r\n            width: self.style.scrollBarWidth,\r\n            style: 'columnHeaderCellCap',\r\n            isColumnHeaderCell: true,\r\n            isColumnHeaderCellCap: true,\r\n            type: 'string',\r\n            index: schema.length,\r\n          };\r\n          drawCell({ endCap: '' }, -1, -1)(c, -1, -1);\r\n        }\r\n        // fill in the space right of the headers\r\n        if (self.attributes.showRowHeaders) {\r\n          cornerCell = { cornerCell: '' };\r\n          x = 0;\r\n          c = {\r\n            name: 'cornerCell',\r\n            width: self.style.rowHeaderCellWidth,\r\n            style: 'cornerCell',\r\n            type: 'string',\r\n            index: -1,\r\n          };\r\n          drawCell(cornerCell, -1, -1)(c, -1, -1);\r\n        }\r\n      }\r\n    }\r\n    function drawRow(rowOrderIndex, rowIndex) {\r\n      var headerIndex,\r\n        treeHeight,\r\n        rowSansTreeHeight,\r\n        columnOrderIndex,\r\n        g = schema.length;\r\n      if (y - cellHeight * 2 > h) {\r\n        return false;\r\n      }\r\n      rowData = viewData[rowOrderIndex];\r\n      rowOpen = self.openChildren[rowOrderIndex];\r\n      rowSansTreeHeight =\r\n        (self.sizes.rows[rowOrderIndex] || self.style.cellHeight) * self.scale;\r\n      treeHeight = (rowOpen ? self.sizes.trees[rowOrderIndex] : 0) * self.scale;\r\n      rowHeight = rowSansTreeHeight + treeHeight;\r\n      if (y < -rowHeight) {\r\n        return false;\r\n      }\r\n      if (self.attributes.showRowHeaders) {\r\n        x += rowHeaderCellWidth;\r\n      }\r\n      cellHeight = rowHeight;\r\n      //draw normal columns\r\n      for (\r\n        columnOrderIndex = self.scrollIndexLeft;\r\n        columnOrderIndex < g;\r\n        columnOrderIndex += 1\r\n      ) {\r\n        headerIndex = self.orders.columns[columnOrderIndex];\r\n        x += drawCell(rowData, rowOrderIndex, rowIndex)(\r\n          schema[headerIndex],\r\n          headerIndex,\r\n          columnOrderIndex,\r\n        );\r\n        if (x > self.width) {\r\n          self.scrollIndexRight = columnOrderIndex;\r\n          self.scrollPixelRight = x;\r\n          break;\r\n        }\r\n      }\r\n      //draw frozen columns\r\n      x = 0;\r\n      if (self.attributes.showRowHeaders) {\r\n        x += rowHeaderCellWidth;\r\n      }\r\n      for (\r\n        columnOrderIndex = 0;\r\n        columnOrderIndex < self.frozenColumn;\r\n        columnOrderIndex += 1\r\n      ) {\r\n        headerIndex = self.orders.columns[columnOrderIndex];\r\n        x += drawCell(rowData, rowOrderIndex, rowIndex)(\r\n          schema[headerIndex],\r\n          headerIndex,\r\n          columnOrderIndex,\r\n        );\r\n        if (x > self.width) {\r\n          break;\r\n        }\r\n      }\r\n      self.lastFrozenColumnPixel = x;\r\n      // cell height might have changed during drawing\r\n      cellHeight = rowHeight;\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      // don't draw a tree for the new row\r\n      treeGrid = self.childGrids[rowOrderIndex];\r\n      if (rowOrderIndex !== viewData.length && rowOpen) {\r\n        treeGrid.visible = true;\r\n        treeGrid.parentNode = {\r\n          offsetTop: y + rowSansTreeHeight + self.canvasOffsetTop,\r\n          offsetLeft: rowHeaderCellWidth - 1 + self.canvasOffsetLeft,\r\n          offsetHeight: treeHeight,\r\n          offsetWidth:\r\n            self.width - rowHeaderCellWidth - self.style.scrollBarWidth - 1,\r\n          offsetParent: self.intf.parentNode,\r\n          parentNode: self.intf.parentNode,\r\n          style: self.style,\r\n          nodeType: 'canvas-datagrid-tree',\r\n          scrollTop: self.scrollBox.scrollTop,\r\n          scrollLeft: self.scrollBox.scrollLeft,\r\n          rowIndex: rowOrderIndex,\r\n        };\r\n        self.visibleCells.unshift({\r\n          rowIndex: rowOrderIndex,\r\n          columnIndex: 0,\r\n          y: treeGrid.parentNode.offsetTop,\r\n          x: treeGrid.parentNode.offsetLeft,\r\n          height: treeGrid.height,\r\n          width: treeGrid.width,\r\n          style: 'tree-grid',\r\n          type: treeGrid.parentNode.nodeType,\r\n        });\r\n        treeGrid.draw();\r\n      } else if (treeGrid) {\r\n        treeGrid.parentNode.offsetHeight = 0;\r\n        delete self.sizes.trees[rowOrderIndex];\r\n      }\r\n      rowHeaders.push([rowData, rowOrderIndex, rowIndex, y, rowHeight]);\r\n      self.visibleRowHeights[rowOrderIndex] = rowHeight;\r\n      y += cellHeight + (bc ? 0 : self.style.cellBorderWidth);\r\n      return true;\r\n    }\r\n    function initDraw() {\r\n      self.visibleRows = [];\r\n      schema = self.getSchema();\r\n      self.visibleCells = [];\r\n      self.canvasOffsetTop = self.isChildGrid ? self.parentNode.offsetTop : 0.5;\r\n      self.canvasOffsetLeft = self.isChildGrid\r\n        ? self.parentNode.offsetLeft\r\n        : -0.5;\r\n      h = self.height;\r\n      w = self.width;\r\n    }\r\n    function drawBackground() {\r\n      radiusRect(0, 0, w, h, 0);\r\n      self.ctx.clip();\r\n      self.ctx.fillStyle = self.style.gridBackgroundColor;\r\n      fillRect(0, 0, w, h);\r\n    }\r\n    function drawFrozenRows() {\r\n      var rowOrderIndex,\r\n        ln = Math.min(viewData.length, self.frozenRow);\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      y = columnHeaderCellHeight;\r\n      for (rowIndex = 0; rowIndex < ln; rowIndex += 1) {\r\n        rowOrderIndex = self.orders.rows[rowIndex];\r\n        if (!drawRow(rowOrderIndex, rowIndex)) {\r\n          break;\r\n        }\r\n      }\r\n      if (self.attributes.allowFreezingRows) {\r\n        // HACK great, another stupid magic number.\r\n        // Background will appear as a 0.5px artifact behind the row freeze bar without this hack\r\n        y +=\r\n          self.style.frozenMarkerBorderWidth +\r\n          self.style.frozenMarkerWidth -\r\n          0.4999999999;\r\n      }\r\n      self.lastFrozenRowPixel = y;\r\n    }\r\n    function drawRows() {\r\n      self.ctx.save();\r\n      if (self.frozenRow > 0) {\r\n        radiusRect(\r\n          0,\r\n          self.lastFrozenRowPixel,\r\n          self.width,\r\n          self.height - self.lastFrozenRowPixel,\r\n          0,\r\n        );\r\n        self.ctx.clip();\r\n      }\r\n      var columnOrderIndex,\r\n        rowOrderIndex,\r\n        headerIndex,\r\n        g = schema.length;\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      if (!self.attributes.snapToRow) {\r\n        y +=\r\n          -self.scrollBox.scrollTop +\r\n          self.scrollPixelTop +\r\n          self.style.cellBorderWidth;\r\n      }\r\n      for (\r\n        rowIndex = self.frozenRow + self.scrollIndexTop;\r\n        rowIndex < l;\r\n        rowIndex += 1\r\n      ) {\r\n        rowOrderIndex = self.orders.rows[rowIndex];\r\n        self.scrollIndexBottom = rowIndex;\r\n        self.scrollPixelBottom = y;\r\n        if (!drawRow(rowOrderIndex, rowIndex)) {\r\n          break;\r\n        }\r\n      }\r\n      if (self.attributes.showNewRow) {\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        rowHeight = cellHeight = self.style.cellHeight;\r\n        rowOpen = false;\r\n        for (\r\n          columnOrderIndex = self.scrollIndexLeft;\r\n          columnOrderIndex < g;\r\n          columnOrderIndex += 1\r\n        ) {\r\n          headerIndex = self.orders.columns[columnOrderIndex];\r\n          x += drawCell(self.newRow, viewData.length, viewData.length)(\r\n            schema[headerIndex],\r\n            headerIndex,\r\n            columnOrderIndex,\r\n          );\r\n          if (x > self.width + self.scrollBox.scrollLeft) {\r\n            break;\r\n          }\r\n        }\r\n        rowHeaders.push([\r\n          self.newRow,\r\n          viewData.length,\r\n          viewData.length,\r\n          y,\r\n          rowHeight,\r\n        ]);\r\n      }\r\n      self.ctx.restore();\r\n    }\r\n    function drawMoveMarkers() {\r\n      if (!self.movingSelection) {\r\n        return;\r\n      }\r\n      self.ctx.lineWidth = self.style.moveOverlayBorderWidth;\r\n      self.ctx.strokeStyle = self.style.moveOverlayBorderColor;\r\n      self.ctx.setLineDash(self.style.moveOverlayBorderSegments);\r\n      moveBorders.forEach(function (c) {\r\n        addBorderLine(c[0], c[1]);\r\n      });\r\n      self.ctx.setLineDash([]);\r\n    }\r\n    function drawReorderMarkers() {\r\n      if (!self.reorderObject) {\r\n        return;\r\n      }\r\n      var b = {\r\n          height: self.reorderObject.height,\r\n          width: self.reorderObject.width,\r\n          x: self.reorderObject.x + self.reorderObject.dragOffset.x,\r\n          y: self.reorderObject.y + self.reorderObject.dragOffset.y,\r\n        },\r\n        m = {\r\n          width: w,\r\n          height: h,\r\n          x: 0,\r\n          y: 0,\r\n        };\r\n      self.ctx.fillStyle = self.style.reorderMarkerBackgroundColor;\r\n      self.ctx.lineWidth = self.style.reorderMarkerBorderWidth;\r\n      self.ctx.strokeStyle = self.style.reorderMarkerBorderColor;\r\n      if (self.dragMode === 'row-reorder') {\r\n        b.width = w;\r\n        b.x = 0;\r\n        m.width = w;\r\n        m.height = self.currentCell.height;\r\n        m.y = self.currentCell.y;\r\n        fillRect(b.x, b.y, b.width, b.height);\r\n        strokeRect(b.x, b.y, b.width, b.height);\r\n        self.ctx.lineWidth = self.style.reorderMarkerIndexBorderWidth;\r\n        self.ctx.strokeStyle = self.style.reorderMarkerIndexBorderColor;\r\n        if (\r\n          self.currentCell.rowIndex !== self.reorderObject.rowIndex &&\r\n          self.currentCell.rowIndex > -1 &&\r\n          self.currentCell.rowIndex < l\r\n        ) {\r\n          addBorderLine(\r\n            m,\r\n            self.reorderTarget.sortRowIndex > self.reorderObject.sortRowIndex\r\n              ? 'b'\r\n              : 't',\r\n          );\r\n        }\r\n      } else if (self.dragMode === 'column-reorder' && self.reorderObject) {\r\n        b.height = h;\r\n        b.y = 0;\r\n        m.height = h;\r\n        m.width = self.currentCell.width;\r\n        m.y = 0;\r\n        m.x = self.currentCell.x;\r\n        fillRect(b.x, b.y, b.width, b.height);\r\n        strokeRect(b.x, b.y, b.width, b.height);\r\n        self.ctx.lineWidth = self.style.reorderMarkerIndexBorderWidth;\r\n        self.ctx.strokeStyle = self.style.reorderMarkerIndexBorderColor;\r\n        if (\r\n          self.currentCell.sortColumnIndex !==\r\n            self.reorderObject.sortColumnIndex &&\r\n          self.currentCell.sortColumnIndex > -1 &&\r\n          self.currentCell.sortColumnIndex < schema.length\r\n        ) {\r\n          addBorderLine(\r\n            m,\r\n            self.reorderTarget.columnIndex > self.reorderObject.columnIndex\r\n              ? 'r'\r\n              : 'l',\r\n          );\r\n        }\r\n      }\r\n    }\r\n    function drawBorder() {\r\n      self.ctx.lineWidth = self.style.gridBorderWidth;\r\n      self.ctx.strokeStyle = self.style.gridBorderColor;\r\n      strokeRect(0, 0, self.width, self.height);\r\n    }\r\n    function drawSelectionBorders() {\r\n      self.ctx.lineWidth = self.style.selectionOverlayBorderWidth;\r\n      self.ctx.strokeStyle = self.style.selectionOverlayBorderColor;\r\n      function dsb(c) {\r\n        addBorderLine(c[0], c[1]);\r\n      }\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex < self.frozenRow &&\r\n            c[0].columnIndex < self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.save();\r\n      clipFrozenArea(0);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex >= self.frozenRow &&\r\n            c[0].columnIndex >= self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n      self.ctx.save();\r\n      clipFrozenArea(1);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex >= self.frozenRow &&\r\n            c[0].columnIndex < self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n      self.ctx.save();\r\n      clipFrozenArea(2);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex < self.frozenRow &&\r\n            c[0].columnIndex >= self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n    }\r\n    function drawSelectionHandles() {\r\n      if (self.mobile || self.attributes.allowMovingSelection) {\r\n        self.ctx.lineWidth = self.style.selectionHandleBorderWidth;\r\n        self.ctx.strokeStyle = self.style.selectionHandleBorderColor;\r\n        self.ctx.fillStyle = self.style.selectionHandleColor;\r\n        selectionHandles.forEach(function (c) {\r\n          addselectionHandle(c[0], c[1]);\r\n          var az = self.attributes.touchSelectHandleZone / 2,\r\n            ax =\r\n              c[0].x + (c[1] === 'tl' || c[1] === 'bl' ? 0 : c[0].width) - az,\r\n            ay =\r\n              c[0].y + (c[1] === 'bl' || c[1] === 'br' ? c[0].height : 0) - az;\r\n          self.visibleCells.unshift({\r\n            x: ax,\r\n            y: ay,\r\n            height: self.style.selectionHandleSize + az,\r\n            width: self.style.selectionHandleSize + az,\r\n            style: 'selection-handle-' + c[1],\r\n          });\r\n        });\r\n      }\r\n    }\r\n    function drawActiveCell() {\r\n      if (!aCell) {\r\n        return;\r\n      }\r\n      self.ctx.save();\r\n      var cl =\r\n          self.activeCell.columnIndex + 1 > self.frozenColumn ||\r\n          self.activeCell.rowIndex + 1 > self.frozenRow,\r\n        acx = cl ? self.lastFrozenColumnPixel : 0,\r\n        acy = cl ? self.lastFrozenRowPixel : 0,\r\n        acw = cl ? self.width - self.lastFrozenColumnPixel : self.width,\r\n        ach = cl ? self.height - self.lastFrozenRowPixel : self.height;\r\n      radiusRect(acx, acy, acw, ach, 0);\r\n      self.ctx.clip();\r\n      if (self.attributes.selectionMode === 'row') {\r\n        if (self.activeCell && self.activeCell.rowIndex === aCell.rowIndex) {\r\n          self.ctx.lineWidth = self.style.activeCellOverlayBorderWidth;\r\n          self.ctx.strokeStyle = self.style.activeCellOverlayBorderColor;\r\n          strokeRect(\r\n            1,\r\n            aCell.y,\r\n            self.getHeaderWidth() + rowHeaderCellWidth,\r\n            self.visibleRowHeights[aCell.rowIndex],\r\n          );\r\n        }\r\n      } else {\r\n        self.ctx.lineWidth = self.style.activeCellOverlayBorderWidth;\r\n        self.ctx.strokeStyle = self.style.activeCellOverlayBorderColor;\r\n        strokeRect(aCell.x, aCell.y, aCell.width, aCell.height);\r\n      }\r\n      self.ctx.restore();\r\n    }\r\n    function drawFrozenMarkers() {\r\n      var my = self.lastFrozenRowPixel - self.style.frozenMarkerWidth,\r\n        mx = self.lastFrozenColumnPixel - self.style.frozenMarkerBorderWidth,\r\n        xHover =\r\n          self.currentCell && self.currentCell.style === 'frozen-row-marker',\r\n        yHover =\r\n          self.currentCell && self.currentCell.style === 'frozen-column-marker';\r\n      self.ctx.lineWidth = self.style.frozenMarkerBorderWidth;\r\n      if (self.attributes.allowFreezingColumns) {\r\n        self.ctx.fillStyle = yHover\r\n          ? self.style.frozenMarkerHoverColor\r\n          : self.style.frozenMarkerColor;\r\n        self.ctx.strokeStyle = yHover\r\n          ? self.style.frozenMarkerHoverBorderColor\r\n          : self.style.frozenMarkerBorderColor;\r\n        fillRect(mx, 0, self.style.frozenMarkerWidth, self.height);\r\n        strokeRect(mx, 0, self.style.frozenMarkerWidth, self.height);\r\n        self.visibleCells.unshift({\r\n          x: mx,\r\n          y: 0,\r\n          height: self.height,\r\n          width:\r\n            self.style.frozenMarkerWidth + self.style.frozenMarkerBorderWidth,\r\n          style: 'frozen-column-marker',\r\n        });\r\n      }\r\n      if (self.attributes.allowFreezingRows) {\r\n        self.ctx.fillStyle = xHover\r\n          ? self.style.frozenMarkerHoverColor\r\n          : self.style.frozenMarkerColor;\r\n        self.ctx.strokeStyle = xHover\r\n          ? self.style.frozenMarkerHoverBorderColor\r\n          : self.style.frozenMarkerBorderColor;\r\n        fillRect(0, my, self.width, self.style.frozenMarkerWidth);\r\n        strokeRect(0, my, self.width, self.style.frozenMarkerWidth);\r\n        self.visibleCells.unshift({\r\n          x: 0,\r\n          y: my,\r\n          height:\r\n            self.style.frozenMarkerWidth + self.style.frozenMarkerBorderWidth,\r\n          width: self.width,\r\n          style: 'frozen-row-marker',\r\n        });\r\n      }\r\n      if (self.freezeMarkerPosition) {\r\n        self.ctx.fillStyle = self.style.frozenMarkerActiveColor;\r\n        self.ctx.strokeStyle = self.style.frozenMarkerActiveBorderColor;\r\n        if (self.dragMode === 'frozen-column-marker') {\r\n          fillRect(\r\n            self.freezeMarkerPosition.x,\r\n            0,\r\n            self.style.frozenMarkerWidth,\r\n            self.height,\r\n          );\r\n          strokeRect(\r\n            self.freezeMarkerPosition.x,\r\n            0,\r\n            self.style.frozenMarkerWidth,\r\n            self.height,\r\n          );\r\n        } else {\r\n          fillRect(\r\n            0,\r\n            self.freezeMarkerPosition.y,\r\n            self.width,\r\n            self.style.frozenMarkerWidth,\r\n          );\r\n          strokeRect(\r\n            0,\r\n            self.freezeMarkerPosition.y,\r\n            self.width,\r\n            self.style.frozenMarkerWidth,\r\n          );\r\n        }\r\n      }\r\n    }\r\n    function drawPerfLines() {\r\n      if (!self.attributes.showPerformance) {\r\n        return;\r\n      }\r\n      var pw = 250,\r\n        px =\r\n          self.width -\r\n          pw -\r\n          self.style.scrollBarWidth -\r\n          self.style.scrollBarBorderWidth * 2,\r\n        py = columnHeaderCellHeight,\r\n        ph = 100;\r\n      if (scrollDebugCounters.length === 0) {\r\n        scrollDebugCounters = fillArray(0, perfWindowSize, 1, function () {\r\n          return [0, 0];\r\n        });\r\n      }\r\n      if (touchPPSCounters.length === 0) {\r\n        touchPPSCounters = fillArray(0, perfWindowSize, 1, function () {\r\n          return [0, 0];\r\n        });\r\n      }\r\n      if (entityCount.length === 0) {\r\n        entityCount = fillArray(0, perfWindowSize, 1, 0);\r\n      }\r\n      self.ctx.lineWidth = 0.5;\r\n      function dpl(name, perfArr, arrIndex, max, color, useAbs, rowIndex) {\r\n        var v;\r\n        drawPerfLine(pw, ph, px, py, perfArr, arrIndex, max, color, useAbs);\r\n        self.ctx.fillStyle = color;\r\n        fillRect(3 + px, py + 9 + rowIndex * 11, 8, 8);\r\n        self.ctx.fillStyle = self.style.debugPerfChartTextColor;\r\n        v = arrIndex !== undefined ? perfArr[0][arrIndex] : perfArr[0];\r\n        fillText(\r\n          name + ' ' + (isNaN(v) ? 0 : v).toFixed(3),\r\n          14 + px,\r\n          py + 16 + rowIndex * 11,\r\n        );\r\n      }\r\n      self.ctx.textAlign = 'left';\r\n      self.ctx.font = self.style.debugFont;\r\n      self.ctx.fillStyle = self.style.debugPerfChartBackground;\r\n      fillRect(px, py, pw, ph);\r\n      [\r\n        [\r\n          'Scroll Height',\r\n          scrollDebugCounters,\r\n          0,\r\n          self.scrollBox.scrollHeight,\r\n          self.style.debugScrollHeightColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Scroll Width',\r\n          scrollDebugCounters,\r\n          1,\r\n          self.scrollBox.scrollWidth,\r\n          self.style.debugScrollWidthColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Performance',\r\n          perfCounters,\r\n          undefined,\r\n          200,\r\n          self.style.debugPerformanceColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Entities',\r\n          entityCount,\r\n          undefined,\r\n          1500,\r\n          self.style.debugEntitiesColor,\r\n          false,\r\n        ],\r\n        [\r\n          'TouchPPSX',\r\n          touchPPSCounters,\r\n          0,\r\n          1000,\r\n          self.style.debugTouchPPSXColor,\r\n          true,\r\n        ],\r\n        [\r\n          'TouchPPSY',\r\n          touchPPSCounters,\r\n          1,\r\n          1000,\r\n          self.style.debugTouchPPSYColor,\r\n          true,\r\n        ],\r\n      ].forEach(function (i, index) {\r\n        i.push(index);\r\n        dpl.apply(null, i);\r\n      });\r\n      self.ctx.fillStyle = self.style.debugPerfChartBackground;\r\n      entityCount.pop();\r\n      entityCount.unshift(self.visibleCells.length);\r\n      scrollDebugCounters.pop();\r\n      scrollDebugCounters.unshift([\r\n        self.scrollBox.scrollTop,\r\n        self.scrollBox.scrollLeft,\r\n      ]);\r\n      touchPPSCounters.pop();\r\n      touchPPSCounters.unshift([self.yPPS, self.xPPS]);\r\n    }\r\n    function drawDebug() {\r\n      self.ctx.save();\r\n      var d;\r\n      if (self.attributes.showPerformance || self.attributes.debug) {\r\n        if (perfCounters.length === 0) {\r\n          perfCounters = fillArray(0, perfWindowSize, 1, 0);\r\n        }\r\n        perfCounters.pop();\r\n        perfCounters.unshift(performance.now() - p);\r\n      }\r\n      if (!self.attributes.debug) {\r\n        self.ctx.restore();\r\n        return;\r\n      }\r\n      self.ctx.font = self.style.debugFont;\r\n      d = {};\r\n      d.perf = (\r\n        perfCounters.reduce(function (a, b) {\r\n          return a + b;\r\n        }, 0) / Math.min(drawCount, perfCounters.length)\r\n      ).toFixed(1);\r\n      d.perfDelta = perfCounters[0].toFixed(1);\r\n      d.frozenColumnsWidth = getFrozenColumnsWidth();\r\n      d.htmlImages = Object.keys(self.htmlImageCache).length;\r\n      d.reorderObject =\r\n        'x: ' +\r\n        (self.reorderObject || { columnIndex: 0 }).columnIndex +\r\n        ', y: ' +\r\n        (self.reorderObject || { rowIndex: 0 }).rowIndex;\r\n      d.reorderTarget =\r\n        'x: ' +\r\n        (self.reorderTarget || { columnIndex: 0 }).columnIndex +\r\n        ', y: ' +\r\n        (self.reorderTarget || { rowIndex: 0 }).rowIndex;\r\n      d.scale = self.scale;\r\n      d.startScale = self.startScale;\r\n      d.scaleDelta = self.scaleDelta;\r\n      d.zoomDeltaStart = self.zoomDeltaStart;\r\n      d.touchLength = self.touchLength;\r\n      d.touches =\r\n        'y0: ' +\r\n        (self.touchPosition || { y: 0 }).y +\r\n        ' y1: ' +\r\n        (self.touchPosition1 || { y: 0 }).y;\r\n      d.scrollBox = self.scrollBox.toString();\r\n      d.scrollIndex =\r\n        'x: ' + self.scrollIndexLeft + ', y: ' + self.scrollIndexTop;\r\n      d.scrollPixel =\r\n        'x: ' + self.scrollPixelLeft + ', y: ' + self.scrollPixelTop;\r\n      d.canvasOffset =\r\n        'x: ' + self.canvasOffsetLeft + ', y: ' + self.canvasOffsetTop;\r\n      d.touchDelta = 'x: ' + self.touchDelta.x + ', y: ' + self.touchDelta.y;\r\n      d.touchAnimateTo =\r\n        'x: ' + self.touchAnimateTo.x + ', y: ' + self.touchAnimateTo.y;\r\n      d.scrollAnimation =\r\n        'x: ' + self.scrollAnimation.x + ', y: ' + self.scrollAnimation.y;\r\n      d.touchPPS = 'x: ' + self.xPPS + ', y: ' + self.yPPS;\r\n      d.touchPPST = 'x: ' + self.xPPST + ', y: ' + self.yPPST;\r\n      d.touchDuration = self.touchDuration;\r\n      d.pointerLockPosition = self.pointerLockPosition\r\n        ? self.pointerLockPosition.x + ', ' + self.pointerLockPosition.y\r\n        : '';\r\n      d.size = 'w: ' + self.width + ', h: ' + self.height;\r\n      d.mouse = 'x: ' + self.mouse.x + ', y: ' + self.mouse.y;\r\n      d.touch = !self.touchStart\r\n        ? ''\r\n        : 'x: ' + self.touchStart.x + ', y: ' + self.touchStart.y;\r\n      d.entities = self.visibleCells.length;\r\n      d.hasFocus = self.hasFocus;\r\n      d.dragMode = self.dragMode;\r\n      if (self.currentCell) {\r\n        d.columnIndex = self.currentCell.columnIndex;\r\n        d.rowIndex = self.currentCell.rowIndex;\r\n        d.sortColumnIndex = self.currentCell.sortColumnIndex;\r\n        d.sortRowIndex = self.currentCell.sortRowIndex;\r\n        d.context = self.currentCell.context;\r\n        d.dragContext = self.currentCell.dragContext;\r\n        d.style = self.currentCell.style;\r\n        d.type = self.currentCell.type;\r\n      }\r\n      self.ctx.textAlign = 'right';\r\n      self.ctx.fillStyle = self.style.debugBackgroundColor;\r\n      fillRect(0, 0, self.width, self.height);\r\n      Object.keys(d).forEach(function (key, index) {\r\n        var m = key + ': ' + d[key],\r\n          lh = 14;\r\n        self.ctx.fillStyle = self.style.debugColor;\r\n        fillText(\r\n          m,\r\n          w - 20,\r\n          (self.attributes.showPerformance ? 140 : 24) + index * lh,\r\n        );\r\n      });\r\n      self.ctx.restore();\r\n    }\r\n    self.ctx.save();\r\n    initDraw();\r\n    drawBackground();\r\n    drawFrozenRows();\r\n    drawRows();\r\n    drawActiveCell();\r\n    drawHeaders();\r\n    drawFrozenMarkers();\r\n    drawSelectionHandles();\r\n    drawReorderMarkers();\r\n    drawMoveMarkers();\r\n    drawBorder();\r\n    drawSelectionBorders();\r\n    drawScrollBars();\r\n    if (checkScrollHeight) {\r\n      self.resize(true);\r\n    }\r\n    drawDebug();\r\n    drawPerfLines();\r\n    if (self.dispatchEvent('afterdraw', {})) {\r\n      return;\r\n    }\r\n    self.ctx.restore();\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, plusplus: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport isPrintableKeyEvent from 'is-printable-key-event';\r\n\r\nexport default function (self) {\r\n  var wheeling;\r\n  self.stopPropagation = function (e) {\r\n    e.stopPropagation();\r\n  };\r\n  /**\r\n   * Adds an event listener to the given event.\r\n   * @memberof canvasDatagrid\r\n   * @name addEventListener\r\n   * @method\r\n   * @param {string} ev The name of the event to subscribe to.\r\n   * @param {function} fn The event procedure to execute when the event is raised.\r\n   */\r\n  self.addEventListener = function (ev, fn) {\r\n    self.events[ev] = self.events[ev] || [];\r\n    self.events[ev].unshift(fn);\r\n  };\r\n  /**\r\n   * Removes the given listener function from the given event.  Must be an actual reference to the function that was bound.\r\n   * @memberof canvasDatagrid\r\n   * @name removeEventListener\r\n   * @method\r\n   * @param {string} ev The name of the event to unsubscribe from.\r\n   * @param {function} fn The event procedure to execute when the event is raised.\r\n   */\r\n  self.removeEventListener = function (ev, fn) {\r\n    (self.events[ev] || []).forEach(function removeEachListener(sfn, idx) {\r\n      if (fn === sfn) {\r\n        self.events[ev].splice(idx, 1);\r\n      }\r\n    });\r\n  };\r\n  /**\r\n   * Fires the given event, passing an event object to the event subscribers.\r\n   * @memberof canvasDatagrid\r\n   * @name dispatchEvent\r\n   * @method\r\n   * @param {number} ev The name of the event to dispatch.\r\n   * @param {number} e The event object.\r\n   */\r\n  self.dispatchEvent = function (ev, e) {\r\n    e = ev.type ? ev : e || {};\r\n    ev = ev.type || ev;\r\n    var defaultPrevented;\r\n    function preventDefault() {\r\n      defaultPrevented = true;\r\n    }\r\n    if (!self.events[ev]) {\r\n      return;\r\n    }\r\n    self.events[ev].forEach(function dispatchEachEvent(fn) {\r\n      e.ctx = self.ctx;\r\n      e.preventDefault = preventDefault;\r\n      fn.apply(self.intf, [e]);\r\n    });\r\n    return defaultPrevented;\r\n  };\r\n  self.getRatio = function () {\r\n    return Math.min(\r\n      self.attributes.maxPixelRatio,\r\n      (window.devicePixelRatio || 1) /\r\n        (self.ctx.webkitBackingStorePixelRatio ||\r\n          self.ctx.mozBackingStorePixelRatio ||\r\n          self.ctx.msBackingStorePixelRatio ||\r\n          self.ctx.oBackingStorePixelRatio ||\r\n          self.ctx.backingStorePixelRatio ||\r\n          1),\r\n    );\r\n  };\r\n  self.resize = function (drawAfterResize) {\r\n    if (!self.canvas) {\r\n      return;\r\n    }\r\n    var x,\r\n      v = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'vertical-scroll-bar',\r\n      },\r\n      n = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'horizontal-scroll-bar',\r\n      },\r\n      vb = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'vertical-scroll-box',\r\n      },\r\n      nb = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'horizontal-scroll-box',\r\n      },\r\n      co = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        isCorner: true,\r\n        isScrollBoxCorner: true,\r\n        style: 'scroll-box-corner',\r\n      },\r\n      m = self.style.scrollBarBoxMargin * 2,\r\n      b = self.style.scrollBarBorderWidth * 2,\r\n      d = self.style.scrollBarBoxMargin * 0.5,\r\n      sbw = self.style.scrollBarWidth + self.style.scrollBarBorderWidth * 2,\r\n      ratio = self.getRatio(),\r\n      bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\r\n      cellBorder = self.style.cellBorderWidth * bm,\r\n      columnHeaderCellBorder = self.style.columnHeaderCellBorderWidth * bm,\r\n      dataHeight = 0,\r\n      dataWidth = 0,\r\n      dims,\r\n      l = (self.viewData || []).length,\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      ch = self.style.cellHeight,\r\n      s = self.getSchema();\r\n    // sets actual DOM canvas element\r\n    function checkScrollBoxVisibility() {\r\n      self.scrollBox.horizontalBarVisible =\r\n        (self.style.width !== 'auto' &&\r\n          dataWidth > self.scrollBox.width &&\r\n          self.style.overflowX !== 'hidden') ||\r\n        self.style.overflowX === 'scroll';\r\n      self.scrollBox.horizontalBoxVisible = dataWidth > self.scrollBox.width;\r\n      self.scrollBox.verticalBarVisible =\r\n        (self.style.height !== 'auto' &&\r\n          dataHeight > self.scrollBox.height &&\r\n          self.style.overflowY !== 'hidden') ||\r\n        self.style.overflowY === 'scroll';\r\n      self.scrollBox.verticalBoxVisible = dataHeight > self.scrollBox.height;\r\n    }\r\n    function setScrollBoxSize() {\r\n      self.scrollBox.width = self.width - rowHeaderCellWidth;\r\n      self.scrollBox.height = self.height - columnHeaderCellHeight;\r\n    }\r\n    function setCanvasSize() {\r\n      if (self.isChildGrid) {\r\n        return;\r\n      }\r\n      dims = {\r\n        // HACK +1 ? maybe it's a magic cell border?  Required to line up properly in auto height mode.\r\n        height: columnHeaderCellHeight + dataHeight + cellBorder + 1,\r\n        width: dataWidth + rowHeaderCellWidth + cellBorder,\r\n      };\r\n      ['width', 'height'].forEach(function (dim) {\r\n        //TODO: support inherit\r\n        if (\r\n          ['auto', undefined].indexOf(self.style[dim]) !== -1 &&\r\n          ['auto', undefined].indexOf(self.appliedInlineStyles[dim]) !== -1\r\n        ) {\r\n          self.parentNodeStyle[dim] = dims[dim] + 'px';\r\n        } else if (\r\n          ['auto', undefined].indexOf(self.style[dim]) == -1 &&\r\n          ['auto', undefined].indexOf(self.appliedInlineStyles[dim]) == -1\r\n        ) {\r\n          self.parentNodeStyle[dim] = self.style[dim];\r\n          if (self.isComponent) {\r\n            self.canvas.style[dim] = self.style[dim];\r\n          }\r\n        }\r\n      });\r\n    }\r\n    self.scrollCache.x = [];\r\n    self.scrollCache.y = [];\r\n    for (x = 0; x < l; x += 1) {\r\n      self.scrollCache.y[x] = dataHeight;\r\n      dataHeight +=\r\n        ((self.sizes.rows[x] || ch) + (self.sizes.trees[x] || 0)) * self.scale +\r\n        // HACK? if an expanded tree row is frozen it is necessary to add the tree row's height a second time.\r\n        (self.frozenRow > x ? self.sizes.trees[x] || 0 : 0);\r\n    }\r\n    if (l > 1) {\r\n      self.scrollCache.y[x] = dataHeight;\r\n    }\r\n    dataWidth =\r\n      s.reduce(function reduceSchema(accumulator, column, columnIndex) {\r\n        // intentional redefintion of column.  This causes scrollCache to be in the correct order\r\n        column = s[self.orders.columns[columnIndex]];\r\n        if (column.hidden) {\r\n          self.scrollCache.x[columnIndex] = accumulator;\r\n          return accumulator;\r\n        }\r\n        var va =\r\n          accumulator + self.getColumnWidth(self.orders.columns[columnIndex]);\r\n        self.scrollCache.x[columnIndex] = va;\r\n        return va;\r\n      }, 0) || 0;\r\n    if (self.attributes.showNewRow) {\r\n      dataHeight += ch;\r\n    }\r\n    if (self.attributes.snapToRow) {\r\n      dataHeight += self.style.cellHeight;\r\n    }\r\n    setCanvasSize();\r\n    if (self.isChildGrid) {\r\n      self.width = self.parentNode.offsetWidth;\r\n      self.height = self.parentNode.offsetHeight;\r\n    } else if (\r\n      self.height !== self.canvas.offsetHeight ||\r\n      self.width !== self.canvas.offsetWidth\r\n    ) {\r\n      self.height = self.canvas.offsetHeight;\r\n      self.width = self.canvas.offsetWidth;\r\n      self.canvasOffsetLeft = self.args.canvasOffsetLeft || 0;\r\n      self.canvasOffsetTop = self.args.canvasOffsetTop || 0;\r\n    }\r\n    /// calculate scroll bar dimensions\r\n    // non-controversial\r\n    self.scrollBox.top = columnHeaderCellHeight + columnHeaderCellBorder;\r\n    self.scrollBox.left = rowHeaderCellWidth;\r\n    // width and height of scroll box\r\n    setScrollBoxSize();\r\n    // is the data larger than the scroll box\r\n    checkScrollBoxVisibility();\r\n    // if the scroll box is visible, make room for it by expanding the size of the element\r\n    // if the other dimension is set to auto\r\n    if (self.scrollBox.horizontalBarVisible) {\r\n      if (self.style.height === 'auto' && !self.isChildGrid) {\r\n        self.height += sbw;\r\n      }\r\n      dataHeight += sbw;\r\n      setCanvasSize();\r\n      setScrollBoxSize();\r\n      checkScrollBoxVisibility();\r\n    }\r\n    if (self.scrollBox.verticalBarVisible) {\r\n      if (self.style.width === 'auto' && !self.isChildGrid) {\r\n        self.width += sbw;\r\n      }\r\n      dataWidth += sbw;\r\n      setCanvasSize();\r\n      setScrollBoxSize();\r\n      checkScrollBoxVisibility();\r\n    }\r\n    // set again after bar visibility checks\r\n    setScrollBoxSize();\r\n    self.scrollBox.scrollWidth = dataWidth - self.scrollBox.width;\r\n    self.scrollBox.scrollHeight = dataHeight - self.scrollBox.height;\r\n    self.scrollBox.widthBoxRatio = self.scrollBox.width / dataWidth;\r\n    self.scrollBox.scrollBoxWidth =\r\n      self.scrollBox.width * self.scrollBox.widthBoxRatio -\r\n      self.style.scrollBarWidth -\r\n      b -\r\n      d;\r\n    // TODO: This heightBoxRatio number is terribly wrong.\r\n    // They should be a result of the size of the grid/canvas?\r\n    // it being off causes the scroll bar to \"slide\" under\r\n    // the dragged mouse.\r\n    // https://github.com/TonyGermaneri/canvas-datagrid/issues/97\r\n    self.scrollBox.heightBoxRatio =\r\n      (self.scrollBox.height - columnHeaderCellHeight) / dataHeight;\r\n    self.scrollBox.scrollBoxHeight =\r\n      self.scrollBox.height * self.scrollBox.heightBoxRatio -\r\n      self.style.scrollBarWidth -\r\n      b -\r\n      d;\r\n    self.scrollBox.scrollBoxWidth = Math.max(\r\n      self.scrollBox.scrollBoxWidth,\r\n      self.style.scrollBarBoxMinSize,\r\n    );\r\n    self.scrollBox.scrollBoxHeight = Math.max(\r\n      self.scrollBox.scrollBoxHeight,\r\n      self.style.scrollBarBoxMinSize,\r\n    );\r\n    // horizontal\r\n    n.x += rowHeaderCellWidth;\r\n    n.y += self.height - self.style.scrollBarWidth - d;\r\n    n.width =\r\n      self.width - self.style.scrollBarWidth - rowHeaderCellWidth - d - m;\r\n    n.height = self.style.scrollBarWidth + self.style.scrollBarBorderWidth + d;\r\n    // horizontal box\r\n    nb.y = n.y + self.style.scrollBarBoxMargin;\r\n    nb.width = self.scrollBox.scrollBoxWidth;\r\n    nb.height = self.style.scrollBarBoxWidth;\r\n    // vertical\r\n    v.x +=\r\n      self.width -\r\n      self.style.scrollBarWidth -\r\n      self.style.scrollBarBorderWidth -\r\n      d;\r\n    v.y += columnHeaderCellHeight;\r\n    v.width = self.style.scrollBarWidth + self.style.scrollBarBorderWidth + d;\r\n    v.height =\r\n      self.height - columnHeaderCellHeight - self.style.scrollBarWidth - d - m;\r\n    // vertical box\r\n    vb.x = v.x + self.style.scrollBarBoxMargin;\r\n    vb.width = self.style.scrollBarBoxWidth;\r\n    vb.height = self.scrollBox.scrollBoxHeight;\r\n    // corner\r\n    co.x = n.x + n.width + m;\r\n    co.y = v.y + v.height + m;\r\n    co.width = self.style.scrollBarWidth + self.style.scrollBarBorderWidth;\r\n    co.height = self.style.scrollBarWidth + self.style.scrollBarBorderWidth;\r\n    self.scrollBox.entities = {\r\n      horizontalBar: n,\r\n      horizontalBox: nb,\r\n      verticalBar: v,\r\n      verticalBox: vb,\r\n      corner: co,\r\n    };\r\n    self.scrollBox.bar = {\r\n      v: v,\r\n      h: n,\r\n    };\r\n    self.scrollBox.box = {\r\n      v: vb,\r\n      h: nb,\r\n    };\r\n    /// calculate page and dom elements\r\n    self.page = Math.max(\r\n      1,\r\n      self.visibleRows.length - 3 - self.attributes.pageUpDownOverlap,\r\n    );\r\n    // set canvas drawing related items\r\n    if (!self.isChildGrid) {\r\n      self.canvas.width = self.width * ratio;\r\n      self.canvas.height = self.height * ratio;\r\n      self.ctx.scale(ratio, ratio);\r\n    }\r\n    // resize any open dom elements (input/textarea)\r\n    self.resizeEditInput();\r\n    self.scroll(true);\r\n    if (drawAfterResize) {\r\n      self.draw(true);\r\n    }\r\n    self.dispatchEvent('resize', {});\r\n    return true;\r\n  };\r\n  self.scroll = function (dontDraw) {\r\n    var s = self.getSchema(),\r\n      l = (self.viewData || []).length,\r\n      ch = self.style.cellHeight;\r\n    // go too far in leaps, then get focused\r\n    self.scrollIndexTop = Math.floor(\r\n      l * (self.scrollBox.scrollTop / self.scrollBox.scrollHeight) - 100,\r\n    );\r\n    self.scrollIndexTop = Math.max(self.scrollIndexTop, 0);\r\n    self.scrollPixelTop = self.scrollCache.y[self.scrollIndexTop];\r\n    // sometimes the grid is rendered but the height is zero\r\n    if (self.scrollBox.scrollHeight === 0) {\r\n      self.scrollIndexTop = 0;\r\n    }\r\n    self.scrollPixelTop = 0;\r\n    self.scrollIndexLeft = self.frozenColumn;\r\n    self.scrollPixelLeft = 0;\r\n    while (\r\n      self.scrollPixelTop < self.scrollBox.scrollTop &&\r\n      self.scrollIndexTop < self.viewData.length\r\n    ) {\r\n      // start on index +1 since index 0 was used in \"go too far\" section above\r\n      self.scrollIndexTop += 1;\r\n      self.scrollPixelTop = self.scrollCache.y[self.scrollIndexTop];\r\n    }\r\n    while (\r\n      self.scrollPixelLeft < self.scrollBox.scrollLeft + 1 &&\r\n      self.scrollIndexLeft < s.length\r\n    ) {\r\n      self.scrollPixelLeft = self.scrollCache.x[self.scrollIndexLeft];\r\n      self.scrollIndexLeft += 1;\r\n    }\r\n    if (s.length > 0) {\r\n      self.scrollIndexLeft = Math.max(self.scrollIndexLeft - 1, 0);\r\n      self.scrollPixelLeft -= self.getColumnWidth(\r\n        self.orders.columns[self.scrollIndexLeft],\r\n      );\r\n    }\r\n    if ((self.viewData || []).length > 0) {\r\n      self.scrollIndexTop = Math.max(self.scrollIndexTop - 1, 0);\r\n      self.scrollPixelTop = Math.max(\r\n        self.scrollPixelTop -\r\n          (self.viewData[self.scrollIndexTop]\r\n            ? (self.sizes.rows[self.scrollIndexTop] || ch) +\r\n              (self.sizes.trees[self.scrollIndexTop] || 0)\r\n            : ch) *\r\n            self.scale,\r\n        0,\r\n      );\r\n    }\r\n    self.ellipsisCache = {};\r\n    if (!dontDraw) {\r\n      self.draw(true);\r\n    }\r\n    //TODO: figure out why this has to be delayed for child grids\r\n    //BUG: wheeling event on 3rd level hierarchy fails to move input box\r\n    requestAnimationFrame(self.resizeEditInput);\r\n    self.dispatchEvent('scroll', {\r\n      top: self.scrollBox.scrollTop,\r\n      left: self.scrollBox.scrollLeft,\r\n    });\r\n  };\r\n  self.mousemove = function (e, overridePos) {\r\n    if (self.contextMenu || self.input) {\r\n      return;\r\n    }\r\n    self.mouse = overridePos || self.getLayerPos(e);\r\n    var ctrl =\r\n        (e.ctrlKey || e.metaKey || self.attributes.persistantSelectionMode) &&\r\n        !self.attributes.singleSelectionMode,\r\n      i,\r\n      s = self.getSchema(),\r\n      dragBounds,\r\n      sBounds,\r\n      x = self.mouse.x,\r\n      y = self.mouse.y,\r\n      cell = self.getCellAt(x, y),\r\n      delta,\r\n      ev = { NativeEvent: e, cell: cell, x: x, y: y },\r\n      previousCell = self.currentCell;\r\n    clearTimeout(self.scrollTimer);\r\n    if (!self.isInGrid({ x: x, y: y })) {\r\n      self.hasFocus = false;\r\n    }\r\n    if (self.dispatchEvent('mousemove', ev)) {\r\n      return;\r\n    }\r\n    if (cell && self.currentCell) {\r\n      self.rowBoundaryCrossed = self.currentCell.rowIndex !== cell.rowIndex;\r\n      self.columnBoundaryCrossed =\r\n        self.currentCell.columnIndex !== cell.columnIndex;\r\n      self.cellBoundaryCrossed =\r\n        self.rowBoundaryCrossed || self.columnBoundaryCrossed;\r\n      ['row', 'column', 'cell'].forEach(function (prefix) {\r\n        if (self[prefix + 'BoundaryCrossed']) {\r\n          ev.cell = previousCell;\r\n          self.dispatchEvent(prefix + 'mouseout', ev);\r\n          ev.cell = cell;\r\n          self.dispatchEvent(prefix + 'mouseover', ev);\r\n        }\r\n      });\r\n    }\r\n    self.currentCell = cell;\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    self.hovers = {};\r\n    if (\r\n      !self.draggingItem &&\r\n      cell &&\r\n      self.scrollModes.indexOf(cell.context) === -1\r\n    ) {\r\n      self.dragItem = cell;\r\n      self.dragMode = cell.dragContext;\r\n      self.cursor = cell.context;\r\n      if (cell.context === 'cell') {\r\n        self.cursor = 'default';\r\n        self.hovers = {\r\n          rowIndex: cell.rowIndex,\r\n          columnIndex: cell.columnIndex,\r\n        };\r\n      }\r\n      if ((self.selecting || self.reorderObject) && cell.context === 'cell') {\r\n        delta = {\r\n          x: Math.abs(self.dragStart.x - x),\r\n          y: Math.abs(self.dragStart.y - y),\r\n        };\r\n        if (self.dragStartObject.columnIndex !== -1 && e.shiftKey) {\r\n          self.dragStartObject = {\r\n            rowIndex: self.activeCell.rowIndex,\r\n            columnIndex: self.activeCell.columnIndex,\r\n          };\r\n        }\r\n        dragBounds = {\r\n          top: Math.min(self.dragStartObject.rowIndex, cell.rowIndex),\r\n          left: Math.min(self.dragStartObject.columnIndex, cell.columnIndex),\r\n          bottom: Math.max(self.dragStartObject.rowIndex, cell.rowIndex),\r\n          right: Math.max(self.dragStartObject.columnIndex, cell.columnIndex),\r\n        };\r\n        if (self.dragStartObject.columnIndex === -1) {\r\n          sBounds = self.getSelectionBounds();\r\n          dragBounds.left = -1;\r\n          dragBounds.right = s.length - 1;\r\n          dragBounds.top = Math.min(sBounds.top, cell.rowIndex);\r\n          dragBounds.bottom = Math.max(sBounds.bottom, cell.rowIndex);\r\n        }\r\n        if (\r\n          self.dragStartObject.rowIndex !== cell.rowIndex ||\r\n          self.dragStartObject.columnIndex !== cell.columnIndex\r\n        ) {\r\n          self.ignoreNextClick = true;\r\n        }\r\n        if (\r\n          self.cellBoundaryCrossed ||\r\n          (delta.x === 0 && delta.y === 0) ||\r\n          self.attributes.selectionMode === 'row'\r\n        ) {\r\n          if (\r\n            (self.attributes.selectionMode === 'row' ||\r\n              self.dragStartObject.columnIndex === -1) &&\r\n            self.rowBoundaryCrossed\r\n          ) {\r\n            self.selectRow(cell.rowIndex, ctrl, null, true);\r\n          } else if (self.attributes.selectionMode !== 'row') {\r\n            if (!self.dragAddToSelection && cell.rowIndex !== undefined) {\r\n              if (\r\n                self.selections[cell.rowIndex] &&\r\n                self.selections[cell.rowIndex].indexOf(cell.columnIndex) !== -1\r\n              ) {\r\n                self.selections[cell.rowIndex].splice(\r\n                  self.selections[cell.rowIndex].indexOf(cell.columnIndex),\r\n                  1,\r\n                );\r\n              }\r\n            } else {\r\n              self.selections[cell.rowIndex] =\r\n                self.selections[cell.rowIndex] || [];\r\n              if (\r\n                self.selections[cell.rowIndex].indexOf(cell.columnIndex) === -1\r\n              ) {\r\n                self.selections[cell.rowIndex].push(cell.columnIndex);\r\n\r\n                const event = {\r\n                  selections: self.selections,\r\n                  selectedData: self.getSelectedData(),\r\n                  selectionBounds: self.getSelectionBounds(),\r\n                };\r\n\r\n                self.dispatchEvent('selectionchanged', event);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (\r\n          (!self.selectionBounds ||\r\n            dragBounds.top !== self.selectionBounds.top ||\r\n            dragBounds.left !== self.selectionBounds.left ||\r\n            dragBounds.bottom !== self.selectionBounds.bottom ||\r\n            dragBounds.right !== self.selectionBounds.right) &&\r\n          !ctrl\r\n        ) {\r\n          self.selections = [];\r\n          sBounds = dragBounds;\r\n          if (self.attributes.selectionMode === 'row') {\r\n            for (i = sBounds.top; i <= sBounds.bottom; i += 1) {\r\n              self.selectRow(i, true, null, true);\r\n            }\r\n          } else if (dragBounds.top !== -1) {\r\n            self.selectArea(sBounds, true);\r\n          }\r\n        }\r\n        self.autoScrollZone(e, x, y, ctrl);\r\n      }\r\n    }\r\n    self.cellBoundaryCrossed = false;\r\n    self.rowBoundaryCrossed = false;\r\n    self.columnBoundaryCrossed = false;\r\n    self.draw(true);\r\n  };\r\n  self.click = function (e, overridePos) {\r\n    var i,\r\n      startingBounds = JSON.stringify(self.getSelectionBounds()),\r\n      ctrl =\r\n        (e.ctrlKey || e.metaKey || self.attributes.persistantSelectionMode) &&\r\n        !self.attributes.singleSelectionMode,\r\n      pos = overridePos || self.getLayerPos(e);\r\n    self.currentCell = self.getCellAt(pos.x, pos.y);\r\n    if (self.currentCell.grid !== undefined) {\r\n      return;\r\n    }\r\n    function checkSelectionChange() {\r\n      var ev,\r\n        sb = self.getSelectionBounds();\r\n      if (startingBounds === JSON.stringify(sb)) {\r\n        return;\r\n      }\r\n      ev = {\r\n        selections: self.selections,\r\n        selectionBounds: self.getSelectionBounds(),\r\n      };\r\n      Object.defineProperty(ev, 'selectedData', {\r\n        get: function () {\r\n          return self.getSelectedData();\r\n        },\r\n      });\r\n      self.dispatchEvent('selectionchanged', ev);\r\n    }\r\n    if (self.input) {\r\n      self.endEdit();\r\n    }\r\n    if (self.ignoreNextClick) {\r\n      self.ignoreNextClick = false;\r\n      return;\r\n    }\r\n    i = self.currentCell;\r\n    if (\r\n      self.dispatchEvent('click', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      ['rowHeaderCell', 'columnHeaderCell'].indexOf(self.currentCell.style) ===\r\n        -1 &&\r\n      !ctrl\r\n    ) {\r\n      self.setActiveCell(i.columnIndex, i.rowIndex);\r\n    }\r\n    if (self.currentCell.context === 'cell') {\r\n      if (self.currentCell.style === 'cornerCell') {\r\n        self.selectAll();\r\n        self.draw();\r\n        checkSelectionChange();\r\n        return;\r\n      }\r\n      if (self.currentCell.style === 'columnHeaderCell') {\r\n        if (self.attributes.columnHeaderClickBehavior === 'sort') {\r\n          if (self.orderBy === i.header.name) {\r\n            self.orderDirection =\r\n              self.orderDirection === 'asc' ? 'desc' : 'asc';\r\n          } else {\r\n            self.orderDirection = 'asc';\r\n          }\r\n          self.order(i.header.name, self.orderDirection);\r\n          checkSelectionChange();\r\n          return;\r\n        }\r\n        if (self.attributes.columnHeaderClickBehavior === 'select') {\r\n          self.selectColumn(i.header.index, ctrl, e.shiftKey);\r\n          self.draw();\r\n          return;\r\n        }\r\n      }\r\n      self.selections[i.rowIndex] = self.selections[i.rowIndex] || [];\r\n      if (\r\n        self.attributes.selectionMode === 'row' ||\r\n        self.currentCell.style === 'rowHeaderCell'\r\n      ) {\r\n        if (\r\n          self.currentCell.style === 'rowHeaderCell' &&\r\n          self.attributes.tree &&\r\n          pos.x > 0 &&\r\n          pos.x - self.currentCell.x <\r\n            self.style.treeArrowWidth +\r\n              self.style.treeArrowMarginLeft +\r\n              self.style.treeArrowMarginRight +\r\n              self.style.treeArrowClickRadius &&\r\n          pos.y - self.currentCell.y <\r\n            self.style.treeArrowHeight +\r\n              self.style.treeArrowMarginTop +\r\n              self.style.treeArrowClickRadius &&\r\n          pos.y > 0\r\n        ) {\r\n          self.toggleTree(i.rowIndex);\r\n          return;\r\n        }\r\n      }\r\n      if (e.shiftKey && !ctrl) {\r\n        self.selectionBounds = self.getSelectionBounds();\r\n        self.selectArea(undefined, false);\r\n      }\r\n    }\r\n    checkSelectionChange();\r\n    self.draw(true);\r\n  };\r\n  self.dragResizeColumn = function (e) {\r\n    var pos, x, y;\r\n    pos = self.getLayerPos(e);\r\n    x = self.resizingStartingWidth + pos.x - self.dragStart.x;\r\n    y = self.resizingStartingHeight + pos.y - self.dragStart.y;\r\n    if (x < self.style.minColumnWidth) {\r\n      x = self.style.minColumnWidth;\r\n    }\r\n    if (y < self.style.minRowHeight) {\r\n      y = self.style.minRowHeight;\r\n    }\r\n    if (\r\n      self.dispatchEvent('resizecolumn', {\r\n        x: x,\r\n        y: y,\r\n        draggingItem: self.draggingItem,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    if (\r\n      self.scrollBox.scrollLeft >\r\n        self.scrollBox.scrollWidth - self.attributes.resizeScrollZone &&\r\n      self.dragMode === 'ew-resize'\r\n    ) {\r\n      self.resize(true);\r\n      self.scrollBox.scrollLeft += x;\r\n    }\r\n    if (self.dragMode === 'ew-resize') {\r\n      self.sizes.columns[\r\n        self.draggingItem.header.style === 'rowHeaderCell'\r\n          ? 'cornerCell'\r\n          : self.draggingItem.sortColumnIndex\r\n      ] = x;\r\n      if (\r\n        ['rowHeaderCell', 'cornerCell'].indexOf(\r\n          self.draggingItem.header.style,\r\n        ) !== -1\r\n      ) {\r\n        self.resize(true);\r\n      }\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    if (self.dragMode === 'ns-resize') {\r\n      if (self.draggingItem.rowOpen) {\r\n        self.sizes.trees[self.draggingItem.rowIndex] = y;\r\n      } else if (self.attributes.globalRowResize) {\r\n        self.style.cellHeight = y;\r\n      } else {\r\n        self.sizes.rows[self.draggingItem.rowIndex] = y;\r\n      }\r\n      self.dispatchEvent('resizerow', { row: y });\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    self.ellipsisCache = {};\r\n  };\r\n  self.stopDragResize = function () {\r\n    self.resize();\r\n    document.body.removeEventListener(\r\n      'mousemove',\r\n      self.dragResizeColumn,\r\n      false,\r\n    );\r\n    document.body.removeEventListener('mouseup', self.stopDragResize, false);\r\n    self.setStorageData();\r\n    self.draw(true);\r\n    self.ignoreNextClick = true;\r\n  };\r\n  self.scrollGrid = function (e) {\r\n    var pos = self.getLayerPos(e);\r\n    if (\r\n      self.attributes.scrollPointerLock &&\r\n      self.pointerLockPosition &&\r\n      ['horizontal-scroll-box', 'vertical-scroll-box'].indexOf(\r\n        self.scrollStartMode,\r\n      ) !== -1\r\n    ) {\r\n      self.pointerLockPosition.x += e.movementX;\r\n      self.pointerLockPosition.y += e.movementY;\r\n      self.pointerLockPosition.x = Math.min(\r\n        self.width - self.style.scrollBarWidth,\r\n        Math.max(0, self.pointerLockPosition.x),\r\n      );\r\n      self.pointerLockPosition.y = Math.min(\r\n        self.height - self.style.scrollBarWidth,\r\n        Math.max(0, self.pointerLockPosition.y),\r\n      );\r\n      pos = self.pointerLockPosition;\r\n    }\r\n    self.scrollMode = self.getCellAt(pos.x, pos.y).context;\r\n    if (\r\n      self.scrollMode === 'horizontal-scroll-box' &&\r\n      self.scrollStartMode !== 'horizontal-scroll-box'\r\n    ) {\r\n      self.scrollStartMode = 'horizontal-scroll-box';\r\n      self.dragStart = pos;\r\n      self.scrollStart.left = self.scrollBox.scrollLeft;\r\n      clearTimeout(self.scrollTimer);\r\n      return;\r\n    }\r\n    if (\r\n      self.scrollMode === 'vertical-scroll-box' &&\r\n      self.scrollStartMode !== 'vertical-scroll-box'\r\n    ) {\r\n      self.scrollStartMode = 'vertical-scroll-box';\r\n      self.dragStart = pos;\r\n      self.scrollStart.top = self.scrollBox.scrollTop;\r\n      clearTimeout(self.scrollTimer);\r\n      return;\r\n    }\r\n    if (\r\n      self.scrollStartMode === 'vertical-scroll-box' &&\r\n      self.scrollMode !== 'vertical-scroll-box'\r\n    ) {\r\n      self.scrollMode = 'vertical-scroll-box';\r\n    }\r\n    if (\r\n      self.scrollStartMode === 'horizontal-scroll-box' &&\r\n      self.scrollMode !== 'horizontal-scroll-box'\r\n    ) {\r\n      self.scrollMode = 'horizontal-scroll-box';\r\n    }\r\n    clearTimeout(self.scrollTimer);\r\n    if (self.scrollModes.indexOf(self.scrollMode) === -1) {\r\n      return;\r\n    }\r\n    if (self.scrollMode === 'vertical-scroll-box') {\r\n      self.scrollBox.scrollTop =\r\n        self.scrollStart.top +\r\n        (pos.y - self.dragStart.y) / self.scrollBox.heightBoxRatio;\r\n    } else if (self.scrollMode === 'vertical-scroll-top') {\r\n      self.scrollBox.scrollTop -= self.page * self.style.cellHeight;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    } else if (self.scrollMode === 'vertical-scroll-bottom') {\r\n      self.scrollBox.scrollTop += self.page * self.style.cellHeight;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n    if (self.scrollMode === 'horizontal-scroll-box') {\r\n      self.scrollBox.scrollLeft =\r\n        self.scrollStart.left +\r\n        (pos.x - self.dragStart.x) / self.scrollBox.widthBoxRatio;\r\n    } else if (self.scrollMode === 'horizontal-scroll-right') {\r\n      self.scrollBox.scrollLeft += self.attributes.selectionScrollIncrement;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    } else if (self.scrollMode === 'horizontal-scroll-left') {\r\n      self.scrollBox.scrollLeft -= self.attributes.selectionScrollIncrement;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n  };\r\n  self.stopScrollGrid = function () {\r\n    clearTimeout(self.scrollTimer);\r\n    if (document.exitPointerLock) {\r\n      document.exitPointerLock();\r\n    }\r\n    document.removeEventListener('mousemove', self.scrollGrid, false);\r\n  };\r\n  self.dragReorder = function (e) {\r\n    var pos,\r\n      x,\r\n      y,\r\n      columReorder = self.dragMode === 'column-reorder',\r\n      rowReorder = self.dragMode === 'row-reorder';\r\n    pos = self.getLayerPos(e);\r\n    x = pos.x - self.dragStart.x;\r\n    y = pos.y - self.dragStart.y;\r\n    if (!self.attributes.allowColumnReordering && columReorder) {\r\n      return;\r\n    }\r\n    if (!self.attributes.allowRowReordering && rowReorder) {\r\n      return;\r\n    }\r\n    if (\r\n      self.dispatchEvent('reordering', {\r\n        NativeEvent: e,\r\n        source: self.dragStartObject,\r\n        target: self.currentCell,\r\n        dragMode: self.dragMode,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    if (\r\n      Math.abs(x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      self.reorderObject = self.draggingItem;\r\n      self.reorderTarget = self.currentCell;\r\n      self.reorderObject.dragOffset = {\r\n        x: x,\r\n        y: y,\r\n      };\r\n      self.autoScrollZone(\r\n        e,\r\n        columReorder ? pos.x : -1,\r\n        rowReorder ? pos.y : -1,\r\n        false,\r\n      );\r\n    }\r\n  };\r\n  self.stopDragReorder = function (e) {\r\n    var oIndex,\r\n      tIndex,\r\n      cr = {\r\n        'row-reorder': self.orders.rows,\r\n        'column-reorder': self.orders.columns,\r\n      },\r\n      i = {\r\n        'row-reorder': 'rowIndex',\r\n        'column-reorder': 'sortColumnIndex',\r\n      }[self.dragMode];\r\n    document.body.removeEventListener('mousemove', self.dragReorder, false);\r\n    document.body.removeEventListener('mouseup', self.stopDragReorder, false);\r\n    if (\r\n      self.reorderObject &&\r\n      self.reorderTarget &&\r\n      ((self.dragMode === 'column-reorder' &&\r\n        self.reorderTarget.sortColumnIndex > -1 &&\r\n        self.reorderTarget.sortColumnIndex < self.getSchema().length) ||\r\n        (self.dragMode === 'row-reorder' &&\r\n          self.reorderTarget.rowIndex > -1 &&\r\n          self.reorderTarget.rowIndex < self.viewData.length)) &&\r\n      self.reorderObject[i] !== self.reorderTarget[i] &&\r\n      !self.dispatchEvent('reorder', {\r\n        NativeEvent: e,\r\n        source: self.reorderObject,\r\n        target: self.reorderTarget,\r\n        dragMode: self.dragMode,\r\n      })\r\n    ) {\r\n      self.ignoreNextClick = true;\r\n      oIndex = cr[self.dragMode].indexOf(self.reorderObject[i]);\r\n      tIndex = cr[self.dragMode].indexOf(self.reorderTarget[i]);\r\n      cr[self.dragMode].splice(oIndex, 1);\r\n      cr[self.dragMode].splice(tIndex, 0, self.reorderObject[i]);\r\n      if (self.dragMode === 'column-reorder') {\r\n        self.orders.columns = cr[self.dragMode];\r\n      } else {\r\n        self.orders.rows = cr[self.dragMode];\r\n      }\r\n      self.resize();\r\n      self.setStorageData();\r\n    }\r\n    self.reorderObject = undefined;\r\n    self.reorderTarget = undefined;\r\n    self.draw(true);\r\n  };\r\n  self.dragMove = function (e) {\r\n    if (\r\n      self.dispatchEvent('moving', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    var pos = self.getLayerPos(e);\r\n    self.moveOffset = {\r\n      x: self.currentCell.columnIndex - self.dragStartObject.columnIndex,\r\n      y: self.currentCell.rowIndex - self.dragStartObject.rowIndex,\r\n    };\r\n    if (\r\n      Math.abs(pos.x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(pos.y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      setTimeout(function () {\r\n        self.autoScrollZone(e, pos.x, pos.y, false);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.stopDragMove = function (e) {\r\n    document.body.removeEventListener('mousemove', self.dragMove, false);\r\n    document.body.removeEventListener('mouseup', self.stopDragMove, false);\r\n    var b = self.getSelectionBounds();\r\n    if (\r\n      self.dispatchEvent('endmove', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      self.movingSelection = undefined;\r\n      self.moveOffset = undefined;\r\n      self.draw(true);\r\n      return;\r\n    }\r\n    if (self.moveOffset) {\r\n      self.moveTo(\r\n        self.movingSelection,\r\n        b.left + self.moveOffset.x,\r\n        b.top + self.moveOffset.y,\r\n      );\r\n      self.moveSelection(self.moveOffset.x, self.moveOffset.y);\r\n    }\r\n    self.movingSelection = undefined;\r\n    self.moveOffset = undefined;\r\n    self.draw(true);\r\n  };\r\n  self.freezeMove = function (e) {\r\n    if (\r\n      self.dispatchEvent('freezemoving', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    var pos = self.getLayerPos(e);\r\n    self.ignoreNextClick = true;\r\n    self.freezeMarkerPosition = pos;\r\n    if (\r\n      self.currentCell &&\r\n      self.currentCell.rowIndex !== undefined &&\r\n      self.dragMode === 'frozen-row-marker'\r\n    ) {\r\n      self.scrollBox.scrollTop = 0;\r\n      self.frozenRow = self.currentCell.rowIndex + 1;\r\n    }\r\n    if (\r\n      self.currentCell &&\r\n      self.currentCell.columnIndex !== undefined &&\r\n      self.dragMode === 'frozen-column-marker'\r\n    ) {\r\n      self.scrollBox.scrollLeft = 0;\r\n      self.frozenColumn = self.currentCell.columnIndex + 1;\r\n    }\r\n    if (\r\n      Math.abs(pos.x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(pos.y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      setTimeout(function () {\r\n        self.autoScrollZone(e, pos.x, pos.y, false);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.stopFreezeMove = function (e) {\r\n    document.body.removeEventListener('mousemove', self.freezeMove, false);\r\n    document.body.removeEventListener('mouseup', self.stopFreezeMove, false);\r\n    self.freezeMarkerPosition = undefined;\r\n    if (\r\n      self.dispatchEvent('endfreezemove', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      self.frozenRow = self.startFreezeMove.x;\r\n      self.frozenColumn = self.startFreezeMove.y;\r\n      self.draw(true);\r\n      return;\r\n    }\r\n    self.draw(true);\r\n  };\r\n  self.mousedown = function (e, overridePos) {\r\n    self.lastMouseDownTarget = e.target;\r\n    if (\r\n      self.dispatchEvent('mousedown', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (e.button === 2 || self.input) {\r\n      return;\r\n    }\r\n    var ctrl = e.ctrlKey || e.metaKey,\r\n      move = /-move/.test(self.dragMode),\r\n      freeze = /frozen-row-marker|frozen-column-marker/.test(self.dragMode),\r\n      resize = /-resize/.test(self.dragMode);\r\n    self.dragStart = overridePos || self.getLayerPos(e);\r\n    self.scrollStart = {\r\n      left: self.scrollBox.scrollLeft,\r\n      top: self.scrollBox.scrollTop,\r\n    };\r\n    self.dragStartObject = self.getCellAt(self.dragStart.x, self.dragStart.y);\r\n    self.dragAddToSelection = !self.dragStartObject.selected;\r\n    if (\r\n      !ctrl &&\r\n      !e.shiftKey &&\r\n      !/(vertical|horizontal)-scroll-(bar|box)/.test(\r\n        self.dragStartObject.context,\r\n      ) &&\r\n      self.currentCell &&\r\n      !self.currentCell.isColumnHeader &&\r\n      !move &&\r\n      !freeze &&\r\n      !resize\r\n    ) {\r\n      self.selections = [];\r\n    }\r\n    if (self.dragStartObject.isGrid) {\r\n      return;\r\n    }\r\n    if (self.scrollModes.indexOf(self.dragStartObject.context) !== -1) {\r\n      self.scrollMode = self.dragStartObject.context;\r\n      self.scrollStartMode = self.dragStartObject.context;\r\n      self.scrollGrid(e);\r\n      if (\r\n        self.attributes.scrollPointerLock &&\r\n        ['horizontal-scroll-box', 'vertical-scroll-box'].indexOf(\r\n          self.scrollStartMode,\r\n        ) !== -1\r\n      ) {\r\n        self.pointerLockPosition = {\r\n          x: self.dragStart.x,\r\n          y: self.dragStart.y,\r\n        };\r\n        self.canvas.requestPointerLock();\r\n      }\r\n      document.addEventListener('mousemove', self.scrollGrid, false);\r\n      document.addEventListener('mouseup', self.stopScrollGrid, false);\r\n      self.ignoreNextClick = true;\r\n      return;\r\n    }\r\n    if (self.dragMode === 'cell') {\r\n      self.selecting = true;\r\n      if (\r\n        (self.attributes.selectionMode === 'row' ||\r\n          self.dragStartObject.columnIndex === -1) &&\r\n        self.dragStartObject.rowIndex > -1\r\n      ) {\r\n        self.selectRow(self.dragStartObject.rowIndex, ctrl, null);\r\n      } else if (self.attributes.selectionMode !== 'row') {\r\n        self.mousemove(e);\r\n      }\r\n      return;\r\n    }\r\n    if (move) {\r\n      self.draggingItem = self.dragItem;\r\n      self.movingSelection = self.selections.concat([]);\r\n      self.dragging = self.dragStartObject;\r\n      if (\r\n        self.dispatchEvent('beginmove', {\r\n          NativeEvent: e,\r\n          cell: self.currentCell,\r\n        })\r\n      ) {\r\n        return;\r\n      }\r\n      document.body.addEventListener('mousemove', self.dragMove, false);\r\n      document.body.addEventListener('mouseup', self.stopDragMove, false);\r\n      return self.mousemove(e);\r\n    }\r\n    if (freeze) {\r\n      self.draggingItem = self.dragItem;\r\n      self.startFreezeMove = {\r\n        x: self.frozenRow,\r\n        y: self.frozenColumn,\r\n      };\r\n      if (self.dispatchEvent('beginfreezemove', { NativeEvent: e })) {\r\n        return;\r\n      }\r\n      document.body.addEventListener('mousemove', self.freezeMove, false);\r\n      document.body.addEventListener('mouseup', self.stopFreezeMove, false);\r\n      return self.mousemove(e);\r\n    }\r\n    if (resize) {\r\n      self.draggingItem = self.dragItem;\r\n      if (self.draggingItem.rowOpen) {\r\n        self.resizingStartingHeight =\r\n          self.sizes.trees[self.draggingItem.rowIndex];\r\n      } else {\r\n        self.resizingStartingHeight =\r\n          self.sizes.rows[self.draggingItem.rowIndex] || self.style.cellHeight;\r\n      }\r\n      self.resizingStartingWidth =\r\n        self.sizes.columns[\r\n          self.draggingItem.header.style === 'rowHeaderCell'\r\n            ? 'cornerCell'\r\n            : self.draggingItem.sortColumnIndex\r\n        ] || self.draggingItem.width;\r\n      document.body.addEventListener('mousemove', self.dragResizeColumn, false);\r\n      document.body.addEventListener('mouseup', self.stopDragResize, false);\r\n      return;\r\n    }\r\n    if (['row-reorder', 'column-reorder'].indexOf(self.dragMode) !== -1) {\r\n      self.draggingItem = self.dragStartObject;\r\n      document.body.addEventListener('mousemove', self.dragReorder, false);\r\n      document.body.addEventListener('mouseup', self.stopDragReorder, false);\r\n      return;\r\n    }\r\n  };\r\n  self.mouseup = function (e) {\r\n    clearTimeout(self.scrollTimer);\r\n    self.cellBoundaryCrossed = true;\r\n    self.rowBoundaryCrossed = true;\r\n    self.columnBoundaryCrossed = true;\r\n    self.selecting = undefined;\r\n    self.draggingItem = undefined;\r\n    self.dragStartObject = undefined;\r\n    if (\r\n      self.dispatchEvent('mouseup', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus && e.target !== self.canvas) {\r\n      return;\r\n    }\r\n    if (self.currentCell && self.currentCell.grid !== undefined) {\r\n      return;\r\n    }\r\n    if (self.contextMenu || self.input) {\r\n      return;\r\n    }\r\n    if (self.dragStart && self.isInGrid(self.dragStart)) {\r\n      self.controlInput.focus();\r\n    }\r\n    e.preventDefault();\r\n  };\r\n  // gets the horizontal adjacent cells as well as first/last based on column visibility\r\n  self.getAdjacentCells = function () {\r\n    var x,\r\n      i,\r\n      s = self.getSchema(),\r\n      o = {};\r\n    for (x = 0; x < s.length; x += 1) {\r\n      i = self.orders.columns[x];\r\n      if (!s[i].hidden) {\r\n        if (o.first === undefined) {\r\n          o.first = x;\r\n          o.left = x;\r\n        }\r\n        o.last = x;\r\n        if (x > self.activeCell.columnIndex && o.right === undefined) {\r\n          o.right = x;\r\n        }\r\n        if (x < self.activeCell.columnIndex) {\r\n          o.left = x;\r\n        }\r\n      }\r\n    }\r\n    if (o.right === undefined) {\r\n      o.right = o.last;\r\n    }\r\n    return o;\r\n  };\r\n  self.keydown = function (e) {\r\n    var i,\r\n      ev,\r\n      adjacentCells = self.getAdjacentCells(),\r\n      x = self.activeCell.columnIndex,\r\n      y = self.activeCell.rowIndex,\r\n      ctrl = e.ctrlKey || e.metaKey,\r\n      last = self.viewData.length - 1,\r\n      s = self.getSchema(),\r\n      cols = s.length - 1;\r\n\r\n    var defaultPrevented = self.dispatchEvent('keydown', {\r\n      NativeEvent: e,\r\n      cell: self.currentCell,\r\n    });\r\n\r\n    if (defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n\r\n    // If a user starts typing content, switch to \"Enter\" mode\r\n    if (isPrintableKeyEvent(e) && !ctrl) {\r\n      return self.beginEditAt(x, y, e, true);\r\n    }\r\n\r\n    if (self.attributes.showNewRow) {\r\n      last += 1;\r\n    }\r\n\r\n    if (e.key === 'Tab') {\r\n      e.preventDefault();\r\n    }\r\n\r\n    if (e.key === 'Escape') {\r\n      self.selectNone();\r\n    } else if (ctrl && e.key === 'a') {\r\n      self.selectAll();\r\n    } else if (e.key === 'ArrowDown') {\r\n      y += 1;\r\n    } else if (e.key === 'ArrowUp') {\r\n      y -= 1;\r\n    } else if (\r\n      (e.key === 'ArrowLeft' && !ctrl) ||\r\n      (e.shiftKey && e.key === 'Tab')\r\n    ) {\r\n      x = adjacentCells.left;\r\n    } else if (\r\n      (e.key === 'ArrowRight' && !ctrl) ||\r\n      (!e.shiftKey && e.key === 'Tab')\r\n    ) {\r\n      x = adjacentCells.right;\r\n    } else if (e.key === 'PageUp') {\r\n      y -= self.page;\r\n      e.preventDefault();\r\n    } else if (e.key === 'PageDown') {\r\n      y += self.page;\r\n      e.preventDefault();\r\n    } else if (e.key === 'Home' || (ctrl && e.key === 'ArrowUp')) {\r\n      y = 0;\r\n    } else if (e.key === 'End' || (ctrl && e.key === 'ArrowDown')) {\r\n      y = self.viewData.length - 1;\r\n    } else if (ctrl && e.key === 'ArrowRight') {\r\n      x = adjacentCells.last;\r\n    } else if (ctrl && e.key === 'ArrowLeft') {\r\n      x = adjacentCells.first;\r\n    }\r\n\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      return self.beginEditAt(x, y, e);\r\n    }\r\n\r\n    if (x < 0 || Number.isNaN(x)) {\r\n      x = adjacentCells.first;\r\n    }\r\n    if (y > last) {\r\n      y = last;\r\n    }\r\n    if (y < 0 || Number.isNaN(y)) {\r\n      y = 0;\r\n    }\r\n    if (x > cols) {\r\n      x = adjacentCells.last;\r\n    }\r\n\r\n    // TODO - most likely some column order related bugs in key based selection\r\n    // Arrows\r\n    var isArrowKey = [\r\n      'ArrowLeft',\r\n      'ArrowUp',\r\n      'ArrowRight',\r\n      'ArrowDown',\r\n    ].includes(e.key);\r\n\r\n    if (e.shiftKey && isArrowKey) {\r\n      self.selections[Math.max(y, 0)] = self.selections[Math.max(y, 0)] || [];\r\n      self.selections[Math.max(y, 0)].push(x);\r\n\r\n      self.selectionBounds = self.getSelectionBounds();\r\n      self.selectArea(undefined, ctrl);\r\n\r\n      self.draw(true);\r\n    }\r\n\r\n    if (x !== self.activeCell.columnIndex || y !== self.activeCell.rowIndex) {\r\n      self.scrollIntoView(\r\n        x !== self.activeCell.columnIndex ? x : undefined,\r\n        y !== self.activeCell.rowIndex && !Number.isNaN(y) ? y : undefined,\r\n      );\r\n\r\n      self.setActiveCell(x, y);\r\n      if (!e.shiftKey && self.attributes.selectionFollowsActiveCell) {\r\n        if (!ctrl) {\r\n          self.selections = [];\r\n        }\r\n        self.selections[y] = self.selections[y] || [];\r\n        self.selections[y].push(x);\r\n        ev = {\r\n          selectedData: self.getSelectedData(),\r\n          selections: self.selections,\r\n          selectionBounds: self.getSelectionBounds(),\r\n        };\r\n        Object.defineProperty(ev, 'selectedData', {\r\n          get: function () {\r\n            return self.getSelectedData();\r\n          },\r\n        });\r\n        self.dispatchEvent('selectionchanged', ev);\r\n      }\r\n      self.draw(true);\r\n    }\r\n  };\r\n  self.keyup = function (e) {\r\n    if (\r\n      self.dispatchEvent('keyup', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n  };\r\n  self.keypress = function (e) {\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      self.dispatchEvent('keypress', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n  };\r\n  self.dblclick = function (e) {\r\n    if (\r\n      self.dispatchEvent('dblclick', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      self.currentCell.context === 'ew-resize' &&\r\n      self.currentCell.style === 'columnHeaderCell'\r\n    ) {\r\n      self.fitColumnToValues(self.currentCell.header.name);\r\n    } else if (\r\n      self.currentCell.context === 'ew-resize' &&\r\n      self.currentCell.style === 'cornerCell'\r\n    ) {\r\n      self.autosize();\r\n    } else if (['cell', 'activeCell'].indexOf(self.currentCell.style) !== -1) {\r\n      self.beginEditAt(self.currentCell.columnIndex, self.currentCell.rowIndex);\r\n    }\r\n  };\r\n  self.scrollWheel = function (e) {\r\n    var l,\r\n      t,\r\n      ev = e,\r\n      deltaX = e.deltaX === undefined ? e.NativeEvent.deltaX : e.deltaX,\r\n      deltaY = e.deltaY === undefined ? e.NativeEvent.deltaY : e.deltaY,\r\n      deltaMode =\r\n        e.deltaMode === undefined ? e.NativeEvent.deltaMode : e.deltaMode;\r\n    var e = e.NativeEvent || e;\r\n    if (wheeling) {\r\n      ev.preventDefault(e);\r\n      return;\r\n    }\r\n    if (self.dispatchEvent('wheel', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    self.touchHaltAnimation = true;\r\n    l = self.scrollBox.scrollLeft;\r\n    t = self.scrollBox.scrollTop;\r\n    if (self.hasFocus) {\r\n      //BUG Issue 42: https://github.com/TonyGermaneri/canvas-datagrid/issues/42\r\n      //https://stackoverflow.com/questions/20110224/what-is-the-height-of-a-line-in-a-wheel-event-deltamode-dom-delta-line\r\n      if (deltaMode === 1) {\r\n        // line mode = 17 pixels per line\r\n        deltaY = deltaY * 17;\r\n      }\r\n      if (\r\n        (self.scrollBox.scrollTop < self.scrollBox.scrollHeight &&\r\n          deltaY > 0) ||\r\n        (self.scrollBox.scrollLeft < self.scrollBox.scrollWidth &&\r\n          deltaX > 0) ||\r\n        (self.scrollBox.scrollTop > 0 && deltaY < 0) ||\r\n        (self.scrollBox.scrollLeft > 0 && deltaX < 0)\r\n      ) {\r\n        ev.preventDefault(e);\r\n      }\r\n      wheeling = setTimeout(function () {\r\n        wheeling = undefined;\r\n        self.scrollBox.scrollTo(deltaX + l, deltaY + t);\r\n      }, 1);\r\n    }\r\n  };\r\n\r\n  self.pasteData = function (\r\n    pasteValue,\r\n    mimeType,\r\n    startRowIndex,\r\n    startColIndex,\r\n  ) {\r\n    var schema = self.getVisibleSchema();\r\n\r\n    const isSupportedHtmlTable = (htmlString) =>\r\n      /(?:^(<meta[^>]+>)?<table>)|(?:<!--StartFragment-->\\s*<table>)/.test(\r\n        htmlString,\r\n      );\r\n\r\n    // TODO: support pasting tables from Excel\r\n    if (\r\n      mimeType === 'text/html' &&\r\n      isSupportedHtmlTable(pasteValue) === false\r\n    ) {\r\n      console.warn(\r\n        'Unrecognized HTML format. HTML must be a simple table, e.g.: <table><tr><td>data</td></tr></table>.',\r\n      );\r\n      console.warn(\r\n        'Data with the mime type text/html not in this format will not be imported as row data.',\r\n      );\r\n\r\n      return;\r\n    }\r\n\r\n    function parseData(data, mimeType) {\r\n      // TODO: use DOMParser\r\n      if (mimeType === 'text/html') {\r\n        // strip table beginning and ending off, then split at rows\r\n        var cleanedHtmlData = data\r\n          .substring(\r\n            data.indexOf('<table><tr>') + 11,\r\n            data.indexOf('</tr></table>'),\r\n          )\r\n          .split('</tr><tr>')\r\n          .filter(\r\n            // ditch any headers on the table\r\n            (row) => !/^<th>|^<thead>/.test(row),\r\n          )\r\n          .map(\r\n            // split row into individual cells\r\n            (row) =>\r\n              row\r\n                .match(/<td>[^<]+/g)\r\n                .map((match) => match.replace(/^<td>/, '')),\r\n          );\r\n\r\n        return cleanedHtmlData;\r\n      }\r\n\r\n      // Default data format is string, so split on new line,\r\n      // and then enclose in an array (a row with one cell):\r\n      return data.split('\\n').map((value) => [value]);\r\n    }\r\n\r\n    var rows = parseData(pasteValue, mimeType);\r\n\r\n    // Special case: if rows.length = 1, we paste this value in each\r\n    // selected cell. This mimics Excel's paste functionality, and works\r\n    // as a poor-man's fill-down.\r\n    if (rows.length === 1) {\r\n      var cellData = rows[0][0];\r\n\r\n      self.forEachSelectedCell(function (data, rowIndex, colName) {\r\n        data[rowIndex][colName] = cellData;\r\n      });\r\n    } else {\r\n      var selections = [];\r\n      for (var rowIndex = 0; rowIndex < rows.length; rowIndex++) {\r\n        // Rows may have been moved by user, so get the actual row index\r\n        // (instead of the row index at which the row is rendered):\r\n        var realRowIndex = self.orders.rows[startRowIndex + rowIndex];\r\n        var cells = rows[rowIndex];\r\n\r\n        var existingRowData = self.viewData[realRowIndex];\r\n        var newRowData = Object.assign({}, existingRowData);\r\n\r\n        selections[realRowIndex] = [];\r\n\r\n        for (var colIndex = 0; colIndex < cells.length; colIndex++) {\r\n          var column = schema[startColIndex + colIndex];\r\n\r\n          if (!column) {\r\n            console.warn('Paste data exceeded grid bounds. Skipping.');\r\n            continue;\r\n          }\r\n\r\n          var columnName = column.name;\r\n          var cellData = cells[colIndex];\r\n\r\n          if (cellData === undefined || cellData === null) {\r\n            newRowData[columnName] = existingRowData[columnName];\r\n            continue;\r\n          }\r\n\r\n          selections[realRowIndex].push(startColIndex + colIndex);\r\n\r\n          newRowData[columnName] = cellData;\r\n        }\r\n\r\n        self.originalData[realRowIndex] = newRowData;\r\n      }\r\n      self.selections = selections;\r\n    }\r\n\r\n    // selections is a sparse array, so we condense:\r\n    var affectedCells = [];\r\n\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      if (rowIndex === undefined) return;\r\n\r\n      row.forEach(function (columnIndex) {\r\n        affectedCells.push([rowIndex, columnIndex]);\r\n      });\r\n    });\r\n\r\n    self.dispatchEvent('afterpaste', {\r\n      cells: affectedCells,\r\n    });\r\n\r\n    // Because originalData has been updated, we must refresh\r\n    // viewData to ensure the new cell values are rendered\r\n    self.refresh();\r\n\r\n    return rows.length;\r\n  };\r\n  self.getNextVisibleColumnIndex = function (visibleColumnIndex) {\r\n    var x,\r\n      s = self.getVisibleSchema();\r\n    for (x = 0; x < s.length; x += 1) {\r\n      if (s[x].columnIndex === visibleColumnIndex) {\r\n        return s[x + 1].columnIndex;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n  self.getVisibleColumnIndexOf = function (columnIndex) {\r\n    var x,\r\n      s = self.getVisibleSchema();\r\n    for (x = 0; x < s.length; x += 1) {\r\n      if (s[x].columnIndex === columnIndex) {\r\n        return x;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n  self.paste = function (event) {\r\n    if (!self.attributes.editable) {\r\n      return;\r\n    }\r\n\r\n    var defaultPrevented = self.dispatchEvent('beforepaste', {\r\n      NativeEvent: event,\r\n    });\r\n\r\n    if (defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    var clipboardItems = new Map(\r\n      Array.from(event.clipboardData.items).map((item) => [item.type, item]),\r\n    );\r\n\r\n    // Supported MIME types, in order of preference:\r\n    var supportedMimeTypes = ['text/html', 'text/csv', 'text/plain'];\r\n\r\n    // The clipboard will often contain the same data in multiple formats,\r\n    // which can be used depending on the context in which it's pasted. Here\r\n    // we'll prefere more structured (HTML/CSV) over less structured, when\r\n    // available, so we try to find those first:\r\n    var pasteableItems = supportedMimeTypes\r\n      .map((mimeType) => clipboardItems.get(mimeType))\r\n      .filter((item) => !!item); // filter out not-found MIME types (= undefined)\r\n\r\n    if (pasteableItems.length === 0) {\r\n      console.warn(\r\n        'Cannot find supported clipboard data type. Supported types are:',\r\n        supportedMimeTypes.join(', '),\r\n      );\r\n      return;\r\n    }\r\n\r\n    var itemToPaste = pasteableItems[0];\r\n\r\n    // itemToPaste is cleared once accessed (getData or getAsString),\r\n    // so we need to store the type here, before reading its value:\r\n    var pasteType = itemToPaste.type;\r\n\r\n    itemToPaste.getAsString(function (pasteValue) {\r\n      self.pasteData(\r\n        pasteValue,\r\n        pasteType,\r\n        self.activeCell.rowIndex,\r\n        self.getVisibleColumnIndexOf(self.activeCell.columnIndex),\r\n      );\r\n\r\n      self.draw();\r\n    });\r\n  };\r\n  self.cut = function (e) {\r\n    self.copy(e);\r\n    self.forEachSelectedCell(function (data, index, colName) {\r\n      data[index][colName] = '';\r\n    });\r\n  };\r\n  self.copy = function (e) {\r\n    if (self.dispatchEvent('copy', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus || !e.clipboardData) {\r\n      return;\r\n    }\r\n    var t,\r\n      d,\r\n      tableRows = [],\r\n      textRows = [],\r\n      outputHeaders = {},\r\n      outputHeaderKeys,\r\n      sData = self.getSelectedData(),\r\n      s = self.getSchema();\r\n    function htmlSafe(v) {\r\n      return v.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    function fCopyCell(v) {\r\n      v = v === null || v === undefined ? '' : v;\r\n      return '<td>' + (typeof v === 'string' ? htmlSafe(v) : v) + '</td>';\r\n    }\r\n    function addHeaders(headers, useHtml) {\r\n      if (!s.length || headers.length < 2) {\r\n        return '';\r\n      }\r\n      var h = [];\r\n      if (useHtml) {\r\n        h.push('<tr>');\r\n      }\r\n      s.forEach(function (column, columnIndex) {\r\n        // intentional redefinition of column\r\n        column = s[self.orders.columns[columnIndex]];\r\n        if (!column.hidden && headers.indexOf(column.name) !== -1) {\r\n          var ev = { NativeEvent: e, column: column };\r\n          if (self.dispatchEvent('copyonschema', ev)) {\r\n            column = ev.column;\r\n          }\r\n\r\n          var hVal = column.name || column.title || '';\r\n          if (useHtml) {\r\n            h.push('<th>' + htmlSafe(hVal) + '</th>');\r\n          } else {\r\n            h.push('\"' + hVal.replace(/\"/g, '\"\"') + '\"');\r\n          }\r\n        }\r\n      });\r\n      h.push(useHtml ? '</tr>' : '\\n');\r\n      return h.join(useHtml ? '' : ',');\r\n    }\r\n    function addCellValue(val, trRow, textRow, column) {\r\n      // escape strings\r\n      if (val !== null && val !== false && val !== undefined && val.replace) {\r\n        trRow.push(fCopyCell(val));\r\n        textRow.push('\"' + val.replace(/\"/g, '\"\"') + '\"');\r\n        return;\r\n      }\r\n      if (val !== undefined) {\r\n        textRow.push(val);\r\n        trRow.push(fCopyCell(val));\r\n        return;\r\n      }\r\n      // issue #66\r\n      textRow.push('');\r\n      trRow.push('<td>&nbsp;</td>');\r\n    }\r\n    if (sData.length > 0) {\r\n      sData.forEach(function (row) {\r\n        var rowKeys = Object.keys(row);\r\n        if (row) {\r\n          var trRow = [],\r\n            textRow = [],\r\n            sSorted = [];\r\n          // HACK: https://github.com/TonyGermaneri/canvas-datagrid/issues/181\r\n          // I can't use sort here or O(1), so hacks\r\n          s.forEach(function (column, columnIndex) {\r\n            sSorted.push(s[self.orders.columns[columnIndex]]);\r\n          });\r\n          sSorted.forEach(function (column, columnIndex) {\r\n            if (rowKeys.indexOf(column.name) !== -1) {\r\n              outputHeaders[column.name] = true;\r\n              // escape strings\r\n              addCellValue(row[column.name], trRow, textRow, column);\r\n            }\r\n          });\r\n          tableRows.push(trRow.join(''));\r\n          textRows.push(textRow.join(','));\r\n        }\r\n      });\r\n      outputHeaderKeys = Object.keys(outputHeaders);\r\n      t = addHeaders(outputHeaderKeys) + textRows.join('\\n');\r\n      d =\r\n        '<table>' +\r\n        addHeaders(outputHeaderKeys, true) +\r\n        '<tr>' +\r\n        tableRows.join('</tr><tr>') +\r\n        '</tr></table>';\r\n      if (outputHeaderKeys.length === 1) {\r\n        // if there was only one cell selected, remove the quotes from the string\r\n        t = t.substring(1, t.length - 1);\r\n      }\r\n      e.clipboardData.setData('text/html', d);\r\n      e.clipboardData.setData('text/plain', t);\r\n      e.clipboardData.setData('text/csv', t);\r\n      e.clipboardData.setData('application/json', JSON.stringify(sData));\r\n      e.preventDefault();\r\n    }\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals HTMLElement: false, Reflect: false, define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self, ctor) {\r\n  self.scale = 1;\r\n  self.orders = {\r\n    rows: [],\r\n    columns: [],\r\n  };\r\n  self.appliedInlineStyles = {};\r\n  self.cellGridAttributes = {};\r\n  self.treeGridAttributes = {};\r\n  self.visibleRowHeights = [];\r\n  self.hasFocus = false;\r\n  self.activeCell = {\r\n    columnIndex: 0,\r\n    rowIndex: 0,\r\n  };\r\n  self.innerHTML = '';\r\n  self.storageName = 'canvasDataGrid';\r\n  self.invalidSearchExpClass = 'canvas-datagrid-invalid-search-regExp';\r\n  self.localStyleLibraryStorageKey = 'canvas-datagrid-user-style-library';\r\n  self.dataType = 'application/x-canvas-datagrid';\r\n  self.orderBy = null;\r\n  self.orderDirection = 'asc';\r\n  self.orderings = {\r\n    columns: [],\r\n    add: function (orderBy, orderDirection, sortFunction) {\r\n      self.orderings.columns = self.orderings.columns.filter(function (col) {\r\n        return col.orderBy !== orderBy;\r\n      });\r\n      self.orderings.columns.push({\r\n        orderBy: orderBy,\r\n        orderDirection: orderDirection,\r\n        sortFunction: sortFunction,\r\n      });\r\n    },\r\n    sort: function () {\r\n      console.warn(\r\n        'grid.orderings.sort has been deprecated. Please use grid.refresh().',\r\n      );\r\n\r\n      self.orderings.columns.forEach(function (col) {\r\n        self.viewData.sort(col.sortFunction(col.orderBy, col.orderDirection));\r\n      });\r\n    },\r\n  };\r\n  self.columnFilters = {};\r\n  self.filters = {};\r\n  self.frozenRow = 0;\r\n  self.frozenColumn = 0;\r\n  self.ellipsisCache = {};\r\n  self.scrollCache = { x: [], y: [] };\r\n  self.scrollBox = {};\r\n  self.visibleRows = [];\r\n  self.visibleCells = [];\r\n  self.sizes = {\r\n    rows: {},\r\n    columns: {},\r\n    trees: {},\r\n  };\r\n  self.selections = [];\r\n  self.hovers = {};\r\n  self.attributes = {};\r\n  self.style = {};\r\n  self.formatters = {};\r\n  self.sorters = {};\r\n  self.parsers = {};\r\n  self.schemaHashes = {};\r\n  self.events = {};\r\n  self.changes = [];\r\n  self.scrollIndexTop = 0;\r\n  self.scrollPixelTop = 0;\r\n  self.scrollIndexLeft = 0;\r\n  self.scrollPixelLeft = 0;\r\n  self.childGrids = {};\r\n  self.openChildren = {};\r\n  self.scrollModes = [\r\n    'vertical-scroll-box',\r\n    'vertical-scroll-top',\r\n    'vertical-scroll-bottom',\r\n    'horizontal-scroll-box',\r\n    'horizontal-scroll-right',\r\n    'horizontal-scroll-left',\r\n  ];\r\n  self.componentL1Events = {};\r\n  self.eventNames = [\r\n    'afterdraw',\r\n    'afterrendercell',\r\n    'attributechanged',\r\n    'beforebeginedit',\r\n    'beforecreatecellgrid',\r\n    'beforedraw',\r\n    'beforeendedit',\r\n    'beforerendercell',\r\n    'beforerendercellgrid',\r\n    'beginedit',\r\n    'cellmouseout',\r\n    'cellmouseover',\r\n    'click',\r\n    'collapsetree',\r\n    'contextmenu',\r\n    'copy',\r\n    'datachanged',\r\n    'dblclick',\r\n    'endedit',\r\n    'expandtree',\r\n    'formatcellvalue',\r\n    'keydown',\r\n    'keypress',\r\n    'keyup',\r\n    'mousedown',\r\n    'mousemove',\r\n    'mouseup',\r\n    'newrow',\r\n    'ordercolumn',\r\n    'rendercell',\r\n    'rendercellgrid',\r\n    'renderorderbyarrow',\r\n    'rendertext',\r\n    'rendertreearrow',\r\n    'reorder',\r\n    'reordering',\r\n    'resize',\r\n    'resizecolumn',\r\n    'resizerow',\r\n    'schemachanged',\r\n    'scroll',\r\n    'selectionchanged',\r\n    'stylechanged',\r\n    'touchcancel',\r\n    'touchend',\r\n    'touchmove',\r\n    'touchstart',\r\n    'wheel',\r\n  ];\r\n  self.mouse = { x: 0, y: 0 };\r\n  self.getSelectedData = function (expandToRow) {\r\n    const selectedData = [];\r\n    const schema = self.getSchema();\r\n    const viewDataLength = self.viewData.length;\r\n\r\n    if (viewDataLength === 0) {\r\n      return [];\r\n    }\r\n\r\n    // self.selections is a sparse array, so `viewRowIndex` here\r\n    // will equal the row index as where it's rendered,\r\n    // not as where it is in the original data array.\r\n    self.selections.forEach(function (row, viewRowIndex) {\r\n      if (!row) {\r\n        return;\r\n      }\r\n\r\n      if (viewRowIndex === viewDataLength) {\r\n        return;\r\n      }\r\n\r\n      if (row.length === 0) {\r\n        selectedData[viewRowIndex] = null;\r\n        return;\r\n      }\r\n\r\n      selectedData[viewRowIndex] = {};\r\n\r\n      row.forEach(function (col) {\r\n        if (col === -1 || !schema[col]) {\r\n          return;\r\n        }\r\n\r\n        const orderedIndex = self.orders.columns[col];\r\n\r\n        if (!expandToRow && schema[orderedIndex].hidden) {\r\n          return;\r\n        }\r\n\r\n        if (self.viewData[viewRowIndex]) {\r\n          selectedData[viewRowIndex][schema[orderedIndex].name] =\r\n            self.viewData[viewRowIndex][schema[orderedIndex].name];\r\n        }\r\n      });\r\n    });\r\n\r\n    return selectedData;\r\n  };\r\n  self.getBoundRowIndexFromViewRowIndex = function (viewRowIndex) {\r\n    if (self.boundRowIndexMap && self.boundRowIndexMap.has(viewRowIndex)) {\r\n      return self.boundRowIndexMap.get(viewRowIndex);\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n  self.getColumnHeaderCellHeight = function () {\r\n    if (!self.attributes.showColumnHeaders) {\r\n      return 0;\r\n    }\r\n    return (\r\n      (self.sizes.rows[-1] || self.style.columnHeaderCellHeight) * self.scale\r\n    );\r\n  };\r\n  self.getRowHeaderCellWidth = function () {\r\n    if (!self.attributes.showRowHeaders) {\r\n      return 0;\r\n    }\r\n    return (\r\n      (self.sizes.columns[-1] || self.style.rowHeaderCellWidth) * self.scale\r\n    );\r\n  };\r\n  self.setStorageData = function () {\r\n    if (!self.attributes.saveAppearance || !self.attributes.name) {\r\n      return;\r\n    }\r\n    var visibility = {};\r\n    self.getSchema().forEach(function (column) {\r\n      visibility[column.name] = !column.hidden;\r\n    });\r\n    localStorage.setItem(\r\n      self.storageName + '-' + self.attributes.name,\r\n      JSON.stringify({\r\n        sizes: {\r\n          rows: self.sizes.rows,\r\n          columns: self.sizes.columns,\r\n        },\r\n        orders: {\r\n          rows: self.orders.rows,\r\n          columns: self.orders.columns,\r\n        },\r\n        orderBy: self.orderBy,\r\n        orderDirection: self.orderDirection,\r\n        visibility: visibility,\r\n      }),\r\n    );\r\n  };\r\n  self.getSchema = function () {\r\n    return self.schema || self.tempSchema || [];\r\n  };\r\n  function fillArray(low, high) {\r\n    var i = [],\r\n      x;\r\n    for (x = low; x <= high; x += 1) {\r\n      i[x] = x;\r\n    }\r\n    return i;\r\n  }\r\n  self.createColumnOrders = function () {\r\n    var s = self.getSchema();\r\n    self.orders.columns = fillArray(0, s.length - 1);\r\n  };\r\n  self.createRowOrders = function () {\r\n    self.orders.rows = fillArray(0, self.originalData.length - 1);\r\n  };\r\n  self.getVisibleSchema = function () {\r\n    return self.getSchema().filter(function (col) {\r\n      return !col.hidden;\r\n    });\r\n  };\r\n  self.applyDefaultValue = function (row, header, rowIndex) {\r\n    var d = header.defaultValue || '';\r\n    if (typeof d === 'function') {\r\n      d = d.apply(self.intf, [header, rowIndex]);\r\n    }\r\n    row[header.name] = d;\r\n  };\r\n  self.createNewRowData = function () {\r\n    self.newRow = {};\r\n\r\n    // The third argument of applyDefaultValue is the row index\r\n    // of the row for which to apply the default value. In this\r\n    // case, we're creating a new row but not yet appending it\r\n    // to self.originalData, so no row index exists\r\n    const newRowIndex = undefined;\r\n\r\n    self.getSchema().forEach(function forEachHeader(header) {\r\n      self.applyDefaultValue(self.newRow, header, newRowIndex);\r\n    });\r\n  };\r\n  self.getSchemaNameHash = function (key) {\r\n    var n = 0;\r\n    while (self.schemaHashes[key]) {\r\n      n += 1;\r\n      key = key + n;\r\n    }\r\n    return key;\r\n  };\r\n  self.filter = function (type) {\r\n    var f = self.filters[type];\r\n    if (!f && type !== undefined) {\r\n      console.warn(\r\n        'Cannot find filter for type %s, falling back to substring match.',\r\n        type,\r\n      );\r\n      f = self.filters.string;\r\n    }\r\n    return f;\r\n  };\r\n  self.hasActiveFilters = function () {\r\n    return self.columnFilters && Object.keys(self.columnFilters).length > 0;\r\n  };\r\n  self.getFilteredAndSortedViewData = function (originalData) {\r\n    // We make a copy of originalData here in order be able to\r\n    // filter and sort rows without modifying the original array.\r\n    // Each row is turned into a (row, rowIndex) tuple\r\n    // so that when we apply filters, we can refer back to the\r\n    // row's original row number in originalData. This becomes\r\n    // useful when emitting cell events.\r\n    let newViewData = originalData.map((row, originalRowIndex) => [\r\n      row,\r\n      originalRowIndex,\r\n    ]);\r\n\r\n    // Apply filtering\r\n    for (const [headerName, filterText] of Object.entries(self.columnFilters)) {\r\n      const header = self.getHeaderByName(headerName);\r\n\r\n      if (!header) {\r\n        continue;\r\n      }\r\n\r\n      const currentFilterFunction =\r\n        header.filter || self.filter(header.type || 'string');\r\n\r\n      newViewData = newViewData.filter(function ([row]) {\r\n        const cellValue = row[headerName];\r\n        const shouldIncludeRow = currentFilterFunction(cellValue, filterText);\r\n\r\n        return shouldIncludeRow;\r\n      });\r\n    }\r\n\r\n    // Apply sorting\r\n    for (const column of self.orderings.columns) {\r\n      const sortFn = column.sortFunction(column.orderBy, column.orderDirection);\r\n\r\n      newViewData.sort(([rowA], [rowB]) => sortFn(rowA, rowB));\r\n    }\r\n\r\n    return {\r\n      viewData: newViewData.map(([row]) => row),\r\n      boundRowIndexMap: new Map(\r\n        newViewData.map(([_row, originalRowIndex], viewRowIndex) => [\r\n          viewRowIndex,\r\n          originalRowIndex,\r\n        ]),\r\n      ),\r\n    };\r\n  };\r\n  self.refresh = function () {\r\n    const { viewData, boundRowIndexMap } = self.getFilteredAndSortedViewData(\r\n      self.originalData,\r\n    );\r\n\r\n    self.viewData = viewData;\r\n    self.boundRowIndexMap = boundRowIndexMap;\r\n\r\n    self.resize();\r\n    self.draw(true);\r\n  };\r\n  self.getBestGuessDataType = function (columnName, data) {\r\n    var t,\r\n      x,\r\n      l = data.length;\r\n    for (x = 0; x < l; x += 1) {\r\n      if (\r\n        data[x] !== undefined &&\r\n        data[x] !== null &&\r\n        [null, undefined].indexOf(data[x][columnName]) !== -1\r\n      ) {\r\n        t = typeof data[x];\r\n        return t === 'object' ? 'string' : t;\r\n      }\r\n    }\r\n    return 'string';\r\n  };\r\n  self.drawChildGrids = function () {\r\n    Object.keys(self.childGrids).forEach(function (gridKey) {\r\n      self.childGrids[gridKey].draw();\r\n    });\r\n  };\r\n  self.resizeChildGrids = function () {\r\n    Object.keys(self.childGrids).forEach(function (gridKey) {\r\n      self.childGrids[gridKey].resize();\r\n    });\r\n  };\r\n  self.autoScrollZone = function (e, x, y, ctrl) {\r\n    var setTimer,\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight();\r\n    if (y !== -1) {\r\n      if (\r\n        x > self.width - self.attributes.selectionScrollZone &&\r\n        x < self.width\r\n      ) {\r\n        self.scrollBox.scrollLeft += self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n      if (x - self.attributes.selectionScrollZone - rowHeaderCellWidth < 0) {\r\n        self.scrollBox.scrollLeft -= self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n    }\r\n    if (y !== -1) {\r\n      if (\r\n        y > self.height - self.attributes.selectionScrollZone &&\r\n        y < self.height\r\n      ) {\r\n        self.scrollBox.scrollTop += self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n      if (\r\n        y - self.attributes.selectionScrollZone - columnHeaderCellHeight <\r\n        0\r\n      ) {\r\n        self.scrollBox.scrollTop -= self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n    }\r\n    if (\r\n      setTimer &&\r\n      !ctrl &&\r\n      self.currentCell &&\r\n      self.currentCell.columnIndex !== -1\r\n    ) {\r\n      self.scrollTimer = setTimeout(\r\n        self.mousemove,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n  };\r\n  self.validateColumn = function (c, s) {\r\n    if (!c.name) {\r\n      throw new Error('A column must contain at least a name.');\r\n    }\r\n    if (\r\n      s.filter(function (i) {\r\n        return i.name === c.name;\r\n      }).length > 0\r\n    ) {\r\n      throw new Error(\r\n        'A column with the name ' +\r\n          c.name +\r\n          ' already exists and cannot be added again.',\r\n      );\r\n    }\r\n    return true;\r\n  };\r\n  self.setDefaults = function (obj1, obj2, key, def) {\r\n    obj1[key] = obj2[key] === undefined ? def : obj2[key];\r\n  };\r\n  self.setAttributes = function () {\r\n    self.defaults.attributes.forEach(function eachAttribute(i) {\r\n      self.setDefaults(self.attributes, self.args, i[0], i[1]);\r\n    });\r\n  };\r\n  self.setStyle = function () {\r\n    self.defaults.styles.forEach(function eachStyle(i) {\r\n      self.setDefaults(self.style, self.args.style || {}, i[0], i[1]);\r\n    });\r\n  };\r\n  self.autosize = function (colName) {\r\n    self.getVisibleSchema().forEach(function (col, colIndex) {\r\n      if (col.name === colName || colName === undefined) {\r\n        self.sizes.columns[colIndex] = Math.max(\r\n          self.findColumnMaxTextLength(col.name),\r\n          self.style.minColumnWidth,\r\n        );\r\n      }\r\n    });\r\n    self.sizes.columns[-1] = self.findColumnMaxTextLength('cornerCell');\r\n  };\r\n  self.dispose = function () {\r\n    if (!self.isChildGrid && self.canvas && self.canvas.parentNode) {\r\n      self.canvas.parentNode.removeChild(self.canvas);\r\n    }\r\n    if (!self.isChildGrid) {\r\n      document.body.removeChild(self.controlInput);\r\n    }\r\n    self.eventParent.removeEventListener('mouseup', self.mouseup, false);\r\n    self.eventParent.removeEventListener('mousedown', self.mousedown, false);\r\n    self.eventParent.removeEventListener('dblclick', self.dblclick, false);\r\n    self.eventParent.removeEventListener('click', self.click, false);\r\n    self.eventParent.removeEventListener('mousemove', self.mousemove);\r\n    self.eventParent.removeEventListener('wheel', self.scrollWheel, false);\r\n    self.canvas.removeEventListener('contextmenu', self.contextmenu, false);\r\n    self.canvas.removeEventListener('copy', self.copy);\r\n    self.controlInput.removeEventListener('copy', self.copy);\r\n    self.controlInput.removeEventListener('cut', self.cut);\r\n    self.controlInput.removeEventListener('paste', self.paste);\r\n    self.controlInput.removeEventListener('keypress', self.keypress, false);\r\n    self.controlInput.removeEventListener('keyup', self.keyup, false);\r\n    self.controlInput.removeEventListener('keydown', self.keydown, false);\r\n    window.removeEventListener('resize', self.resize);\r\n    if (self.observer && self.observer.disconnect) {\r\n      self.observer.disconnect();\r\n    }\r\n  };\r\n  self.tryLoadStoredSettings = function () {\r\n    var s;\r\n    self.reloadStoredValues();\r\n    if (\r\n      self.storedSettings &&\r\n      typeof self.storedSettings.orders === 'object' &&\r\n      self.storedSettings.orders !== null\r\n    ) {\r\n      if (\r\n        self.storedSettings.orders.rows.length >= (self.viewData || []).length\r\n      ) {\r\n        self.orders.rows = self.storedSettings.orders.rows;\r\n      }\r\n      s = self.getSchema();\r\n      if (self.storedSettings.orders.columns.length === s.length) {\r\n        self.orders.columns = self.storedSettings.orders.columns;\r\n      }\r\n      self.orderBy =\r\n        self.storedSettings.orderBy === undefined\r\n          ? s[0].name\r\n          : self.storedSettings.orderBy;\r\n      self.orderDirection =\r\n        self.storedSettings.orderDirection === undefined\r\n          ? 'asc'\r\n          : self.storedSettings.orderDirection;\r\n      if (\r\n        self.storedSettings.orderBy !== undefined &&\r\n        self.getHeaderByName(self.orderBy) &&\r\n        self.orderDirection\r\n      ) {\r\n        self.order(self.orderBy, self.orderDirection);\r\n      }\r\n    }\r\n  };\r\n  self.getDomRoot = function () {\r\n    return self.shadowRoot ? self.shadowRoot.host : self.parentNode;\r\n  };\r\n  self.getFontName = function (fontStyle) {\r\n    return fontStyle.replace(/\\d+\\.?\\d*px/, '');\r\n  };\r\n  self.getFontHeight = function (fontStyle) {\r\n    return parseFloat(fontStyle, 10);\r\n  };\r\n  self.parseStyleValue = function (key) {\r\n    if (/Font/.test(key)) {\r\n      self.style[key + 'Height'] = self.getFontHeight(self.style[key]);\r\n      self.style[key + 'Name'] = self.getFontName(self.style[key]);\r\n      return;\r\n    }\r\n    // when inheriting styles from already instantiated grids, don't parse already parsed values.\r\n    if (\r\n      key === 'moveOverlayBorderSegments' &&\r\n      typeof self.style[key] === 'string'\r\n    ) {\r\n      self.style[key] = self.style[key].split(',').map(function (i) {\r\n        return parseInt(i, 10);\r\n      });\r\n    }\r\n  };\r\n  self.initProp = function (propName) {\r\n    if (!self.args[propName]) {\r\n      return;\r\n    }\r\n    Object.keys(self.args[propName]).forEach(function (key) {\r\n      self[propName][key] = self.args[propName][key];\r\n    });\r\n  };\r\n  self.getStyleProperty = function (key) {\r\n    if (self.styleKeys.indexOf(key) === -1) {\r\n      return self.parentNodeStyle[key];\r\n    }\r\n    return self.style[key];\r\n  };\r\n  self.setStyleProperty = function (key, value, supressDrawAndEvent) {\r\n    var isDim =\r\n      [\r\n        'height',\r\n        'width',\r\n        'minHeight',\r\n        'minWidth',\r\n        'maxHeight',\r\n        'maxWidth',\r\n      ].indexOf(key) !== -1;\r\n    if (self.styleKeys.indexOf(key) === -1) {\r\n      self.parentNodeStyle[key] = value;\r\n    } else {\r\n      if (/-/.test(key)) {\r\n        key = self.dehyphenateProperty(key);\r\n      }\r\n      self.style[key] = value;\r\n      self.parseStyleValue(key);\r\n    }\r\n    if (isDim) {\r\n      self.resize();\r\n    }\r\n    if (!supressDrawAndEvent) {\r\n      self.draw(true);\r\n      self.dispatchEvent('stylechanged', { name: 'style', value: value });\r\n    }\r\n  };\r\n  self.reloadStoredValues = function () {\r\n    if (self.attributes.name && self.attributes.saveAppearance) {\r\n      try {\r\n        self.storedSettings = localStorage.getItem(\r\n          self.storageName + '-' + self.attributes.name,\r\n        );\r\n      } catch (e) {\r\n        console.warn('Error loading stored values. ' + e.message);\r\n        self.storedSettings = undefined;\r\n      }\r\n      if (self.storedSettings) {\r\n        try {\r\n          self.storedSettings = JSON.parse(self.storedSettings);\r\n        } catch (e) {\r\n          console.warn('could not read settings from localStore', e);\r\n          self.storedSettings = undefined;\r\n        }\r\n      }\r\n      if (self.storedSettings) {\r\n        if (\r\n          typeof self.storedSettings.sizes === 'object' &&\r\n          self.storedSettings.sizes !== null\r\n        ) {\r\n          self.sizes.rows = self.storedSettings.sizes.rows;\r\n          self.sizes.columns = self.storedSettings.sizes.columns;\r\n          ['trees', 'columns', 'rows'].forEach(function (i) {\r\n            if (!self.sizes[i]) {\r\n              self.sizes[i] = {};\r\n            }\r\n          });\r\n        }\r\n        if (typeof self.storedSettings.visibility === 'object') {\r\n          self.getSchema().forEach(function (column) {\r\n            if (\r\n              self.storedSettings.visibility &&\r\n              self.storedSettings.visibility[column.name] !== undefined\r\n            ) {\r\n              column.hidden = !self.storedSettings.visibility[column.name];\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n  self.init = function () {\r\n    if (self.initialized) {\r\n      return;\r\n    }\r\n    function addStyleKeyIfNoneExists(key) {\r\n      if (self.styleKeys.indexOf(key) === -1) {\r\n        self.styleKeys.push(key);\r\n      }\r\n    }\r\n    var publicStyleKeyIntf = {};\r\n    self.setAttributes();\r\n    self.setStyle();\r\n    self.initScrollBox();\r\n    self.setDom();\r\n    self.nodeType = 'canvas-datagrid';\r\n    self.ie = /Trident/.test(window.navigator.userAgent);\r\n    self.edge = /Edge/.test(window.navigator.userAgent);\r\n    self.webKit = /WebKit/.test(window.navigator.userAgent);\r\n    self.moz = /Gecko/.test(window.navigator.userAgent);\r\n    self.mobile = /Mobile/i.test(window.navigator.userAgent);\r\n    self.blankValues = [undefined, null, ''];\r\n    self.cursorGrab = 'grab';\r\n    self.cursorGrabing = 'grabbing';\r\n    self.cursorGrab = self.webKit ? '-webkit-grab' : self.cursorGrab;\r\n    self.cursorGrabing = self.moz ? '-webkit-grabbing' : self.cursorGrabbing;\r\n    self.pointerLockPosition = { x: 0, y: 0 };\r\n    Object.keys(self.style).forEach(self.parseStyleValue);\r\n    self.intf.moveSelection = self.moveSelection;\r\n    self.intf.moveTo = self.moveTo;\r\n    self.intf.addEventListener = self.addEventListener;\r\n    self.intf.removeEventListener = self.removeEventListener;\r\n    self.intf.dispatchEvent = self.dispatchEvent;\r\n    /**\r\n     * Releases grid resources and removes grid elements.\r\n     * @memberof canvasDatagrid\r\n     * @name dispose\r\n     * @method\r\n     */\r\n    self.intf.dispose = self.dispose;\r\n    /**\r\n     * Appends the grid to another element later.  Not implemented.\r\n     * @memberof canvasDatagrid\r\n     * @name appendTo\r\n     * @method\r\n     * @param {number} el The element to append the grid to.\r\n     */\r\n    self.intf.appendTo = self.appendTo;\r\n    self.intf.getVisibleCellByIndex = self.getVisibleCellByIndex;\r\n    self.intf.filters = self.filters;\r\n    self.intf.sorters = self.sorters;\r\n    self.intf.autosize = self.autosize;\r\n    self.intf.beginEditAt = self.beginEditAt;\r\n    self.intf.endEdit = self.endEdit;\r\n    self.intf.setActiveCell = self.setActiveCell;\r\n    self.intf.forEachSelectedCell = self.forEachSelectedCell;\r\n    self.intf.scrollIntoView = self.scrollIntoView;\r\n    self.intf.clearChangeLog = self.clearChangeLog;\r\n    self.intf.gotoCell = self.gotoCell;\r\n    self.intf.gotoRow = self.gotoRow;\r\n    self.intf.getHeaderByName = self.getHeaderByName;\r\n    self.intf.findColumnScrollLeft = self.findColumnScrollLeft;\r\n    self.intf.findRowScrollTop = self.findRowScrollTop;\r\n    self.intf.fitColumnToValues = self.fitColumnToValues;\r\n    self.intf.findColumnMaxTextLength = self.findColumnMaxTextLength;\r\n    self.intf.disposeContextMenu = self.disposeContextMenu;\r\n    self.intf.getCellAt = self.getCellAt;\r\n    self.intf.isCellVisible = self.isCellVisible;\r\n    self.intf.isRowVisible = self.isRowVisible;\r\n    self.intf.isColumnVisible = self.isColumnVisible;\r\n    self.intf.order = self.order;\r\n    self.intf.draw = self.draw;\r\n    self.intf.refresh = self.refresh;\r\n    self.intf.isComponent = self.isComponent;\r\n    self.intf.selectArea = self.selectArea;\r\n    self.intf.clipElement = self.clipElement;\r\n    self.intf.getSchemaFromData = self.getSchemaFromData;\r\n    self.intf.setFilter = self.setFilter;\r\n    self.intf.selectRow = self.selectRow;\r\n    self.intf.parentGrid = self.parentGrid;\r\n    self.intf.toggleTree = self.toggleTree;\r\n    self.intf.expandTree = self.expandTree;\r\n    self.intf.collapseTree = self.collapseTree;\r\n    self.intf.canvas = self.canvas;\r\n    self.intf.context = self.ctx;\r\n    self.intf.insertRow = self.insertRow;\r\n    self.intf.deleteRow = self.deleteRow;\r\n    self.intf.addRow = self.addRow;\r\n    self.intf.insertColumn = self.insertColumn;\r\n    self.intf.deleteColumn = self.deleteColumn;\r\n    self.intf.addColumn = self.addColumn;\r\n    self.intf.getClippingRect = self.getClippingRect;\r\n    self.intf.setRowHeight = self.setRowHeight;\r\n    self.intf.setColumnWidth = self.setColumnWidth;\r\n    self.intf.resetColumnWidths = self.resetColumnWidths;\r\n    self.intf.resetRowHeights = self.resetRowHeights;\r\n    self.intf.resize = self.resize;\r\n    self.intf.selectColumn = self.selectColumn;\r\n    self.intf.selectRow = self.selectRow;\r\n    self.intf.selectAll = self.selectAll;\r\n    self.intf.selectNone = self.selectNone;\r\n    self.intf.drawChildGrids = self.drawChildGrids;\r\n    self.intf.assertPxColor = self.assertPxColor;\r\n    self.intf.clearPxColorAssertions = self.clearPxColorAssertions;\r\n    self.intf.integerToAlpha = self.integerToAlpha;\r\n    self.intf.copy = self.copy;\r\n    self.intf.paste = self.paste;\r\n    self.intf.setStyleProperty = self.setStyleProperty;\r\n    Object.defineProperty(self.intf, 'defaults', {\r\n      get: function () {\r\n        return {\r\n          styles: self.defaults.styles.reduce(function (a, i) {\r\n            a[i[0]] = i[1];\r\n            return a;\r\n          }, {}),\r\n          attributes: self.defaults.attributes.reduce(function (a, i) {\r\n            a[i[0]] = i[1];\r\n            return a;\r\n          }, {}),\r\n        };\r\n      },\r\n    });\r\n    self.styleKeys = Object.keys(self.intf.defaults.styles);\r\n    self.styleKeys\r\n      .map(function (i) {\r\n        return self.hyphenateProperty(i, false);\r\n      })\r\n      .forEach(addStyleKeyIfNoneExists);\r\n    self.styleKeys\r\n      .map(function (i) {\r\n        return self.hyphenateProperty(i, true);\r\n      })\r\n      .forEach(addStyleKeyIfNoneExists);\r\n    self.DOMStyles = window.getComputedStyle(document.body, null);\r\n    self.styleKeys.concat(Object.keys(self.DOMStyles)).forEach(function (key) {\r\n      // unless this line is here, Object.keys() will not work on <instance>.style\r\n      publicStyleKeyIntf[key] = undefined;\r\n      Object.defineProperty(publicStyleKeyIntf, key, {\r\n        get: function () {\r\n          return self.getStyleProperty(key);\r\n        },\r\n        set: function (value) {\r\n          if (self.initialized) {\r\n            self.appliedInlineStyles[key] = value;\r\n          }\r\n          self.setStyleProperty(key, value);\r\n        },\r\n      });\r\n    });\r\n    Object.defineProperty(self.intf, 'shadowRoot', {\r\n      get: function () {\r\n        return self.shadowRoot;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'activeCell', {\r\n      get: function () {\r\n        return self.activeCell;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'hasFocus', {\r\n      get: function () {\r\n        return self.hasFocus;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'hasActiveFilters', {\r\n      get: function () {\r\n        return self.hasActiveFilters();\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'style', {\r\n      get: function () {\r\n        return publicStyleKeyIntf;\r\n      },\r\n      set: function (valueObject) {\r\n        Object.keys(valueObject).forEach(function (key) {\r\n          self.setStyleProperty(key, valueObject[key], true);\r\n        });\r\n        self.draw(true);\r\n        self.dispatchEvent('stylechanged', {\r\n          name: 'style',\r\n          value: valueObject,\r\n        });\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'attributes', { value: {} });\r\n    Object.keys(self.attributes).forEach(function (key) {\r\n      Object.defineProperty(self.intf.attributes, key, {\r\n        get: function () {\r\n          return self.attributes[key];\r\n        },\r\n        set: function (value) {\r\n          self.attributes[key] = value;\r\n          if (key === 'name') {\r\n            self.tryLoadStoredSettings();\r\n          }\r\n          self.draw(true);\r\n          self.dispatchEvent('attributechanged', {\r\n            name: key,\r\n            value: value[key],\r\n          });\r\n        },\r\n      });\r\n    });\r\n    self.filters.string = function (value, filterFor) {\r\n      if (filterFor === self.attributes.blanksText) {\r\n        return self.blankValues.includes(\r\n          value == null ? value : String(value).trim(),\r\n        );\r\n      }\r\n\r\n      value = String(value);\r\n      var filterRegExp,\r\n        regEnd = /\\/(i|g|m)*$/,\r\n        pattern = regEnd.exec(filterFor),\r\n        flags = pattern ? pattern[0].substring(1) : '',\r\n        flagLength = flags.length;\r\n      self.invalidFilterRegEx = undefined;\r\n      if (filterFor.substring(0, 1) === '/' && pattern) {\r\n        try {\r\n          filterRegExp = new RegExp(\r\n            filterFor.substring(1, filterFor.length - (flagLength + 1)),\r\n            flags,\r\n          );\r\n        } catch (e) {\r\n          self.invalidFilterRegEx = e;\r\n          return;\r\n        }\r\n        return filterRegExp.test(value);\r\n      }\r\n      return value.toString\r\n        ? value\r\n            .toString()\r\n            .toLocaleUpperCase()\r\n            .indexOf(filterFor.toLocaleUpperCase()) !== -1\r\n        : false;\r\n    };\r\n    self.filters.number = function (value, filterFor) {\r\n      if (filterFor === self.attributes.blanksText) {\r\n        return self.blankValues.includes(\r\n          value == null ? value : String(value).trim(),\r\n        );\r\n      }\r\n\r\n      if (!filterFor) {\r\n        return true;\r\n      }\r\n      return value === filterFor;\r\n    };\r\n    ['formatters', 'filters', 'sorters'].forEach(self.initProp);\r\n    self.applyComponentStyle(false, self.intf);\r\n    self.reloadStoredValues();\r\n    if (self.args.data) {\r\n      self.intf.data = self.args.data;\r\n    }\r\n    if (self.intf.innerText || self.intf.textContent) {\r\n      if (self.intf.dataType === 'application/x-canvas-datagrid') {\r\n        self.intf.dataType = 'application/json+x-canvas-datagrid';\r\n      }\r\n      self.intf.data = self.intf.innerText || self.intf.textContent;\r\n    }\r\n    if (self.args.schema) {\r\n      self.intf.schema = self.args.schema;\r\n    }\r\n    if (self.isChildGrid || !self.isComponent) {\r\n      requestAnimationFrame(function () {\r\n        self.resize(true);\r\n      });\r\n    } else {\r\n      self.resize(true);\r\n    }\r\n    self.initialized = true;\r\n    return self;\r\n  };\r\n  /**\r\n   * Removes focus from the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name blur\r\n   * @method\r\n   */\r\n  self.intf.blur = function (e) {\r\n    self.hasFocus = false;\r\n  };\r\n  /**\r\n   * Focuses on the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name focus\r\n   * @method\r\n   */\r\n  self.intf.focus = function () {\r\n    self.hasFocus = true;\r\n    self.controlInput.focus();\r\n  };\r\n  if (self.shadowRoot || self.isChildGrid) {\r\n    Object.defineProperty(self.intf, 'height', {\r\n      get: function () {\r\n        if (self.shadowRoot) {\r\n          return self.shadowRoot.height;\r\n        }\r\n        return self.parentNode.height;\r\n      },\r\n      set: function (value) {\r\n        if (self.shadowRoot) {\r\n          self.shadowRoot.height = value;\r\n        } else {\r\n          self.parentNode.height = value;\r\n        }\r\n        self.resize(true);\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'width', {\r\n      get: function () {\r\n        if (self.shadowRoot) {\r\n          return self.shadowRoot.width;\r\n        }\r\n        return self.parentNode.width;\r\n      },\r\n      set: function (value) {\r\n        if (self.shadowRoot) {\r\n          self.shadowRoot.width = value;\r\n        } else {\r\n          self.parentNode.width = value;\r\n        }\r\n        self.resize(true);\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'parentNode', {\r\n      get: function () {\r\n        return self.parentNode;\r\n      },\r\n      set: function (value) {\r\n        if (!self.isChildGrid) {\r\n          throw new TypeError(\r\n            'Cannot set property parentNode which has only a getter',\r\n          );\r\n        }\r\n        self.parentNode = value;\r\n      },\r\n    });\r\n  }\r\n  Object.defineProperty(self.intf, 'visibleRowHeights', {\r\n    get: function () {\r\n      return self.visibleRowHeights;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'openChildren', {\r\n    get: function () {\r\n      return self.openChildren;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'childGrids', {\r\n    get: function () {\r\n      return Object.keys(self.childGrids).map(function (gridId) {\r\n        return self.childGrids[gridId];\r\n      });\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'isChildGrid', {\r\n    get: function () {\r\n      return self.isChildGrid;\r\n    },\r\n  });\r\n  Object.defineProperty(self, 'cursor', {\r\n    get: function () {\r\n      return self.parentNodeStyle.cursor;\r\n    },\r\n    set: function (value) {\r\n      if (value === 'cell') {\r\n        value = 'default';\r\n      }\r\n      if (self.currentCursor !== value) {\r\n        self.parentNodeStyle.cursor = value;\r\n        self.currentCursor = value;\r\n      }\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'orderDirection', {\r\n    get: function () {\r\n      return self.orderDirection;\r\n    },\r\n    set: function (value) {\r\n      if (value !== 'desc') {\r\n        value = 'asc';\r\n      }\r\n      self.orderDirection = value;\r\n      self.order(self.orderBy, self.orderDirection);\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'orderBy', {\r\n    get: function () {\r\n      return self.orderBy;\r\n    },\r\n    set: function (value) {\r\n      if (\r\n        self.getSchema().find(function (col) {\r\n          return col.name === value;\r\n        }) === undefined\r\n      ) {\r\n        throw new Error('Cannot sort by unknown column name.');\r\n      }\r\n      self.orderBy = value;\r\n      self.order(self.orderBy, self.orderDirection);\r\n    },\r\n  });\r\n  if (self.isComponent) {\r\n    Object.defineProperty(self.intf, 'offsetHeight', {\r\n      get: function () {\r\n        return self.canvas.offsetHeight;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'offsetWidth', {\r\n      get: function () {\r\n        return self.canvas.offsetWidth;\r\n      },\r\n    });\r\n  }\r\n  Object.defineProperty(self.intf, 'scrollHeight', {\r\n    get: function () {\r\n      return self.scrollBox.scrollHeight;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollWidth', {\r\n    get: function () {\r\n      return self.scrollBox.scrollWidth;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollTop', {\r\n    get: function () {\r\n      return self.scrollBox.scrollTop;\r\n    },\r\n    set: function (value) {\r\n      self.scrollBox.scrollTop = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollLeft', {\r\n    get: function () {\r\n      return self.scrollBox.scrollLeft;\r\n    },\r\n    set: function (value) {\r\n      self.scrollBox.scrollLeft = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'sizes', {\r\n    get: function () {\r\n      return self.sizes;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'parentDOMNode', {\r\n    get: function () {\r\n      return self.parentDOMNode;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'input', {\r\n    get: function () {\r\n      return self.input;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'controlInput', {\r\n    get: function () {\r\n      return self.controlInput;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'currentCell', {\r\n    get: function () {\r\n      return self.currentCell;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleCells', {\r\n    get: function () {\r\n      return self.visibleCells;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleRows', {\r\n    get: function () {\r\n      return self.visibleRows;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selections', {\r\n    get: function () {\r\n      return self.selections;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'dragMode', {\r\n    get: function () {\r\n      return self.dragMode;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'changes', {\r\n    get: function () {\r\n      return self.changes;\r\n    },\r\n  });\r\n  self.intf.formatters = self.formatters;\r\n  Object.defineProperty(self.intf, 'dataType', {\r\n    get: function () {\r\n      return self.dataType;\r\n    },\r\n    set: function (value) {\r\n      if (!self.parsers[value]) {\r\n        throw new Error('No parser for MIME type ' + value);\r\n      }\r\n      self.dataType = value;\r\n    },\r\n  });\r\n  self.eventNames.forEach(function (eventName) {\r\n    Object.defineProperty(self.intf, 'on' + eventName, {\r\n      get: function () {\r\n        return self.componentL1Events[eventName];\r\n      },\r\n      set: function (value) {\r\n        self.events[eventName] = [];\r\n        self.componentL1Events[eventName] = value;\r\n        if (!value) {\r\n          return;\r\n        }\r\n        self.addEventListener(eventName, value);\r\n      },\r\n    });\r\n  });\r\n  Object.defineProperty(self.intf, 'frozenRow', {\r\n    get: function () {\r\n      return self.frozenRow;\r\n    },\r\n    set: function (val) {\r\n      if (isNaN(val)) {\r\n        throw new TypeError('Expected value for frozenRow to be a number.');\r\n      }\r\n      if (self.visibleRows.length < val) {\r\n        throw new RangeError(\r\n          'Cannot set a value larger than the number of visible rows.',\r\n        );\r\n      }\r\n      self.frozenRow = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'frozenColumn', {\r\n    get: function () {\r\n      return self.frozenColumn;\r\n    },\r\n    set: function (val) {\r\n      if (isNaN(val)) {\r\n        throw new TypeError('Expected value for frozenRow to be a number.');\r\n      }\r\n      if (self.getVisibleSchema().length < val) {\r\n        throw new RangeError(\r\n          'Cannot set a value larger than the number of visible columns.',\r\n        );\r\n      }\r\n      self.frozenColumn = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollIndexRect', {\r\n    get: function () {\r\n      return {\r\n        top: self.scrollIndexTop,\r\n        right: self.scrollIndexRight,\r\n        bottom: self.scrollIndexBottom,\r\n        left: self.scrollIndexLeft,\r\n      };\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollPixelRect', {\r\n    get: function () {\r\n      return {\r\n        top: self.scrollPixelTop,\r\n        right: self.scrollPixelRight,\r\n        bottom: self.scrollPixelBottom,\r\n        left: self.scrollPixelLeft,\r\n      };\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'rowOrder', {\r\n    get: function () {\r\n      return self.orders.rows;\r\n    },\r\n    set: function (val) {\r\n      if (!Array.isArray(val)) {\r\n        throw new TypeError('Value must be an array.');\r\n      }\r\n      if (!self.originalData || val.length < self.originalData.length) {\r\n        throw new RangeError(\r\n          'Array length must be equal to or greater than number of rows.',\r\n        );\r\n      }\r\n      self.orders.rows = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'columnOrder', {\r\n    get: function () {\r\n      return self.orders.columns;\r\n    },\r\n    set: function (val) {\r\n      if (!Array.isArray(val)) {\r\n        throw new TypeError('Value must be an array.');\r\n      }\r\n      if (val.length < self.getSchema().length) {\r\n        throw new RangeError(\r\n          'Array length must be equal to or greater than number of columns.',\r\n        );\r\n      }\r\n      self.orders.columns = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectionBounds', {\r\n    get: function () {\r\n      return self.getSelectionBounds();\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectedRows', {\r\n    get: function () {\r\n      return self.getSelectedData(true);\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectedCells', {\r\n    get: function () {\r\n      return self.getSelectedData();\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleSchema', {\r\n    get: function () {\r\n      return self.getVisibleSchema().map(function eachDataRow(col) {\r\n        return col;\r\n      });\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'treeGridAttributes', {\r\n    get: function () {\r\n      return self.treeGridAttributes;\r\n    },\r\n    set: function setTreeGridAttributes(value) {\r\n      self.treeGridAttributes = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'cellGridAttributes', {\r\n    get: function () {\r\n      return self.cellGridAttributes;\r\n    },\r\n    set: function setCellGridAttributes(value) {\r\n      self.cellGridAttributes = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'ctx', {\r\n    get: function () {\r\n      return self.ctx;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'schema', {\r\n    get: function schemaGetter() {\r\n      return self.getSchema();\r\n    },\r\n    set: function schemaSetter(value) {\r\n      if (value === undefined) {\r\n        // Issue #89 - allow schema to be set to initialized state\r\n        self.schema = undefined;\r\n        self.tempSchema = undefined;\r\n        self.dispatchEvent('schemachanged', { schema: undefined });\r\n        return;\r\n      }\r\n      if (!Array.isArray(value) || typeof value[0] !== 'object') {\r\n        throw new Error('Schema must be an array of objects.');\r\n      }\r\n      if (value[0].name === undefined) {\r\n        throw new Error(\r\n          'Expected schema to contain an object with at least a name property.',\r\n        );\r\n      }\r\n      self.schema = value.map(function eachSchemaColumn(column, index) {\r\n        column.width = column.width || self.style.cellWidth;\r\n        column.filter = column.filter || self.filter(column.type);\r\n        column.type = column.type || 'string';\r\n        column.index = index;\r\n        column.columnIndex = index;\r\n        column.rowIndex = -1;\r\n        return column;\r\n      });\r\n      self.tempSchema = undefined;\r\n      self.createNewRowData();\r\n      self.createColumnOrders();\r\n      self.tryLoadStoredSettings();\r\n      if (\r\n        self.storedSettings &&\r\n        typeof self.storedSettings.visibility === 'object'\r\n      ) {\r\n        self.schema.forEach(function hideEachSchemaColumn(column, index) {\r\n          if (\r\n            self.storedSettings &&\r\n            self.storedSettings.visibility[column.name] !== undefined\r\n          ) {\r\n            column.hidden = !self.storedSettings.visibility[column.name];\r\n          }\r\n        });\r\n      }\r\n      self.resize(true);\r\n      self.dispatchEvent('schemachanged', { schema: self.schema });\r\n    },\r\n  });\r\n  /**\r\n   * Gets an array of currently registered MIME types.\r\n   * @memberof canvasDatagrid\r\n   * @name getDataTypes\r\n   * @method\r\n   */\r\n  self.intf.getTypes = function () {\r\n    return Object.keys(self.parsers);\r\n  };\r\n  self.parseInnerHtml = function (data) {\r\n    if (!data || /^ +$/.test(data)) {\r\n      return [];\r\n    }\r\n    try {\r\n      data = JSON.parse(data);\r\n    } catch (e) {\r\n      console.warn(\r\n        Error(\r\n          'Cannot parse application/json+x-canvas-datagrid formated data. ' +\r\n            e.message +\r\n            '  \\nNote: canvas-datagrid.innerHTML is for string data only.  ' +\r\n            'Use the canvas-datagrid.data property to set object data.',\r\n        ),\r\n      );\r\n    }\r\n    return data;\r\n  };\r\n  self.parsers['application/json+x-canvas-datagrid'] = function (\r\n    data,\r\n    callback,\r\n  ) {\r\n    self.parsers['application/x-canvas-datagrid'](\r\n      self.parseInnerHtml(data),\r\n      function (data, schema) {\r\n        return callback(data, schema);\r\n      },\r\n    );\r\n  };\r\n  self.parsers['application/x-canvas-datagrid'] = function (data, callback) {\r\n    return callback(data);\r\n  };\r\n  self.intf.parsers = self.parsers;\r\n  // send to dataType ETL function to extract from input data\r\n  // and transform into native [{}, {}] format\r\n  self.etl = function (data, callback) {\r\n    if (!self.intf.parsers[self.dataType]) {\r\n      throw new Error('Unsupported data type.');\r\n    }\r\n    self.intf.parsers[self.dataType](data, function (data, schema) {\r\n      // set the unfiltered/sorted data array\r\n      self.originalData = data;\r\n      self.viewData = Array.from(self.originalData);\r\n\r\n      if (Array.isArray(schema)) {\r\n        self.schema = schema;\r\n      }\r\n      // Issue #89 - allow schema to be auto-created every time data is set\r\n      if (self.attributes.autoGenerateSchema) {\r\n        self.schema = self.getSchemaFromData(data);\r\n      }\r\n      if (!self.schema) {\r\n        self.tempSchema = self.getSchemaFromData(data);\r\n      }\r\n      if (self.getSchema()) {\r\n        self.createColumnOrders();\r\n      }\r\n      // apply filter, sort, etc to incoming dataset, set viewData:\r\n      self.refresh();\r\n      // empty data was set\r\n      if (!self.schema && (self.originalData || []).length === 0) {\r\n        self.tempSchema = [{ name: '' }];\r\n      }\r\n      self.fitColumnToValues('cornerCell', true);\r\n      if (\r\n        (self.tempSchema && !self.schema) ||\r\n        self.attributes.autoGenerateSchema\r\n      ) {\r\n        self.createColumnOrders();\r\n        self.dispatchEvent('schemachanged', { schema: self.tempSchema });\r\n      }\r\n      callback();\r\n    });\r\n  };\r\n  Object.defineProperty(self.intf, 'viewData', {\r\n    get: function () {\r\n      return self.viewData;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'boundData', {\r\n    get: function () {\r\n      return self.originalData;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'data', {\r\n    get: function dataGetter() {\r\n      return self.originalData;\r\n    },\r\n    set: function dataSetter(value) {\r\n      self.etl(value, function () {\r\n        self.changes = [];\r\n        self.createNewRowData();\r\n        if (\r\n          self.attributes.autoResizeColumns &&\r\n          self.originalData.length > 0 &&\r\n          self.storedSettings === undefined\r\n        ) {\r\n          self.autosize();\r\n        }\r\n        // set the header column to fit the numbers in it\r\n        self.fitColumnToValues('cornerCell', true);\r\n        self.createRowOrders();\r\n        self.tryLoadStoredSettings();\r\n        self.dispatchEvent('datachanged', { data: self.originalData });\r\n        self.resize(true);\r\n      });\r\n    },\r\n  });\r\n  self.initScrollBox = function () {\r\n    var sHeight = 0,\r\n      sWidth = 0,\r\n      scrollTop = 0,\r\n      scrollLeft = 0,\r\n      scrollHeight = 0,\r\n      scrollWidth = 0,\r\n      scrollBoxHeight = 20,\r\n      scrollBoxWidth = 20;\r\n    function setScrollTop(value, preventScrollEvent) {\r\n      if (isNaN(value)) {\r\n        throw new Error('ScrollTop value must be a number');\r\n      }\r\n      if (value < 0) {\r\n        value = 0;\r\n      }\r\n      if (value > scrollHeight) {\r\n        value = scrollHeight;\r\n      }\r\n      if (scrollHeight < 0) {\r\n        value = 0;\r\n      }\r\n      scrollTop = value;\r\n      if (!preventScrollEvent) {\r\n        self.scroll();\r\n      }\r\n    }\r\n    function setScrollLeft(value, preventScrollEvent) {\r\n      if (isNaN(value)) {\r\n        throw new Error('ScrollLeft value must be a number');\r\n      }\r\n      if (value < 0) {\r\n        value = 0;\r\n      }\r\n      if (value > scrollWidth) {\r\n        value = scrollWidth;\r\n      }\r\n      if (scrollWidth < 0) {\r\n        value = 0;\r\n      }\r\n      scrollLeft = value;\r\n      if (!preventScrollEvent) {\r\n        self.scroll();\r\n      }\r\n    }\r\n    self.scrollBox.toString = function () {\r\n      return (\r\n        '{\"width\": ' +\r\n        scrollWidth.toFixed(2) +\r\n        ', \"height\": ' +\r\n        scrollHeight.toFixed(2) +\r\n        ', \"left\": ' +\r\n        scrollLeft.toFixed(2) +\r\n        ', \"top\": ' +\r\n        scrollTop.toFixed(2) +\r\n        ', \"widthRatio\": ' +\r\n        self.scrollBox.widthBoxRatio.toFixed(5) +\r\n        ', \"heightRatio\": ' +\r\n        self.scrollBox.heightBoxRatio.toFixed(5) +\r\n        '}'\r\n      );\r\n    };\r\n    self.scrollBox.scrollTo = function (x, y, supressDrawEvent) {\r\n      setScrollLeft(x, true);\r\n      setScrollTop(y, supressDrawEvent);\r\n    };\r\n    Object.defineProperty(self.scrollBox, 'scrollBoxHeight', {\r\n      get: function () {\r\n        return scrollBoxHeight;\r\n      },\r\n      set: function (value) {\r\n        scrollBoxHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollBoxWidth', {\r\n      get: function () {\r\n        return scrollBoxWidth;\r\n      },\r\n      set: function (value) {\r\n        scrollBoxWidth = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'height', {\r\n      get: function () {\r\n        return sHeight;\r\n      },\r\n      set: function (value) {\r\n        sHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'width', {\r\n      get: function () {\r\n        return sWidth;\r\n      },\r\n      set: function (value) {\r\n        sWidth = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollTop', {\r\n      get: function () {\r\n        return scrollTop;\r\n      },\r\n      set: setScrollTop,\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollLeft', {\r\n      get: function () {\r\n        return scrollLeft;\r\n      },\r\n      set: setScrollLeft,\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollHeight', {\r\n      get: function () {\r\n        return scrollHeight;\r\n      },\r\n      set: function (value) {\r\n        if (scrollTop > value) {\r\n          scrollTop = Math.max(value, 0);\r\n        }\r\n        scrollHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollWidth', {\r\n      get: function () {\r\n        return scrollWidth;\r\n      },\r\n      set: function (value) {\r\n        if (scrollLeft > value) {\r\n          scrollLeft = Math.max(value, 0);\r\n        }\r\n        scrollWidth = value;\r\n      },\r\n    });\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, evil: true*/\r\n/*globals Reflect: false, HTMLElement: true, define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport component from './component';\r\nimport defaults from './defaults';\r\nimport draw from './draw';\r\nimport events from './events';\r\nimport touch from './touch';\r\nimport intf from './intf';\r\nimport contextMenu from './contextMenu';\r\nimport dom from './dom';\r\nimport publicMethods from './publicMethods';\r\n\r\nvar webComponent = component();\r\n\r\nvar modules = [\r\n  defaults,\r\n  draw,\r\n  events,\r\n  touch,\r\n  intf,\r\n  contextMenu,\r\n  dom,\r\n  publicMethods,\r\n];\r\n\r\nfunction Grid(args) {\r\n  args = args || {};\r\n  var self = {};\r\n  self.isComponent = args.component === undefined;\r\n  self.isChildGrid =\r\n    args.parentNode &&\r\n    /canvas-datagrid-(cell|tree)/.test(args.parentNode.nodeType);\r\n  if (self.isChildGrid) {\r\n    self.intf = {};\r\n  } else {\r\n    self.intf = self.isComponent\r\n      ? eval('Reflect.construct(HTMLElement, [], new.target)')\r\n      : document.createElement('canvas');\r\n  }\r\n  self.args = args;\r\n  self.intf.args = args;\r\n  self.applyComponentStyle = webComponent.applyComponentStyle;\r\n  self.hyphenateProperty = webComponent.hyphenateProperty;\r\n  self.dehyphenateProperty = webComponent.dehyphenateProperty;\r\n  self.createGrid = function grid(args) {\r\n    args.component = false;\r\n    return new Grid(args);\r\n  };\r\n\r\n  modules.forEach(function (module) {\r\n    module(self);\r\n  });\r\n\r\n  if (self.isChildGrid) {\r\n    self.shadowRoot = args.parentNode.shadowRoot;\r\n    self.parentNode = args.parentNode;\r\n  } else {\r\n    self.shadowRoot = self.intf.attachShadow({ mode: 'open' });\r\n    self.parentNode = self.shadowRoot;\r\n  }\r\n  self.init();\r\n  return self.intf;\r\n}\r\nif (window.HTMLElement) {\r\n  Grid.prototype = Object.create(window.HTMLElement.prototype);\r\n}\r\n// export web component\r\nif (window.customElements) {\r\n  Grid.observedAttributes = webComponent.getObservableAttributes();\r\n  Grid.prototype.disconnectedCallback = webComponent.disconnectedCallback;\r\n  Grid.prototype.attributeChangedCallback =\r\n    webComponent.attributeChangedCallback;\r\n  Grid.prototype.connectedCallback = webComponent.connectedCallback;\r\n  Grid.prototype.adoptedCallback = webComponent.adoptedCallback;\r\n  window.customElements.define('canvas-datagrid', Grid);\r\n}\r\n\r\n// export global\r\nif (\r\n  window &&\r\n  !window.canvasDatagrid &&\r\n  !window.require &&\r\n  // Present to exclude global declarations from ES Module bundles\r\n  !window.EXCLUDE_GLOBAL\r\n) {\r\n  window.canvasDatagrid = function (args) {\r\n    return new Grid(args);\r\n  };\r\n}\r\n\r\n// export amd loader\r\nexport default function canvasDatagrid(args) {\r\n  args = args || {};\r\n  var i,\r\n    tKeys = [\r\n      'style',\r\n      'formatters',\r\n      'sorters',\r\n      'filters',\r\n      'treeGridAttributes',\r\n      'cellGridAttributes',\r\n      'data',\r\n      'schema',\r\n    ];\r\n  if (window.customElements) {\r\n    i = document.createElement('canvas-datagrid');\r\n    Object.keys(args).forEach(function (argKey) {\r\n      // set data and parentNode after everything else\r\n      if (argKey === 'data') {\r\n        return;\r\n      }\r\n      if (argKey === 'parentNode') {\r\n        return;\r\n      }\r\n      // top level keys in args\r\n      if (tKeys.indexOf(argKey) !== -1) {\r\n        tKeys.forEach(function (tKey) {\r\n          if (args[tKey] === undefined || tKey !== argKey) {\r\n            return;\r\n          }\r\n          if (['formatters', 'sorters', 'filters'].indexOf(argKey) !== -1) {\r\n            if (typeof args[tKey] === 'object' && args[tKey] !== null) {\r\n              Object.keys(args[tKey]).forEach(function (sKey) {\r\n                i[tKey][sKey] = args[tKey][sKey];\r\n              });\r\n            }\r\n          } else {\r\n            i[tKey] = args[tKey];\r\n          }\r\n        });\r\n        return;\r\n      }\r\n      // all others are attribute level keys\r\n      i.attributes[argKey] = args[argKey];\r\n    });\r\n    if (args.data) {\r\n      i.data = args.data;\r\n    }\r\n    // add to the dom very last to avoid redraws\r\n    if (args.parentNode) {\r\n      args.parentNode.appendChild(i);\r\n    }\r\n    return i;\r\n  }\r\n  args.component = false;\r\n  i = new Grid(args);\r\n  if (args.parentNode && args.parentNode.appendChild) {\r\n    args.parentNode.appendChild(i);\r\n  }\r\n  return i;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  /**\r\n   * Converts a integer into a letter A - ZZZZZ...\r\n   * @memberof canvasDatagrid\r\n   * @name integerToAlpha\r\n   * @method\r\n   * @param {column} n The number to convert.\r\n   */\r\n  self.integerToAlpha = function (n) {\r\n    var ordA = 'a'.charCodeAt(0),\r\n      ordZ = 'z'.charCodeAt(0),\r\n      len = ordZ - ordA + 1,\r\n      s = '';\r\n    while (n >= 0) {\r\n      s = String.fromCharCode((n % len) + ordA) + s;\r\n      n = Math.floor(n / len) - 1;\r\n    }\r\n    return s;\r\n  };\r\n  /**\r\n   * Inserts a new column before the specified index into the schema.\r\n   * @tutorial schema\r\n   * @memberof canvasDatagrid\r\n   * @name insertColumn\r\n   * @method\r\n   * @param {column} c The column to insert into the schema.\r\n   * @param {number} index The index of the column to insert before.\r\n   */\r\n  self.insertColumn = function (c, index) {\r\n    var s = self.getSchema();\r\n    if (s.length < index) {\r\n      throw new Error('Index is beyond the length of the schema.');\r\n    }\r\n    self.validateColumn(c, s);\r\n    s.splice(index, 0, c);\r\n\r\n    self.originalData.forEach(function (row, rowIndex) {\r\n      self.applyDefaultValue(row, c, rowIndex);\r\n    });\r\n    self.intf.schema = s;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Deletes a column from the schema at the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteColumn\r\n   * @tutorial schema\r\n   * @method\r\n   * @param {number} index The index of the column to delete.\r\n   */\r\n  self.deleteColumn = function (index) {\r\n    var schema = self.getSchema();\r\n\r\n    // remove data matching this column name from data\r\n    self.originalData.forEach(function (row) {\r\n      delete row[schema[index].name];\r\n    });\r\n\r\n    schema.splice(index, 1);\r\n    self.intf.schema = schema;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Adds a new column into the schema.\r\n   * @tutorial schema\r\n   * @memberof canvasDatagrid\r\n   * @name addColumn\r\n   * @method\r\n   * @param {column} c The column to add to the schema.\r\n   */\r\n  self.addColumn = function (c) {\r\n    var s = self.getSchema();\r\n    self.validateColumn(c, s);\r\n    s.push(c);\r\n    self.originalData.forEach(function (row, rowIndex) {\r\n      self.applyDefaultValue(row, c, rowIndex);\r\n    });\r\n    self.intf.schema = s;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Deletes a row from the dataset at the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteRow\r\n   * @method\r\n   * @param {number} index The index of the row to delete.\r\n   */\r\n  self.deleteRow = function (index) {\r\n    self.originalData.splice(index, 1);\r\n    self.setFilter();\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Inserts a new row into the dataset before the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name insertRow\r\n   * @method\r\n   * @param {object} d data.\r\n   * @param {number} index The index of the row to insert before.\r\n   */\r\n  self.insertRow = function (d, index) {\r\n    if (self.originalData.length < index) {\r\n      throw new Error('Index is beyond the length of the dataset.');\r\n    }\r\n    self.originalData.splice(index, 0, d);\r\n    self.getSchema().forEach(function (c) {\r\n      if (d[c.name] === undefined) {\r\n        self.applyDefaultValue(self.originalData[index], c, index);\r\n      }\r\n    });\r\n\r\n    // setFilter calls .refresh(), so we need not call it again:\r\n    self.setFilter();\r\n\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Adds a new row into the dataset.\r\n   * @memberof canvasDatagrid\r\n   * @name addRow\r\n   * @method\r\n   * @param {object} d data.\r\n   */\r\n  self.addRow = function (d) {\r\n    self.originalData.push(d);\r\n    self.getSchema().forEach(function (c) {\r\n      if (d[c.name] === undefined) {\r\n        self.applyDefaultValue(\r\n          self.originalData[self.originalData.length - 1],\r\n          c,\r\n          self.originalData.length - 1,\r\n        );\r\n      }\r\n    });\r\n\r\n    // setFilter calls .refresh(), so we need not call it again:\r\n    self.setFilter();\r\n\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Sets the height of a given row by index number.\r\n   * @memberof canvasDatagrid\r\n   * @name setRowHeight\r\n   * @method\r\n   * @param {number} rowIndex The index of the row to set.\r\n   * @param {number} height Height to set the row to.\r\n   */\r\n  self.setRowHeight = function (rowIndex, height) {\r\n    self.sizes.rows[rowIndex] = height;\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Sets the width of a given column by index number.\r\n   * @memberof canvasDatagrid\r\n   * @name setColumnWidth\r\n   * @method\r\n   * @param {number} colIndex The index of the column to set.\r\n   * @param {number} width Width to set the column to.\r\n   */\r\n  self.setColumnWidth = function (colIndex, width) {\r\n    self.sizes.columns[colIndex] = width;\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Removes any changes to the width of the columns due to user or api interaction, setting them back to the schema or style default.\r\n   * @memberof canvasDatagrid\r\n   * @name resetColumnWidths\r\n   * @tutorial schema\r\n   * @method\r\n   */\r\n  self.resetColumnWidths = function () {\r\n    self.sizes.columns = {};\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Removes any changes to the height of the rows due to user or api interaction, setting them back to the schema or style default.\r\n   * @memberof canvasDatagrid\r\n   * @name resetRowHeights\r\n   * @tutorial schema\r\n   * @method\r\n   */\r\n  self.resetRowHeights = function () {\r\n    self.sizes.rows = {};\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Sets the value of the filter.\r\n   * @memberof canvasDatagrid\r\n   * @name setFilter\r\n   * @method\r\n   * @param {string} column Name of the column to filter.\r\n   * @param {string} value The value to filter for.\r\n   */\r\n  self.setFilter = function (column, value) {\r\n    if (column === undefined && value === undefined) {\r\n      self.columnFilters = {};\r\n    } else if (column && (value === '' || value === undefined)) {\r\n      delete self.columnFilters[column];\r\n    } else {\r\n      self.columnFilters[column] = value;\r\n    }\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Returns the number of pixels to scroll down to line up with row rowIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name findRowScrollTop\r\n   * @method\r\n   * @param {number} rowIndex The row index of the row to scroll find.\r\n   */\r\n  self.findRowScrollTop = function (rowIndex) {\r\n    if (self.scrollCache.y[rowIndex] === undefined) {\r\n      throw new RangeError(\r\n        `Row index ${rowIndex} out of range: ${self.scrollCache.y.length}.`,\r\n      );\r\n    }\r\n    return self.scrollCache.y[rowIndex];\r\n  };\r\n  /**\r\n   * Returns the number of pixels to scroll to the left to line up with column columnIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name findColumnScrollLeft\r\n   * @method\r\n   * @param {number} columnIndex The column index of the column to find.\r\n   */\r\n  self.findColumnScrollLeft = function (columnIndex) {\r\n    var i = Math.max(columnIndex - 1, 0);\r\n    if (self.scrollCache.x[i] === undefined) {\r\n      throw new Error('Column index out of range.');\r\n    }\r\n    return (\r\n      self.scrollCache.x[i] -\r\n      self.getColumnWidth(self.orders.columns[columnIndex])\r\n    );\r\n  };\r\n  /**\r\n   * Scrolls to the cell at columnIndex x, and rowIndex y.  If you define both rowIndex and columnIndex additional calculations can be made to center the cell using the target cell's height and width.  Defining only one rowIndex or only columnIndex will result in simpler calculations.\r\n   * @memberof canvasDatagrid\r\n   * @name gotoCell\r\n   * @method\r\n   * @param {number} x The column index of the cell to scroll to.\r\n   * @param {number} y The row index of the cell to scroll to.\r\n   * @param {number} [offsetX=0] Percentage offset the cell should be from the left edge (not including headers).  The default is 0, meaning the cell will appear at the left edge. Valid values are 0 through 1. 1 = Left, 0 = Right, 0.5 = Center.\r\n   * @param {number} [offsetY=0] Percentage offset the cell should be from the top edge (not including headers).  The default is 0, meaning the cell will appear at the top edge. Valid values are 0 through 1. 1 = Bottom, 0 = Top, 0.5 = Center.\r\n   */\r\n  self.gotoCell = function (x, y, offsetX, offsetY) {\r\n    var targetX = x === undefined ? undefined : self.findColumnScrollLeft(x),\r\n      targetY = y === undefined ? undefined : self.findRowScrollTop(y),\r\n      cell,\r\n      sbw =\r\n        self.scrollBox.width -\r\n        (self.scrollBox.verticalBarVisible ? self.style.scrollBarWidth : 0),\r\n      sbh =\r\n        self.scrollBox.height -\r\n        (self.scrollBox.horizontalBarVisible ? self.style.scrollBarWidth : 0);\r\n    offsetX = offsetX === undefined ? 0 : offsetX;\r\n    offsetY = offsetY === undefined ? 0 : offsetY;\r\n    targetX -= sbw * offsetX;\r\n    targetY -= sbh * offsetY;\r\n    if (x !== undefined && y !== undefined) {\r\n      self.scrollBox.scrollTo(targetX, targetY);\r\n      requestAnimationFrame(function () {\r\n        cell = self.getVisibleCellByIndex(x, y);\r\n        // HACK: just don't offset if the target cell cannot be seen\r\n        // TODO: offset does not work on very small grids, not sure why\r\n        if (!cell) {\r\n          return;\r\n        }\r\n        targetX += cell.width * offsetX;\r\n        targetY += cell.height * offsetY;\r\n        self.scrollBox.scrollTo(targetX, targetY);\r\n      });\r\n    } else if (x !== undefined) {\r\n      self.scrollBox.scrollLeft = targetX;\r\n    } else if (y !== undefined) {\r\n      self.scrollBox.scrollTop = targetY;\r\n    }\r\n  };\r\n  /**\r\n   * Scrolls the row y.\r\n   * @memberof canvasDatagrid\r\n   * @name gotoRow\r\n   * @method\r\n   * @param {number} y The row index of the cell to scroll to.\r\n   */\r\n  self.gotoRow = function (y) {\r\n    self.gotoCell(0, y);\r\n  };\r\n  /**\r\n   * Scrolls the cell at cell x, row y into view if it is not already.\r\n   * @memberof canvasDatagrid\r\n   * @name scrollIntoView\r\n   * @method\r\n   * @param {number} x The column index of the cell to scroll into view.\r\n   * @param {number} y The row index of the cell to scroll into view.\r\n   * @param {number} [offsetX=0] Percentage offset the cell should be from the left edge (not including headers).  The default is 0, meaning the cell will appear at the left edge. Valid values are 0 through 1. 1 = Left, 0 = Right, 0.5 = Center.\r\n   * @param {number} [offsetY=0] Percentage offset the cell should be from the top edge (not including headers).  The default is 0, meaning the cell will appear at the top edge. Valid values are 0 through 1. 1 = Bottom, 0 = Top, 0.5 = Center.\r\n   */\r\n  self.scrollIntoView = function (x, y, offsetX, offsetY) {\r\n    if (\r\n      self.visibleCells.filter(function (cell) {\r\n        return (\r\n          (cell.rowIndex === y || y === undefined) &&\r\n          (cell.columnIndex === x || x === undefined) &&\r\n          cell.x > 0 &&\r\n          cell.y > 0 &&\r\n          cell.x + cell.width < self.width &&\r\n          cell.y + cell.height < self.height\r\n        );\r\n      }).length === 0\r\n    ) {\r\n      self.gotoCell(x, y, offsetX, offsetY);\r\n    }\r\n  };\r\n  /**\r\n   * Sets the active cell. Requires redrawing.\r\n   * @memberof canvasDatagrid\r\n   * @name setActiveCell\r\n   * @method\r\n   * @param {number} x The column index of the cell to set active.\r\n   * @param {number} y The row index of the cell to set active.\r\n   */\r\n  self.setActiveCell = function (x, y) {\r\n    if (x < 0) {\r\n      x = 0;\r\n    }\r\n    if (y < 0) {\r\n      y = 0;\r\n    }\r\n    self.activeCell = {\r\n      rowIndex: y,\r\n      columnIndex: x,\r\n    };\r\n  };\r\n  /**\r\n   * Removes the selection.\r\n   * @memberof canvasDatagrid\r\n   * @name selectNone\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   * @method\r\n   */\r\n  self.selectNone = function (dontDraw) {\r\n    self.selections = [];\r\n    self.dispatchEvent('selectionchanged', {\r\n      selectedData: self.getSelectedData(),\r\n      selections: self.selections,\r\n      selectionBounds: self.selectionBounds,\r\n    });\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n    self.draw();\r\n  };\r\n  /**\r\n   * Selects every visible cell.\r\n   * @memberof canvasDatagrid\r\n   * @name selectAll\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   * @method\r\n   */\r\n  self.selectAll = function (dontDraw) {\r\n    self.selectArea({\r\n      top: 0,\r\n      left: -1,\r\n      right: self.getSchema().length - 1,\r\n      bottom: self.viewData.length - 1,\r\n    });\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n    self.draw();\r\n  };\r\n  /**\r\n   * Returns true if the selected columnIndex is selected on every row.\r\n   * @memberof canvasDatagrid\r\n   * @name isColumnSelected\r\n   * @method\r\n   * @param {number} columnIndex The column index to check.\r\n   */\r\n  self.isColumnSelected = function (columnIndex) {\r\n    var colIsSelected = true;\r\n    self.viewData.forEach(function (row, rowIndex) {\r\n      if (\r\n        !self.selections[rowIndex] ||\r\n        self.selections[rowIndex].indexOf(self.orders.columns[columnIndex]) ===\r\n          -1\r\n      ) {\r\n        colIsSelected = false;\r\n      }\r\n    });\r\n    return colIsSelected;\r\n  };\r\n  /**\r\n   * Runs the defined method on each selected cell.\r\n   * @memberof canvasDatagrid\r\n   * @name forEachSelectedCell\r\n   * @method\r\n   * @param {number} fn The function to execute.  The signature of the function is: (data, rowIndex, columnName).\r\n   * @param {number} expandToRow When true the data in the array is expanded to the entire row.\r\n   */\r\n  self.forEachSelectedCell = function (fn, expandToRow) {\r\n    var d = [],\r\n      s = expandToRow ? self.getSchema() : self.getVisibleSchema(),\r\n      l = self.viewData.length;\r\n    self.selections.forEach(function (row, index) {\r\n      if (index === l) {\r\n        return;\r\n      }\r\n      if (row.length === 0) {\r\n        d[index] = null;\r\n        return;\r\n      }\r\n      d[index] = {};\r\n      row.forEach(function (col) {\r\n        if (col === -1 || !s[col]) {\r\n          return;\r\n        }\r\n        fn(self.viewData, index, s[col].name);\r\n      });\r\n    });\r\n  };\r\n  /**\r\n   * Selects a column.\r\n   * @memberof canvasDatagrid\r\n   * @name selectColumn\r\n   * @method\r\n   * @param {number} columnIndex The column index to select.\r\n   * @param {boolean} toggleSelectMode When true, behaves as if you were holding control/command when you clicked the column.\r\n   * @param {boolean} shift When true, behaves as if you were holding shift when you clicked the column.\r\n   * @param {boolean} supressSelectionchangedEvent When true, prevents the selectionchanged event from firing.\r\n   */\r\n  self.selectColumn = function (columnIndex, ctrl, shift, supressEvent) {\r\n    var s, e, x;\r\n    function addCol(i) {\r\n      self.viewData.forEach(function (row, rowIndex) {\r\n        self.selections[rowIndex] = self.selections[rowIndex] || [];\r\n        if (self.selections[rowIndex].indexOf(i) === -1) {\r\n          self.selections[rowIndex].push(i);\r\n        }\r\n      });\r\n    }\r\n    function removeCol(i) {\r\n      self.viewData.forEach(function (row, rowIndex) {\r\n        self.selections[rowIndex] = self.selections[rowIndex] || [];\r\n        if (self.selections[rowIndex].indexOf(i) !== -1) {\r\n          self.selections[rowIndex].splice(\r\n            self.selections[rowIndex].indexOf(i),\r\n            1,\r\n          );\r\n        }\r\n      });\r\n    }\r\n    if (shift) {\r\n      if (!self.activeCell) {\r\n        return;\r\n      }\r\n      s = Math.min(self.activeCell.columnIndex, columnIndex);\r\n      e = Math.max(self.activeCell.columnIndex, columnIndex);\r\n      for (x = s; e > x; x += 1) {\r\n        addCol(x);\r\n      }\r\n    }\r\n    if (!ctrl && !shift) {\r\n      self.selections = [];\r\n      self.activeCell.columnIndex = columnIndex;\r\n      self.activeCell.rowIndex = self.scrollIndexTop;\r\n    }\r\n    if (ctrl && self.isColumnSelected(columnIndex)) {\r\n      removeCol(columnIndex);\r\n    } else {\r\n      addCol(columnIndex);\r\n    }\r\n    if (supressEvent) {\r\n      return;\r\n    }\r\n    self.dispatchEvent('selectionchanged', {\r\n      selectedData: self.getSelectedData(),\r\n      selections: self.selections,\r\n      selectionBounds: self.getSelectionBounds(),\r\n    });\r\n  };\r\n  /**\r\n   * Selects a row.\r\n   * @memberof canvasDatagrid\r\n   * @name selectRow\r\n   * @method\r\n   * @param {number} rowIndex The row index to select.\r\n   * @param {boolean} ctrl When true, behaves as if you were holding control/command when you clicked the row.\r\n   * @param {boolean} shift When true, behaves as if you were holding shift when you clicked the row.\r\n   * @param {boolean} supressSelectionchangedEvent When true, prevents the selectionchanged event from firing.\r\n   */\r\n  self.selectRow = function (rowIndex, ctrl, shift, supressEvent) {\r\n    var x,\r\n      st,\r\n      en,\r\n      s = self.getVisibleSchema();\r\n    function de() {\r\n      if (supressEvent) {\r\n        return;\r\n      }\r\n      self.dispatchEvent('selectionchanged', {\r\n        selectedData: self.getSelectedData(),\r\n        selections: self.selections,\r\n        selectionBounds: self.selectionBounds,\r\n      });\r\n    }\r\n    function addRow(ri) {\r\n      self.selections[ri] = [];\r\n      self.selections[ri].push(-1);\r\n      s.forEach(function (col, index) {\r\n        self.selections[ri].push(self.orders.columns.indexOf(col.index));\r\n      });\r\n    }\r\n    if (self.dragAddToSelection === false || self.dragObject === undefined) {\r\n      if (\r\n        self.selections[rowIndex] &&\r\n        self.selections[rowIndex].length - 1 === s.length\r\n      ) {\r\n        if (ctrl) {\r\n          self.selections[rowIndex] = [];\r\n          de();\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (self.dragAddToSelection === true || self.dragObject === undefined) {\r\n      if (shift && self.dragObject === undefined) {\r\n        if (!self.activeCell) {\r\n          return;\r\n        }\r\n        st = Math.min(self.activeCell.rowIndex, rowIndex);\r\n        en = Math.max(self.activeCell.rowIndex, rowIndex);\r\n        for (x = st; en >= x; x += 1) {\r\n          addRow(x);\r\n        }\r\n      } else {\r\n        addRow(rowIndex);\r\n      }\r\n    }\r\n    de();\r\n  };\r\n  /**\r\n   * Collapse a tree grid by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name collapseTree\r\n   * @method\r\n   * @param {number} index The index of the row to collapse.\r\n   */\r\n  self.collapseTree = function (rowIndex) {\r\n    self.dispatchEvent('collapsetree', {\r\n      childGrid: self.childGrids[rowIndex],\r\n      data: self.viewData[rowIndex],\r\n      rowIndex: rowIndex,\r\n    });\r\n    self.openChildren[rowIndex].blur();\r\n    self.openChildren[rowIndex].dispose();\r\n    delete self.openChildren[rowIndex];\r\n    delete self.sizes.trees[rowIndex];\r\n    delete self.childGrids[rowIndex];\r\n    self.dispatchEvent('resizerow', {\r\n      cellHeight: self.style.cellHeight,\r\n    });\r\n    self.resize(true);\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Expands a tree grid by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name expandTree\r\n   * @method\r\n   * @param {number} index The index of the row to expand.\r\n   */\r\n  self.expandTree = function (rowIndex) {\r\n    var trArgs = self.args.treeGridAttributes || {},\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth =\r\n        self.sizes.columns.cornerCell || self.style.rowHeaderCellWidth,\r\n      h = self.sizes.trees[rowIndex] || self.style.treeGridHeight,\r\n      treeGrid;\r\n    if (!self.childGrids[rowIndex]) {\r\n      trArgs.debug = self.attributes.debug;\r\n      trArgs.name = self.attributes.saveAppearance\r\n        ? self.attributes.name + 'tree' + rowIndex\r\n        : undefined;\r\n      trArgs.style = trArgs.style || self.style;\r\n      trArgs.parentNode = {\r\n        parentGrid: self.intf,\r\n        nodeType: 'canvas-datagrid-tree',\r\n        offsetHeight: h,\r\n        offsetWidth: self.width - rowHeaderCellWidth,\r\n        header: { width: self.width - rowHeaderCellWidth },\r\n        offsetLeft: rowHeaderCellWidth,\r\n        offsetTop: columnHeaderCellHeight,\r\n        offsetParent: self.intf.parentNode,\r\n        parentNode: self.intf.parentNode,\r\n        style: 'tree',\r\n        data: self.viewData[rowIndex],\r\n      };\r\n      treeGrid = self.createGrid(trArgs);\r\n      self.childGrids[rowIndex] = treeGrid;\r\n    }\r\n    treeGrid = self.childGrids[rowIndex];\r\n    treeGrid.visible = true;\r\n    self.dispatchEvent('expandtree', {\r\n      treeGrid: treeGrid,\r\n      data: self.viewData[rowIndex],\r\n      rowIndex: rowIndex,\r\n    });\r\n    self.openChildren[rowIndex] = treeGrid;\r\n    self.sizes.trees[rowIndex] = h;\r\n    self.dispatchEvent('resizerow', { height: self.style.cellHeight });\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Toggles tree grid open and close by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name toggleTree\r\n   * @method\r\n   * @param {number} index The index of the row to toggle.\r\n   */\r\n  self.toggleTree = function (rowIndex) {\r\n    var i = self.openChildren[rowIndex];\r\n    if (i) {\r\n      return self.collapseTree(rowIndex);\r\n    }\r\n    self.expandTree(rowIndex);\r\n  };\r\n  /**\r\n   * Returns a header from the schema by name.\r\n   * @memberof canvasDatagrid\r\n   * @name getHeaderByName\r\n   * @tutorial schema\r\n   * @method\r\n   * @returns {header} header with the selected name, or undefined.\r\n   * @param {string} name The name of the column to resize.\r\n   */\r\n  self.getHeaderByName = function (name) {\r\n    var x,\r\n      i = self.getSchema();\r\n    for (x = 0; x < i.length; x += 1) {\r\n      if (i[x].name === name) {\r\n        return i[x];\r\n      }\r\n    }\r\n  };\r\n  /**\r\n   * Resizes a column to fit the longest value in the column. Call without a value to resize all columns.\r\n   * Warning, can be slow on very large record sets (1m records ~3-5 seconds on an i7).\r\n   * @memberof canvasDatagrid\r\n   * @name fitColumnToValues\r\n   * @method\r\n   * @param {string} name The name of the column to resize.\r\n   */\r\n  self.fitColumnToValues = function (name, internal) {\r\n    if (!self.canvas) {\r\n      return;\r\n    }\r\n    self.sizes.columns[\r\n      name === 'cornerCell' ? -1 : self.getHeaderByName(name).index\r\n    ] = Math.max(self.findColumnMaxTextLength(name), self.style.minColumnWidth);\r\n    if (!internal) {\r\n      self.resize();\r\n      self.draw(true);\r\n    }\r\n  };\r\n  /**\r\n   * Checks if a cell is currently visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isCellVisible\r\n   * @overload\r\n   * @method\r\n   * @returns {boolean} when true, the cell is visible, when false the cell is not currently drawn.\r\n   * @param {number} columnIndex The column index of the cell to check.\r\n   * @param {number} rowIndex The row index of the cell to check.\r\n   */\r\n  self.isCellVisible = function (cell, rowIndex) {\r\n    // overload\r\n    if (rowIndex !== undefined) {\r\n      return (\r\n        self.visibleCells.filter(function (c) {\r\n          return c.columnIndex === cell && c.rowIndex === rowIndex;\r\n        }).length > 0\r\n      );\r\n    }\r\n    var x,\r\n      l = self.visibleCells.length;\r\n    for (x = 0; x < l; x += 1) {\r\n      if (\r\n        cell.x === self.visibleCells[x].x &&\r\n        cell.y === self.visibleCells[x].y\r\n      ) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n  /**\r\n   * Sets the order of the data.\r\n   * @memberof canvasDatagrid\r\n   * @name order\r\n   * @method\r\n   * @param {number} columnName Name of the column to be sorted.\r\n   * @param {string} direction `asc` for ascending or `desc` for descending.\r\n   * @param {function} [sortFunction] When defined, override the default sorting method defined in the column's schema and use this one.\r\n   * @param {bool} [dontSetStorageData] Don't store this setting for future use.\r\n   */\r\n  self.order = function (\r\n    columnName,\r\n    direction,\r\n    sortFunction,\r\n    dontSetStorageData,\r\n  ) {\r\n    var f,\r\n      c = self.getSchema().filter(function (col) {\r\n        return col.name === columnName;\r\n      });\r\n    if (\r\n      self.dispatchEvent('beforesortcolumn', {\r\n        name: columnName,\r\n        direction: direction,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.orderBy = columnName;\r\n    self.orderDirection = direction;\r\n    if (!self.viewData || self.viewData.length === 0) {\r\n      return;\r\n    }\r\n    if (c.length === 0) {\r\n      throw new Error('Cannot sort.  No such column name');\r\n    }\r\n    f = sortFunction || c[0].sorter || self.sorters[c[0].type];\r\n    if (!f && c[0].type !== undefined) {\r\n      console.warn(\r\n        'Cannot sort type \"%s\" falling back to string sort.',\r\n        c[0].type,\r\n      );\r\n    }\r\n    self.orderings.add(\r\n      columnName,\r\n      direction,\r\n      typeof f === 'function' ? f : self.sorters.string,\r\n    );\r\n    self.refresh();\r\n    self.dispatchEvent('sortcolumn', {\r\n      name: columnName,\r\n      direction: direction,\r\n    });\r\n\r\n    if (dontSetStorageData) {\r\n      return;\r\n    }\r\n    self.setStorageData();\r\n  };\r\n  self.isInGrid = function (e) {\r\n    if (e.x < 0 || e.x > self.width || e.y < 0 || e.y > self.height) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  /**\r\n   * Moves the current selection relative to the its current position.  Note: this method does not move the selected data, just the selection itself.\r\n   * @memberof canvasDatagrid\r\n   * @name moveSelection\r\n   * @method\r\n   * @param {number} offsetX The number of columns to offset the selection.\r\n   * @param {number} offsetY The number of rows to offset the selection.\r\n   */\r\n  self.moveSelection = function (offsetX, offsetY) {\r\n    var sel = [];\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      sel[rowIndex + offsetY] = [];\r\n      row.forEach(function (colIndex) {\r\n        sel[rowIndex + offsetY].push(colIndex + offsetX);\r\n      });\r\n    });\r\n    self.selections = sel;\r\n  };\r\n  /**\r\n   * Moves data in the provided selection to another position in the grid.  Moving data off the edge of the schema (columns/x) will truncate data.\r\n   * @memberof canvasDatagrid\r\n   * @name moveTo\r\n   * @method\r\n   * @param {array} sel 2D array representing selected rows and columns.  `canvasDatagrid.selections` is in this format and can be used here.\r\n   * @param {number} x The column index to start inserting the selection at.\r\n   * @param {number} y The row index to start inserting the selection at.\r\n   */\r\n  self.moveTo = function (sel, x, y) {\r\n    var selectedData = self.getSelectedData(),\r\n      visibleSchema = self.getVisibleSchema(),\r\n      selectionLength = sel.length,\r\n      xi,\r\n      maxRowLength = -Infinity,\r\n      minXi = Infinity,\r\n      yi = y - 1;\r\n\r\n    sel.forEach(function (row, rowIndex) {\r\n      if (rowIndex === selectionLength) {\r\n        return;\r\n      }\r\n      if (row.length === 0) {\r\n        return;\r\n      }\r\n      minXi = Math.min(self.getVisibleColumnIndexOf(x), minXi);\r\n      maxRowLength = Math.max(maxRowLength, row.length);\r\n      row.forEach(function (colIndex) {\r\n        // intentional redef of colIndex\r\n        colIndex = self.getVisibleColumnIndexOf(colIndex);\r\n        if (!visibleSchema[colIndex]) {\r\n          return;\r\n        }\r\n        // TODO:\r\n        if (!self.data[rowIndex]) {\r\n          self.data[rowIndex] = {};\r\n        }\r\n        // TODO:\r\n        self.data[rowIndex][visibleSchema[colIndex].name] = null;\r\n      });\r\n    });\r\n\r\n    sel.forEach(function (row, index) {\r\n      var lastSourceIndex;\r\n      yi += 1;\r\n      xi = self.getVisibleColumnIndexOf(x);\r\n      row.forEach(function (colIndex, cidx) {\r\n        colIndex = self.getVisibleColumnIndexOf(colIndex);\r\n        if (cidx > 0) {\r\n          // this confusing bit of nonsense figures out\r\n          // if the selection has skipped cells\r\n          xi += colIndex - lastSourceIndex;\r\n        }\r\n        lastSourceIndex = colIndex;\r\n        if (\r\n          colIndex === -1 ||\r\n          !visibleSchema[xi] ||\r\n          !visibleSchema[colIndex] ||\r\n          // TODO:\r\n          self.data.length - 1 < yi ||\r\n          yi < 0\r\n        ) {\r\n          return;\r\n        }\r\n        // TODO:\r\n        if (!self.data[yi]) {\r\n          self.data[yi] = {};\r\n        }\r\n        // TODO:\r\n        self.data[yi][visibleSchema[xi].name] =\r\n          selectedData[index][visibleSchema[colIndex].name];\r\n      });\r\n    });\r\n  };\r\n  /**\r\n   * Checks if a given column is visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isColumnVisible\r\n   * @method\r\n   * @returns {boolean} When true, the column is visible.\r\n   * @param {number} columnIndex Column index.\r\n   */\r\n  self.isColumnVisible = function (columnIndex) {\r\n    return (\r\n      self.visibleCells.filter(function (c) {\r\n        return c.columnIndex === columnIndex;\r\n      }).length > 0\r\n    );\r\n  };\r\n  /**\r\n   * Checks if a given row is visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isRowVisible\r\n   * @method\r\n   * @returns {boolean} When true, the row is visible.\r\n   * @param {number} rowIndex Row index.\r\n   */\r\n  self.isRowVisible = function (rowIndex) {\r\n    return (\r\n      self.visibleCells.filter(function (c) {\r\n        return c.rowIndex === rowIndex;\r\n      }).length > 0\r\n    );\r\n  };\r\n  /**\r\n   * Gets the cell at columnIndex and rowIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name getVisibleCellByIndex\r\n   * @method\r\n   * @returns {cell} cell at the selected location.\r\n   * @param {number} x Column index.\r\n   * @param {number} y Row index.\r\n   */\r\n  self.getVisibleCellByIndex = function (x, y) {\r\n    return self.visibleCells.filter(function (c) {\r\n      return c.columnIndex === x && c.rowIndex === y;\r\n    })[0];\r\n  };\r\n  /**\r\n   * Gets the cell at grid pixel coordinate x and y.  Author's note.  This function ties drawing and events together.  This is a very complex function and is core to the component.\r\n   * @memberof canvasDatagrid\r\n   * @name getCellAt\r\n   * @method\r\n   * @returns {cell} cell at the selected location.\r\n   * @param {number} x Number of pixels from the left.\r\n   * @param {number} y Number of pixels from the top.\r\n   */\r\n  self.getCellAt = function (x, y, useTouchScrollZones) {\r\n    function getBorder(entitiy) {\r\n      if (\r\n        entitiy.x + entitiy.width - self.attributes.borderResizeZone * 0.4 <\r\n          x &&\r\n        entitiy.x + entitiy.width + self.attributes.borderResizeZone * 0.6 > x\r\n      ) {\r\n        return 'r';\r\n      }\r\n      if (\r\n        entitiy.x - self.attributes.borderResizeZone * 0.4 < x &&\r\n        entitiy.x + self.attributes.borderResizeZone * 0.6 > x\r\n      ) {\r\n        return 'l';\r\n      }\r\n      if (\r\n        entitiy.y + entitiy.height - self.attributes.borderResizeZone * 0.4 <\r\n          y &&\r\n        entitiy.y + entitiy.height + self.attributes.borderResizeZone * 0.6 > y\r\n      ) {\r\n        return 'b';\r\n      }\r\n      if (\r\n        entitiy.y - self.attributes.borderResizeZone * 0.4 < y &&\r\n        entitiy.y + self.attributes.borderResizeZone * 0.6 > y\r\n      ) {\r\n        return 't';\r\n      }\r\n    }\r\n    if (!self.visibleCells) {\r\n      return;\r\n    }\r\n    var border,\r\n      tsz = useTouchScrollZones ? self.attributes.touchScrollZone : 0,\r\n      moveMode = self.attributes.borderDragBehavior === 'move',\r\n      i,\r\n      l = self.visibleCells.length,\r\n      moveBorder,\r\n      xBorderBehavior = moveMode ? self.cursorGrab : 'ew-resize',\r\n      yBorderBehavior = moveMode ? self.cursorGrab : 'ns-resize',\r\n      cell,\r\n      entitiy;\r\n    if (!self.visibleCells || !self.visibleCells.length) {\r\n      return;\r\n    }\r\n    self.hasFocus = true;\r\n    if (!(y < self.height && y > 0 && x < self.width && x > 0)) {\r\n      self.hasFocus = false;\r\n      return {\r\n        dragContext: 'inherit',\r\n        context: 'inherit',\r\n      };\r\n    }\r\n    for (i = 0; i < l; i += 1) {\r\n      cell = self.visibleCells[i];\r\n      // interactive dimensions of the cell.  used for touch \"over size\" zones\r\n      entitiy = {\r\n        x: cell.x,\r\n        y: cell.y,\r\n        height: cell.height,\r\n        width: cell.width,\r\n      };\r\n      if (\r\n        useTouchScrollZones &&\r\n        /(vertical|horizontal)-scroll-/.test(cell.style)\r\n      ) {\r\n        entitiy.x -= tsz;\r\n        entitiy.y -= tsz;\r\n        entitiy.height += tsz;\r\n        entitiy.width += tsz;\r\n      }\r\n      if (\r\n        entitiy.x - self.style.cellBorderWidth < x &&\r\n        entitiy.x + entitiy.width + self.style.cellBorderWidth > x &&\r\n        entitiy.y - self.style.cellBorderWidth < y &&\r\n        entitiy.y + entitiy.height + self.style.cellBorderWidth > y\r\n      ) {\r\n        if (/frozen-row-marker/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'row-resize';\r\n          return cell;\r\n        }\r\n        if (/frozen-column-marker/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'col-resize';\r\n          return cell;\r\n        }\r\n        if (/selection-handle-/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'crosshair';\r\n          return cell;\r\n        }\r\n        if (/vertical-scroll-(bar|box)/.test(cell.style)) {\r\n          cell.dragContext = 'vertical-scroll-box';\r\n          cell.context = 'vertical-scroll-box';\r\n          cell.isScrollBar = true;\r\n          cell.isVerticalScrollBar = true;\r\n          if (y > self.scrollBox.box.v.y + self.scrollBox.scrollBoxHeight) {\r\n            cell.dragContext = 'vertical-scroll-bottom';\r\n            cell.context = 'vertical-scroll-bottom';\r\n          } else if (y < self.scrollBox.box.v.y) {\r\n            cell.dragContext = 'vertical-scroll-top';\r\n            cell.context = 'vertical-scroll-top';\r\n          }\r\n          self.cursor = 'default';\r\n          return cell;\r\n        }\r\n        if (/horizontal-scroll-(bar|box)/.test(cell.style)) {\r\n          cell.dragContext = 'horizontal-scroll-box';\r\n          cell.context = 'horizontal-scroll-box';\r\n          cell.isScrollBar = true;\r\n          cell.isHorizontalScrollBar = true;\r\n          if (x > self.scrollBox.box.h.x + self.scrollBox.scrollBoxWidth) {\r\n            cell.dragContext = 'horizontal-scroll-right';\r\n            cell.context = 'horizontal-scroll-right';\r\n          } else if (x < self.scrollBox.box.h.x) {\r\n            cell.dragContext = 'horizontal-scroll-left';\r\n            cell.context = 'horizontal-scroll-left';\r\n          }\r\n          self.cursor = 'default';\r\n          return cell;\r\n        }\r\n        border = getBorder(entitiy);\r\n        // check if the border of this cell is the border of the selection and if so show move cursor in move mode\r\n        moveBorder =\r\n          moveMode &&\r\n          cell.selectionBorder &&\r\n          cell.selectionBorder.indexOf(border) !== -1;\r\n        if (\r\n          ['l', 'r'].indexOf(border) !== -1 &&\r\n          (self.attributes.allowColumnResize || moveBorder) &&\r\n          ((self.attributes.allowColumnResizeFromCell && cell.isNormal) ||\r\n            !cell.isNormal ||\r\n            moveBorder) &&\r\n          ((self.attributes.allowRowHeaderResize &&\r\n            (cell.isRowHeader || cell.isCorner)) ||\r\n            !(cell.isRowHeader && cell.isCorner))\r\n        ) {\r\n          if (\r\n            (cell.isColumnHeader ||\r\n              cell.isCorner ||\r\n              (self.attributes.allowColumnResizeFromCell && cell.isNormal)) &&\r\n            border === 'r'\r\n          ) {\r\n            cell.context = 'ew-resize';\r\n            cell.dragContext = 'ew-resize';\r\n            return cell;\r\n          }\r\n          if (!(cell.isColumnHeader || cell.isCorner) && moveBorder) {\r\n            cell.context = xBorderBehavior;\r\n            cell.dragContext = border + '-move';\r\n            return cell;\r\n          }\r\n        }\r\n        if (\r\n          ['t', 'b'].indexOf(border) !== -1 &&\r\n          cell.rowIndex > -1 &&\r\n          (self.attributes.allowRowResize || moveBorder) &&\r\n          ((self.attributes.allowRowResizeFromCell && cell.isNormal) ||\r\n            !cell.isNormal ||\r\n            moveBorder) &&\r\n          !cell.isColumnHeader\r\n        ) {\r\n          if (\r\n            (cell.isRowHeader ||\r\n              cell.isCorner ||\r\n              (self.attributes.allowRowResizeFromCell && cell.isNormal)) &&\r\n            border === 'b'\r\n          ) {\r\n            cell.context = 'ns-resize';\r\n            cell.dragContext = 'ns-resize';\r\n            return cell;\r\n          }\r\n          if (!(cell.isRowHeader || cell.isCorner) && moveBorder) {\r\n            cell.context = yBorderBehavior;\r\n            cell.dragContext = border + '-move';\r\n            return cell;\r\n          }\r\n        }\r\n        if (cell.style === 'columnHeaderCell') {\r\n          cell.context = 'cell';\r\n          cell.dragContext = 'column-reorder';\r\n          return cell;\r\n        }\r\n        if (cell.style === 'rowHeaderCell') {\r\n          if (\r\n            self.attributes.rowGrabZoneSize +\r\n              (cell.y - self.style.cellBorderWidth) <\r\n              y ||\r\n            !self.attributes.allowRowReordering\r\n          ) {\r\n            cell.dragContext = 'cell';\r\n            cell.context = 'cell';\r\n          } else {\r\n            cell.context = self.cursorGrab;\r\n            cell.dragContext = 'row-reorder';\r\n          }\r\n          return cell;\r\n        }\r\n        if (cell.isGrid) {\r\n          self.hasFocus = false;\r\n          cell.dragContext = 'cell-grid';\r\n          cell.context = 'cell-grid';\r\n          return cell;\r\n        }\r\n        if (cell.style === 'tree-grid') {\r\n          self.hasFocus = false;\r\n          cell.dragContext = 'tree';\r\n          cell.context = 'tree';\r\n          return cell;\r\n        }\r\n        cell.dragContext = 'cell';\r\n        cell.context = 'cell';\r\n        return cell;\r\n      }\r\n    }\r\n    self.hasFocus = true;\r\n    self.cursor = 'default';\r\n    return {\r\n      dragContext: 'background',\r\n      context: 'background',\r\n      style: 'background',\r\n      isBackground: true,\r\n    };\r\n  };\r\n  /**\r\n   * Gets the bounds of current selection.\r\n   * @returns {rect} selection.\r\n   * @memberof canvasDatagrid\r\n   * @name getSelectionBounds\r\n   * @method\r\n   */\r\n  self.getSelectionBounds = function () {\r\n    var low = { x: Infinity, y: Infinity },\r\n      high = { x: -Infinity, y: -Infinity };\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      var maxCol, minCol;\r\n      low.y = rowIndex < low.y ? rowIndex : low.y;\r\n      high.y = rowIndex > high.y ? rowIndex : high.y;\r\n      maxCol = Math.max.apply(null, row);\r\n      minCol = Math.min.apply(null, row);\r\n      low.x = minCol < low.x ? minCol : low.x;\r\n      high.x = maxCol > high.x ? maxCol : high.x;\r\n    });\r\n    return {\r\n      top: low.y,\r\n      left: low.x,\r\n      bottom: high.y,\r\n      right: high.x,\r\n    };\r\n  };\r\n  /**\r\n   * Returns an auto generated schema based on data structure.\r\n   * @memberof canvasDatagrid\r\n   * @name getSchemaFromData\r\n   * @method\r\n   * @tutorial schema\r\n   * @returns {schema} schema A schema based on the first item in the data array.\r\n   */\r\n  self.getSchemaFromData = function (d) {\r\n    d = d || self.originalData;\r\n    return Object.keys(d[0] || { ' ': '' }).map(function mapEachSchemaColumn(\r\n      key,\r\n      index,\r\n    ) {\r\n      var type = self.getBestGuessDataType(key, d),\r\n        i = {\r\n          name: key,\r\n          title: isNaN(parseInt(key, 10))\r\n            ? key\r\n            : self.integerToAlpha(key).toUpperCase(),\r\n          index: index,\r\n          columnIndex: index,\r\n          type: type,\r\n          filter: self.filter(type),\r\n        };\r\n      if (\r\n        self.storedSettings &&\r\n        self.storedSettings.visibility &&\r\n        self.storedSettings.visibility[i.name] !== undefined\r\n      ) {\r\n        i.hidden = !self.storedSettings.visibility[i.name];\r\n      }\r\n      return i;\r\n    });\r\n  };\r\n  /**\r\n   * Clears the change log grid.changes that keeps track of changes to the data set.\r\n   * This does not undo changes or alter data it is simply a convince array to keep\r\n   * track of changes made to the data since last this method was called.\r\n   * @memberof canvasDatagrid\r\n   * @name clearChangeLog\r\n   * @method\r\n   */\r\n  self.clearChangeLog = function () {\r\n    self.changes = [];\r\n  };\r\n  /**\r\n   * Selects an area of the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name selectArea\r\n   * @method\r\n   * @param {rect} bounds A rect object representing the selected values.\r\n   */\r\n  self.selectArea = function (bounds, ctrl) {\r\n    self.selectionBounds = bounds || self.selectionBounds;\r\n    var ev,\r\n      x,\r\n      y,\r\n      s = self.getSchema();\r\n    if (!ctrl) {\r\n      self.selections = [];\r\n    }\r\n    if (\r\n      self.selectionBounds.top < -1 ||\r\n      self.selectionBounds.bottom > self.viewData.length ||\r\n      self.selectionBounds.left < -1 ||\r\n      self.selectionBounds.right > s.length\r\n    ) {\r\n      throw new Error('Impossible selection area');\r\n    }\r\n    for (\r\n      x = self.selectionBounds.top;\r\n      x <= self.selectionBounds.bottom;\r\n      x += 1\r\n    ) {\r\n      self.selections[x] = [];\r\n      for (\r\n        y = self.selectionBounds.left;\r\n        y <= self.selectionBounds.right;\r\n        y += 1\r\n      ) {\r\n        if (self.selections[x].indexOf(y) === -1) {\r\n          self.selections[x].push(y);\r\n        }\r\n      }\r\n    }\r\n    ev = {\r\n      selections: self.selections,\r\n      selectionBounds: self.selectionBounds,\r\n    };\r\n    Object.defineProperty(ev, 'selectedData', {\r\n      get: function () {\r\n        return self.getSelectedData();\r\n      },\r\n    });\r\n    self.dispatchEvent('selectionchanged', ev);\r\n  };\r\n  /**\r\n   * Returns the maximum text width for a given column by column name.\r\n   * @memberof canvasDatagrid\r\n   * @name findColumnMaxTextLength\r\n   * @method\r\n   * @returns {number} The number of pixels wide the maximum width value in the selected column.\r\n   * @param {string} name The name of the column to calculate the value's width of.\r\n   */\r\n  self.findColumnMaxTextLength = function (name) {\r\n    var m = -Infinity;\r\n    if (name === 'cornerCell') {\r\n      self.ctx.font = self.style.rowHeaderCellFont;\r\n      return (\r\n        self.ctx.measureText(\r\n          (\r\n            self.viewData.length + (self.attributes.showNewRow ? 1 : 0)\r\n          ).toString(),\r\n        ).width +\r\n        self.style.autosizePadding +\r\n        self.style.autosizeHeaderCellPadding +\r\n        self.style.rowHeaderCellPaddingRight +\r\n        self.style.rowHeaderCellPaddingLeft +\r\n        (self.attributes.tree\r\n          ? self.style.treeArrowWidth +\r\n            self.style.treeArrowMarginLeft +\r\n            self.style.treeArrowMarginRight\r\n          : 0)\r\n      );\r\n    }\r\n    var formatter = null;\r\n    self.getSchema().forEach(function (col) {\r\n      if (col.name !== name) {\r\n        return;\r\n      }\r\n      self.ctx.font = self.style.columnHeaderCellFont;\r\n      var t =\r\n        self.ctx.measureText(col.title || col.name).width +\r\n        self.style.headerCellPaddingRight +\r\n        self.style.headerCellPaddingLeft;\r\n      m = t > m ? t : m;\r\n      formatter = self.formatters[col.type];\r\n    });\r\n    self.viewData.forEach(function (row) {\r\n      var text = row[name];\r\n      if (formatter) {\r\n        text = formatter({ cell: { value: text } });\r\n      }\r\n      self.ctx.font = self.style.cellFont;\r\n      var t =\r\n        self.ctx.measureText(text).width +\r\n        self.style.cellPaddingRight +\r\n        self.style.cellPaddingLeft +\r\n        self.style.cellAutoResizePadding;\r\n      m = t > m ? t : m;\r\n    });\r\n    return m;\r\n  };\r\n  /**\r\n   * Gets the total width of all header columns.\r\n   * @memberof canvasDatagrid\r\n   * @name getHeaderWidth\r\n   * @method\r\n   */\r\n  self.getHeaderWidth = function () {\r\n    return self.getVisibleSchema().reduce(function (total, header) {\r\n      return total + parseInt(header.width || self.style.cellWidth, 10);\r\n    }, 0);\r\n  };\r\n  /**\r\n   * Gets the height of a row by index.\r\n   * @memberof canvasDatagrid\r\n   * @name getRowHeight\r\n   * @method\r\n   * @param {number} rowIndex The row index to lookup.\r\n   */\r\n  self.getRowHeight = function (rowIndex) {\r\n    return (self.sizes.rows[rowIndex] || self.style.cellHeight) * self.scale;\r\n  };\r\n  /**\r\n   * Gets the width of a column by index.\r\n   * @memberof canvasDatagrid\r\n   * @name getColumnWidth\r\n   * @method\r\n   * @param {number} columnIndex The column index to lookup.\r\n   */\r\n  self.getColumnWidth = function (columnIndex) {\r\n    return (\r\n      (self.sizes.columns[columnIndex] ||\r\n        self.getSchema()[columnIndex].width ||\r\n        self.style.cellWidth) * self.scale\r\n    );\r\n  };\r\n  self.formatters.string = function cellFormatterString(e) {\r\n    return e.cell.value !== undefined ? e.cell.value : '';\r\n  };\r\n  self.formatters.rowHeaderCell = self.formatters.string;\r\n  self.formatters.headerCell = self.formatters.string;\r\n  self.formatters.number = self.formatters.string;\r\n  self.formatters.int = self.formatters.string;\r\n  self.formatters.html = self.formatters.string;\r\n  self.sorters.string = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (a[columnName] === undefined || a[columnName] === null) {\r\n        return 1;\r\n      }\r\n      if (b[columnName] === undefined || b[columnName] === null) {\r\n        return 0;\r\n      }\r\n      if (asc) {\r\n        if (!a[columnName].localeCompare) {\r\n          return 1;\r\n        }\r\n        return a[columnName].localeCompare(b[columnName]);\r\n      }\r\n      if (!b[columnName].localeCompare) {\r\n        return 1;\r\n      }\r\n      return b[columnName].localeCompare(a[columnName]);\r\n    };\r\n  };\r\n  self.sorters.number = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (asc) {\r\n        return a[columnName] - b[columnName];\r\n      }\r\n      return b[columnName] - a[columnName];\r\n    };\r\n  };\r\n  self.sorters.date = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (asc) {\r\n        return (\r\n          new Date(a[columnName]).getTime() - new Date(b[columnName]).getTime()\r\n        );\r\n      }\r\n      return (\r\n        new Date(b[columnName]).getTime() - new Date(a[columnName]).getTime()\r\n      );\r\n    };\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, plusplus: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var touchTimerMs = 50,\r\n    debounceTouchMove,\r\n    touchMoving,\r\n    touchScrollTimeout;\r\n  self.scrollAnimation = {};\r\n  self.touchDelta = {};\r\n  self.touchAnimateTo = {};\r\n  self.animationFrames = 0;\r\n  self.getTouchPos = function (e, touchIndex) {\r\n    var t = touchIndex ? e.touches[touchIndex] : e.touches[0],\r\n      rect = self.canvas.getBoundingClientRect(),\r\n      pos;\r\n    if (!t) {\r\n      return;\r\n    }\r\n    pos = {\r\n      x: t.clientX - rect.left,\r\n      y: t.clientY - rect.top,\r\n    };\r\n    if (self.isChildGrid) {\r\n      pos.x -= self.canvasOffsetLeft;\r\n      pos.y -= self.canvasOffsetTop;\r\n    }\r\n    return {\r\n      x: pos.x,\r\n      y: pos.y,\r\n      rect: rect,\r\n    };\r\n  };\r\n  // shamelessly stolen from from https://gist.github.com/gre/1650294\r\n  self.easingFunctions = {\r\n    linear: function (t) {\r\n      return t;\r\n    },\r\n    easeInQuad: function (t) {\r\n      return t * t;\r\n    },\r\n    easeOutQuad: function (t) {\r\n      return t * (2 - t);\r\n    },\r\n    easeInOutQuad: function (t) {\r\n      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n    },\r\n    easeInCubic: function (t) {\r\n      return t * t * t;\r\n    },\r\n    easeOutCubic: function (t) {\r\n      return --t * t * t + 1;\r\n    },\r\n    easeInOutCubic: function (t) {\r\n      return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n    },\r\n    easeInQuart: function (t) {\r\n      return t * t * t * t;\r\n    },\r\n    easeOutQuart: function (t) {\r\n      return 1 - --t * t * t * t;\r\n    },\r\n    easeInOutQuart: function (t) {\r\n      return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\r\n    },\r\n    easeInQuint: function (t) {\r\n      return t * t * t * t * t;\r\n    },\r\n    easeOutQuint: function (t) {\r\n      return 1 + --t * t * t * t * t;\r\n    },\r\n    easeInOutQuint: function (t) {\r\n      return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\r\n    },\r\n  };\r\n  self.easing = function (t, b, c, d) {\r\n    return (\r\n      c * self.easingFunctions[self.attributes.touchEasingMethod](t / d) + b\r\n    );\r\n  };\r\n  self.calculatePPSTimed = function () {\r\n    self.xPPST = -(\r\n      (self.touchDelta.x - self.touchSigmaTimed.x) /\r\n      (self.touchDelta.t - self.touchSigmaTimed.t)\r\n    );\r\n    self.yPPST = -(\r\n      (self.touchDelta.y - self.touchSigmaTimed.y) /\r\n      (self.touchDelta.t - self.touchSigmaTimed.t)\r\n    );\r\n    self.touchSigmaTimed = {\r\n      x: self.touchDelta.x,\r\n      y: self.touchDelta.y,\r\n      t: performance.now(),\r\n    };\r\n  };\r\n  self.calculatePPS = function () {\r\n    self.xPPS = -(\r\n      (self.touchDelta.x - self.touchSigma.x) /\r\n      (self.touchDelta.t - self.touchSigma.t)\r\n    );\r\n    self.yPPS = -(\r\n      (self.touchDelta.y - self.touchSigma.y) /\r\n      (self.touchDelta.t - self.touchSigma.t)\r\n    );\r\n    self.touchSigma = {\r\n      x: self.touchDelta.x,\r\n      y: self.touchDelta.y,\r\n      t: performance.now(),\r\n    };\r\n  };\r\n  self.touchEndAnimation = function () {\r\n    if (!self.canvas || !self.scrollBox.scrollTo) {\r\n      return requestAnimationFrame(self.touchEndAnimation);\r\n    }\r\n    var n = performance.now(),\r\n      d = self.attributes.touchReleaseAnimationDurationMs,\r\n      t;\r\n    t = n - self.touchDelta.t;\r\n    self.animationFrames += 1;\r\n    self.scrollAnimation.x = self.easing(\r\n      t,\r\n      self.touchDelta.scrollLeft,\r\n      self.touchAnimateTo.x,\r\n      d,\r\n    );\r\n    self.scrollAnimation.y = self.easing(\r\n      t,\r\n      self.touchDelta.scrollTop,\r\n      self.touchAnimateTo.y,\r\n      d,\r\n    );\r\n    if (\r\n      t > d ||\r\n      (self.scrollAnimation.y === self.scrollBox.scrollTop &&\r\n        self.scrollAnimation.x === self.scrollBox.scrollLeft) ||\r\n      self.stopAnimation\r\n    ) {\r\n      return;\r\n    }\r\n    self.scrollBox.scrollTo(self.scrollAnimation.x, self.scrollAnimation.y);\r\n    requestAnimationFrame(self.touchEndAnimation);\r\n  };\r\n  self.touchEditCell = function (cell) {\r\n    self.beginEditAt(cell.columnIndex, cell.rowIndex);\r\n  };\r\n  self.touchCell = function (e) {\r\n    return function () {\r\n      clearInterval(self.calculatePPSTimer);\r\n      var i,\r\n        pos = self.getTouchPos(e);\r\n      if (\r\n        Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) <\r\n        self.attributes.touchDeadZone\r\n      ) {\r\n        i = self.getCellAt(pos.x, pos.y);\r\n        if (!i) {\r\n          return;\r\n        }\r\n        if (\r\n          self.touchingCell &&\r\n          self.touchingCell.rowIndex === i.rowIndex &&\r\n          self.touchingCell.columnIndex === i.columnIndex\r\n        ) {\r\n          self.touchEditCell(i);\r\n          return;\r\n        }\r\n        if (self.input && self.input.editCell) {\r\n          self.endEdit();\r\n        }\r\n        self.touchingCell = i;\r\n        self.selectArea({\r\n          top: i.rowIndex,\r\n          bottom: i.rowIndex,\r\n          left: i.columnIndex,\r\n          right: i.columnIndex,\r\n        });\r\n        self.draw(true);\r\n      }\r\n    };\r\n  };\r\n  self.touchstart = function (e) {\r\n    if (e.changedTouches[0]) {\r\n      self.touchStart = self.getTouchPos(e);\r\n      self.startingCell = self.getCellAt(\r\n        self.touchStart.x,\r\n        self.touchStart.y,\r\n        true,\r\n      );\r\n    }\r\n    if (\r\n      self.dispatchEvent('touchstart', {\r\n        NativeEvent: e,\r\n        cell: self.startingCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.disposeContextMenu();\r\n    clearInterval(self.calculatePPSTimer);\r\n    clearTimeout(self.touchContextTimeout);\r\n    self.touchStartEvent = e;\r\n    self.stopAnimation = true;\r\n    self.animationFrames = 0;\r\n    self.stopPropagation(e);\r\n    e.preventDefault();\r\n    if (e.touches.length === 1 && e.changedTouches[0] && !self.zoomAltered) {\r\n      self.touchLength = 1;\r\n      self.touchStart = self.touchStart || self.touchStart1;\r\n      self.touchScrollStart = {\r\n        x: self.scrollBox.scrollLeft,\r\n        y: self.scrollBox.scrollTop,\r\n        t: performance.now(),\r\n      };\r\n      self.touchDelta = {\r\n        x: 0,\r\n        y: 0,\r\n        scrollLeft: self.scrollBox.scrollLeft,\r\n        scrollTop: self.scrollBox.scrollTop,\r\n        t: self.touchScrollStart.t,\r\n      };\r\n      self.touchSigma = {\r\n        x: self.touchDelta.x,\r\n        y: self.touchDelta.y,\r\n        t: self.touchDelta.t,\r\n      };\r\n      self.touchSigmaTimed = {\r\n        x: self.touchDelta.x,\r\n        y: self.touchDelta.y,\r\n        t: self.touchDelta.t,\r\n      };\r\n      self.touchContextTimeout = setTimeout(function () {\r\n        self.contextmenuEvent(e, self.touchStart);\r\n      }, self.attributes.touchContextMenuTimeMs);\r\n      self.calculatePPSTimer = setInterval(\r\n        self.calculatePPSTimed,\r\n        touchTimerMs,\r\n      );\r\n      if (\r\n        self.startingCell &&\r\n        (self.startingCell.isGrid ||\r\n          ['tree', 'inherit'].indexOf(self.startingCell.context) !== -1)\r\n      ) {\r\n        self.hasFocus = false;\r\n        return;\r\n      }\r\n      self.hasFocus = true;\r\n      if (self.startingCell.isHeader) {\r\n        if (self.startingCell.isRowHeader) {\r\n          self.selectArea({\r\n            top: self.startingCell.rowIndex,\r\n            bottom: self.startingCell.rowIndex,\r\n            left: 0,\r\n            right: self.getVisibleSchema().length - 1,\r\n          });\r\n          self.draw(true);\r\n        } else if (self.startingCell.isColumnHeader) {\r\n          if (self.attributes.columnHeaderClickBehavior === 'sort') {\r\n            if (self.orderBy === self.startingCell.header.name) {\r\n              self.orderDirection =\r\n                self.orderDirection === 'asc' ? 'desc' : 'asc';\r\n            } else {\r\n              self.orderDirection = 'asc';\r\n            }\r\n            self.order(self.startingCell.header.name, self.orderDirection);\r\n          }\r\n          if (self.attributes.columnHeaderClickBehavior === 'select') {\r\n            self.selectArea({\r\n              top: 0,\r\n              bottom: self.viewData.length - 1,\r\n              left: self.startingCell.columnIndex,\r\n              right: self.startingCell.columnIndex,\r\n            });\r\n            self.draw(true);\r\n          }\r\n        }\r\n        self.touchEndEvents(e);\r\n        return;\r\n      }\r\n    }\r\n    if (self.zoomAltered) {\r\n      return;\r\n    }\r\n    document.body.addEventListener('touchmove', self.touchmove, {\r\n      passive: false,\r\n    });\r\n    document.body.addEventListener('touchend', self.touchend, false);\r\n    document.body.addEventListener('touchcancel', self.touchcancel, false);\r\n    self.draw(true);\r\n  };\r\n  self.touchSelect = function (cell, handleType) {\r\n    if (cell.rowIndex === undefined || cell.columnIndex === undefined) {\r\n      return;\r\n    }\r\n    self.touchSelecting = true;\r\n    var bounds = self.getSelectionBounds();\r\n    if (\r\n      handleType === 'selection-handle-bl' &&\r\n      cell.rowIndex >= bounds.top &&\r\n      cell.columnIndex <= bounds.right\r\n    ) {\r\n      bounds.bottom = cell.rowIndex;\r\n      bounds.left = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-tl' &&\r\n      cell.rowIndex <= bounds.bottom &&\r\n      cell.columnIndex <= bounds.right\r\n    ) {\r\n      bounds.top = cell.rowIndex;\r\n      bounds.left = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-tr' &&\r\n      cell.rowIndex <= bounds.bottom &&\r\n      cell.columnIndex >= bounds.left\r\n    ) {\r\n      bounds.top = cell.rowIndex;\r\n      bounds.right = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-br' &&\r\n      cell.rowIndex >= bounds.top &&\r\n      cell.columnIndex >= bounds.left\r\n    ) {\r\n      bounds.bottom = cell.rowIndex;\r\n      bounds.right = cell.columnIndex;\r\n    }\r\n    if (self.attributes.selectionMode === 'row' || cell.rowIndex === -1) {\r\n      bounds.left = 0;\r\n      bounds.right = self.getSchema().length - 1;\r\n    } else {\r\n      bounds.left = Math.max(0, bounds.left);\r\n    }\r\n    self.selectArea(bounds);\r\n    self.draw(true);\r\n  };\r\n  function touchMove(e) {\r\n    var ch, rw, rScrollZone, lScrollZone, bScrollZone, tScrollZone, sbw, t1, t2;\r\n    if (self.dispatchEvent('beforetouchmove', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    clearTimeout(touchScrollTimeout);\r\n    if (e.changedTouches[0]) {\r\n      self.touchPosition = self.getTouchPos(e);\r\n    }\r\n    if (e.changedTouches[1]) {\r\n      self.touchPosition1 = self.getTouchPos(e, 1);\r\n    }\r\n    if (\r\n      Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) >\r\n      self.attributes.touchDeadZone\r\n    ) {\r\n      clearTimeout(self.touchContextTimeout);\r\n    }\r\n    if (e.touches.length === 2 && self.touchPosition && self.touchPosition1) {\r\n      t1 = self.touchPosition.y;\r\n      t2 = self.touchPosition1.y;\r\n      if (!self.zoomDeltaStart) {\r\n        self.zoomDeltaStart = Math.abs(t1 - t2);\r\n        self.startScale = self.scale;\r\n      }\r\n      self.touchLength = 2;\r\n      self.scaleDelta = self.zoomDeltaStart - Math.abs(t1 - t2);\r\n      self.scale =\r\n        self.startScale -\r\n        self.scaleDelta * self.attributes.touchZoomSensitivity;\r\n      self.scale = Math.min(\r\n        Math.max(self.scale, self.attributes.touchZoomMin),\r\n        self.attributes.touchZoomMax,\r\n      );\r\n      self.zoomAltered = true;\r\n      self.resize(true);\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    if (self.zoomAltered) {\r\n      return;\r\n    }\r\n    self.touchLength = 1;\r\n    self.touchPosition = self.touchPosition || self.touchPosition1;\r\n    ch = self.getColumnHeaderCellHeight();\r\n    rw = self.getRowHeaderCellWidth();\r\n    rScrollZone =\r\n      self.width - self.style.scrollBarWidth - self.touchPosition.x <\r\n      self.attributes.selectionScrollZone;\r\n    lScrollZone =\r\n      self.touchPosition.x - rw < self.attributes.selectionScrollZone;\r\n    bScrollZone =\r\n      self.height - self.style.scrollBarWidth - self.touchPosition.y <\r\n      self.attributes.selectionScrollZone;\r\n    tScrollZone =\r\n      self.touchPosition.y - ch < self.attributes.selectionScrollZone;\r\n    sbw = self.style.scrollBarWidth;\r\n    function touchScroll() {\r\n      var x = self.scrollBox.scrollLeft,\r\n        y = self.scrollBox.scrollTop;\r\n      x += rScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      y += bScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      y -= tScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      x -= lScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      self.scrollBox.scrollTo(x, y);\r\n      touchScrollTimeout = setTimeout(\r\n        touchScroll,\r\n        self.attributes.scrollRepeatRate,\r\n      );\r\n    }\r\n    e.stopPropagation();\r\n    self.touchDelta = {\r\n      x: self.touchPosition.x - self.touchStart.x,\r\n      y: self.touchPosition.y - self.touchStart.y,\r\n      scrollLeft: self.scrollBox.scrollLeft,\r\n      scrollTop: self.scrollBox.scrollTop,\r\n      t: performance.now(),\r\n    };\r\n    self.currentCell = self.getCellAt(\r\n      self.touchPosition.x,\r\n      self.touchPosition.y,\r\n    );\r\n    self.dispatchEvent('touchmove', { NativeEvent: e, cell: self.currentCell });\r\n    self.calculatePPS();\r\n    self.touchDuration = performance.now() - self.touchScrollStart.t;\r\n    self.stopAnimation = true;\r\n    self.animationFrames = 0;\r\n    if (\r\n      self.touchSelecting &&\r\n      (rScrollZone || lScrollZone || tScrollZone || bScrollZone)\r\n    ) {\r\n      touchScroll();\r\n    }\r\n    if (/vertical-scroll-/.test(self.startingCell.style)) {\r\n      self.scrollBox.scrollTop =\r\n        self.scrollBox.scrollHeight *\r\n        ((self.touchPosition.y - ch - sbw) /\r\n          (self.scrollBox.height - sbw - ch));\r\n      return;\r\n    }\r\n    if (/horizontal-scroll-/.test(self.startingCell.style)) {\r\n      self.scrollBox.scrollLeft =\r\n        self.scrollBox.scrollWidth *\r\n        ((self.touchPosition.x - rw - sbw) / (self.scrollBox.width - sbw - rw));\r\n      return;\r\n    }\r\n    if (/selection-handle-/.test(self.startingCell.style)) {\r\n      self.touchSelect(self.currentCell, self.startingCell.style);\r\n      return;\r\n    }\r\n    self.scrollBox.scrollTo(\r\n      self.touchScrollStart.x - self.touchDelta.x,\r\n      self.touchScrollStart.y - self.touchDelta.y,\r\n    );\r\n  }\r\n  self.touchmove = function (e) {\r\n    if (touchMoving) {\r\n      return;\r\n    }\r\n    requestAnimationFrame(function () {\r\n      touchMoving = true;\r\n      touchMove(e);\r\n      touchMoving = false;\r\n    });\r\n  };\r\n  self.touchEndEvents = function (e) {\r\n    self.zoomDeltaStart = undefined;\r\n    self.touchSelecting = false;\r\n    clearInterval(self.touchScrollTimeout);\r\n    clearInterval(self.touchContextTimeout);\r\n    clearInterval(self.calculatePPSTimer);\r\n    e.stopPropagation();\r\n    document.body.removeEventListener('touchmove', self.touchmove, {\r\n      passive: false,\r\n    });\r\n    document.body.removeEventListener('touchend', self.touchend, false);\r\n    document.body.removeEventListener('touchcancel', self.touchcancel, false);\r\n  };\r\n  self.touchend = function (e) {\r\n    if (\r\n      self.dispatchEvent('touchend', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    self.zoomDeltaStart = undefined;\r\n    if (e.changedTouches[0]) {\r\n      self.touchPosition = undefined;\r\n    }\r\n    if (e.changedTouches[1]) {\r\n      self.touchPosition1 = undefined;\r\n    }\r\n    if (self.zoomAltered) {\r\n      if (e.touches.length === 0) {\r\n        self.zoomAltered = false;\r\n      }\r\n      return;\r\n    }\r\n    var dz =\r\n      Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) <\r\n      self.attributes.touchDeadZone;\r\n    if (isNaN(self.xPPS)) {\r\n      self.xPPS = 0;\r\n    }\r\n    if (isNaN(self.yPPS)) {\r\n      self.yPPS = 0;\r\n    }\r\n    if (isNaN(self.xPPST)) {\r\n      self.xPPST = 0;\r\n    }\r\n    if (isNaN(self.yPPST)) {\r\n      self.yPPST = 0;\r\n    }\r\n    self.touchAnimateTo.x =\r\n      self.xPPS * self.attributes.touchReleaseAcceleration;\r\n    self.touchAnimateTo.y =\r\n      self.yPPS * self.attributes.touchReleaseAcceleration;\r\n    self.calculatePPSTimed();\r\n    if (dz && !self.contextMenu) {\r\n      self.touchCell(self.touchStartEvent)();\r\n    } else if (\r\n      self.animationFrames === 0 &&\r\n      (Math.abs(self.xPPST) > self.attributes.scrollAnimationPPSThreshold ||\r\n        Math.abs(self.yPPST) > self.attributes.scrollAnimationPPSThreshold) &&\r\n      !/-scroll-/.test(self.startingCell.style) &&\r\n      !dz\r\n    ) {\r\n      self.stopAnimation = false;\r\n      self.touchEndAnimation();\r\n    }\r\n    self.touchEndEvents(e);\r\n  };\r\n  self.touchcancel = function (e) {\r\n    if (\r\n      self.dispatchEvent('touchcancel', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.touchEndEvents(e);\r\n  };\r\n}\r\n","module.exports=function(e){var o={};function a(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=o,a.d=function(e,o,t){a.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,o){if(1&o&&(e=a(e)),8&o)return e;if(4&o&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&o&&\"string\"!=typeof e)for(var r in e)a.d(t,r,function(o){return e[o]}.bind(null,r));return t},a.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(o,\"a\",o),o},a.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},a.p=\"\",a(a.s=0)}([function(e,o,a){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});var t=a(1),r=Object.keys(t.default).reduce((function(e,o){return e.concat(t.default[o])}),[]);o.default=function(e){return-1===r.indexOf(e.key)}},function(e,o,a){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});o.default={modifier:[\"Alt\",\"AltGraph\",\"CapsLock\",\"Control\",\"Fn\",\"FnLock\",\"Meta\",\"NumLock\",\"ScrollLock\",\"Shift\",\"Symbol\",\"SymbolLock\"],legacyModifier:[\"Hyper\",\"Super\"],whiteSpace:[\"Enter\",\"Tab\"],navigation:[\"ArrowDown\",\"ArrowLeft\",\"ArrowRight\",\"ArrowUp\",\"End\",\"Home\",\"PageDown\",\"PageUp\"],editing:[\"Backspace\",\"Clear\",\"Copy\",\"CrSel\",\"Cut\",\"Delete\",\"EraseEof\",\"ExSel\",\"Insert\",\"Paste\",\"Redo\",\"Undo\"],ui:[\"Accept\",\"Again\",\"Attn\",\"Cancel\",\"ContextMenu\",\"Escape\",\"Execute\",\"Find\",\"Help\",\"Pause\",\"Play\",\"Props\",\"Select\",\"ZoomIn\",\"ZoomOut\"],device:[\"BrightnessDown\",\"BrightnessUp\",\"Eject\",\"LogOff\",\"Power\",\"PowerOff\",\"PrintScreen\",\"Hibernate\",\"Standby\",\"WakeUp\"],imeCompositionKeys:[\"AllCandidates\",\"Alphanumeric\",\"CodeInput\",\"Compose\",\"Convert\",\"Dead\",\"FinalMode\",\"GroupFirst\",\"GroupLast\",\"GroupNext\",\"GroupPrevious\",\"ModeChange\",\"NextCandidate\",\"NonConvert\",\"PreviousCandidate\",\"Process\",\"SingleCandidate\"],koreanSpecific:[\"HangulMode\",\"HanjaMode\",\"JunjaMode\"],japaneseSpecific:[\"Eisu\",\"Hankaku\",\"Hiragana\",\"HiraganaKatakana\",\"KanaMode\",\"KanjiMode\",\"Katakana\",\"Romaji\",\"Zenkaku\",\"ZenkakuHankaku\"],commonFunction:[\"F1\",\"F2\",\"F3\",\"F4\",\"F5\",\"F6\",\"F7\",\"F8\",\"F9\",\"F10\",\"F11\",\"F12\",\"Soft1\",\"Soft2\",\"Soft3\",\"Soft4\"],multimedia:[\"ChannelDown\",\"ChannelUp\",\"Close\",\"MailForward\",\"MailReply\",\"MailSend\",\"MediaClose\",\"MediaFastForward\",\"MediaPause\",\"MediaPlay\",\"MediaPlayPause\",\"MediaRecord\",\"MediaRewind\",\"MediaStop\",\"MediaTrackNext\",\"MediaTrackPrevious\",\"New\",\"Open\",\"Print\",\"Save\",\"SpellCheck\"],multimediaNumpad:[\"Key11\",\"Key12\"],audio:[\"AudioBalanceLeft\",\"AudioBalanceRight\",\"AudioBassBoostDown\",\"AudioBassBoostToggle\",\"AudioBassBoostUp\",\"AudioFaderFront\",\"AudioFaderRear\",\"AudioSurroundModeNext\",\"AudioTrebleDown\",\"AudioTrebleUp\",\"AudioVolumeDown\",\"AudioVolumeUp\",\"AudioVolumeMute\",\"MicrophoneToggle\",\"MicrophoneVolumeDown\",\"MicrophoneVolumeUp\",\"MicrophoneVolumeMute\"],speech:[\"SpeechCorrectionList\",\"SpeechInputToggle\"],application:[\"LaunchApplication1\",\"LaunchApplication2\",\"LaunchCalendar\",\"LaunchContacts\",\"LaunchMail\",\"LaunchMediaPlayer\",\"LaunchMusicPlayer\",\"LaunchPhone\",\"LaunchScreenSaver\",\"LaunchSpreadsheet\",\"LaunchWebBrowser\",\"LaunchWebCam\",\"LaunchWordProcessor\"],browser:[\"BrowserBack\",\"BrowserFavorites\",\"BrowserForward\",\"BrowserHome\",\"BrowserRefresh\",\"BrowserSearch\",\"BrowserStop\"],mobilePhone:[\"AppSwitch\",\"Call\",\"Camera\",\"CameraFocus\",\"EndCall\",\"GoBack\",\"GoHome\",\"HeadsetHook\",\"LastNumberRedial\",\"Notification\",\"MannerMode\",\"VoiceDial\"],tv:[\"TV\",\"TV3DMode\",\"TVAntennaCable\",\"TVAudioDescription\",\"TVAudioDescriptionMixDown\",\"TVAudioDescriptionMixUp\",\"TVContentsMenu\",\"TVDataService\",\"TVInput\",\"TVInputComponent1\",\"TVInputComponent2\",\"TVInputComposite1\",\"TVInputComposite2\",\"TVInputHDMI1\",\"TVInputHDMI2\",\"TVInputHDMI3\",\"TVInputHDMI4\",\"TVInputVGA1\",\"TVMediaContext\",\"TVNetwork\",\"TVNumberEntry\",\"TVPower\",\"TVRadioService\",\"TVSatellite\",\"TVSatelliteBS\",\"TVSatelliteCS\",\"TVSatelliteToggle\",\"TVTerrestrialAnalog\",\"TVTerrestrialDigital\",\"TVTimer\"],mediaControls:[\"AVRInput\",\"AVRPower\",\"ColorF0Red\",\"ColorF1Green\",\"ColorF2Yellow\",\"ColorF3Blue\",\"ColorF4Grey\",\"ColorF5Brown\",\"ClosedCaptionToggle\",\"Dimmer\",\"DisplaySwap\",\"DVR\",\"Exit\",\"FavoriteClear0\",\"FavoriteClear1\",\"FavoriteClear2\",\"FavoriteClear3\",\"FavoriteRecall0\",\"FavoriteRecall1\",\"FavoriteRecall2\",\"FavoriteRecall3\",\"FavoriteStore0\",\"FavoriteStore1\",\"FavoriteStore2\",\"FavoriteStore3\",\"Guide\",\"GuideNextDay\",\"GuidePreviousDay\",\"Info\",\"InstantReplay\",\"Link\",\"ListProgram\",\"LiveContent\",\"Lock\",\"MediaApps\",\"MediaAudioTrack\",\"MediaLast\",\"MediaSkipBackward\",\"MediaSkipForward\",\"MediaStepBackward\",\"MediaStepForward\",\"MediaTopMenu\",\"NavigateIn\",\"NavigateNext\",\"NavigateOut\",\"NavigatePrevious\",\"NextFavoriteChannel\",\"NextUserProfile\",\"OnDemand\",\"Pairing\",\"PinPDown\",\"PinPMove\",\"PinPToggle\",\"PinPUp\",\"PlaySpeedDown\",\"PlaySpeedReset\",\"PlaySpeedUp\",\"RandomToggle\",\"RcLowBattery\",\"RecordSpeedNext\",\"RfBypass\",\"ScanChannelsToggle\",\"ScreenModeNext\",\"Settings\",\"SplitScreenToggle\",\"STBInput\",\"STBPower\",\"Subtitle\",\"Teletext\",\"VideoModeNext\",\"Wink\",\"ZoomToggle\"]}}]).default;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(\"./lib/main.js\");\n"],"sourceRoot":""}