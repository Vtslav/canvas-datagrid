{"version":3,"file":"canvas-datagrid.module.js","sources":["../lib/defaults.js","../lib/component.js","../lib/draw.js","../node_modules/is-printable-key-event/dist/index.js","../lib/events.js","../lib/touch.js","../lib/intf.js","../lib/contextMenu.js","../lib/dom.js","../lib/publicMethods.js","../lib/main.js"],"sourcesContent":["/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n\r\n'use strict';\r\nexport default function (self) {\r\n  self.defaults = {\r\n    attributes: [\r\n      ['allowColumnReordering', true],\r\n      ['allowColumnResize', true],\r\n      ['allowColumnResizeFromCell', false],\r\n      ['allowFreezingRows', false],\r\n      ['allowFreezingColumns', false],\r\n      ['allowMovingSelection', true],\r\n      ['allowRowHeaderResize', true],\r\n      ['allowRowReordering', false],\r\n      ['allowRowResize', true],\r\n      ['allowRowResizeFromCell', false],\r\n      ['allowSorting', true],\r\n      ['autoGenerateSchema', false],\r\n      ['autoResizeColumns', false],\r\n      ['autoResizeRows', false],\r\n      ['blanksText', '(Blanks)'],\r\n      ['borderDragBehavior', 'none'],\r\n      ['borderResizeZone', 10],\r\n      ['clearSettingsOptionText', 'Clear saved settings'],\r\n      ['columnHeaderClickBehavior', 'sort'],\r\n      ['columnSelectorHiddenText', '&nbsp;&nbsp;&nbsp;'],\r\n      ['columnSelectorText', 'Add/Remove columns'],\r\n      ['columnSelectorVisibleText', '\\u2713'],\r\n      ['contextHoverScrollAmount', 2],\r\n      ['contextHoverScrollRateMs', 5],\r\n      ['copyHeadersOnSelectAll', true],\r\n      ['copyText', 'Copy'],\r\n      ['debug', false],\r\n      ['editable', true],\r\n      ['ellipsisText', '...'],\r\n      ['filterOptionText', 'Filter %s'],\r\n      ['filterTextPrefix', '(filtered) '],\r\n      ['globalRowResize', false],\r\n      ['hideColumnText', 'Hide %s'],\r\n      ['hoverMode', 'cell'],\r\n      ['maxAutoCompleteItems', 200],\r\n      ['multiLine', false],\r\n      ['name', ''],\r\n      ['pageUpDownOverlap', 1],\r\n      ['pasteText', 'Paste'],\r\n      ['persistantSelectionMode', false],\r\n      ['removeFilterOptionText', 'Remove filter on %s'],\r\n      ['reorderDeadZone', 3],\r\n      ['resizeScrollZone', 20],\r\n      ['rowGrabZoneSize', 5],\r\n      ['saveAppearance', true],\r\n      ['scrollAnimationPPSThreshold', 0.75],\r\n      ['scrollPointerLock', false],\r\n      ['scrollRepeatRate', 75],\r\n      ['selectionFollowsActiveCell', false],\r\n      ['selectionHandleBehavior', 'none'],\r\n      ['selectionMode', 'cell'],\r\n      ['selectionScrollIncrement', 20],\r\n      ['selectionScrollZone', 20],\r\n      ['showClearSettingsOption', true],\r\n      ['showColumnHeaders', true],\r\n      ['showColumnSelector', true],\r\n      ['showCopy', false],\r\n      ['showFilter', true],\r\n      ['showNewRow', false],\r\n      ['showOrderByOption', true],\r\n      ['showOrderByOptionTextAsc', 'Order by %s ascending'],\r\n      ['showOrderByOptionTextDesc', 'Order by %s descending'],\r\n      ['showPaste', false],\r\n      ['showPerformance', false],\r\n      ['showRowHeaders', true],\r\n      ['showRowNumbers', true],\r\n      ['showRowNumberGaps', true],\r\n      ['singleSelectionMode', false],\r\n      ['snapToRow', false],\r\n      ['touchContextMenuTimeMs', 800],\r\n      ['touchDeadZone', 3],\r\n      ['touchEasingMethod', 'easeOutQuad'],\r\n      ['touchReleaseAcceleration', 1000],\r\n      ['touchReleaseAnimationDurationMs', 2000],\r\n      ['touchScrollZone', 20],\r\n      ['touchSelectHandleZone', 20],\r\n      ['touchZoomSensitivity', 0.005],\r\n      ['touchZoomMin', 0.5],\r\n      ['touchZoomMax', 1.75],\r\n      ['maxPixelRatio', 2],\r\n      ['tree', false],\r\n      ['treeHorizontalScroll', false],\r\n    ],\r\n    styles: [\r\n      ['activeCellBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['activeCellBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['activeCellBorderWidth', 1],\r\n      ['activeCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellFont', '16px sans-serif'],\r\n      ['activeCellHoverBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['activeCellHorizontalAlignment', 'left'],\r\n      ['activeCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['activeCellOverlayBorderWidth', 1],\r\n      ['activeCellPaddingBottom', 5],\r\n      ['activeCellPaddingLeft', 5],\r\n      ['activeCellPaddingRight', 5],\r\n      ['activeCellPaddingTop', 5],\r\n      ['activeCellSelectedBackgroundColor', 'rgba(236, 243, 255, 1)'],\r\n      ['activeCellSelectedColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeCellVerticalAlignment', 'center'],\r\n      ['activeColumnHeaderCellBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['activeColumnHeaderCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['activeRowHeaderCellBackgroundColor', 'rgba(225, 225, 225, 1)'],\r\n      ['activeRowHeaderCellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['autocompleteBottomMargin', 60],\r\n      ['autosizeHeaderCellPadding', 8],\r\n      ['autosizePadding', 5],\r\n      ['cellAutoResizePadding', 13],\r\n      ['cellBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['cellBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['cellBorderWidth', 1],\r\n      ['cellColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellFont', '16px sans-serif'],\r\n      ['cellGridHeight', 250],\r\n      ['cellHeight', 24],\r\n      ['cellHeightWithChildGrid', 150],\r\n      ['cellHorizontalAlignment', 'left'],\r\n      ['cellHoverBackgroundColor', 'rgba(255, 255, 255, 1)'],\r\n      ['cellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellPaddingBottom', 5],\r\n      ['cellPaddingLeft', 5],\r\n      ['cellPaddingRight', 5],\r\n      ['cellPaddingTop', 5],\r\n      ['cellSelectedBackgroundColor', 'rgba(236, 243, 255, 1)'],\r\n      ['cellSelectedColor', 'rgba(0, 0, 0, 1)'],\r\n      ['cellVerticalAlignment', 'center'],\r\n      ['cellWidth', 250],\r\n      ['cellWidthWithChildGrid', 250],\r\n      ['cellWhiteSpace', 'nowrap'],\r\n      ['cellLineHeight', 1],\r\n      ['cellLineSpacing', 3],\r\n      ['childContextMenuArrowColor', 'rgba(43, 48, 43, 1)'],\r\n      ['childContextMenuArrowHTML', '&#x25BA;'],\r\n      ['childContextMenuMarginLeft', -11],\r\n      ['childContextMenuMarginTop', -6],\r\n      ['columnHeaderCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['columnHeaderCellBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['columnHeaderCellBorderWidth', 1],\r\n      ['columnHeaderCellCapBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['columnHeaderCellCapBorderColor', 'rgba(172, 172, 172, 1)'],\r\n      ['columnHeaderCellCapBorderWidth', 1],\r\n      ['columnHeaderCellColor', 'rgba(50, 50, 50, 1)'],\r\n      ['columnHeaderCellFont', '16px sans-serif'],\r\n      ['columnHeaderCellHeight', 25],\r\n      ['columnHeaderCellHorizontalAlignment', 'left'],\r\n      ['columnHeaderCellHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['columnHeaderCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['columnHeaderCellPaddingBottom', 5],\r\n      ['columnHeaderCellPaddingLeft', 5],\r\n      ['columnHeaderCellPaddingRight', 5],\r\n      ['columnHeaderCellPaddingTop', 5],\r\n      ['columnHeaderCellVerticalAlignment', 'center'],\r\n      ['columnHeaderOrderByArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['columnHeaderOrderByArrowBorderWidth', 1],\r\n      ['columnHeaderOrderByArrowColor', 'rgba(155, 155, 155, 1)'],\r\n      ['columnHeaderOrderByArrowHeight', 8],\r\n      ['columnHeaderOrderByArrowMarginLeft', 0],\r\n      ['columnHeaderOrderByArrowMarginRight', 5],\r\n      ['columnHeaderOrderByArrowMarginTop', 6],\r\n      ['columnHeaderOrderByArrowWidth', 13],\r\n      ['contextFilterButtonBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextFilterButtonBorderRadius', '3px'],\r\n      ['contextFilterButtonHTML', '&#x25BC;'],\r\n      ['contextFilterInputBackground', 'rgba(255,255,255,1)'],\r\n      ['contextFilterInputBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextFilterInputBorderRadius', '0'],\r\n      ['contextFilterInputColor', 'rgba(0,0,0,1)'],\r\n      ['contextFilterInputFontFamily', 'sans-serif'],\r\n      ['contextFilterInputFontSize', '14px'],\r\n      ['contextFilterInvalidRegExpBackground', 'rgba(180, 6, 1, 1)'],\r\n      ['contextFilterInvalidRegExpColor', 'rgba(255, 255, 255, 1)'],\r\n      ['contextMenuArrowColor', 'rgba(43, 48, 43, 1)'],\r\n      ['contextMenuArrowDownHTML', '&#x25BC;'],\r\n      ['contextMenuArrowUpHTML', '&#x25B2;'],\r\n      ['contextMenuBackground', 'rgba(240, 240, 240, 1)'],\r\n      ['contextMenuBorder', 'solid 1px rgba(158, 163, 169, 1)'],\r\n      ['contextMenuBorderRadius', '3px'],\r\n      ['contextMenuChildArrowFontSize', '12px'],\r\n      ['contextMenuColor', 'rgba(43, 48, 43, 1)'],\r\n      ['contextMenuCursor', 'default'],\r\n      ['contextMenuFilterButtonFontFamily', 'sans-serif'],\r\n      ['contextMenuFilterButtonFontSize', '10px'],\r\n      ['contextMenuFilterInvalidExpresion', 'rgba(237, 155, 156, 1)'],\r\n      ['contextMenuFontFamily', 'sans-serif'],\r\n      ['contextMenuFontSize', '16px'],\r\n      ['contextMenuHoverBackground', 'rgba(182, 205, 250, 1)'],\r\n      ['contextMenuHoverColor', 'rgba(43, 48, 153, 1)'],\r\n      ['contextMenuItemBorderRadius', '3px'],\r\n      ['contextMenuItemMargin', '2px'],\r\n      ['contextMenuLabelDisplay', 'inline-block'],\r\n      ['contextMenuLabelMargin', '0 3px 0 0'],\r\n      ['contextMenuLabelMaxWidth', '700px'],\r\n      ['contextMenuLabelMinWidth', '75px'],\r\n      ['contextMenuMarginLeft', 3],\r\n      ['contextMenuMarginTop', -3],\r\n      ['contextMenuOpacity', '0.98'],\r\n      ['contextMenuPadding', '2px'],\r\n      ['contextMenuWindowMargin', 30],\r\n      ['contextMenuZIndex', 10000],\r\n      ['cornerCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['cornerCellBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['debugBackgroundColor', 'rgba(0, 0, 0, .0)'],\r\n      ['debugColor', 'rgba(255, 15, 24, 1)'],\r\n      ['debugEntitiesColor', 'rgba(76, 231, 239, 1.00)'],\r\n      ['debugFont', '11px sans-serif'],\r\n      ['debugPerfChartBackground', 'rgba(29, 25, 26, 1.00)'],\r\n      ['debugPerfChartTextColor', 'rgba(255, 255, 255, 0.8)'],\r\n      ['debugPerformanceColor', 'rgba(252, 255, 37, 1.00)'],\r\n      ['debugScrollHeightColor', 'rgba(248, 33, 103, 1.00)'],\r\n      ['debugScrollWidthColor', 'rgba(66, 255, 27, 1.00)'],\r\n      ['debugTouchPPSXColor', 'rgba(246, 102, 24, 1.00)'],\r\n      ['debugTouchPPSYColor', 'rgba(186, 0, 255, 1.00)'],\r\n      ['display', 'inline-block'],\r\n      ['editCellBackgroundColor', 'white'],\r\n      ['editCellBorder', 'solid 1px rgba(110, 168, 255, 1)'],\r\n      ['editCellBoxShadow', '0 2px 5px rgba(0,0,0,0.4)'],\r\n      ['editCellColor', 'black'],\r\n      ['editCellFontFamily', 'sans-serif'],\r\n      ['editCellFontSize', '16px'],\r\n      ['editCellPaddingLeft', 4],\r\n      ['editCellZIndex', 10000],\r\n      ['frozenMarkerHoverColor', 'rgba(236, 243, 255, 1)'],\r\n      ['frozenMarkerHoverBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['frozenMarkerActiveColor', 'rgba(236, 243, 255, 1)'],\r\n      ['frozenMarkerActiveBorderColor', 'rgba(110, 168, 255, 1)'],\r\n      ['frozenMarkerColor', 'rgba(222, 222, 222, 1)'],\r\n      ['frozenMarkerBorderColor', 'rgba(168, 168, 168, 1)'],\r\n      ['frozenMarkerBorderWidth', 1],\r\n      ['frozenMarkerWidth', 2],\r\n      ['gridBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['gridBorderCollapse', 'collapse'],\r\n      ['gridBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['gridBorderWidth', 1],\r\n      ['height', 'auto'],\r\n      ['maxHeight', 'inherit'],\r\n      ['maxWidth', 'inherit'],\r\n      ['minColumnWidth', 45],\r\n      ['minHeight', 'inherit'],\r\n      ['minRowHeight', 24],\r\n      ['minWidth', 'inherit'],\r\n      ['mobileContextMenuMargin', 10],\r\n      ['mobileEditInputHeight', 30],\r\n      ['mobileEditFontFamily', 'sans-serif'],\r\n      ['mobileEditFontSize', '16px'],\r\n      ['moveOverlayBorderWidth', 1],\r\n      ['moveOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['moveOverlayBorderSegments', '12, 7'],\r\n      ['name', 'default'],\r\n      ['overflowY', 'auto'],\r\n      ['overflowX', 'auto'],\r\n      ['reorderMarkerBackgroundColor', 'rgba(0, 0, 0, 0.1)'],\r\n      ['reorderMarkerBorderColor', 'rgba(0, 0, 0, 0.2)'],\r\n      ['reorderMarkerBorderWidth', 1.25],\r\n      ['reorderMarkerIndexBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['reorderMarkerIndexBorderWidth', 2.75],\r\n      ['rowHeaderCellBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['rowHeaderCellBorderColor', 'rgba(200, 200, 200, 1)'],\r\n      ['rowHeaderCellBorderWidth', 1],\r\n      ['rowHeaderCellColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellFont', '16px sans-serif'],\r\n      ['rowHeaderCellHeight', 25],\r\n      ['rowHeaderCellHorizontalAlignment', 'left'],\r\n      ['rowHeaderCellHoverBackgroundColor', 'rgba(235, 235, 235, 1)'],\r\n      ['rowHeaderCellHoverColor', 'rgba(0, 0, 0, 1)'],\r\n      ['rowHeaderCellPaddingBottom', 5],\r\n      ['rowHeaderCellPaddingLeft', 5],\r\n      ['rowHeaderCellPaddingRight', 5],\r\n      ['rowHeaderCellPaddingTop', 5],\r\n      ['rowHeaderCellRowNumberGapHeight', 5],\r\n      ['rowHeaderCellRowNumberGapColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellSelectedBackgroundColor', 'rgba(217, 217, 217, 1)'],\r\n      ['rowHeaderCellSelectedColor', 'rgba(50, 50, 50, 1)'],\r\n      ['rowHeaderCellVerticalAlignment', 'center'],\r\n      ['rowHeaderCellWidth', 57],\r\n      ['scrollBarActiveColor', 'rgba(125, 125, 125, 1)'],\r\n      ['scrollBarBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['scrollBarBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['scrollBarBorderWidth', 0.5],\r\n      ['scrollBarBoxBorderRadius', 4.125],\r\n      ['scrollBarBoxColor', 'rgba(192, 192, 192, 1)'],\r\n      ['scrollBarBoxMargin', 2],\r\n      ['scrollBarBoxMinSize', 15],\r\n      ['scrollBarBoxWidth', 8],\r\n      ['scrollBarCornerBackgroundColor', 'rgba(240, 240, 240, 1)'],\r\n      ['scrollBarCornerBorderColor', 'rgba(202, 202, 202, 1)'],\r\n      ['scrollBarWidth', 11],\r\n      ['selectionHandleBorderColor', 'rgba(255, 255, 255, 1)'],\r\n      ['selectionHandleBorderWidth', 1.5],\r\n      ['selectionHandleColor', 'rgba(66, 133, 244, 1)'],\r\n      ['selectionHandleSize', 8],\r\n      ['selectionHandleType', 'square'],\r\n      ['selectionOverlayBorderColor', 'rgba(66, 133, 244, 1)'],\r\n      ['selectionOverlayBorderWidth', 1],\r\n      ['treeArrowBorderColor', 'rgba(195, 199, 202, 1)'],\r\n      ['treeArrowBorderWidth', 1],\r\n      ['treeArrowClickRadius', 5],\r\n      ['treeArrowColor', 'rgba(155, 155, 155, 1)'],\r\n      ['treeArrowHeight', 8],\r\n      ['treeArrowMarginLeft', 0],\r\n      ['treeArrowMarginRight', 5],\r\n      ['treeArrowMarginTop', 6],\r\n      ['treeArrowWidth', 13],\r\n      ['treeGridHeight', 250],\r\n      ['width', 'auto'],\r\n    ],\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport defaults from './defaults';\r\n\r\nexport default function () {\r\n  var typeMap,\r\n    component = {};\r\n  component.dehyphenateProperty = function hyphenateProperty(prop) {\r\n    prop = prop.replace('--cdg-', '');\r\n    var p = '',\r\n      nextLetterCap;\r\n    Array.prototype.forEach.call(prop, function (char) {\r\n      if (nextLetterCap) {\r\n        nextLetterCap = false;\r\n        p += char.toUpperCase();\r\n        return;\r\n      }\r\n      if (char === '-') {\r\n        nextLetterCap = true;\r\n        return;\r\n      }\r\n      p += char;\r\n    });\r\n    return p;\r\n  };\r\n  component.hyphenateProperty = function hyphenateProperty(prop, cust) {\r\n    var p = '';\r\n    Array.prototype.forEach.call(prop, function (char) {\r\n      if (char === char.toUpperCase()) {\r\n        p += '-' + char.toLowerCase();\r\n        return;\r\n      }\r\n      p += char;\r\n    });\r\n    return (cust ? '--cdg-' : '') + p;\r\n  };\r\n  function getDefaultItem(base, item) {\r\n    var i = {},\r\n      r;\r\n    defaults(i);\r\n    r = i.defaults[base].filter(function (i) {\r\n      return (\r\n        i[0].toLowerCase() === item.toLowerCase() ||\r\n        component.hyphenateProperty(i[0]) === item.toLowerCase() ||\r\n        component.hyphenateProperty(i[0], true) === item.toLowerCase()\r\n      );\r\n    })[0];\r\n    return r;\r\n  }\r\n  component.applyComponentStyle = function (supressChangeAndDrawEvents, intf) {\r\n    if (!intf.isComponent) {\r\n      return;\r\n    }\r\n    var cStyle = window.getComputedStyle(\r\n        intf.tagName === 'CANVAS-DATAGRID' ? intf : intf.canvas,\r\n        null,\r\n      ),\r\n      defs = {};\r\n    intf.computedStyle = cStyle;\r\n    defaults(defs);\r\n    defs = defs.defaults.styles;\r\n    defs.forEach(function (def) {\r\n      var val;\r\n      val = cStyle.getPropertyValue(component.hyphenateProperty(def[0], true));\r\n      if (val === '') {\r\n        val = cStyle.getPropertyValue(\r\n          component.hyphenateProperty(def[0], false),\r\n        );\r\n      }\r\n      if (val !== '' && typeof val === 'string') {\r\n        intf.setStyleProperty(\r\n          def[0],\r\n          typeMap[typeof def[1]](\r\n            val.replace(/^\\s+/, '').replace(/\\s+$/, ''),\r\n            def[1],\r\n          ),\r\n          true,\r\n        );\r\n      }\r\n    });\r\n    if (!supressChangeAndDrawEvents && intf.dispatchEvent) {\r\n      requestAnimationFrame(function () {\r\n        intf.resize(true);\r\n      });\r\n      intf.dispatchEvent('stylechanged', intf.style);\r\n    }\r\n  };\r\n  typeMap = {\r\n    data: function (strData) {\r\n      try {\r\n        return JSON.parse(strData);\r\n      } catch (e) {\r\n        throw new Error('Cannot read JSON data in canvas-datagrid data.');\r\n      }\r\n    },\r\n    schema: function (strSchema) {\r\n      try {\r\n        return JSON.parse(strSchema);\r\n      } catch (e) {\r\n        throw new Error(\r\n          'Cannot read JSON data in canvas-datagrid schema attribute.',\r\n        );\r\n      }\r\n    },\r\n    number: function (strNum, def) {\r\n      var n = parseInt(strNum, 10);\r\n      return isNaN(n) ? def : n;\r\n    },\r\n    boolean: function (strBool) {\r\n      return /true/i.test(strBool);\r\n    },\r\n    string: function (str) {\r\n      return str;\r\n    },\r\n  };\r\n  component.getObservableAttributes = function () {\r\n    var i = {},\r\n      attrs = ['data', 'schema', 'style', 'className', 'name'];\r\n    defaults(i);\r\n    i.defaults.attributes.forEach(function (attr) {\r\n      attrs.push(attr[0].toLowerCase());\r\n    });\r\n    return attrs;\r\n  };\r\n  component.disconnectedCallback = function () {\r\n    this.connected = false;\r\n  };\r\n  component.connectedCallback = function () {\r\n    var intf = this;\r\n    intf.parentDOMNode.innerHTML = '';\r\n    intf.parentDOMNode.appendChild(intf.canvas);\r\n    intf.connected = true;\r\n    component.observe(intf);\r\n    component.applyComponentStyle(true, intf);\r\n    intf.resize(true);\r\n  };\r\n  component.adoptedCallback = function () {\r\n    this.resize();\r\n  };\r\n  component.attributeChangedCallback = function (attrName, oldVal, newVal) {\r\n    var tfn,\r\n      intf = this,\r\n      def;\r\n    if (attrName === 'style') {\r\n      component.applyComponentStyle(false, intf);\r\n      return;\r\n    }\r\n    if (attrName === 'data') {\r\n      if (intf.dataType === 'application/x-canvas-datagrid') {\r\n        intf.dataType = 'application/json+x-canvas-datagrid';\r\n      }\r\n      intf.data = newVal;\r\n      return;\r\n    }\r\n    if (attrName === 'schema') {\r\n      intf.schema = typeMap.schema(newVal);\r\n      return;\r\n    }\r\n    if (attrName === 'name') {\r\n      intf.name = newVal;\r\n      return;\r\n    }\r\n    if (attrName === 'class' || attrName === 'className') {\r\n      return;\r\n    }\r\n    def = getDefaultItem('attributes', attrName);\r\n    if (def) {\r\n      tfn = typeMap[typeof def[1]];\r\n      intf.attributes[def[0]] = tfn(newVal);\r\n      return;\r\n    }\r\n    if (/^on/.test(attrName)) {\r\n      intf.addEventListener('on' + attrName, Function('e', newVal));\r\n    }\r\n    return;\r\n  };\r\n  component.observe = function (intf) {\r\n    var observer;\r\n    if (!window.MutationObserver) {\r\n      return;\r\n    }\r\n    intf.applyComponentStyle = function () {\r\n      component.applyComponentStyle(false, intf);\r\n      intf.resize();\r\n    };\r\n    /**\r\n     * Applies the computed css styles to the grid.  In some browsers, changing directives in attached style sheets does not automatically update the styles in this component.  It is necessary to call this method to update in these cases.\r\n     * @memberof canvasDatagrid\r\n     * @name applyComponentStyle\r\n     * @method\r\n     */\r\n    observer = new window.MutationObserver(function (mutations) {\r\n      var checkInnerHTML, checkStyle;\r\n      Array.prototype.forEach.call(mutations, function (mutation) {\r\n        if (\r\n          mutation.attributeName === 'class' ||\r\n          mutation.attributeName === 'style'\r\n        ) {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (mutation.target.nodeName === 'STYLE') {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (\r\n          mutation.target.parentNode &&\r\n          mutation.target.parentNode.nodeName === 'STYLE'\r\n        ) {\r\n          checkStyle = true;\r\n          return;\r\n        }\r\n        if (\r\n          mutation.target === intf &&\r\n          (mutation.addedNodes.length > 0 || mutation.type === 'characterData')\r\n        ) {\r\n          checkInnerHTML = true;\r\n        }\r\n      });\r\n      if (checkStyle) {\r\n        intf.applyComponentStyle(false, intf);\r\n      }\r\n      if (checkInnerHTML) {\r\n        if (intf.dataType === 'application/x-canvas-datagrid') {\r\n          intf.dataType = 'application/json+x-canvas-datagrid';\r\n        }\r\n        intf.data = intf.innerHTML;\r\n      }\r\n    });\r\n    observer.observe(intf, {\r\n      characterData: true,\r\n      childList: true,\r\n      attributes: true,\r\n      subtree: true,\r\n    });\r\n    Array.prototype.forEach.call(\r\n      document.querySelectorAll('style'),\r\n      function (el) {\r\n        observer.observe(el, {\r\n          characterData: true,\r\n          childList: true,\r\n          attributes: true,\r\n          subtree: true,\r\n        });\r\n      },\r\n    );\r\n  };\r\n  return component;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals XMLSerializer: false, define: true, Blob: false, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var perfCounters = [],\r\n    cachedImagesDrawn = false,\r\n    drawCount = 0,\r\n    perfWindowSize = 300,\r\n    entityCount = [],\r\n    hiddenFrozenColumnCount = 0,\r\n    scrollDebugCounters = [],\r\n    touchPPSCounters = [];\r\n  self.htmlImageCache = {};\r\n  // more heavyweight version than fillArray defined in intf.js\r\n  function fillArray(low, high, step, def) {\r\n    step = step || 1;\r\n    var i = [],\r\n      x;\r\n    for (x = low; x <= high; x += step) {\r\n      i[x] = def === undefined ? x : typeof def === 'function' ? def(x) : def;\r\n    }\r\n    return i;\r\n  }\r\n  function drawPerfLine(w, h, x, y, perfArr, arrIndex, max, color, useAbs) {\r\n    var i = w / perfArr.length,\r\n      r = h / max;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.moveTo(x, y + h);\r\n    perfArr.forEach(function (n) {\r\n      var val = arrIndex === undefined ? n : n[arrIndex],\r\n        cx,\r\n        cy;\r\n      if (useAbs) {\r\n        val = Math.abs(val);\r\n      }\r\n      cx = x + i;\r\n      cy = y + h - val * r;\r\n      self.ctx.lineTo(cx, cy);\r\n      x += i;\r\n    });\r\n    self.ctx.moveTo(x + w, y + h);\r\n    self.ctx.strokeStyle = color;\r\n    self.ctx.stroke();\r\n  }\r\n  function drawOnAllImagesLoaded() {\r\n    var loaded = true;\r\n    Object.keys(self.htmlImageCache).forEach(function (html) {\r\n      if (!self.htmlImageCache[html].img.complete) {\r\n        loaded = false;\r\n      }\r\n    });\r\n    if (loaded && !cachedImagesDrawn) {\r\n      cachedImagesDrawn = true;\r\n      self.draw();\r\n    }\r\n  }\r\n  function drawHtml(cell) {\r\n    var img,\r\n      v = cell.innerHTML || cell.formattedValue,\r\n      cacheKey =\r\n        v.toString() + cell.rowIndex.toString() + cell.columnIndex.toString(),\r\n      x = Math.round(cell.x + self.canvasOffsetLeft),\r\n      y = Math.round(cell.y + self.canvasOffsetTop);\r\n    if (self.htmlImageCache[cacheKey]) {\r\n      img = self.htmlImageCache[cacheKey].img;\r\n      if (\r\n        self.htmlImageCache[cacheKey].height !== cell.height ||\r\n        self.htmlImageCache[cacheKey].width !== cell.width\r\n      ) {\r\n        // height and width of the cell has changed, invalidate cache\r\n        self.htmlImageCache[cacheKey] = undefined;\r\n      } else {\r\n        if (!img.complete) {\r\n          return;\r\n        }\r\n        return self.ctx.drawImage(img, x, y);\r\n      }\r\n    } else {\r\n      cachedImagesDrawn = false;\r\n    }\r\n    img = new Image(cell.width, cell.height);\r\n    self.htmlImageCache[cacheKey] = {\r\n      img,\r\n      width: cell.width,\r\n      height: cell.height,\r\n    };\r\n    img.onload = function () {\r\n      self.ctx.drawImage(img, x, y);\r\n      drawOnAllImagesLoaded();\r\n    };\r\n    img.src =\r\n      'data:image/svg+xml;base64,' +\r\n      btoa(\r\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' +\r\n          cell.width +\r\n          '\" height=\"' +\r\n          cell.height +\r\n          '\">\\n' +\r\n          '<foreignObject class=\"node\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\\n' +\r\n          '<body xmlns=\"http://www.w3.org/1999/xhtml\" style=\"margin:0;padding:0;\">\\n' +\r\n          v +\r\n          '\\n' +\r\n          '</body>' +\r\n          '</foreignObject>\\n' +\r\n          '</svg>\\n',\r\n      );\r\n  }\r\n  function drawOrderByArrow(x, y) {\r\n    var mt = self.style.columnHeaderOrderByArrowMarginTop * self.scale,\r\n      ml = self.style.columnHeaderOrderByArrowMarginLeft * self.scale,\r\n      mr = self.style.columnHeaderOrderByArrowMarginRight * self.scale,\r\n      aw = self.style.columnHeaderOrderByArrowWidth * self.scale,\r\n      ah = self.style.columnHeaderOrderByArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.columnHeaderOrderByArrowColor;\r\n    self.ctx.strokeStyle = self.style.columnHeaderOrderByArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n    if (self.orderDirection === 'asc') {\r\n      self.ctx.moveTo(x, y);\r\n      self.ctx.lineTo(x + aw, y);\r\n      self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n      self.ctx.moveTo(x, y);\r\n    } else {\r\n      self.ctx.lineTo(x, y + ah);\r\n      self.ctx.lineTo(x + aw, y + ah);\r\n      self.ctx.lineTo(x + aw * 0.5, y);\r\n      self.ctx.lineTo(x, y + ah);\r\n    }\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw + mr;\r\n  }\r\n  function drawTreeArrow(cell, x, y) {\r\n    var mt = self.style.treeArrowMarginTop * self.scale,\r\n      mr = self.style.treeArrowMarginRight * self.scale,\r\n      ml = self.style.treeArrowMarginLeft * self.scale,\r\n      aw = self.style.treeArrowWidth * self.scale,\r\n      ah = self.style.treeArrowHeight * self.scale;\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillStyle = self.style.treeArrowColor;\r\n    self.ctx.strokeStyle = self.style.treeArrowBorderColor;\r\n    self.ctx.beginPath();\r\n    x = x + ml;\r\n    y = y + mt;\r\n    if (self.openChildren[cell.rowIndex]) {\r\n      self.ctx.moveTo(x, y);\r\n      self.ctx.lineTo(x + aw, y);\r\n      self.ctx.lineTo(x + aw * 0.5, y + ah);\r\n      self.ctx.moveTo(x, y);\r\n    } else {\r\n      self.ctx.lineTo(x, y);\r\n      self.ctx.lineTo(x + ah, y + aw * 0.5);\r\n      self.ctx.lineTo(x, y + aw);\r\n      self.ctx.lineTo(x, y);\r\n    }\r\n    self.ctx.stroke();\r\n    self.ctx.fill();\r\n    return ml + aw + mr;\r\n  }\r\n  function radiusRect(x, y, w, h, radius) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    var r = x + w,\r\n      b = y + h;\r\n    self.ctx.beginPath();\r\n    self.ctx.moveTo(x + radius, y);\r\n    self.ctx.lineTo(r - radius, y);\r\n    self.ctx.quadraticCurveTo(r, y, r, y + radius);\r\n    self.ctx.lineTo(r, y + h - radius);\r\n    self.ctx.quadraticCurveTo(r, b, r - radius, b);\r\n    self.ctx.lineTo(x + radius, b);\r\n    self.ctx.quadraticCurveTo(x, b, x, b - radius);\r\n    self.ctx.lineTo(x, y + radius);\r\n    self.ctx.quadraticCurveTo(x, y, x + radius, y);\r\n  }\r\n  function fillRect(x, y, w, h) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillRect(x, y, w, h);\r\n  }\r\n  function strokeRect(x, y, w, h) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.strokeRect(x, y, w, h);\r\n  }\r\n  function fillText(text, x, y) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.fillText(text, x, y);\r\n  }\r\n  function fillCircle(x, y, r) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    self.ctx.fill();\r\n  }\r\n  function strokeCircle(x, y, r) {\r\n    x += self.canvasOffsetLeft;\r\n    y += self.canvasOffsetTop;\r\n    self.ctx.beginPath();\r\n    self.ctx.arc(x, y, r, 0, 2 * Math.PI);\r\n    self.ctx.stroke();\r\n  }\r\n  function clipFrozenArea(mode) {\r\n    // 0 both, 1 rows, 2 cols\r\n    // self.lastFrozenColumnPixel;\r\n    // self.lastFrozenRowPixel;\r\n    self.ctx.beginPath();\r\n    if (mode === 0) {\r\n      self.ctx.moveTo(self.lastFrozenColumnPixel, self.lastFrozenRowPixel);\r\n      self.ctx.lineTo(self.lastFrozenColumnPixel, self.height);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.width, self.lastFrozenRowPixel);\r\n    }\r\n    if (mode === 1) {\r\n      self.ctx.moveTo(0, self.lastFrozenRowPixel);\r\n      self.ctx.lineTo(0, self.height);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.width, self.lastFrozenRowPixel);\r\n    }\r\n    if (mode === 2) {\r\n      self.ctx.moveTo(self.lastFrozenColumnPixel, 0);\r\n      self.ctx.lineTo(self.width, 0);\r\n      self.ctx.lineTo(self.width, self.height);\r\n      self.ctx.lineTo(self.lastFrozenColumnPixel, self.height);\r\n    }\r\n    self.ctx.clip();\r\n  }\r\n  function fillHandle(x, y, r) {\r\n    if (self.style.selectionHandleType === 'circle') {\r\n      return fillCircle(x, y, r * 0.5);\r\n    }\r\n    fillRect(x - r * 0.5, y - r * 0.5, r, r);\r\n  }\r\n  function strokeHandle(x, y, r) {\r\n    if (self.style.selectionHandleType === 'circle') {\r\n      return strokeCircle(x, y, r * 0.5);\r\n    }\r\n    strokeRect(x - r * 0.5, y - r * 0.5, r, r);\r\n  }\r\n  function addselectionHandle(c, pos) {\r\n    var hw = self.style.selectionHandleSize,\r\n      p = {\r\n        tr: function () {\r\n          fillHandle(c.x + c.width, c.y, hw);\r\n          strokeHandle(c.x + c.width, c.y, hw);\r\n        },\r\n        br: function () {\r\n          fillHandle(c.x + c.width, c.y + c.height, hw);\r\n          strokeHandle(c.x + c.width, c.y + c.height, hw);\r\n        },\r\n        tl: function () {\r\n          fillHandle(c.x, c.y, hw);\r\n          strokeHandle(c.x, c.y, hw);\r\n        },\r\n        bl: function () {\r\n          fillHandle(c.x, c.y + c.height, hw);\r\n          strokeHandle(c.x, c.y + c.height, hw);\r\n        },\r\n      };\r\n    p[pos]();\r\n  }\r\n  function addBorderLine(c, pos) {\r\n    self.ctx.beginPath();\r\n    var p = {\r\n      t: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n      },\r\n      r: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n      b: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft + c.width,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n      l: function () {\r\n        self.ctx.moveTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop,\r\n        );\r\n        self.ctx.lineTo(\r\n          c.x + self.canvasOffsetLeft,\r\n          c.y + self.canvasOffsetTop + c.height,\r\n        );\r\n      },\r\n    };\r\n    p[pos]();\r\n    self.ctx.stroke();\r\n  }\r\n  function addEllipsis(text, width) {\r\n    var c,\r\n      w = 0;\r\n    if (self.ellipsisCache[text] && self.ellipsisCache[text][width]) {\r\n      return self.ellipsisCache[text][width];\r\n    }\r\n    //TODO Add ellipsis back when there is a fast way to do it\r\n    w = self.ctx.measureText(text).width;\r\n    self.ellipsisCache[text] = self.ellipsisCache[text] || {};\r\n    c = { value: text, width: w };\r\n    self.ellipsisCache[text][width] = c;\r\n    return c;\r\n  }\r\n  function wrapText(cell, splitChar) {\r\n    if (!cell.formattedValue) {\r\n      return {\r\n        lines: [{ width: 0, value: '' }],\r\n        width: 0,\r\n        height: cell.calculatedLineHeight,\r\n      };\r\n    }\r\n    var max = 0,\r\n      n = '\\n',\r\n      x,\r\n      word,\r\n      words = cell.formattedValue.split(splitChar),\r\n      textHeight = cell.calculatedLineHeight,\r\n      lines = [],\r\n      out = [],\r\n      wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n      autoResize = self.attributes.autoResizeRows && wrap,\r\n      elWidth,\r\n      et = self.attributes.ellipsisText,\r\n      elClipLength,\r\n      plWidth,\r\n      clippedVal,\r\n      ogWordWidth,\r\n      previousLine,\r\n      line = {\r\n        width: 0,\r\n        value: '',\r\n      },\r\n      cHeight = wrap ? cell.paddedHeight : cell.calculatedLineHeight;\r\n    lines.push(line);\r\n    elWidth = self.ctx.measureText(' ' + et).width;\r\n    for (x = 0; x < words.length; x += 1) {\r\n      word = words[x];\r\n      var measure = self.ctx.measureText(word + splitChar);\r\n      if (line.width + measure.width + elWidth < cell.paddedWidth) {\r\n        line.value += word + splitChar;\r\n        line.width += measure.width;\r\n        continue;\r\n      }\r\n      // if there is a hyphenated word that is too long\r\n      // split it and add the split set to the array\r\n      // then back up and re-read new split set\r\n      // this behavior seems right, it might not be\r\n      if (/\\w-\\w/.test(word) && cell.paddedWidth < measure.width) {\r\n        words.splice(x, 1, word.split('-')[0] + '-', word.split('-')[1]);\r\n        x -= 1;\r\n        continue;\r\n      }\r\n      line = {\r\n        width: measure.width,\r\n        value: word + splitChar,\r\n      };\r\n      if (x === 0) {\r\n        lines = [];\r\n        lines.push(line);\r\n      }\r\n      textHeight += cell.calculatedLineHeight;\r\n      if (textHeight > cHeight && !autoResize) {\r\n        if (lines.length === 0) {\r\n          break;\r\n        }\r\n        elClipLength = 1;\r\n        previousLine = lines[lines.length - 1];\r\n        if (previousLine.width < cell.paddedWidth && words.length === 1) {\r\n          break;\r\n        }\r\n        clippedVal = previousLine.value + word;\r\n        plWidth = self.ctx.measureText(clippedVal + et).width;\r\n        var originText = clippedVal;\r\n        if (plWidth > cell.paddedWidth) {\r\n          var stepLength = parseInt(clippedVal.length / 2);\r\n          var direction = -1;\r\n          while (stepLength > 0) {\r\n            clippedVal = originText.substr(\r\n              0,\r\n              stepLength * direction + clippedVal.length,\r\n            );\r\n            plWidth = self.ctx.measureText(clippedVal + et).width;\r\n            direction = plWidth > cell.paddedWidth ? -1 : 1;\r\n            stepLength = parseInt(stepLength / 2);\r\n          }\r\n        }\r\n        clippedVal =\r\n          clippedVal + (originText.length != clippedVal.length ? et : '');\r\n        previousLine.value = clippedVal;\r\n        previousLine.width = plWidth;\r\n        break;\r\n      }\r\n      if (x > 0) {\r\n        lines.push(line);\r\n      }\r\n    }\r\n    return {\r\n      lines: lines,\r\n      width: max,\r\n      height: cell.calculatedLineHeight * lines.length,\r\n    };\r\n  }\r\n  function drawText(cell) {\r\n    var ll = cell.text.lines.length,\r\n      h = cell.fontHeight * cell.lineHeight,\r\n      x,\r\n      line,\r\n      wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n      textHeight = 0;\r\n    for (x = 0; x < cell.text.lines.length; x += 1) {\r\n      line = cell.text.lines[x];\r\n      var vPos =\r\n          Math.max(\r\n            (cell.height -\r\n              (wrap ? cell.text.height : cell.calculatedLineHeight)) *\r\n              0.5,\r\n            0,\r\n          ) + h,\r\n        hPos = cell.paddingLeft + cell.treeArrowWidth + cell.orderByArrowWidth;\r\n      if (cell.horizontalAlignment === 'right') {\r\n        hPos = cell.paddingLeft + cell.paddedWidth - line.width;\r\n      } else if (cell.horizontalAlignment === 'center') {\r\n        hPos =\r\n          cell.paddingLeft +\r\n          (cell.paddedWidth + cell.paddingRight) / 2 -\r\n          line.width / 2;\r\n      }\r\n      if (cell.verticalAlignment === 'top') {\r\n        vPos = cell.calculatedLineHeight;\r\n      } else if (cell.verticalAlignment === 'bottom') {\r\n        vPos = cell.height - cell.paddingBottom - cell.text.height;\r\n      }\r\n      line.height = h + cell.lineSpacing;\r\n      line.offsetLeft = hPos;\r\n      line.offsetTop = vPos;\r\n      line.x = cell.x + hPos;\r\n      line.y = cell.y + textHeight + vPos;\r\n      textHeight += line.height;\r\n      fillText(line.value, line.x, line.y);\r\n    }\r\n    if (self.attributes.debug && cell.active) {\r\n      requestAnimationFrame(function () {\r\n        self.ctx.font = self.style.debugFont;\r\n        self.ctx.fillStyle = self.style.debugColor;\r\n        fillText(\r\n          JSON.stringify(\r\n            {\r\n              x: cell.x,\r\n              y: cell.y,\r\n              h: cell.height,\r\n              w: cell.width,\r\n              pw: cell.paddedWidth,\r\n              idx: cell.columnIndex,\r\n              idx_ord: cell.sortColumnIndex,\r\n            },\r\n            null,\r\n            '\\t',\r\n          ),\r\n          cell.x + 14,\r\n          cell.y + 14,\r\n        );\r\n        fillText(\r\n          JSON.stringify(\r\n            cell.text.lines.map(function (l) {\r\n              return { w: l.width, v: l.value.length };\r\n            }),\r\n            null,\r\n            '\\t',\r\n          ),\r\n          cell.x + 14,\r\n          cell.y + 30,\r\n        );\r\n      });\r\n    }\r\n  }\r\n  function getFrozenColumnsWidth() {\r\n    var w = 0,\r\n      s = self.getSchema(),\r\n      x = 0,\r\n      n = Math.min(self.frozenColumn, s.length),\r\n      column;\r\n    hiddenFrozenColumnCount = 0;\r\n    while (x < n) {\r\n      column = s[x];\r\n      if (column.hidden) {\r\n        hiddenFrozenColumnCount += 1;\r\n      } else {\r\n        w += self.getColumnWidth(x);\r\n      }\r\n      x += 1;\r\n    }\r\n    return w;\r\n  }\r\n  /**\r\n   * Redraws the grid. No matter what the change, this is the only method required to refresh everything.\r\n   * @memberof canvasDatagrid\r\n   * @name draw\r\n   * @method\r\n   */\r\n  // r = literal row index\r\n  // rd = row data array\r\n  // i = user order index\r\n  // o = literal data index\r\n  // y = y drawing cursor\r\n  // x = x drawing cursor\r\n  // s = visible schema array\r\n  // cx = current x drawing cursor sub calculation var\r\n  // cy = current y drawing cursor sub calculation var\r\n  // a = static cell (like corner cell)\r\n  // p = perf counter\r\n  // l = data length\r\n  // u = current cell\r\n  // h = current height\r\n  // w = current width\r\n  self.draw = function (internal) {\r\n    if (self.dispatchEvent('beforedraw', {})) {\r\n      return;\r\n    }\r\n    if (!self.isChildGrid && (!self.height || !self.width)) {\r\n      return;\r\n    }\r\n    if (self.isChildGrid && internal) {\r\n      requestAnimationFrame(self.parentGrid.draw);\r\n      return;\r\n    }\r\n    if (self.intf.visible === false) {\r\n      return;\r\n    }\r\n    // initial values\r\n    var checkScrollHeight,\r\n      rowHeaderCell,\r\n      p,\r\n      cx,\r\n      cy,\r\n      treeGrid,\r\n      rowOpen,\r\n      rowHeight,\r\n      cornerCell,\r\n      y,\r\n      x,\r\n      c,\r\n      h,\r\n      w,\r\n      schema,\r\n      rowIndex,\r\n      rowData,\r\n      aCell,\r\n      viewData = self.viewData || [],\r\n      bc = self.style.gridBorderCollapse === 'collapse',\r\n      selectionBorders = [],\r\n      moveBorders = [],\r\n      selectionHandles = [],\r\n      rowHeaders = [],\r\n      l = viewData.length,\r\n      u = self.currentCell || {},\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      cellHeight = self.style.cellHeight;\r\n    drawCount += 1;\r\n    p = performance.now();\r\n    self.visibleRowHeights = [];\r\n    // if data length has changed, there is no way to know\r\n    if (viewData.length > self.orders.rows.length) {\r\n      self.createRowOrders();\r\n    }\r\n    function drawScrollBars() {\r\n      var drawCorner,\r\n        en = self.scrollBox.entities,\r\n        m = self.style.scrollBarBoxMargin * 2;\r\n      self.ctx.strokeStyle = self.style.scrollBarBorderColor;\r\n      self.ctx.lineWidth = self.style.scrollBarBorderWidth;\r\n      en.horizontalBox.x =\r\n        rowHeaderCellWidth +\r\n        self.style.scrollBarBoxMargin +\r\n        (en.horizontalBar.width - self.scrollBox.scrollBoxWidth) *\r\n          (self.scrollBox.scrollLeft / self.scrollBox.scrollWidth);\r\n      en.verticalBox.y =\r\n        columnHeaderCellHeight +\r\n        self.style.scrollBarBoxMargin +\r\n        (en.verticalBar.height - self.scrollBox.scrollBoxHeight) *\r\n          (self.scrollBox.scrollTop / self.scrollBox.scrollHeight);\r\n      if (self.scrollBox.horizontalBarVisible) {\r\n        self.ctx.fillStyle = self.style.scrollBarBackgroundColor;\r\n        fillRect(\r\n          en.horizontalBar.x,\r\n          en.horizontalBar.y,\r\n          en.horizontalBar.width + m,\r\n          en.horizontalBar.height,\r\n        );\r\n        strokeRect(\r\n          en.horizontalBar.x,\r\n          en.horizontalBar.y,\r\n          en.horizontalBar.width + m,\r\n          en.horizontalBar.height,\r\n        );\r\n        self.ctx.fillStyle = self.style.scrollBarBoxColor;\r\n        if (self.scrollBox.horizontalBoxVisible) {\r\n          if (/horizontal/.test(u.context)) {\r\n            self.ctx.fillStyle = self.style.scrollBarActiveColor;\r\n          }\r\n          radiusRect(\r\n            en.horizontalBox.x,\r\n            en.horizontalBox.y,\r\n            en.horizontalBox.width,\r\n            en.horizontalBox.height,\r\n            self.style.scrollBarBoxBorderRadius,\r\n          );\r\n          self.ctx.stroke();\r\n          self.ctx.fill();\r\n        }\r\n        drawCorner = true;\r\n        self.visibleCells.unshift(en.horizontalBar);\r\n        self.visibleCells.unshift(en.horizontalBox);\r\n      }\r\n      if (self.scrollBox.verticalBarVisible) {\r\n        self.ctx.fillStyle = self.style.scrollBarBackgroundColor;\r\n        fillRect(\r\n          en.verticalBar.x,\r\n          en.verticalBar.y,\r\n          en.verticalBar.width,\r\n          en.verticalBar.height + m,\r\n        );\r\n        strokeRect(\r\n          en.verticalBar.x,\r\n          en.verticalBar.y,\r\n          en.verticalBar.width,\r\n          en.verticalBar.height + m,\r\n        );\r\n        if (self.scrollBox.verticalBoxVisible) {\r\n          self.ctx.fillStyle = self.style.scrollBarBoxColor;\r\n          if (/vertical/.test(u.context)) {\r\n            self.ctx.fillStyle = self.style.scrollBarActiveColor;\r\n          }\r\n          radiusRect(\r\n            en.verticalBox.x,\r\n            en.verticalBox.y,\r\n            en.verticalBox.width,\r\n            en.verticalBox.height,\r\n            self.style.scrollBarBoxBorderRadius,\r\n          );\r\n          self.ctx.stroke();\r\n          self.ctx.fill();\r\n        }\r\n        drawCorner = true;\r\n        self.visibleCells.unshift(en.verticalBar);\r\n        self.visibleCells.unshift(en.verticalBox);\r\n      }\r\n      if (drawCorner) {\r\n        //corner\r\n        self.ctx.strokeStyle = self.style.scrollBarCornerBorderColor;\r\n        self.ctx.fillStyle = self.style.scrollBarCornerBackgroundColor;\r\n        radiusRect(\r\n          en.corner.x,\r\n          en.corner.y,\r\n          en.corner.width,\r\n          en.corner.height,\r\n          0,\r\n        );\r\n        self.ctx.stroke();\r\n        self.ctx.fill();\r\n        self.visibleCells.unshift(en.corner);\r\n      }\r\n    }\r\n    function createHandlesOverlayArray(cell) {\r\n      if (self.attributes.allowMovingSelection || self.mobile) {\r\n        if (\r\n          cell.selectionBorderTop &&\r\n          cell.selectionBorderRight &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'tr']);\r\n          cell.selectionHandle = 'tr';\r\n        }\r\n        if (\r\n          cell.selectionBorderTop &&\r\n          cell.selectionBorderLeft &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'tl']);\r\n          cell.selectionHandle = 'tl';\r\n        }\r\n        if (\r\n          cell.selectionBorderBottom &&\r\n          cell.selectionBorderLeft &&\r\n          self.mobile\r\n        ) {\r\n          selectionHandles.push([cell, 'bl']);\r\n          cell.selectionHandle = 'bl';\r\n        }\r\n        if (\r\n          cell.selectionBorderBottom &&\r\n          cell.selectionBorderRight &&\r\n          (self.attributes.selectionHandleBehavior !== 'none' || self.mobile)\r\n        ) {\r\n          selectionHandles.push([cell, 'br']);\r\n          cell.selectionHandle = 'br';\r\n        }\r\n      }\r\n    }\r\n    function createBorderOverlayArray(\r\n      cell,\r\n      drawArray,\r\n      propPrefix,\r\n      offsetPoint,\r\n    ) {\r\n      offsetPoint = offsetPoint || { x: 0, y: 0 };\r\n      cell.selectionBorder = '';\r\n      if (\r\n        !cell.isRowHeader &&\r\n        self.selections[cell.rowIndex + -offsetPoint.y] &&\r\n        self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n          cell.columnIndex + -offsetPoint.x,\r\n        ) !== -1\r\n      ) {\r\n        if (\r\n          (!self.selections[cell.rowIndex - 1 + -offsetPoint.y] ||\r\n            self.selections[cell.rowIndex - 1 + -offsetPoint.y].indexOf(\r\n              cell.columnIndex + -offsetPoint.x,\r\n            ) === -1 ||\r\n            cell.rowIndex === 0) &&\r\n          !cell.isHeader\r\n        ) {\r\n          drawArray.push([cell, 't']);\r\n          cell[propPrefix + 'BorderTop'] = true;\r\n          cell[propPrefix + 'Border'] += 't';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + 1 + -offsetPoint.y] ||\r\n          self.selections[cell.rowIndex + 1 + -offsetPoint.y].indexOf(\r\n            cell.columnIndex + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'b']);\r\n          cell[propPrefix + 'BorderBottom'] = true;\r\n          cell[propPrefix + 'Border'] += 'b';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + -offsetPoint.y] ||\r\n          cell.columnIndex === 0 ||\r\n          self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n            cell.columnIndex - 1 + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'l']);\r\n          cell[propPrefix + 'BorderLeft'] = true;\r\n          cell[propPrefix + 'Border'] += 'l';\r\n        }\r\n        if (\r\n          !self.selections[cell.rowIndex + -offsetPoint.y] ||\r\n          cell.columnIndex === schema.length ||\r\n          self.selections[cell.rowIndex + -offsetPoint.y].indexOf(\r\n            cell.columnIndex + 1 + -offsetPoint.x,\r\n          ) === -1\r\n        ) {\r\n          drawArray.push([cell, 'r']);\r\n          cell[propPrefix + 'BorderRight'] = true;\r\n          cell[propPrefix + 'Border'] += 'r';\r\n        }\r\n      }\r\n    }\r\n    function drawCell(rowData, rowOrderIndex, rowIndex) {\r\n      return function drawEach(header, headerIndex, columnOrderIndex) {\r\n        if (header.hidden) {\r\n          return 0;\r\n        }\r\n        var cellStyle = header.style || 'cell',\r\n          cellGridAttributes,\r\n          cell,\r\n          isHeader = /HeaderCell/.test(cellStyle),\r\n          isCorner = /cornerCell/.test(cellStyle),\r\n          isRowHeader = 'rowHeaderCell' === cellStyle,\r\n          isColumnHeader = 'columnHeaderCell' === cellStyle,\r\n          wrap = self.style.cellWhiteSpace !== 'nowrap',\r\n          selected =\r\n            self.selections[rowOrderIndex] &&\r\n            self.selections[rowOrderIndex].indexOf(columnOrderIndex) !== -1,\r\n          hovered =\r\n            self.hovers.rowIndex === rowOrderIndex &&\r\n            (self.attributes.hoverMode === 'row' ||\r\n              self.hovers.columnIndex === columnOrderIndex),\r\n          active =\r\n            self.activeCell.rowIndex === rowOrderIndex &&\r\n            self.activeCell.columnIndex === columnOrderIndex,\r\n          isColumnHeaderCellCap = cellStyle === 'columnHeaderCellCap',\r\n          rawValue = rowData ? rowData[header.name] : undefined,\r\n          isGrid = header.type === 'canvas-datagrid',\r\n          activeHeader =\r\n            (self.orders.rows[self.activeCell.rowIndex] === rowOrderIndex ||\r\n              self.orders.columns[self.activeCell.columnIndex] ===\r\n                headerIndex) &&\r\n            (columnOrderIndex === -1 || rowOrderIndex === -1)\r\n              ? isRowHeader\r\n                ? 'activeRowHeaderCell'\r\n                : 'activeColumnHeaderCell'\r\n              : false,\r\n          val,\r\n          f = self.formatters[header.type || 'string'],\r\n          orderByArrowSize = 0,\r\n          treeArrowSize = 0,\r\n          cellWidth = self.sizes.columns[headerIndex] || header.width,\r\n          ev = {\r\n            value: rawValue,\r\n            row: rowData,\r\n            header: header,\r\n          };\r\n        if (isColumnHeaderCellCap) {\r\n          cellWidth = w - x;\r\n        }\r\n        // if no data or schema are defined, a width is provided to the stub column\r\n        if (cellWidth === undefined) {\r\n          cellWidth = self.style.cellWidth;\r\n        }\r\n        cellWidth = cellWidth * self.scale;\r\n        if (x + cellWidth + self.style.cellBorderWidth < 0) {\r\n          x += cellWidth + self.style.cellBorderWidth;\r\n        }\r\n        if (active && cellStyle !== 'cornerCell') {\r\n          cellStyle = 'activeCell';\r\n        }\r\n        if (self.visibleRows.indexOf(rowIndex) === -1 && !isHeader) {\r\n          self.visibleRows.push(rowIndex);\r\n        }\r\n        val = self.dispatchEvent('formatcellvalue', ev);\r\n        cx = x;\r\n        cy = y;\r\n        if (cellStyle === 'cornerCell') {\r\n          cx = 0;\r\n          cy = 0;\r\n        } else if (isRowHeader) {\r\n          cx = 0;\r\n        } else if (isHeader) {\r\n          cy = 0;\r\n        }\r\n        cell = {\r\n          type: isGrid ? 'canvas-datagrid-cell' : header.type,\r\n          style: cellStyle,\r\n          nodeType: 'canvas-datagrid-cell',\r\n          x: cx,\r\n          y: cy,\r\n          fontHeight: (self.style[cellStyle + 'FontHeight'] || 0) * self.scale,\r\n          horizontalAlignment: self.style[cellStyle + 'HorizontalAlignment'],\r\n          verticalAlignment: self.style[cellStyle + 'VerticalAlignment'],\r\n          paddingLeft:\r\n            (self.style[cellStyle + 'PaddingLeft'] || 0) * self.scale,\r\n          paddingTop: (self.style[cellStyle + 'PaddingTop'] || 0) * self.scale,\r\n          paddingRight:\r\n            (self.style[cellStyle + 'PaddingRight'] || 0) * self.scale,\r\n          paddingBottom:\r\n            (self.style[cellStyle + 'PaddingBottom'] || 0) * self.scale,\r\n          whiteSpace: self.style.cellWhiteSpace,\r\n          lineHeight: self.style.cellLineHeight,\r\n          lineSpacing: self.style.cellLineSpacing,\r\n          offsetTop: self.canvasOffsetTop + cy,\r\n          offsetLeft: self.canvasOffsetLeft + cx,\r\n          scrollTop: self.scrollBox.scrollTop,\r\n          scrollLeft: self.scrollBox.scrollLeft,\r\n          active: active || activeHeader,\r\n          hovered: hovered,\r\n          selected: selected,\r\n          width: cellWidth,\r\n          height: cellHeight,\r\n          offsetWidth: cellWidth,\r\n          offsetHeight: cellHeight,\r\n          parentNode: self.intf.parentNode,\r\n          offsetParent: self.intf.parentNode,\r\n          data: rowData,\r\n          isCorner: isCorner,\r\n          isHeader: isHeader,\r\n          isColumnHeader: isColumnHeader,\r\n          isColumnHeaderCellCap: isColumnHeaderCellCap,\r\n          isRowHeader: isRowHeader,\r\n          rowOpen: rowOpen,\r\n          header: header,\r\n\r\n          columnIndex: columnOrderIndex,\r\n          rowIndex: rowOrderIndex,\r\n\r\n          viewRowIndex: rowOrderIndex,\r\n          viewColumnIndex: columnOrderIndex,\r\n\r\n          boundRowIndex: self.getBoundRowIndexFromViewRowIndex(rowOrderIndex),\r\n          boundColumnIndex: columnOrderIndex,\r\n\r\n          sortColumnIndex: headerIndex,\r\n          sortRowIndex: rowIndex,\r\n\r\n          isGrid: isGrid,\r\n          isNormal: !isGrid && !isCorner && !isHeader,\r\n          gridId: (self.attributes.name || '') + rowIndex + ':' + headerIndex,\r\n          parentGrid: self.intf,\r\n          innerHTML: '',\r\n          activeHeader: activeHeader,\r\n          value:\r\n            isHeader && !isRowHeader ? header.title || header.name : rawValue,\r\n        };\r\n        cell.calculatedLineHeight =\r\n          cell.fontHeight * cell.lineHeight + cell.lineSpacing;\r\n        cell.paddedWidth = cell.width - cell.paddingRight - cell.paddingLeft;\r\n        cell.paddedHeight = cell.height - cell.paddingTop - cell.paddingBottom;\r\n        ev.cell = cell;\r\n        cell.userHeight = cell.isHeader ? self.sizes.rows[-1] : rowHeight;\r\n        cell.userWidth = cell.isHeader\r\n          ? self.sizes.columns.cornerCell\r\n          : self.sizes.columns[headerIndex];\r\n        self.visibleCells.unshift(cell);\r\n        if (self.dispatchEvent('beforerendercell', ev)) {\r\n          return;\r\n        }\r\n        self.ctx.fillStyle = self.style[cellStyle + 'BackgroundColor'];\r\n        self.ctx.strokeStyle = self.style[cellStyle + 'BorderColor'];\r\n        self.ctx.lineWidth = self.style[cellStyle + 'BorderWidth'];\r\n        if (hovered) {\r\n          self.ctx.fillStyle = self.style[cellStyle + 'HoverBackgroundColor'];\r\n          self.ctx.strokeStyle = self.style[cellStyle + 'HoverBorderColor'];\r\n        }\r\n        if (selected) {\r\n          self.ctx.fillStyle =\r\n            self.style[cellStyle + 'SelectedBackgroundColor'];\r\n          self.ctx.strokeStyle = self.style[cellStyle + 'SelectedBorderColor'];\r\n        }\r\n        if (activeHeader) {\r\n          self.ctx.fillStyle = self.style[activeHeader + 'BackgroundColor'];\r\n        }\r\n        self.dispatchEvent('rendercell', ev);\r\n        if (cell.isGrid) {\r\n          if (cell.height !== rowHeight) {\r\n            cell.height = rowHeight || self.style.cellHeightWithChildGrid;\r\n            checkScrollHeight = true;\r\n          }\r\n          cell.width =\r\n            self.sizes.columns[headerIndex] ||\r\n            self.style.cellWidthWithChildGrid;\r\n        }\r\n        if (rowOpen && !cell.isRowHeader) {\r\n          cell.height = self.sizes.rows[rowIndex] || self.style.cellHeight;\r\n        }\r\n        if (!cell.isGrid) {\r\n          fillRect(cx, cy, cell.width, cell.height);\r\n          strokeRect(cx, cy, cell.width, cell.height);\r\n        }\r\n        self.ctx.save();\r\n        radiusRect(cell.x, cell.y, cell.width, cell.height, 0);\r\n        self.ctx.clip();\r\n        self.dispatchEvent('afterrendercell', ev);\r\n        if (cell.height !== cellHeight && !(rowOpen && !cell.isRowHeader)) {\r\n          self.sizes.rows[isHeader ? -1 : rowIndex] = cell.height;\r\n          checkScrollHeight = true;\r\n        }\r\n        if (cell.width !== cellWidth) {\r\n          self.sizes.columns[headerIndex] = cell.width;\r\n          checkScrollHeight = true;\r\n        }\r\n        if (isRowHeader && self.attributes.tree) {\r\n          if (!self.dispatchEvent('rendertreearrow', ev)) {\r\n            treeArrowSize = drawTreeArrow(\r\n              cell,\r\n              self.style[cellStyle + 'PaddingLeft'],\r\n              cy,\r\n              0,\r\n            );\r\n          }\r\n        }\r\n        if ((self.attributes.showRowNumbers && isRowHeader) || !isRowHeader) {\r\n          if (cell.isGrid && !self.dispatchEvent('beforerendercellgrid', ev)) {\r\n            if (!self.childGrids[cell.gridId]) {\r\n              // HACK: this only allows setting of the child grids styles if data is set _after_\r\n              // this is less than desirable.  An interface needs to be made to effect the\r\n              // style of all cell grids.  One for individual grids already exists.\r\n              cellGridAttributes = self.cellGridAttributes;\r\n              cellGridAttributes.name = self.attributes.saveAppearance\r\n                ? cell.gridId\r\n                : undefined;\r\n              cellGridAttributes.component = false;\r\n              cellGridAttributes.parentNode = cell;\r\n              cellGridAttributes.data = rawValue;\r\n              ev.cellGridAttributes = cellGridAttributes;\r\n              if (self.dispatchEvent('beforecreatecellgrid', ev)) {\r\n                return;\r\n              }\r\n              self.childGrids[cell.gridId] = self.createGrid(\r\n                cellGridAttributes,\r\n              );\r\n              self.sizes.rows[rowIndex] =\r\n                self.sizes.rows[rowIndex] || self.style.cellGridHeight;\r\n              checkScrollHeight = true;\r\n            }\r\n            cell.grid = self.childGrids[cell.gridId];\r\n            cell.grid.parentNode = cell;\r\n            cell.grid.visible = true;\r\n            cell.grid.draw();\r\n            self.dispatchEvent('rendercellgrid', ev);\r\n          } else if (!cell.isGrid) {\r\n            if (self.childGrids[cell.gridId]) {\r\n              self.childGrids[cell.gridId].parentNode.offsetHeight = 0;\r\n            }\r\n            if (isHeader && self.orderBy === header.name) {\r\n              if (!self.dispatchEvent('renderorderbyarrow', ev)) {\r\n                orderByArrowSize = drawOrderByArrow(\r\n                  cx + self.style[cellStyle + 'PaddingLeft'],\r\n                  0,\r\n                );\r\n              }\r\n            }\r\n            self.ctx.fillStyle = self.style[cellStyle + 'Color'];\r\n            if (hovered) {\r\n              self.ctx.fillStyle = self.style[cellStyle + 'HoverColor'];\r\n            }\r\n            if (selected) {\r\n              self.ctx.fillStyle = self.style[cellStyle + 'SelectedColor'];\r\n            }\r\n            if (activeHeader) {\r\n              self.ctx.fillStyle = self.style[activeHeader + 'Color'];\r\n            }\r\n            cell.treeArrowWidth = treeArrowSize;\r\n            cell.orderByArrowWidth = orderByArrowSize;\r\n            // create text ref to see if height needs to expand\r\n            val = val !== undefined ? val : f ? f(ev) : '';\r\n            if (val === undefined && !f) {\r\n              val = '';\r\n              console.warn(\r\n                'canvas-datagrid: Unknown format ' +\r\n                  header.type +\r\n                  ' add a cellFormater',\r\n              );\r\n            }\r\n            cell.formattedValue = (val !== undefined && val !== null\r\n              ? val\r\n              : ''\r\n            ).toString();\r\n            if (\r\n              self.columnFilters &&\r\n              self.columnFilters[val] !== undefined &&\r\n              isHeader\r\n            ) {\r\n              cell.formattedValue = self.attributes.filterTextPrefix + val;\r\n            }\r\n            self.ctx.font =\r\n              self.style[cellStyle + 'FontHeight'] * self.scale +\r\n              'px ' +\r\n              self.style[cellStyle + 'FontName'];\r\n            if (!self.dispatchEvent('formattext', ev)) {\r\n              cell.text = wrapText(cell, ' ');\r\n            }\r\n            if (!self.dispatchEvent('rendertext', ev)) {\r\n              if (cell.innerHTML || header.type === 'html') {\r\n                drawHtml(cell);\r\n              } else {\r\n                drawText(cell);\r\n              }\r\n\r\n              if (wrap && cell.text && cell.text.height > rowHeight) {\r\n                self.sizes.rows[isHeader ? -1 : rowIndex] = cell.text.height;\r\n                checkScrollHeight = true;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (active) {\r\n          aCell = cell;\r\n        }\r\n        createBorderOverlayArray(cell, selectionBorders, 'selection');\r\n        // createBorderOverlayArray calculates data for createHandlesOverlayArray so it must go 2nd\r\n        createHandlesOverlayArray(cell);\r\n        if (self.movingSelection) {\r\n          createBorderOverlayArray(cell, moveBorders, 'move', self.moveOffset);\r\n        }\r\n        self.ctx.restore();\r\n\r\n        // Gaps may occur in row numbers between consecutively rendered rows\r\n        // when we are filtering. We draw attention to this by drawing a thick\r\n        // border overlapping the two consecutive row headers.\r\n        if (\r\n          isRowHeader &&\r\n          self.attributes.showRowNumbers &&\r\n          self.attributes.showRowNumberGaps\r\n        ) {\r\n          const previousRowNumber = self.getBoundRowIndexFromViewRowIndex(\r\n            rowOrderIndex - 1,\r\n          );\r\n          const hasRowGap =\r\n            previousRowNumber !== undefined &&\r\n            cell.boundRowIndex > 0 &&\r\n            cell.boundRowIndex - previousRowNumber > 1;\r\n\r\n          if (hasRowGap) {\r\n            const barHeight = self.style.rowHeaderCellRowNumberGapHeight;\r\n            const barColor = self.style.rowHeaderCellRowNumberGapColor;\r\n\r\n            self.ctx.save();\r\n\r\n            self.ctx.fillStyle = barColor;\r\n\r\n            fillRect(cell.x, cell.y - barHeight / 2, cell.width, barHeight);\r\n\r\n            self.ctx.restore();\r\n          }\r\n        }\r\n\r\n        x += cell.width + (bc ? 0 : self.style.cellBorderWidth);\r\n        return cell.width;\r\n      };\r\n    }\r\n    function drawRowHeader(rowData, rowIndex, rowOrderIndex) {\r\n      if (self.attributes.showRowHeaders) {\r\n        x = 0;\r\n\r\n        // When filtering we'd like to display the actual row numbers,\r\n        // as it is in the unfiltered data, instead of simply the viewed\r\n        // row index + 1. If rowIndex > viewData.length, it's a new row\r\n        // added to the end, and we want to render that new row's number\r\n        const filteredRowNumber =\r\n          self.viewData && rowIndex < self.viewData.length\r\n            ? self.getBoundRowIndexFromViewRowIndex(rowIndex) + 1\r\n            : self.originalData\r\n            ? self.originalData.length + 1\r\n            : rowOrderIndex + 1;\r\n\r\n        const rowHeaderValue = self.hasActiveFilters()\r\n          ? filteredRowNumber\r\n          : rowIndex + 1;\r\n\r\n        const rowHeaderCell = { rowHeaderCell: rowHeaderValue };\r\n        const headerDescription = {\r\n          name: 'rowHeaderCell',\r\n          width: self.sizes.columns[-1] || self.style.rowHeaderCellWidth,\r\n          style: 'rowHeaderCell',\r\n          type: 'string',\r\n          data: rowHeaderValue,\r\n          index: -1,\r\n        };\r\n        rowOpen = self.openChildren[rowIndex];\r\n        drawCell(rowHeaderCell, rowOrderIndex, rowIndex)(\r\n          headerDescription,\r\n          -1,\r\n          -1,\r\n        );\r\n      }\r\n    }\r\n    function drawHeaders() {\r\n      var d,\r\n        g = schema.length,\r\n        i,\r\n        o,\r\n        columnHeaderCell,\r\n        header,\r\n        nonFrozenHeaderWidth;\r\n      function drawHeaderColumnRange(start, end) {\r\n        end = Math.min(end, g);\r\n        for (o = start; o < end; o += 1) {\r\n          i = self.orders.columns[o];\r\n          header = schema[i];\r\n          if (!header.hidden) {\r\n            d = {\r\n              title: header.title,\r\n              name: header.name,\r\n              width: header.width || self.style.cellWidth,\r\n              style: 'columnHeaderCell',\r\n              type: 'string',\r\n              index: o,\r\n              order: i,\r\n            };\r\n            columnHeaderCell = {\r\n              columnHeaderCell: header.title || header.name,\r\n            };\r\n            x += drawCell(columnHeaderCell, -1, -1)(d, i, o);\r\n            if (x > self.width + self.scrollBox.scrollLeft) {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      rowHeaders.forEach(function (rArgs, rhIndex) {\r\n        y = rArgs[3];\r\n        cellHeight = rArgs[4];\r\n        if (rhIndex === self.frozenRow) {\r\n          self.ctx.save();\r\n          radiusRect(\r\n            0,\r\n            self.lastFrozenRowPixel,\r\n            self.width,\r\n            self.height - self.lastFrozenRowPixel,\r\n            0,\r\n          );\r\n          self.ctx.clip();\r\n        }\r\n        drawRowHeader(rArgs[0], rArgs[1], rArgs[2]);\r\n      });\r\n      self.ctx.restore();\r\n      if (self.attributes.showColumnHeaders) {\r\n        x =\r\n          -self.scrollBox.scrollLeft +\r\n          self.scrollPixelLeft +\r\n          self.style.columnHeaderCellBorderWidth;\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        y = 0;\r\n        // cell height might have changed during drawing\r\n        cellHeight = self.getColumnHeaderCellHeight();\r\n        drawHeaderColumnRange(self.scrollIndexLeft, g);\r\n        nonFrozenHeaderWidth = x;\r\n        x = self.style.columnHeaderCellBorderWidth;\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        drawHeaderColumnRange(0, self.frozenColumn);\r\n        // fill in the space right of the headers\r\n        x = nonFrozenHeaderWidth;\r\n        if (x < w) {\r\n          c = {\r\n            name: '',\r\n            width: self.style.scrollBarWidth,\r\n            style: 'columnHeaderCellCap',\r\n            isColumnHeaderCell: true,\r\n            isColumnHeaderCellCap: true,\r\n            type: 'string',\r\n            index: schema.length,\r\n          };\r\n          drawCell({ endCap: '' }, -1, -1)(c, -1, -1);\r\n        }\r\n        // fill in the space right of the headers\r\n        if (self.attributes.showRowHeaders) {\r\n          cornerCell = { cornerCell: '' };\r\n          x = 0;\r\n          c = {\r\n            name: 'cornerCell',\r\n            width: self.style.rowHeaderCellWidth,\r\n            style: 'cornerCell',\r\n            type: 'string',\r\n            index: -1,\r\n          };\r\n          drawCell(cornerCell, -1, -1)(c, -1, -1);\r\n        }\r\n      }\r\n    }\r\n    function drawRow(rowOrderIndex, rowIndex) {\r\n      var headerIndex,\r\n        treeHeight,\r\n        rowSansTreeHeight,\r\n        columnOrderIndex,\r\n        g = schema.length;\r\n      if (y - cellHeight * 2 > h) {\r\n        return false;\r\n      }\r\n      rowData = viewData[rowOrderIndex];\r\n      rowOpen = self.openChildren[rowOrderIndex];\r\n      rowSansTreeHeight =\r\n        (self.sizes.rows[rowOrderIndex] || self.style.cellHeight) * self.scale;\r\n      treeHeight = (rowOpen ? self.sizes.trees[rowOrderIndex] : 0) * self.scale;\r\n      rowHeight = rowSansTreeHeight + treeHeight;\r\n      if (y < -rowHeight) {\r\n        return false;\r\n      }\r\n      if (self.attributes.showRowHeaders) {\r\n        x += rowHeaderCellWidth;\r\n      }\r\n      cellHeight = rowHeight;\r\n      //draw normal columns\r\n      for (\r\n        columnOrderIndex = self.scrollIndexLeft;\r\n        columnOrderIndex < g;\r\n        columnOrderIndex += 1\r\n      ) {\r\n        headerIndex = self.orders.columns[columnOrderIndex];\r\n        x += drawCell(rowData, rowOrderIndex, rowIndex)(\r\n          schema[headerIndex],\r\n          headerIndex,\r\n          columnOrderIndex,\r\n        );\r\n        if (x > self.width) {\r\n          self.scrollIndexRight = columnOrderIndex;\r\n          self.scrollPixelRight = x;\r\n          break;\r\n        }\r\n      }\r\n      //draw frozen columns\r\n      x = 0;\r\n      if (self.attributes.showRowHeaders) {\r\n        x += rowHeaderCellWidth;\r\n      }\r\n      for (\r\n        columnOrderIndex = 0;\r\n        columnOrderIndex < self.frozenColumn;\r\n        columnOrderIndex += 1\r\n      ) {\r\n        headerIndex = self.orders.columns[columnOrderIndex];\r\n        x += drawCell(rowData, rowOrderIndex, rowIndex)(\r\n          schema[headerIndex],\r\n          headerIndex,\r\n          columnOrderIndex,\r\n        );\r\n        if (x > self.width) {\r\n          break;\r\n        }\r\n      }\r\n      self.lastFrozenColumnPixel = x;\r\n      // cell height might have changed during drawing\r\n      cellHeight = rowHeight;\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      // don't draw a tree for the new row\r\n      treeGrid = self.childGrids[rowOrderIndex];\r\n      if (rowOrderIndex !== viewData.length && rowOpen) {\r\n        treeGrid.visible = true;\r\n        treeGrid.parentNode = {\r\n          offsetTop: y + rowSansTreeHeight + self.canvasOffsetTop,\r\n          offsetLeft: rowHeaderCellWidth - 1 + self.canvasOffsetLeft,\r\n          offsetHeight: treeHeight,\r\n          offsetWidth:\r\n            self.width - rowHeaderCellWidth - self.style.scrollBarWidth - 1,\r\n          offsetParent: self.intf.parentNode,\r\n          parentNode: self.intf.parentNode,\r\n          style: self.style,\r\n          nodeType: 'canvas-datagrid-tree',\r\n          scrollTop: self.scrollBox.scrollTop,\r\n          scrollLeft: self.scrollBox.scrollLeft,\r\n          rowIndex: rowOrderIndex,\r\n        };\r\n        self.visibleCells.unshift({\r\n          rowIndex: rowOrderIndex,\r\n          columnIndex: 0,\r\n          y: treeGrid.parentNode.offsetTop,\r\n          x: treeGrid.parentNode.offsetLeft,\r\n          height: treeGrid.height,\r\n          width: treeGrid.width,\r\n          style: 'tree-grid',\r\n          type: treeGrid.parentNode.nodeType,\r\n        });\r\n        treeGrid.draw();\r\n      } else if (treeGrid) {\r\n        treeGrid.parentNode.offsetHeight = 0;\r\n        delete self.sizes.trees[rowOrderIndex];\r\n      }\r\n      rowHeaders.push([rowData, rowOrderIndex, rowIndex, y, rowHeight]);\r\n      self.visibleRowHeights[rowOrderIndex] = rowHeight;\r\n      y += cellHeight + (bc ? 0 : self.style.cellBorderWidth);\r\n      return true;\r\n    }\r\n    function initDraw() {\r\n      self.visibleRows = [];\r\n      schema = self.getSchema();\r\n      self.visibleCells = [];\r\n      self.canvasOffsetTop = self.isChildGrid ? self.parentNode.offsetTop : 0.5;\r\n      self.canvasOffsetLeft = self.isChildGrid\r\n        ? self.parentNode.offsetLeft\r\n        : -0.5;\r\n      h = self.height;\r\n      w = self.width;\r\n    }\r\n    function drawBackground() {\r\n      radiusRect(0, 0, w, h, 0);\r\n      self.ctx.clip();\r\n      self.ctx.fillStyle = self.style.gridBackgroundColor;\r\n      fillRect(0, 0, w, h);\r\n    }\r\n    function drawFrozenRows() {\r\n      var rowOrderIndex,\r\n        ln = Math.min(viewData.length, self.frozenRow);\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      y = columnHeaderCellHeight;\r\n      for (rowIndex = 0; rowIndex < ln; rowIndex += 1) {\r\n        rowOrderIndex = self.orders.rows[rowIndex];\r\n        if (!drawRow(rowOrderIndex, rowIndex)) {\r\n          break;\r\n        }\r\n      }\r\n      if (self.attributes.allowFreezingRows) {\r\n        // HACK great, another stupid magic number.\r\n        // Background will appear as a 0.5px artifact behind the row freeze bar without this hack\r\n        y +=\r\n          self.style.frozenMarkerBorderWidth +\r\n          self.style.frozenMarkerWidth -\r\n          0.4999999999;\r\n      }\r\n      self.lastFrozenRowPixel = y;\r\n    }\r\n    function drawRows() {\r\n      self.ctx.save();\r\n      if (self.frozenRow > 0) {\r\n        radiusRect(\r\n          0,\r\n          self.lastFrozenRowPixel,\r\n          self.width,\r\n          self.height - self.lastFrozenRowPixel,\r\n          0,\r\n        );\r\n        self.ctx.clip();\r\n      }\r\n      var columnOrderIndex,\r\n        rowOrderIndex,\r\n        headerIndex,\r\n        g = schema.length;\r\n      x =\r\n        -self.scrollBox.scrollLeft +\r\n        self.scrollPixelLeft +\r\n        self.style.cellBorderWidth;\r\n      if (!self.attributes.snapToRow) {\r\n        y +=\r\n          -self.scrollBox.scrollTop +\r\n          self.scrollPixelTop +\r\n          self.style.cellBorderWidth;\r\n      }\r\n      for (\r\n        rowIndex = self.frozenRow + self.scrollIndexTop;\r\n        rowIndex < l;\r\n        rowIndex += 1\r\n      ) {\r\n        rowOrderIndex = self.orders.rows[rowIndex];\r\n        self.scrollIndexBottom = rowIndex;\r\n        self.scrollPixelBottom = y;\r\n        if (!drawRow(rowOrderIndex, rowIndex)) {\r\n          break;\r\n        }\r\n      }\r\n      if (self.attributes.showNewRow) {\r\n        if (self.attributes.showRowHeaders) {\r\n          x += rowHeaderCellWidth;\r\n        }\r\n        rowHeight = cellHeight = self.style.cellHeight;\r\n        rowOpen = false;\r\n        for (\r\n          columnOrderIndex = self.scrollIndexLeft;\r\n          columnOrderIndex < g;\r\n          columnOrderIndex += 1\r\n        ) {\r\n          headerIndex = self.orders.columns[columnOrderIndex];\r\n          x += drawCell(self.newRow, viewData.length, viewData.length)(\r\n            schema[headerIndex],\r\n            headerIndex,\r\n            columnOrderIndex,\r\n          );\r\n          if (x > self.width + self.scrollBox.scrollLeft) {\r\n            break;\r\n          }\r\n        }\r\n        rowHeaders.push([\r\n          self.newRow,\r\n          viewData.length,\r\n          viewData.length,\r\n          y,\r\n          rowHeight,\r\n        ]);\r\n      }\r\n      self.ctx.restore();\r\n    }\r\n    function drawMoveMarkers() {\r\n      if (!self.movingSelection) {\r\n        return;\r\n      }\r\n      self.ctx.lineWidth = self.style.moveOverlayBorderWidth;\r\n      self.ctx.strokeStyle = self.style.moveOverlayBorderColor;\r\n      self.ctx.setLineDash(self.style.moveOverlayBorderSegments);\r\n      moveBorders.forEach(function (c) {\r\n        addBorderLine(c[0], c[1]);\r\n      });\r\n      self.ctx.setLineDash([]);\r\n    }\r\n    function drawReorderMarkers() {\r\n      if (!self.reorderObject) {\r\n        return;\r\n      }\r\n      var b = {\r\n          height: self.reorderObject.height,\r\n          width: self.reorderObject.width,\r\n          x: self.reorderObject.x + self.reorderObject.dragOffset.x,\r\n          y: self.reorderObject.y + self.reorderObject.dragOffset.y,\r\n        },\r\n        m = {\r\n          width: w,\r\n          height: h,\r\n          x: 0,\r\n          y: 0,\r\n        };\r\n      self.ctx.fillStyle = self.style.reorderMarkerBackgroundColor;\r\n      self.ctx.lineWidth = self.style.reorderMarkerBorderWidth;\r\n      self.ctx.strokeStyle = self.style.reorderMarkerBorderColor;\r\n      if (self.dragMode === 'row-reorder') {\r\n        b.width = w;\r\n        b.x = 0;\r\n        m.width = w;\r\n        m.height = self.currentCell.height;\r\n        m.y = self.currentCell.y;\r\n        fillRect(b.x, b.y, b.width, b.height);\r\n        strokeRect(b.x, b.y, b.width, b.height);\r\n        self.ctx.lineWidth = self.style.reorderMarkerIndexBorderWidth;\r\n        self.ctx.strokeStyle = self.style.reorderMarkerIndexBorderColor;\r\n        if (\r\n          self.currentCell.rowIndex !== self.reorderObject.rowIndex &&\r\n          self.currentCell.rowIndex > -1 &&\r\n          self.currentCell.rowIndex < l\r\n        ) {\r\n          addBorderLine(\r\n            m,\r\n            self.reorderTarget.sortRowIndex > self.reorderObject.sortRowIndex\r\n              ? 'b'\r\n              : 't',\r\n          );\r\n        }\r\n      } else if (self.dragMode === 'column-reorder' && self.reorderObject) {\r\n        b.height = h;\r\n        b.y = 0;\r\n        m.height = h;\r\n        m.width = self.currentCell.width;\r\n        m.y = 0;\r\n        m.x = self.currentCell.x;\r\n        fillRect(b.x, b.y, b.width, b.height);\r\n        strokeRect(b.x, b.y, b.width, b.height);\r\n        self.ctx.lineWidth = self.style.reorderMarkerIndexBorderWidth;\r\n        self.ctx.strokeStyle = self.style.reorderMarkerIndexBorderColor;\r\n        if (\r\n          self.currentCell.sortColumnIndex !==\r\n            self.reorderObject.sortColumnIndex &&\r\n          self.currentCell.sortColumnIndex > -1 &&\r\n          self.currentCell.sortColumnIndex < schema.length\r\n        ) {\r\n          addBorderLine(\r\n            m,\r\n            self.reorderTarget.columnIndex > self.reorderObject.columnIndex\r\n              ? 'r'\r\n              : 'l',\r\n          );\r\n        }\r\n      }\r\n    }\r\n    function drawBorder() {\r\n      self.ctx.lineWidth = self.style.gridBorderWidth;\r\n      self.ctx.strokeStyle = self.style.gridBorderColor;\r\n      strokeRect(0, 0, self.width, self.height);\r\n    }\r\n    function drawSelectionBorders() {\r\n      self.ctx.lineWidth = self.style.selectionOverlayBorderWidth;\r\n      self.ctx.strokeStyle = self.style.selectionOverlayBorderColor;\r\n      function dsb(c) {\r\n        addBorderLine(c[0], c[1]);\r\n      }\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex < self.frozenRow &&\r\n            c[0].columnIndex < self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.save();\r\n      clipFrozenArea(0);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex >= self.frozenRow &&\r\n            c[0].columnIndex >= self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n      self.ctx.save();\r\n      clipFrozenArea(1);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex >= self.frozenRow &&\r\n            c[0].columnIndex < self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n      self.ctx.save();\r\n      clipFrozenArea(2);\r\n      selectionBorders\r\n        .filter(function (c) {\r\n          return (\r\n            c[0].rowIndex < self.frozenRow &&\r\n            c[0].columnIndex >= self.frozenColumn\r\n          );\r\n        })\r\n        .forEach(dsb);\r\n      self.ctx.restore();\r\n    }\r\n    function drawSelectionHandles() {\r\n      if (self.mobile || self.attributes.allowMovingSelection) {\r\n        self.ctx.lineWidth = self.style.selectionHandleBorderWidth;\r\n        self.ctx.strokeStyle = self.style.selectionHandleBorderColor;\r\n        self.ctx.fillStyle = self.style.selectionHandleColor;\r\n        selectionHandles.forEach(function (c) {\r\n          addselectionHandle(c[0], c[1]);\r\n          var az = self.attributes.touchSelectHandleZone / 2,\r\n            ax =\r\n              c[0].x + (c[1] === 'tl' || c[1] === 'bl' ? 0 : c[0].width) - az,\r\n            ay =\r\n              c[0].y + (c[1] === 'bl' || c[1] === 'br' ? c[0].height : 0) - az;\r\n          self.visibleCells.unshift({\r\n            x: ax,\r\n            y: ay,\r\n            height: self.style.selectionHandleSize + az,\r\n            width: self.style.selectionHandleSize + az,\r\n            style: 'selection-handle-' + c[1],\r\n          });\r\n        });\r\n      }\r\n    }\r\n    function drawActiveCell() {\r\n      if (!aCell) {\r\n        return;\r\n      }\r\n      self.ctx.save();\r\n      var cl =\r\n          self.activeCell.columnIndex + 1 > self.frozenColumn ||\r\n          self.activeCell.rowIndex + 1 > self.frozenRow,\r\n        acx = cl ? self.lastFrozenColumnPixel : 0,\r\n        acy = cl ? self.lastFrozenRowPixel : 0,\r\n        acw = cl ? self.width - self.lastFrozenColumnPixel : self.width,\r\n        ach = cl ? self.height - self.lastFrozenRowPixel : self.height;\r\n      radiusRect(acx, acy, acw, ach, 0);\r\n      self.ctx.clip();\r\n      if (self.attributes.selectionMode === 'row') {\r\n        if (self.activeCell && self.activeCell.rowIndex === aCell.rowIndex) {\r\n          self.ctx.lineWidth = self.style.activeCellOverlayBorderWidth;\r\n          self.ctx.strokeStyle = self.style.activeCellOverlayBorderColor;\r\n          strokeRect(\r\n            1,\r\n            aCell.y,\r\n            self.getHeaderWidth() + rowHeaderCellWidth,\r\n            self.visibleRowHeights[aCell.rowIndex],\r\n          );\r\n        }\r\n      } else {\r\n        self.ctx.lineWidth = self.style.activeCellOverlayBorderWidth;\r\n        self.ctx.strokeStyle = self.style.activeCellOverlayBorderColor;\r\n        strokeRect(aCell.x, aCell.y, aCell.width, aCell.height);\r\n      }\r\n      self.ctx.restore();\r\n    }\r\n    function drawFrozenMarkers() {\r\n      var my = self.lastFrozenRowPixel - self.style.frozenMarkerWidth,\r\n        mx = self.lastFrozenColumnPixel - self.style.frozenMarkerBorderWidth,\r\n        xHover =\r\n          self.currentCell && self.currentCell.style === 'frozen-row-marker',\r\n        yHover =\r\n          self.currentCell && self.currentCell.style === 'frozen-column-marker';\r\n      self.ctx.lineWidth = self.style.frozenMarkerBorderWidth;\r\n      if (self.attributes.allowFreezingColumns) {\r\n        self.ctx.fillStyle = yHover\r\n          ? self.style.frozenMarkerHoverColor\r\n          : self.style.frozenMarkerColor;\r\n        self.ctx.strokeStyle = yHover\r\n          ? self.style.frozenMarkerHoverBorderColor\r\n          : self.style.frozenMarkerBorderColor;\r\n        fillRect(mx, 0, self.style.frozenMarkerWidth, self.height);\r\n        strokeRect(mx, 0, self.style.frozenMarkerWidth, self.height);\r\n        self.visibleCells.unshift({\r\n          x: mx,\r\n          y: 0,\r\n          height: self.height,\r\n          width:\r\n            self.style.frozenMarkerWidth + self.style.frozenMarkerBorderWidth,\r\n          style: 'frozen-column-marker',\r\n        });\r\n      }\r\n      if (self.attributes.allowFreezingRows) {\r\n        self.ctx.fillStyle = xHover\r\n          ? self.style.frozenMarkerHoverColor\r\n          : self.style.frozenMarkerColor;\r\n        self.ctx.strokeStyle = xHover\r\n          ? self.style.frozenMarkerHoverBorderColor\r\n          : self.style.frozenMarkerBorderColor;\r\n        fillRect(0, my, self.width, self.style.frozenMarkerWidth);\r\n        strokeRect(0, my, self.width, self.style.frozenMarkerWidth);\r\n        self.visibleCells.unshift({\r\n          x: 0,\r\n          y: my,\r\n          height:\r\n            self.style.frozenMarkerWidth + self.style.frozenMarkerBorderWidth,\r\n          width: self.width,\r\n          style: 'frozen-row-marker',\r\n        });\r\n      }\r\n      if (self.freezeMarkerPosition) {\r\n        self.ctx.fillStyle = self.style.frozenMarkerActiveColor;\r\n        self.ctx.strokeStyle = self.style.frozenMarkerActiveBorderColor;\r\n        if (self.dragMode === 'frozen-column-marker') {\r\n          fillRect(\r\n            self.freezeMarkerPosition.x,\r\n            0,\r\n            self.style.frozenMarkerWidth,\r\n            self.height,\r\n          );\r\n          strokeRect(\r\n            self.freezeMarkerPosition.x,\r\n            0,\r\n            self.style.frozenMarkerWidth,\r\n            self.height,\r\n          );\r\n        } else {\r\n          fillRect(\r\n            0,\r\n            self.freezeMarkerPosition.y,\r\n            self.width,\r\n            self.style.frozenMarkerWidth,\r\n          );\r\n          strokeRect(\r\n            0,\r\n            self.freezeMarkerPosition.y,\r\n            self.width,\r\n            self.style.frozenMarkerWidth,\r\n          );\r\n        }\r\n      }\r\n    }\r\n    function drawPerfLines() {\r\n      if (!self.attributes.showPerformance) {\r\n        return;\r\n      }\r\n      var pw = 250,\r\n        px =\r\n          self.width -\r\n          pw -\r\n          self.style.scrollBarWidth -\r\n          self.style.scrollBarBorderWidth * 2,\r\n        py = columnHeaderCellHeight,\r\n        ph = 100;\r\n      if (scrollDebugCounters.length === 0) {\r\n        scrollDebugCounters = fillArray(0, perfWindowSize, 1, function () {\r\n          return [0, 0];\r\n        });\r\n      }\r\n      if (touchPPSCounters.length === 0) {\r\n        touchPPSCounters = fillArray(0, perfWindowSize, 1, function () {\r\n          return [0, 0];\r\n        });\r\n      }\r\n      if (entityCount.length === 0) {\r\n        entityCount = fillArray(0, perfWindowSize, 1, 0);\r\n      }\r\n      self.ctx.lineWidth = 0.5;\r\n      function dpl(name, perfArr, arrIndex, max, color, useAbs, rowIndex) {\r\n        var v;\r\n        drawPerfLine(pw, ph, px, py, perfArr, arrIndex, max, color, useAbs);\r\n        self.ctx.fillStyle = color;\r\n        fillRect(3 + px, py + 9 + rowIndex * 11, 8, 8);\r\n        self.ctx.fillStyle = self.style.debugPerfChartTextColor;\r\n        v = arrIndex !== undefined ? perfArr[0][arrIndex] : perfArr[0];\r\n        fillText(\r\n          name + ' ' + (isNaN(v) ? 0 : v).toFixed(3),\r\n          14 + px,\r\n          py + 16 + rowIndex * 11,\r\n        );\r\n      }\r\n      self.ctx.textAlign = 'left';\r\n      self.ctx.font = self.style.debugFont;\r\n      self.ctx.fillStyle = self.style.debugPerfChartBackground;\r\n      fillRect(px, py, pw, ph);\r\n      [\r\n        [\r\n          'Scroll Height',\r\n          scrollDebugCounters,\r\n          0,\r\n          self.scrollBox.scrollHeight,\r\n          self.style.debugScrollHeightColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Scroll Width',\r\n          scrollDebugCounters,\r\n          1,\r\n          self.scrollBox.scrollWidth,\r\n          self.style.debugScrollWidthColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Performance',\r\n          perfCounters,\r\n          undefined,\r\n          200,\r\n          self.style.debugPerformanceColor,\r\n          false,\r\n        ],\r\n        [\r\n          'Entities',\r\n          entityCount,\r\n          undefined,\r\n          1500,\r\n          self.style.debugEntitiesColor,\r\n          false,\r\n        ],\r\n        [\r\n          'TouchPPSX',\r\n          touchPPSCounters,\r\n          0,\r\n          1000,\r\n          self.style.debugTouchPPSXColor,\r\n          true,\r\n        ],\r\n        [\r\n          'TouchPPSY',\r\n          touchPPSCounters,\r\n          1,\r\n          1000,\r\n          self.style.debugTouchPPSYColor,\r\n          true,\r\n        ],\r\n      ].forEach(function (i, index) {\r\n        i.push(index);\r\n        dpl.apply(null, i);\r\n      });\r\n      self.ctx.fillStyle = self.style.debugPerfChartBackground;\r\n      entityCount.pop();\r\n      entityCount.unshift(self.visibleCells.length);\r\n      scrollDebugCounters.pop();\r\n      scrollDebugCounters.unshift([\r\n        self.scrollBox.scrollTop,\r\n        self.scrollBox.scrollLeft,\r\n      ]);\r\n      touchPPSCounters.pop();\r\n      touchPPSCounters.unshift([self.yPPS, self.xPPS]);\r\n    }\r\n    function drawDebug() {\r\n      self.ctx.save();\r\n      var d;\r\n      if (self.attributes.showPerformance || self.attributes.debug) {\r\n        if (perfCounters.length === 0) {\r\n          perfCounters = fillArray(0, perfWindowSize, 1, 0);\r\n        }\r\n        perfCounters.pop();\r\n        perfCounters.unshift(performance.now() - p);\r\n      }\r\n      if (!self.attributes.debug) {\r\n        self.ctx.restore();\r\n        return;\r\n      }\r\n      self.ctx.font = self.style.debugFont;\r\n      d = {};\r\n      d.perf = (\r\n        perfCounters.reduce(function (a, b) {\r\n          return a + b;\r\n        }, 0) / Math.min(drawCount, perfCounters.length)\r\n      ).toFixed(1);\r\n      d.perfDelta = perfCounters[0].toFixed(1);\r\n      d.frozenColumnsWidth = getFrozenColumnsWidth();\r\n      d.htmlImages = Object.keys(self.htmlImageCache).length;\r\n      d.reorderObject =\r\n        'x: ' +\r\n        (self.reorderObject || { columnIndex: 0 }).columnIndex +\r\n        ', y: ' +\r\n        (self.reorderObject || { rowIndex: 0 }).rowIndex;\r\n      d.reorderTarget =\r\n        'x: ' +\r\n        (self.reorderTarget || { columnIndex: 0 }).columnIndex +\r\n        ', y: ' +\r\n        (self.reorderTarget || { rowIndex: 0 }).rowIndex;\r\n      d.scale = self.scale;\r\n      d.startScale = self.startScale;\r\n      d.scaleDelta = self.scaleDelta;\r\n      d.zoomDeltaStart = self.zoomDeltaStart;\r\n      d.touchLength = self.touchLength;\r\n      d.touches =\r\n        'y0: ' +\r\n        (self.touchPosition || { y: 0 }).y +\r\n        ' y1: ' +\r\n        (self.touchPosition1 || { y: 0 }).y;\r\n      d.scrollBox = self.scrollBox.toString();\r\n      d.scrollIndex =\r\n        'x: ' + self.scrollIndexLeft + ', y: ' + self.scrollIndexTop;\r\n      d.scrollPixel =\r\n        'x: ' + self.scrollPixelLeft + ', y: ' + self.scrollPixelTop;\r\n      d.canvasOffset =\r\n        'x: ' + self.canvasOffsetLeft + ', y: ' + self.canvasOffsetTop;\r\n      d.touchDelta = 'x: ' + self.touchDelta.x + ', y: ' + self.touchDelta.y;\r\n      d.touchAnimateTo =\r\n        'x: ' + self.touchAnimateTo.x + ', y: ' + self.touchAnimateTo.y;\r\n      d.scrollAnimation =\r\n        'x: ' + self.scrollAnimation.x + ', y: ' + self.scrollAnimation.y;\r\n      d.touchPPS = 'x: ' + self.xPPS + ', y: ' + self.yPPS;\r\n      d.touchPPST = 'x: ' + self.xPPST + ', y: ' + self.yPPST;\r\n      d.touchDuration = self.touchDuration;\r\n      d.pointerLockPosition = self.pointerLockPosition\r\n        ? self.pointerLockPosition.x + ', ' + self.pointerLockPosition.y\r\n        : '';\r\n      d.size = 'w: ' + self.width + ', h: ' + self.height;\r\n      d.mouse = 'x: ' + self.mouse.x + ', y: ' + self.mouse.y;\r\n      d.touch = !self.touchStart\r\n        ? ''\r\n        : 'x: ' + self.touchStart.x + ', y: ' + self.touchStart.y;\r\n      d.entities = self.visibleCells.length;\r\n      d.hasFocus = self.hasFocus;\r\n      d.dragMode = self.dragMode;\r\n      if (self.currentCell) {\r\n        d.columnIndex = self.currentCell.columnIndex;\r\n        d.rowIndex = self.currentCell.rowIndex;\r\n        d.sortColumnIndex = self.currentCell.sortColumnIndex;\r\n        d.sortRowIndex = self.currentCell.sortRowIndex;\r\n        d.context = self.currentCell.context;\r\n        d.dragContext = self.currentCell.dragContext;\r\n        d.style = self.currentCell.style;\r\n        d.type = self.currentCell.type;\r\n      }\r\n      self.ctx.textAlign = 'right';\r\n      self.ctx.fillStyle = self.style.debugBackgroundColor;\r\n      fillRect(0, 0, self.width, self.height);\r\n      Object.keys(d).forEach(function (key, index) {\r\n        var m = key + ': ' + d[key],\r\n          lh = 14;\r\n        self.ctx.fillStyle = self.style.debugColor;\r\n        fillText(\r\n          m,\r\n          w - 20,\r\n          (self.attributes.showPerformance ? 140 : 24) + index * lh,\r\n        );\r\n      });\r\n      self.ctx.restore();\r\n    }\r\n    self.ctx.save();\r\n    initDraw();\r\n    drawBackground();\r\n    drawFrozenRows();\r\n    drawRows();\r\n    drawActiveCell();\r\n    drawHeaders();\r\n    drawFrozenMarkers();\r\n    drawSelectionHandles();\r\n    drawReorderMarkers();\r\n    drawMoveMarkers();\r\n    drawBorder();\r\n    drawSelectionBorders();\r\n    drawScrollBars();\r\n    if (checkScrollHeight) {\r\n      self.resize(true);\r\n    }\r\n    drawDebug();\r\n    drawPerfLines();\r\n    if (self.dispatchEvent('afterdraw', {})) {\r\n      return;\r\n    }\r\n    self.ctx.restore();\r\n  };\r\n}\r\n","module.exports=function(e){var o={};function a(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=o,a.d=function(e,o,t){a.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,o){if(1&o&&(e=a(e)),8&o)return e;if(4&o&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&o&&\"string\"!=typeof e)for(var r in e)a.d(t,r,function(o){return e[o]}.bind(null,r));return t},a.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(o,\"a\",o),o},a.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},a.p=\"\",a(a.s=0)}([function(e,o,a){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});var t=a(1),r=Object.keys(t.default).reduce((function(e,o){return e.concat(t.default[o])}),[]);o.default=function(e){return-1===r.indexOf(e.key)}},function(e,o,a){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});o.default={modifier:[\"Alt\",\"AltGraph\",\"CapsLock\",\"Control\",\"Fn\",\"FnLock\",\"Meta\",\"NumLock\",\"ScrollLock\",\"Shift\",\"Symbol\",\"SymbolLock\"],legacyModifier:[\"Hyper\",\"Super\"],whiteSpace:[\"Enter\",\"Tab\"],navigation:[\"ArrowDown\",\"ArrowLeft\",\"ArrowRight\",\"ArrowUp\",\"End\",\"Home\",\"PageDown\",\"PageUp\"],editing:[\"Backspace\",\"Clear\",\"Copy\",\"CrSel\",\"Cut\",\"Delete\",\"EraseEof\",\"ExSel\",\"Insert\",\"Paste\",\"Redo\",\"Undo\"],ui:[\"Accept\",\"Again\",\"Attn\",\"Cancel\",\"ContextMenu\",\"Escape\",\"Execute\",\"Find\",\"Help\",\"Pause\",\"Play\",\"Props\",\"Select\",\"ZoomIn\",\"ZoomOut\"],device:[\"BrightnessDown\",\"BrightnessUp\",\"Eject\",\"LogOff\",\"Power\",\"PowerOff\",\"PrintScreen\",\"Hibernate\",\"Standby\",\"WakeUp\"],imeCompositionKeys:[\"AllCandidates\",\"Alphanumeric\",\"CodeInput\",\"Compose\",\"Convert\",\"Dead\",\"FinalMode\",\"GroupFirst\",\"GroupLast\",\"GroupNext\",\"GroupPrevious\",\"ModeChange\",\"NextCandidate\",\"NonConvert\",\"PreviousCandidate\",\"Process\",\"SingleCandidate\"],koreanSpecific:[\"HangulMode\",\"HanjaMode\",\"JunjaMode\"],japaneseSpecific:[\"Eisu\",\"Hankaku\",\"Hiragana\",\"HiraganaKatakana\",\"KanaMode\",\"KanjiMode\",\"Katakana\",\"Romaji\",\"Zenkaku\",\"ZenkakuHankaku\"],commonFunction:[\"F1\",\"F2\",\"F3\",\"F4\",\"F5\",\"F6\",\"F7\",\"F8\",\"F9\",\"F10\",\"F11\",\"F12\",\"Soft1\",\"Soft2\",\"Soft3\",\"Soft4\"],multimedia:[\"ChannelDown\",\"ChannelUp\",\"Close\",\"MailForward\",\"MailReply\",\"MailSend\",\"MediaClose\",\"MediaFastForward\",\"MediaPause\",\"MediaPlay\",\"MediaPlayPause\",\"MediaRecord\",\"MediaRewind\",\"MediaStop\",\"MediaTrackNext\",\"MediaTrackPrevious\",\"New\",\"Open\",\"Print\",\"Save\",\"SpellCheck\"],multimediaNumpad:[\"Key11\",\"Key12\"],audio:[\"AudioBalanceLeft\",\"AudioBalanceRight\",\"AudioBassBoostDown\",\"AudioBassBoostToggle\",\"AudioBassBoostUp\",\"AudioFaderFront\",\"AudioFaderRear\",\"AudioSurroundModeNext\",\"AudioTrebleDown\",\"AudioTrebleUp\",\"AudioVolumeDown\",\"AudioVolumeUp\",\"AudioVolumeMute\",\"MicrophoneToggle\",\"MicrophoneVolumeDown\",\"MicrophoneVolumeUp\",\"MicrophoneVolumeMute\"],speech:[\"SpeechCorrectionList\",\"SpeechInputToggle\"],application:[\"LaunchApplication1\",\"LaunchApplication2\",\"LaunchCalendar\",\"LaunchContacts\",\"LaunchMail\",\"LaunchMediaPlayer\",\"LaunchMusicPlayer\",\"LaunchPhone\",\"LaunchScreenSaver\",\"LaunchSpreadsheet\",\"LaunchWebBrowser\",\"LaunchWebCam\",\"LaunchWordProcessor\"],browser:[\"BrowserBack\",\"BrowserFavorites\",\"BrowserForward\",\"BrowserHome\",\"BrowserRefresh\",\"BrowserSearch\",\"BrowserStop\"],mobilePhone:[\"AppSwitch\",\"Call\",\"Camera\",\"CameraFocus\",\"EndCall\",\"GoBack\",\"GoHome\",\"HeadsetHook\",\"LastNumberRedial\",\"Notification\",\"MannerMode\",\"VoiceDial\"],tv:[\"TV\",\"TV3DMode\",\"TVAntennaCable\",\"TVAudioDescription\",\"TVAudioDescriptionMixDown\",\"TVAudioDescriptionMixUp\",\"TVContentsMenu\",\"TVDataService\",\"TVInput\",\"TVInputComponent1\",\"TVInputComponent2\",\"TVInputComposite1\",\"TVInputComposite2\",\"TVInputHDMI1\",\"TVInputHDMI2\",\"TVInputHDMI3\",\"TVInputHDMI4\",\"TVInputVGA1\",\"TVMediaContext\",\"TVNetwork\",\"TVNumberEntry\",\"TVPower\",\"TVRadioService\",\"TVSatellite\",\"TVSatelliteBS\",\"TVSatelliteCS\",\"TVSatelliteToggle\",\"TVTerrestrialAnalog\",\"TVTerrestrialDigital\",\"TVTimer\"],mediaControls:[\"AVRInput\",\"AVRPower\",\"ColorF0Red\",\"ColorF1Green\",\"ColorF2Yellow\",\"ColorF3Blue\",\"ColorF4Grey\",\"ColorF5Brown\",\"ClosedCaptionToggle\",\"Dimmer\",\"DisplaySwap\",\"DVR\",\"Exit\",\"FavoriteClear0\",\"FavoriteClear1\",\"FavoriteClear2\",\"FavoriteClear3\",\"FavoriteRecall0\",\"FavoriteRecall1\",\"FavoriteRecall2\",\"FavoriteRecall3\",\"FavoriteStore0\",\"FavoriteStore1\",\"FavoriteStore2\",\"FavoriteStore3\",\"Guide\",\"GuideNextDay\",\"GuidePreviousDay\",\"Info\",\"InstantReplay\",\"Link\",\"ListProgram\",\"LiveContent\",\"Lock\",\"MediaApps\",\"MediaAudioTrack\",\"MediaLast\",\"MediaSkipBackward\",\"MediaSkipForward\",\"MediaStepBackward\",\"MediaStepForward\",\"MediaTopMenu\",\"NavigateIn\",\"NavigateNext\",\"NavigateOut\",\"NavigatePrevious\",\"NextFavoriteChannel\",\"NextUserProfile\",\"OnDemand\",\"Pairing\",\"PinPDown\",\"PinPMove\",\"PinPToggle\",\"PinPUp\",\"PlaySpeedDown\",\"PlaySpeedReset\",\"PlaySpeedUp\",\"RandomToggle\",\"RcLowBattery\",\"RecordSpeedNext\",\"RfBypass\",\"ScanChannelsToggle\",\"ScreenModeNext\",\"Settings\",\"SplitScreenToggle\",\"STBInput\",\"STBPower\",\"Subtitle\",\"Teletext\",\"VideoModeNext\",\"Wink\",\"ZoomToggle\"]}}]).default;","/*jslint browser: true, unparam: true, todo: true, plusplus: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport isPrintableKeyEvent from 'is-printable-key-event';\r\n\r\nexport default function (self) {\r\n  var wheeling;\r\n  self.stopPropagation = function (e) {\r\n    e.stopPropagation();\r\n  };\r\n  /**\r\n   * Adds an event listener to the given event.\r\n   * @memberof canvasDatagrid\r\n   * @name addEventListener\r\n   * @method\r\n   * @param {string} ev The name of the event to subscribe to.\r\n   * @param {function} fn The event procedure to execute when the event is raised.\r\n   */\r\n  self.addEventListener = function (ev, fn) {\r\n    self.events[ev] = self.events[ev] || [];\r\n    self.events[ev].unshift(fn);\r\n  };\r\n  /**\r\n   * Removes the given listener function from the given event.  Must be an actual reference to the function that was bound.\r\n   * @memberof canvasDatagrid\r\n   * @name removeEventListener\r\n   * @method\r\n   * @param {string} ev The name of the event to unsubscribe from.\r\n   * @param {function} fn The event procedure to execute when the event is raised.\r\n   */\r\n  self.removeEventListener = function (ev, fn) {\r\n    (self.events[ev] || []).forEach(function removeEachListener(sfn, idx) {\r\n      if (fn === sfn) {\r\n        self.events[ev].splice(idx, 1);\r\n      }\r\n    });\r\n  };\r\n  /**\r\n   * Fires the given event, passing an event object to the event subscribers.\r\n   * @memberof canvasDatagrid\r\n   * @name dispatchEvent\r\n   * @method\r\n   * @param {number} ev The name of the event to dispatch.\r\n   * @param {number} e The event object.\r\n   */\r\n  self.dispatchEvent = function (ev, e) {\r\n    e = ev.type ? ev : e || {};\r\n    ev = ev.type || ev;\r\n    var defaultPrevented;\r\n    function preventDefault() {\r\n      defaultPrevented = true;\r\n    }\r\n    if (!self.events[ev]) {\r\n      return;\r\n    }\r\n    self.events[ev].forEach(function dispatchEachEvent(fn) {\r\n      e.ctx = self.ctx;\r\n      e.preventDefault = preventDefault;\r\n      fn.apply(self.intf, [e]);\r\n    });\r\n    return defaultPrevented;\r\n  };\r\n  self.getRatio = function () {\r\n    return Math.min(\r\n      self.attributes.maxPixelRatio,\r\n      (window.devicePixelRatio || 1) /\r\n        (self.ctx.webkitBackingStorePixelRatio ||\r\n          self.ctx.mozBackingStorePixelRatio ||\r\n          self.ctx.msBackingStorePixelRatio ||\r\n          self.ctx.oBackingStorePixelRatio ||\r\n          self.ctx.backingStorePixelRatio ||\r\n          1),\r\n    );\r\n  };\r\n  self.resize = function (drawAfterResize) {\r\n    if (!self.canvas) {\r\n      return;\r\n    }\r\n    var x,\r\n      v = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'vertical-scroll-bar',\r\n      },\r\n      n = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'horizontal-scroll-bar',\r\n      },\r\n      vb = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'vertical-scroll-box',\r\n      },\r\n      nb = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        style: 'horizontal-scroll-box',\r\n      },\r\n      co = {\r\n        x: 0,\r\n        y: 0,\r\n        height: 0,\r\n        width: 0,\r\n        isCorner: true,\r\n        isScrollBoxCorner: true,\r\n        style: 'scroll-box-corner',\r\n      },\r\n      m = self.style.scrollBarBoxMargin * 2,\r\n      b = self.style.scrollBarBorderWidth * 2,\r\n      d = self.style.scrollBarBoxMargin * 0.5,\r\n      sbw = self.style.scrollBarWidth + self.style.scrollBarBorderWidth * 2,\r\n      ratio = self.getRatio(),\r\n      bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\r\n      cellBorder = self.style.cellBorderWidth * bm,\r\n      columnHeaderCellBorder = self.style.columnHeaderCellBorderWidth * bm,\r\n      dataHeight = 0,\r\n      dataWidth = 0,\r\n      dims,\r\n      l = (self.viewData || []).length,\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      ch = self.style.cellHeight,\r\n      s = self.getSchema();\r\n    // sets actual DOM canvas element\r\n    function checkScrollBoxVisibility() {\r\n      self.scrollBox.horizontalBarVisible =\r\n        (self.style.width !== 'auto' &&\r\n          dataWidth > self.scrollBox.width &&\r\n          self.style.overflowX !== 'hidden') ||\r\n        self.style.overflowX === 'scroll';\r\n      self.scrollBox.horizontalBoxVisible = dataWidth > self.scrollBox.width;\r\n      self.scrollBox.verticalBarVisible =\r\n        (self.style.height !== 'auto' &&\r\n          dataHeight > self.scrollBox.height &&\r\n          self.style.overflowY !== 'hidden') ||\r\n        self.style.overflowY === 'scroll';\r\n      self.scrollBox.verticalBoxVisible = dataHeight > self.scrollBox.height;\r\n    }\r\n    function setScrollBoxSize() {\r\n      self.scrollBox.width = self.width - rowHeaderCellWidth;\r\n      self.scrollBox.height = self.height - columnHeaderCellHeight;\r\n    }\r\n    function setCanvasSize() {\r\n      if (self.isChildGrid) {\r\n        return;\r\n      }\r\n      dims = {\r\n        // HACK +1 ? maybe it's a magic cell border?  Required to line up properly in auto height mode.\r\n        height: columnHeaderCellHeight + dataHeight + cellBorder + 1,\r\n        width: dataWidth + rowHeaderCellWidth + cellBorder,\r\n      };\r\n      ['width', 'height'].forEach(function (dim) {\r\n        //TODO: support inherit\r\n        if (\r\n          ['auto', undefined].indexOf(self.style[dim]) !== -1 &&\r\n          ['auto', undefined].indexOf(self.appliedInlineStyles[dim]) !== -1\r\n        ) {\r\n          self.parentNodeStyle[dim] = dims[dim] + 'px';\r\n        } else if (\r\n          ['auto', undefined].indexOf(self.style[dim]) == -1 &&\r\n          ['auto', undefined].indexOf(self.appliedInlineStyles[dim]) == -1\r\n        ) {\r\n          self.parentNodeStyle[dim] = self.style[dim];\r\n          if (self.isComponent) {\r\n            self.canvas.style[dim] = self.style[dim];\r\n          }\r\n        }\r\n      });\r\n    }\r\n    self.scrollCache.x = [];\r\n    self.scrollCache.y = [];\r\n    for (x = 0; x < l; x += 1) {\r\n      self.scrollCache.y[x] = dataHeight;\r\n      dataHeight +=\r\n        ((self.sizes.rows[x] || ch) + (self.sizes.trees[x] || 0)) * self.scale +\r\n        // HACK? if an expanded tree row is frozen it is necessary to add the tree row's height a second time.\r\n        (self.frozenRow > x ? self.sizes.trees[x] || 0 : 0);\r\n    }\r\n    if (l > 1) {\r\n      self.scrollCache.y[x] = dataHeight;\r\n    }\r\n    dataWidth =\r\n      s.reduce(function reduceSchema(accumulator, column, columnIndex) {\r\n        // intentional redefintion of column.  This causes scrollCache to be in the correct order\r\n        column = s[self.orders.columns[columnIndex]];\r\n        if (column.hidden) {\r\n          self.scrollCache.x[columnIndex] = accumulator;\r\n          return accumulator;\r\n        }\r\n        var va =\r\n          accumulator + self.getColumnWidth(self.orders.columns[columnIndex]);\r\n        self.scrollCache.x[columnIndex] = va;\r\n        return va;\r\n      }, 0) || 0;\r\n    if (self.attributes.showNewRow) {\r\n      dataHeight += ch;\r\n    }\r\n    if (self.attributes.snapToRow) {\r\n      dataHeight += self.style.cellHeight;\r\n    }\r\n    setCanvasSize();\r\n    if (self.isChildGrid) {\r\n      self.width = self.parentNode.offsetWidth;\r\n      self.height = self.parentNode.offsetHeight;\r\n    } else if (\r\n      self.height !== self.canvas.offsetHeight ||\r\n      self.width !== self.canvas.offsetWidth\r\n    ) {\r\n      self.height = self.canvas.offsetHeight;\r\n      self.width = self.canvas.offsetWidth;\r\n      self.canvasOffsetLeft = self.args.canvasOffsetLeft || 0;\r\n      self.canvasOffsetTop = self.args.canvasOffsetTop || 0;\r\n    }\r\n    /// calculate scroll bar dimensions\r\n    // non-controversial\r\n    self.scrollBox.top = columnHeaderCellHeight + columnHeaderCellBorder;\r\n    self.scrollBox.left = rowHeaderCellWidth;\r\n    // width and height of scroll box\r\n    setScrollBoxSize();\r\n    // is the data larger than the scroll box\r\n    checkScrollBoxVisibility();\r\n    // if the scroll box is visible, make room for it by expanding the size of the element\r\n    // if the other dimension is set to auto\r\n    if (self.scrollBox.horizontalBarVisible) {\r\n      if (self.style.height === 'auto' && !self.isChildGrid) {\r\n        self.height += sbw;\r\n      }\r\n      dataHeight += sbw;\r\n      setCanvasSize();\r\n      setScrollBoxSize();\r\n      checkScrollBoxVisibility();\r\n    }\r\n    if (self.scrollBox.verticalBarVisible) {\r\n      if (self.style.width === 'auto' && !self.isChildGrid) {\r\n        self.width += sbw;\r\n      }\r\n      dataWidth += sbw;\r\n      setCanvasSize();\r\n      setScrollBoxSize();\r\n      checkScrollBoxVisibility();\r\n    }\r\n    // set again after bar visibility checks\r\n    setScrollBoxSize();\r\n    self.scrollBox.scrollWidth = dataWidth - self.scrollBox.width;\r\n    self.scrollBox.scrollHeight = dataHeight - self.scrollBox.height;\r\n    self.scrollBox.widthBoxRatio = self.scrollBox.width / dataWidth;\r\n    self.scrollBox.scrollBoxWidth =\r\n      self.scrollBox.width * self.scrollBox.widthBoxRatio -\r\n      self.style.scrollBarWidth -\r\n      b -\r\n      d;\r\n    // TODO: This heightBoxRatio number is terribly wrong.\r\n    // They should be a result of the size of the grid/canvas?\r\n    // it being off causes the scroll bar to \"slide\" under\r\n    // the dragged mouse.\r\n    // https://github.com/TonyGermaneri/canvas-datagrid/issues/97\r\n    self.scrollBox.heightBoxRatio =\r\n      (self.scrollBox.height - columnHeaderCellHeight) / dataHeight;\r\n    self.scrollBox.scrollBoxHeight =\r\n      self.scrollBox.height * self.scrollBox.heightBoxRatio -\r\n      self.style.scrollBarWidth -\r\n      b -\r\n      d;\r\n    self.scrollBox.scrollBoxWidth = Math.max(\r\n      self.scrollBox.scrollBoxWidth,\r\n      self.style.scrollBarBoxMinSize,\r\n    );\r\n    self.scrollBox.scrollBoxHeight = Math.max(\r\n      self.scrollBox.scrollBoxHeight,\r\n      self.style.scrollBarBoxMinSize,\r\n    );\r\n    // horizontal\r\n    n.x += rowHeaderCellWidth;\r\n    n.y += self.height - self.style.scrollBarWidth - d;\r\n    n.width =\r\n      self.width - self.style.scrollBarWidth - rowHeaderCellWidth - d - m;\r\n    n.height = self.style.scrollBarWidth + self.style.scrollBarBorderWidth + d;\r\n    // horizontal box\r\n    nb.y = n.y + self.style.scrollBarBoxMargin;\r\n    nb.width = self.scrollBox.scrollBoxWidth;\r\n    nb.height = self.style.scrollBarBoxWidth;\r\n    // vertical\r\n    v.x +=\r\n      self.width -\r\n      self.style.scrollBarWidth -\r\n      self.style.scrollBarBorderWidth -\r\n      d;\r\n    v.y += columnHeaderCellHeight;\r\n    v.width = self.style.scrollBarWidth + self.style.scrollBarBorderWidth + d;\r\n    v.height =\r\n      self.height - columnHeaderCellHeight - self.style.scrollBarWidth - d - m;\r\n    // vertical box\r\n    vb.x = v.x + self.style.scrollBarBoxMargin;\r\n    vb.width = self.style.scrollBarBoxWidth;\r\n    vb.height = self.scrollBox.scrollBoxHeight;\r\n    // corner\r\n    co.x = n.x + n.width + m;\r\n    co.y = v.y + v.height + m;\r\n    co.width = self.style.scrollBarWidth + self.style.scrollBarBorderWidth;\r\n    co.height = self.style.scrollBarWidth + self.style.scrollBarBorderWidth;\r\n    self.scrollBox.entities = {\r\n      horizontalBar: n,\r\n      horizontalBox: nb,\r\n      verticalBar: v,\r\n      verticalBox: vb,\r\n      corner: co,\r\n    };\r\n    self.scrollBox.bar = {\r\n      v: v,\r\n      h: n,\r\n    };\r\n    self.scrollBox.box = {\r\n      v: vb,\r\n      h: nb,\r\n    };\r\n    /// calculate page and dom elements\r\n    self.page = Math.max(\r\n      1,\r\n      self.visibleRows.length - 3 - self.attributes.pageUpDownOverlap,\r\n    );\r\n    // set canvas drawing related items\r\n    if (!self.isChildGrid) {\r\n      self.canvas.width = self.width * ratio;\r\n      self.canvas.height = self.height * ratio;\r\n      self.ctx.scale(ratio, ratio);\r\n    }\r\n    // resize any open dom elements (input/textarea)\r\n    self.resizeEditInput();\r\n    self.scroll(true);\r\n    if (drawAfterResize) {\r\n      self.draw(true);\r\n    }\r\n    self.dispatchEvent('resize', {});\r\n    return true;\r\n  };\r\n  self.scroll = function (dontDraw) {\r\n    var s = self.getSchema(),\r\n      l = (self.viewData || []).length,\r\n      ch = self.style.cellHeight;\r\n    // go too far in leaps, then get focused\r\n    self.scrollIndexTop = Math.floor(\r\n      l * (self.scrollBox.scrollTop / self.scrollBox.scrollHeight) - 100,\r\n    );\r\n    self.scrollIndexTop = Math.max(self.scrollIndexTop, 0);\r\n    self.scrollPixelTop = self.scrollCache.y[self.scrollIndexTop];\r\n    // sometimes the grid is rendered but the height is zero\r\n    if (self.scrollBox.scrollHeight === 0) {\r\n      self.scrollIndexTop = 0;\r\n    }\r\n    self.scrollPixelTop = 0;\r\n    self.scrollIndexLeft = self.frozenColumn;\r\n    self.scrollPixelLeft = 0;\r\n    while (\r\n      self.scrollPixelTop < self.scrollBox.scrollTop &&\r\n      self.scrollIndexTop < self.viewData.length\r\n    ) {\r\n      // start on index +1 since index 0 was used in \"go too far\" section above\r\n      self.scrollIndexTop += 1;\r\n      self.scrollPixelTop = self.scrollCache.y[self.scrollIndexTop];\r\n    }\r\n    while (\r\n      self.scrollPixelLeft < self.scrollBox.scrollLeft + 1 &&\r\n      self.scrollIndexLeft < s.length\r\n    ) {\r\n      self.scrollPixelLeft = self.scrollCache.x[self.scrollIndexLeft];\r\n      self.scrollIndexLeft += 1;\r\n    }\r\n    if (s.length > 0) {\r\n      self.scrollIndexLeft = Math.max(self.scrollIndexLeft - 1, 0);\r\n      self.scrollPixelLeft -= self.getColumnWidth(\r\n        self.orders.columns[self.scrollIndexLeft],\r\n      );\r\n    }\r\n    if ((self.viewData || []).length > 0) {\r\n      self.scrollIndexTop = Math.max(self.scrollIndexTop - 1, 0);\r\n      self.scrollPixelTop = Math.max(\r\n        self.scrollPixelTop -\r\n          (self.viewData[self.scrollIndexTop]\r\n            ? (self.sizes.rows[self.scrollIndexTop] || ch) +\r\n              (self.sizes.trees[self.scrollIndexTop] || 0)\r\n            : ch) *\r\n            self.scale,\r\n        0,\r\n      );\r\n    }\r\n    self.ellipsisCache = {};\r\n    if (!dontDraw) {\r\n      self.draw(true);\r\n    }\r\n    //TODO: figure out why this has to be delayed for child grids\r\n    //BUG: wheeling event on 3rd level hierarchy fails to move input box\r\n    requestAnimationFrame(self.resizeEditInput);\r\n    self.dispatchEvent('scroll', {\r\n      top: self.scrollBox.scrollTop,\r\n      left: self.scrollBox.scrollLeft,\r\n    });\r\n  };\r\n  self.mousemove = function (e, overridePos) {\r\n    if (self.contextMenu || self.input) {\r\n      return;\r\n    }\r\n    self.mouse = overridePos || self.getLayerPos(e);\r\n    var ctrl =\r\n        (e.ctrlKey || e.metaKey || self.attributes.persistantSelectionMode) &&\r\n        !self.attributes.singleSelectionMode,\r\n      i,\r\n      s = self.getSchema(),\r\n      dragBounds,\r\n      sBounds,\r\n      x = self.mouse.x,\r\n      y = self.mouse.y,\r\n      cell = self.getCellAt(x, y),\r\n      delta,\r\n      ev = { NativeEvent: e, cell: cell, x: x, y: y },\r\n      previousCell = self.currentCell;\r\n    clearTimeout(self.scrollTimer);\r\n    if (!self.isInGrid({ x: x, y: y })) {\r\n      self.hasFocus = false;\r\n    }\r\n    if (self.dispatchEvent('mousemove', ev)) {\r\n      return;\r\n    }\r\n    if (cell && self.currentCell) {\r\n      self.rowBoundaryCrossed = self.currentCell.rowIndex !== cell.rowIndex;\r\n      self.columnBoundaryCrossed =\r\n        self.currentCell.columnIndex !== cell.columnIndex;\r\n      self.cellBoundaryCrossed =\r\n        self.rowBoundaryCrossed || self.columnBoundaryCrossed;\r\n      ['row', 'column', 'cell'].forEach(function (prefix) {\r\n        if (self[prefix + 'BoundaryCrossed']) {\r\n          ev.cell = previousCell;\r\n          self.dispatchEvent(prefix + 'mouseout', ev);\r\n          ev.cell = cell;\r\n          self.dispatchEvent(prefix + 'mouseover', ev);\r\n        }\r\n      });\r\n    }\r\n    self.currentCell = cell;\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    self.hovers = {};\r\n    if (\r\n      !self.draggingItem &&\r\n      cell &&\r\n      self.scrollModes.indexOf(cell.context) === -1\r\n    ) {\r\n      self.dragItem = cell;\r\n      self.dragMode = cell.dragContext;\r\n      self.cursor = cell.context;\r\n      if (cell.context === 'cell') {\r\n        self.cursor = 'default';\r\n        self.hovers = {\r\n          rowIndex: cell.rowIndex,\r\n          columnIndex: cell.columnIndex,\r\n        };\r\n      }\r\n      if ((self.selecting || self.reorderObject) && cell.context === 'cell') {\r\n        delta = {\r\n          x: Math.abs(self.dragStart.x - x),\r\n          y: Math.abs(self.dragStart.y - y),\r\n        };\r\n        if (self.dragStartObject.columnIndex !== -1 && e.shiftKey) {\r\n          self.dragStartObject = {\r\n            rowIndex: self.activeCell.rowIndex,\r\n            columnIndex: self.activeCell.columnIndex,\r\n          };\r\n        }\r\n        dragBounds = {\r\n          top: Math.min(self.dragStartObject.rowIndex, cell.rowIndex),\r\n          left: Math.min(self.dragStartObject.columnIndex, cell.columnIndex),\r\n          bottom: Math.max(self.dragStartObject.rowIndex, cell.rowIndex),\r\n          right: Math.max(self.dragStartObject.columnIndex, cell.columnIndex),\r\n        };\r\n        if (self.dragStartObject.columnIndex === -1) {\r\n          sBounds = self.getSelectionBounds();\r\n          dragBounds.left = -1;\r\n          dragBounds.right = s.length - 1;\r\n          dragBounds.top = Math.min(sBounds.top, cell.rowIndex);\r\n          dragBounds.bottom = Math.max(sBounds.bottom, cell.rowIndex);\r\n        }\r\n        if (\r\n          self.dragStartObject.rowIndex !== cell.rowIndex ||\r\n          self.dragStartObject.columnIndex !== cell.columnIndex\r\n        ) {\r\n          self.ignoreNextClick = true;\r\n        }\r\n        if (\r\n          self.cellBoundaryCrossed ||\r\n          (delta.x === 0 && delta.y === 0) ||\r\n          self.attributes.selectionMode === 'row'\r\n        ) {\r\n          if (\r\n            (self.attributes.selectionMode === 'row' ||\r\n              self.dragStartObject.columnIndex === -1) &&\r\n            self.rowBoundaryCrossed\r\n          ) {\r\n            self.selectRow(cell.rowIndex, ctrl, null, true);\r\n          } else if (self.attributes.selectionMode !== 'row') {\r\n            if (!self.dragAddToSelection && cell.rowIndex !== undefined) {\r\n              if (\r\n                self.selections[cell.rowIndex] &&\r\n                self.selections[cell.rowIndex].indexOf(cell.columnIndex) !== -1\r\n              ) {\r\n                self.selections[cell.rowIndex].splice(\r\n                  self.selections[cell.rowIndex].indexOf(cell.columnIndex),\r\n                  1,\r\n                );\r\n              }\r\n            } else {\r\n              self.selections[cell.rowIndex] =\r\n                self.selections[cell.rowIndex] || [];\r\n              if (\r\n                self.selections[cell.rowIndex].indexOf(cell.columnIndex) === -1\r\n              ) {\r\n                self.selections[cell.rowIndex].push(cell.columnIndex);\r\n\r\n                const event = {\r\n                  selections: self.selections,\r\n                  selectedData: self.getSelectedData(),\r\n                  selectionBounds: self.getSelectionBounds(),\r\n                };\r\n\r\n                self.dispatchEvent('selectionchanged', event);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        if (\r\n          (!self.selectionBounds ||\r\n            dragBounds.top !== self.selectionBounds.top ||\r\n            dragBounds.left !== self.selectionBounds.left ||\r\n            dragBounds.bottom !== self.selectionBounds.bottom ||\r\n            dragBounds.right !== self.selectionBounds.right) &&\r\n          !ctrl\r\n        ) {\r\n          self.selections = [];\r\n          sBounds = dragBounds;\r\n          if (self.attributes.selectionMode === 'row') {\r\n            for (i = sBounds.top; i <= sBounds.bottom; i += 1) {\r\n              self.selectRow(i, true, null, true);\r\n            }\r\n          } else if (dragBounds.top !== -1) {\r\n            self.selectArea(sBounds, true);\r\n          }\r\n        }\r\n        self.autoScrollZone(e, x, y, ctrl);\r\n      }\r\n    }\r\n    self.cellBoundaryCrossed = false;\r\n    self.rowBoundaryCrossed = false;\r\n    self.columnBoundaryCrossed = false;\r\n    self.draw(true);\r\n  };\r\n  self.click = function (e, overridePos) {\r\n    var i,\r\n      startingBounds = JSON.stringify(self.getSelectionBounds()),\r\n      ctrl =\r\n        (e.ctrlKey || e.metaKey || self.attributes.persistantSelectionMode) &&\r\n        !self.attributes.singleSelectionMode,\r\n      pos = overridePos || self.getLayerPos(e);\r\n    self.currentCell = self.getCellAt(pos.x, pos.y);\r\n    if (self.currentCell.grid !== undefined) {\r\n      return;\r\n    }\r\n    function checkSelectionChange() {\r\n      var ev,\r\n        sb = self.getSelectionBounds();\r\n      if (startingBounds === JSON.stringify(sb)) {\r\n        return;\r\n      }\r\n      ev = {\r\n        selections: self.selections,\r\n        selectionBounds: self.getSelectionBounds(),\r\n      };\r\n      Object.defineProperty(ev, 'selectedData', {\r\n        get: function () {\r\n          return self.getSelectedData();\r\n        },\r\n      });\r\n      self.dispatchEvent('selectionchanged', ev);\r\n    }\r\n    if (self.input) {\r\n      self.endEdit();\r\n    }\r\n    if (self.ignoreNextClick) {\r\n      self.ignoreNextClick = false;\r\n      return;\r\n    }\r\n    i = self.currentCell;\r\n    if (\r\n      self.dispatchEvent('click', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      ['rowHeaderCell', 'columnHeaderCell'].indexOf(self.currentCell.style) ===\r\n        -1 &&\r\n      !ctrl\r\n    ) {\r\n      self.setActiveCell(i.columnIndex, i.rowIndex);\r\n    }\r\n    if (self.currentCell.context === 'cell') {\r\n      if (self.currentCell.style === 'cornerCell') {\r\n        self.selectAll();\r\n        self.draw();\r\n        checkSelectionChange();\r\n        return;\r\n      }\r\n      if (self.currentCell.style === 'columnHeaderCell') {\r\n        if (self.attributes.columnHeaderClickBehavior === 'sort') {\r\n          if (self.orderBy === i.header.name) {\r\n            self.orderDirection =\r\n              self.orderDirection === 'asc' ? 'desc' : 'asc';\r\n          } else {\r\n            self.orderDirection = 'asc';\r\n          }\r\n          self.order(i.header.name, self.orderDirection);\r\n          checkSelectionChange();\r\n          return;\r\n        }\r\n        if (self.attributes.columnHeaderClickBehavior === 'select') {\r\n          self.selectColumn(i.header.index, ctrl, e.shiftKey);\r\n          self.draw();\r\n          return;\r\n        }\r\n      }\r\n      self.selections[i.rowIndex] = self.selections[i.rowIndex] || [];\r\n      if (\r\n        self.attributes.selectionMode === 'row' ||\r\n        self.currentCell.style === 'rowHeaderCell'\r\n      ) {\r\n        if (\r\n          self.currentCell.style === 'rowHeaderCell' &&\r\n          self.attributes.tree &&\r\n          pos.x > 0 &&\r\n          pos.x - self.currentCell.x <\r\n            self.style.treeArrowWidth +\r\n              self.style.treeArrowMarginLeft +\r\n              self.style.treeArrowMarginRight +\r\n              self.style.treeArrowClickRadius &&\r\n          pos.y - self.currentCell.y <\r\n            self.style.treeArrowHeight +\r\n              self.style.treeArrowMarginTop +\r\n              self.style.treeArrowClickRadius &&\r\n          pos.y > 0\r\n        ) {\r\n          self.toggleTree(i.rowIndex);\r\n          return;\r\n        }\r\n      }\r\n      if (e.shiftKey && !ctrl) {\r\n        self.selectionBounds = self.getSelectionBounds();\r\n        self.selectArea(undefined, false);\r\n      }\r\n    }\r\n    checkSelectionChange();\r\n    self.draw(true);\r\n  };\r\n  self.dragResizeColumn = function (e) {\r\n    var pos, x, y;\r\n    pos = self.getLayerPos(e);\r\n    x = self.resizingStartingWidth + pos.x - self.dragStart.x;\r\n    y = self.resizingStartingHeight + pos.y - self.dragStart.y;\r\n    if (x < self.style.minColumnWidth) {\r\n      x = self.style.minColumnWidth;\r\n    }\r\n    if (y < self.style.minRowHeight) {\r\n      y = self.style.minRowHeight;\r\n    }\r\n    if (\r\n      self.dispatchEvent('resizecolumn', {\r\n        x: x,\r\n        y: y,\r\n        draggingItem: self.draggingItem,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    if (\r\n      self.scrollBox.scrollLeft >\r\n        self.scrollBox.scrollWidth - self.attributes.resizeScrollZone &&\r\n      self.dragMode === 'ew-resize'\r\n    ) {\r\n      self.resize(true);\r\n      self.scrollBox.scrollLeft += x;\r\n    }\r\n    if (self.dragMode === 'ew-resize') {\r\n      self.sizes.columns[\r\n        self.draggingItem.header.style === 'rowHeaderCell'\r\n          ? 'cornerCell'\r\n          : self.draggingItem.sortColumnIndex\r\n      ] = x;\r\n      if (\r\n        ['rowHeaderCell', 'cornerCell'].indexOf(\r\n          self.draggingItem.header.style,\r\n        ) !== -1\r\n      ) {\r\n        self.resize(true);\r\n      }\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    if (self.dragMode === 'ns-resize') {\r\n      if (self.draggingItem.rowOpen) {\r\n        self.sizes.trees[self.draggingItem.rowIndex] = y;\r\n      } else if (self.attributes.globalRowResize) {\r\n        self.style.cellHeight = y;\r\n      } else {\r\n        self.sizes.rows[self.draggingItem.rowIndex] = y;\r\n      }\r\n      self.dispatchEvent('resizerow', { row: y });\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    self.ellipsisCache = {};\r\n  };\r\n  self.stopDragResize = function () {\r\n    self.resize();\r\n    document.body.removeEventListener(\r\n      'mousemove',\r\n      self.dragResizeColumn,\r\n      false,\r\n    );\r\n    document.body.removeEventListener('mouseup', self.stopDragResize, false);\r\n    self.setStorageData();\r\n    self.draw(true);\r\n    self.ignoreNextClick = true;\r\n  };\r\n  self.scrollGrid = function (e) {\r\n    var pos = self.getLayerPos(e);\r\n    if (\r\n      self.attributes.scrollPointerLock &&\r\n      self.pointerLockPosition &&\r\n      ['horizontal-scroll-box', 'vertical-scroll-box'].indexOf(\r\n        self.scrollStartMode,\r\n      ) !== -1\r\n    ) {\r\n      self.pointerLockPosition.x += e.movementX;\r\n      self.pointerLockPosition.y += e.movementY;\r\n      self.pointerLockPosition.x = Math.min(\r\n        self.width - self.style.scrollBarWidth,\r\n        Math.max(0, self.pointerLockPosition.x),\r\n      );\r\n      self.pointerLockPosition.y = Math.min(\r\n        self.height - self.style.scrollBarWidth,\r\n        Math.max(0, self.pointerLockPosition.y),\r\n      );\r\n      pos = self.pointerLockPosition;\r\n    }\r\n    self.scrollMode = self.getCellAt(pos.x, pos.y).context;\r\n    if (\r\n      self.scrollMode === 'horizontal-scroll-box' &&\r\n      self.scrollStartMode !== 'horizontal-scroll-box'\r\n    ) {\r\n      self.scrollStartMode = 'horizontal-scroll-box';\r\n      self.dragStart = pos;\r\n      self.scrollStart.left = self.scrollBox.scrollLeft;\r\n      clearTimeout(self.scrollTimer);\r\n      return;\r\n    }\r\n    if (\r\n      self.scrollMode === 'vertical-scroll-box' &&\r\n      self.scrollStartMode !== 'vertical-scroll-box'\r\n    ) {\r\n      self.scrollStartMode = 'vertical-scroll-box';\r\n      self.dragStart = pos;\r\n      self.scrollStart.top = self.scrollBox.scrollTop;\r\n      clearTimeout(self.scrollTimer);\r\n      return;\r\n    }\r\n    if (\r\n      self.scrollStartMode === 'vertical-scroll-box' &&\r\n      self.scrollMode !== 'vertical-scroll-box'\r\n    ) {\r\n      self.scrollMode = 'vertical-scroll-box';\r\n    }\r\n    if (\r\n      self.scrollStartMode === 'horizontal-scroll-box' &&\r\n      self.scrollMode !== 'horizontal-scroll-box'\r\n    ) {\r\n      self.scrollMode = 'horizontal-scroll-box';\r\n    }\r\n    clearTimeout(self.scrollTimer);\r\n    if (self.scrollModes.indexOf(self.scrollMode) === -1) {\r\n      return;\r\n    }\r\n    if (self.scrollMode === 'vertical-scroll-box') {\r\n      self.scrollBox.scrollTop =\r\n        self.scrollStart.top +\r\n        (pos.y - self.dragStart.y) / self.scrollBox.heightBoxRatio;\r\n    } else if (self.scrollMode === 'vertical-scroll-top') {\r\n      self.scrollBox.scrollTop -= self.page * self.style.cellHeight;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    } else if (self.scrollMode === 'vertical-scroll-bottom') {\r\n      self.scrollBox.scrollTop += self.page * self.style.cellHeight;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n    if (self.scrollMode === 'horizontal-scroll-box') {\r\n      self.scrollBox.scrollLeft =\r\n        self.scrollStart.left +\r\n        (pos.x - self.dragStart.x) / self.scrollBox.widthBoxRatio;\r\n    } else if (self.scrollMode === 'horizontal-scroll-right') {\r\n      self.scrollBox.scrollLeft += self.attributes.selectionScrollIncrement;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    } else if (self.scrollMode === 'horizontal-scroll-left') {\r\n      self.scrollBox.scrollLeft -= self.attributes.selectionScrollIncrement;\r\n      self.scrollTimer = setTimeout(\r\n        self.scrollGrid,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n  };\r\n  self.stopScrollGrid = function () {\r\n    clearTimeout(self.scrollTimer);\r\n    if (document.exitPointerLock) {\r\n      document.exitPointerLock();\r\n    }\r\n    document.removeEventListener('mousemove', self.scrollGrid, false);\r\n  };\r\n  self.dragReorder = function (e) {\r\n    var pos,\r\n      x,\r\n      y,\r\n      columReorder = self.dragMode === 'column-reorder',\r\n      rowReorder = self.dragMode === 'row-reorder';\r\n    pos = self.getLayerPos(e);\r\n    x = pos.x - self.dragStart.x;\r\n    y = pos.y - self.dragStart.y;\r\n    if (!self.attributes.allowColumnReordering && columReorder) {\r\n      return;\r\n    }\r\n    if (!self.attributes.allowRowReordering && rowReorder) {\r\n      return;\r\n    }\r\n    if (\r\n      self.dispatchEvent('reordering', {\r\n        NativeEvent: e,\r\n        source: self.dragStartObject,\r\n        target: self.currentCell,\r\n        dragMode: self.dragMode,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    if (\r\n      Math.abs(x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      self.reorderObject = self.draggingItem;\r\n      self.reorderTarget = self.currentCell;\r\n      self.reorderObject.dragOffset = {\r\n        x: x,\r\n        y: y,\r\n      };\r\n      self.autoScrollZone(\r\n        e,\r\n        columReorder ? pos.x : -1,\r\n        rowReorder ? pos.y : -1,\r\n        false,\r\n      );\r\n    }\r\n  };\r\n  self.stopDragReorder = function (e) {\r\n    var oIndex,\r\n      tIndex,\r\n      cr = {\r\n        'row-reorder': self.orders.rows,\r\n        'column-reorder': self.orders.columns,\r\n      },\r\n      i = {\r\n        'row-reorder': 'rowIndex',\r\n        'column-reorder': 'sortColumnIndex',\r\n      }[self.dragMode];\r\n    document.body.removeEventListener('mousemove', self.dragReorder, false);\r\n    document.body.removeEventListener('mouseup', self.stopDragReorder, false);\r\n    if (\r\n      self.reorderObject &&\r\n      self.reorderTarget &&\r\n      ((self.dragMode === 'column-reorder' &&\r\n        self.reorderTarget.sortColumnIndex > -1 &&\r\n        self.reorderTarget.sortColumnIndex < self.getSchema().length) ||\r\n        (self.dragMode === 'row-reorder' &&\r\n          self.reorderTarget.rowIndex > -1 &&\r\n          self.reorderTarget.rowIndex < self.viewData.length)) &&\r\n      self.reorderObject[i] !== self.reorderTarget[i] &&\r\n      !self.dispatchEvent('reorder', {\r\n        NativeEvent: e,\r\n        source: self.reorderObject,\r\n        target: self.reorderTarget,\r\n        dragMode: self.dragMode,\r\n      })\r\n    ) {\r\n      self.ignoreNextClick = true;\r\n      oIndex = cr[self.dragMode].indexOf(self.reorderObject[i]);\r\n      tIndex = cr[self.dragMode].indexOf(self.reorderTarget[i]);\r\n      cr[self.dragMode].splice(oIndex, 1);\r\n      cr[self.dragMode].splice(tIndex, 0, self.reorderObject[i]);\r\n      if (self.dragMode === 'column-reorder') {\r\n        self.orders.columns = cr[self.dragMode];\r\n      } else {\r\n        self.orders.rows = cr[self.dragMode];\r\n      }\r\n      self.resize();\r\n      self.setStorageData();\r\n    }\r\n    self.reorderObject = undefined;\r\n    self.reorderTarget = undefined;\r\n    self.draw(true);\r\n  };\r\n  self.dragMove = function (e) {\r\n    if (\r\n      self.dispatchEvent('moving', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    var pos = self.getLayerPos(e);\r\n    self.moveOffset = {\r\n      x: self.currentCell.columnIndex - self.dragStartObject.columnIndex,\r\n      y: self.currentCell.rowIndex - self.dragStartObject.rowIndex,\r\n    };\r\n    if (\r\n      Math.abs(pos.x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(pos.y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      setTimeout(function () {\r\n        self.autoScrollZone(e, pos.x, pos.y, false);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.stopDragMove = function (e) {\r\n    document.body.removeEventListener('mousemove', self.dragMove, false);\r\n    document.body.removeEventListener('mouseup', self.stopDragMove, false);\r\n    var b = self.getSelectionBounds();\r\n    if (\r\n      self.dispatchEvent('endmove', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      self.movingSelection = undefined;\r\n      self.moveOffset = undefined;\r\n      self.draw(true);\r\n      return;\r\n    }\r\n    if (self.moveOffset) {\r\n      self.moveTo(\r\n        self.movingSelection,\r\n        b.left + self.moveOffset.x,\r\n        b.top + self.moveOffset.y,\r\n      );\r\n      self.moveSelection(self.moveOffset.x, self.moveOffset.y);\r\n    }\r\n    self.movingSelection = undefined;\r\n    self.moveOffset = undefined;\r\n    self.draw(true);\r\n  };\r\n  self.freezeMove = function (e) {\r\n    if (\r\n      self.dispatchEvent('freezemoving', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    var pos = self.getLayerPos(e);\r\n    self.ignoreNextClick = true;\r\n    self.freezeMarkerPosition = pos;\r\n    if (\r\n      self.currentCell &&\r\n      self.currentCell.rowIndex !== undefined &&\r\n      self.dragMode === 'frozen-row-marker'\r\n    ) {\r\n      self.scrollBox.scrollTop = 0;\r\n      self.frozenRow = self.currentCell.rowIndex + 1;\r\n    }\r\n    if (\r\n      self.currentCell &&\r\n      self.currentCell.columnIndex !== undefined &&\r\n      self.dragMode === 'frozen-column-marker'\r\n    ) {\r\n      self.scrollBox.scrollLeft = 0;\r\n      self.frozenColumn = self.currentCell.columnIndex + 1;\r\n    }\r\n    if (\r\n      Math.abs(pos.x) > self.attributes.reorderDeadZone ||\r\n      Math.abs(pos.y) > self.attributes.reorderDeadZone\r\n    ) {\r\n      setTimeout(function () {\r\n        self.autoScrollZone(e, pos.x, pos.y, false);\r\n      }, 1);\r\n    }\r\n  };\r\n  self.stopFreezeMove = function (e) {\r\n    document.body.removeEventListener('mousemove', self.freezeMove, false);\r\n    document.body.removeEventListener('mouseup', self.stopFreezeMove, false);\r\n    self.freezeMarkerPosition = undefined;\r\n    if (\r\n      self.dispatchEvent('endfreezemove', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      self.frozenRow = self.startFreezeMove.x;\r\n      self.frozenColumn = self.startFreezeMove.y;\r\n      self.draw(true);\r\n      return;\r\n    }\r\n    self.draw(true);\r\n  };\r\n  self.mousedown = function (e, overridePos) {\r\n    self.lastMouseDownTarget = e.target;\r\n    if (\r\n      self.dispatchEvent('mousedown', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (e.button === 2 || self.input) {\r\n      return;\r\n    }\r\n    var ctrl = e.ctrlKey || e.metaKey,\r\n      move = /-move/.test(self.dragMode),\r\n      freeze = /frozen-row-marker|frozen-column-marker/.test(self.dragMode),\r\n      resize = /-resize/.test(self.dragMode);\r\n    self.dragStart = overridePos || self.getLayerPos(e);\r\n    self.scrollStart = {\r\n      left: self.scrollBox.scrollLeft,\r\n      top: self.scrollBox.scrollTop,\r\n    };\r\n    self.dragStartObject = self.getCellAt(self.dragStart.x, self.dragStart.y);\r\n    self.dragAddToSelection = !self.dragStartObject.selected;\r\n    if (\r\n      !ctrl &&\r\n      !e.shiftKey &&\r\n      !/(vertical|horizontal)-scroll-(bar|box)/.test(\r\n        self.dragStartObject.context,\r\n      ) &&\r\n      self.currentCell &&\r\n      !self.currentCell.isColumnHeader &&\r\n      !move &&\r\n      !freeze &&\r\n      !resize\r\n    ) {\r\n      self.selections = [];\r\n    }\r\n    if (self.dragStartObject.isGrid) {\r\n      return;\r\n    }\r\n    if (self.scrollModes.indexOf(self.dragStartObject.context) !== -1) {\r\n      self.scrollMode = self.dragStartObject.context;\r\n      self.scrollStartMode = self.dragStartObject.context;\r\n      self.scrollGrid(e);\r\n      if (\r\n        self.attributes.scrollPointerLock &&\r\n        ['horizontal-scroll-box', 'vertical-scroll-box'].indexOf(\r\n          self.scrollStartMode,\r\n        ) !== -1\r\n      ) {\r\n        self.pointerLockPosition = {\r\n          x: self.dragStart.x,\r\n          y: self.dragStart.y,\r\n        };\r\n        self.canvas.requestPointerLock();\r\n      }\r\n      document.addEventListener('mousemove', self.scrollGrid, false);\r\n      document.addEventListener('mouseup', self.stopScrollGrid, false);\r\n      self.ignoreNextClick = true;\r\n      return;\r\n    }\r\n    if (self.dragMode === 'cell') {\r\n      self.selecting = true;\r\n      if (\r\n        (self.attributes.selectionMode === 'row' ||\r\n          self.dragStartObject.columnIndex === -1) &&\r\n        self.dragStartObject.rowIndex > -1\r\n      ) {\r\n        self.selectRow(self.dragStartObject.rowIndex, ctrl, null);\r\n      } else if (self.attributes.selectionMode !== 'row') {\r\n        self.mousemove(e);\r\n      }\r\n      return;\r\n    }\r\n    if (move) {\r\n      self.draggingItem = self.dragItem;\r\n      self.movingSelection = self.selections.concat([]);\r\n      self.dragging = self.dragStartObject;\r\n      if (\r\n        self.dispatchEvent('beginmove', {\r\n          NativeEvent: e,\r\n          cell: self.currentCell,\r\n        })\r\n      ) {\r\n        return;\r\n      }\r\n      document.body.addEventListener('mousemove', self.dragMove, false);\r\n      document.body.addEventListener('mouseup', self.stopDragMove, false);\r\n      return self.mousemove(e);\r\n    }\r\n    if (freeze) {\r\n      self.draggingItem = self.dragItem;\r\n      self.startFreezeMove = {\r\n        x: self.frozenRow,\r\n        y: self.frozenColumn,\r\n      };\r\n      if (self.dispatchEvent('beginfreezemove', { NativeEvent: e })) {\r\n        return;\r\n      }\r\n      document.body.addEventListener('mousemove', self.freezeMove, false);\r\n      document.body.addEventListener('mouseup', self.stopFreezeMove, false);\r\n      return self.mousemove(e);\r\n    }\r\n    if (resize) {\r\n      self.draggingItem = self.dragItem;\r\n      if (self.draggingItem.rowOpen) {\r\n        self.resizingStartingHeight =\r\n          self.sizes.trees[self.draggingItem.rowIndex];\r\n      } else {\r\n        self.resizingStartingHeight =\r\n          self.sizes.rows[self.draggingItem.rowIndex] || self.style.cellHeight;\r\n      }\r\n      self.resizingStartingWidth =\r\n        self.sizes.columns[\r\n          self.draggingItem.header.style === 'rowHeaderCell'\r\n            ? 'cornerCell'\r\n            : self.draggingItem.sortColumnIndex\r\n        ] || self.draggingItem.width;\r\n      document.body.addEventListener('mousemove', self.dragResizeColumn, false);\r\n      document.body.addEventListener('mouseup', self.stopDragResize, false);\r\n      return;\r\n    }\r\n    if (['row-reorder', 'column-reorder'].indexOf(self.dragMode) !== -1) {\r\n      self.draggingItem = self.dragStartObject;\r\n      document.body.addEventListener('mousemove', self.dragReorder, false);\r\n      document.body.addEventListener('mouseup', self.stopDragReorder, false);\r\n      return;\r\n    }\r\n  };\r\n  self.mouseup = function (e) {\r\n    clearTimeout(self.scrollTimer);\r\n    self.cellBoundaryCrossed = true;\r\n    self.rowBoundaryCrossed = true;\r\n    self.columnBoundaryCrossed = true;\r\n    self.selecting = undefined;\r\n    self.draggingItem = undefined;\r\n    self.dragStartObject = undefined;\r\n    if (\r\n      self.dispatchEvent('mouseup', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus && e.target !== self.canvas) {\r\n      return;\r\n    }\r\n    if (self.currentCell && self.currentCell.grid !== undefined) {\r\n      return;\r\n    }\r\n    if (self.contextMenu || self.input) {\r\n      return;\r\n    }\r\n    if (self.dragStart && self.isInGrid(self.dragStart)) {\r\n      self.controlInput.focus();\r\n    }\r\n    e.preventDefault();\r\n  };\r\n  // gets the horizontal adjacent cells as well as first/last based on column visibility\r\n  self.getAdjacentCells = function () {\r\n    var x,\r\n      i,\r\n      s = self.getSchema(),\r\n      o = {};\r\n    for (x = 0; x < s.length; x += 1) {\r\n      i = self.orders.columns[x];\r\n      if (!s[i].hidden) {\r\n        if (o.first === undefined) {\r\n          o.first = x;\r\n          o.left = x;\r\n        }\r\n        o.last = x;\r\n        if (x > self.activeCell.columnIndex && o.right === undefined) {\r\n          o.right = x;\r\n        }\r\n        if (x < self.activeCell.columnIndex) {\r\n          o.left = x;\r\n        }\r\n      }\r\n    }\r\n    if (o.right === undefined) {\r\n      o.right = o.last;\r\n    }\r\n    return o;\r\n  };\r\n  self.keydown = function (e) {\r\n    var i,\r\n      ev,\r\n      adjacentCells = self.getAdjacentCells(),\r\n      x = self.activeCell.columnIndex,\r\n      y = self.activeCell.rowIndex,\r\n      ctrl = e.ctrlKey || e.metaKey,\r\n      last = self.viewData.length - 1,\r\n      s = self.getSchema(),\r\n      cols = s.length - 1;\r\n\r\n    var defaultPrevented = self.dispatchEvent('keydown', {\r\n      NativeEvent: e,\r\n      cell: self.currentCell,\r\n    });\r\n\r\n    if (defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n\r\n    // If a user starts typing content, switch to \"Enter\" mode\r\n    if (isPrintableKeyEvent(e) && !ctrl) {\r\n      return self.beginEditAt(x, y, e, true);\r\n    }\r\n\r\n    if (self.attributes.showNewRow) {\r\n      last += 1;\r\n    }\r\n\r\n    if (e.key === 'Tab') {\r\n      e.preventDefault();\r\n    }\r\n\r\n    if (e.key === 'Escape') {\r\n      self.selectNone();\r\n    } else if (ctrl && e.key === 'a') {\r\n      self.selectAll();\r\n    } else if (e.key === 'ArrowDown') {\r\n      y += 1;\r\n    } else if (e.key === 'ArrowUp') {\r\n      y -= 1;\r\n    } else if (\r\n      (e.key === 'ArrowLeft' && !ctrl) ||\r\n      (e.shiftKey && e.key === 'Tab')\r\n    ) {\r\n      x = adjacentCells.left;\r\n    } else if (\r\n      (e.key === 'ArrowRight' && !ctrl) ||\r\n      (!e.shiftKey && e.key === 'Tab')\r\n    ) {\r\n      x = adjacentCells.right;\r\n    } else if (e.key === 'PageUp') {\r\n      y -= self.page;\r\n      e.preventDefault();\r\n    } else if (e.key === 'PageDown') {\r\n      y += self.page;\r\n      e.preventDefault();\r\n    } else if (e.key === 'Home' || (ctrl && e.key === 'ArrowUp')) {\r\n      y = 0;\r\n    } else if (e.key === 'End' || (ctrl && e.key === 'ArrowDown')) {\r\n      y = self.viewData.length - 1;\r\n    } else if (ctrl && e.key === 'ArrowRight') {\r\n      x = adjacentCells.last;\r\n    } else if (ctrl && e.key === 'ArrowLeft') {\r\n      x = adjacentCells.first;\r\n    }\r\n\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      return self.beginEditAt(x, y, e);\r\n    }\r\n\r\n    if (x < 0 || Number.isNaN(x)) {\r\n      x = adjacentCells.first;\r\n    }\r\n    if (y > last) {\r\n      y = last;\r\n    }\r\n    if (y < 0 || Number.isNaN(y)) {\r\n      y = 0;\r\n    }\r\n    if (x > cols) {\r\n      x = adjacentCells.last;\r\n    }\r\n\r\n    // TODO - most likely some column order related bugs in key based selection\r\n    // Arrows\r\n    var isArrowKey = [\r\n      'ArrowLeft',\r\n      'ArrowUp',\r\n      'ArrowRight',\r\n      'ArrowDown',\r\n    ].includes(e.key);\r\n\r\n    if (e.shiftKey && isArrowKey) {\r\n      self.selections[Math.max(y, 0)] = self.selections[Math.max(y, 0)] || [];\r\n      self.selections[Math.max(y, 0)].push(x);\r\n\r\n      self.selectionBounds = self.getSelectionBounds();\r\n      self.selectArea(undefined, ctrl);\r\n\r\n      self.draw(true);\r\n    }\r\n\r\n    if (x !== self.activeCell.columnIndex || y !== self.activeCell.rowIndex) {\r\n      self.scrollIntoView(\r\n        x !== self.activeCell.columnIndex ? x : undefined,\r\n        y !== self.activeCell.rowIndex && !Number.isNaN(y) ? y : undefined,\r\n      );\r\n\r\n      self.setActiveCell(x, y);\r\n      if (!e.shiftKey && self.attributes.selectionFollowsActiveCell) {\r\n        if (!ctrl) {\r\n          self.selections = [];\r\n        }\r\n        self.selections[y] = self.selections[y] || [];\r\n        self.selections[y].push(x);\r\n        ev = {\r\n          selectedData: self.getSelectedData(),\r\n          selections: self.selections,\r\n          selectionBounds: self.getSelectionBounds(),\r\n        };\r\n        Object.defineProperty(ev, 'selectedData', {\r\n          get: function () {\r\n            return self.getSelectedData();\r\n          },\r\n        });\r\n        self.dispatchEvent('selectionchanged', ev);\r\n      }\r\n      self.draw(true);\r\n    }\r\n  };\r\n  self.keyup = function (e) {\r\n    if (\r\n      self.dispatchEvent('keyup', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n  };\r\n  self.keypress = function (e) {\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      self.dispatchEvent('keypress', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n  };\r\n  self.dblclick = function (e) {\r\n    if (\r\n      self.dispatchEvent('dblclick', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus) {\r\n      return;\r\n    }\r\n    if (\r\n      self.currentCell.context === 'ew-resize' &&\r\n      self.currentCell.style === 'columnHeaderCell'\r\n    ) {\r\n      self.fitColumnToValues(self.currentCell.header.name);\r\n    } else if (\r\n      self.currentCell.context === 'ew-resize' &&\r\n      self.currentCell.style === 'cornerCell'\r\n    ) {\r\n      self.autosize();\r\n    } else if (['cell', 'activeCell'].indexOf(self.currentCell.style) !== -1) {\r\n      self.beginEditAt(self.currentCell.columnIndex, self.currentCell.rowIndex);\r\n    }\r\n  };\r\n  self.scrollWheel = function (e) {\r\n    var l,\r\n      t,\r\n      ev = e,\r\n      deltaX = e.deltaX === undefined ? e.NativeEvent.deltaX : e.deltaX,\r\n      deltaY = e.deltaY === undefined ? e.NativeEvent.deltaY : e.deltaY,\r\n      deltaMode =\r\n        e.deltaMode === undefined ? e.NativeEvent.deltaMode : e.deltaMode;\r\n    var e = e.NativeEvent || e;\r\n    if (wheeling) {\r\n      ev.preventDefault(e);\r\n      return;\r\n    }\r\n    if (self.dispatchEvent('wheel', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    self.touchHaltAnimation = true;\r\n    l = self.scrollBox.scrollLeft;\r\n    t = self.scrollBox.scrollTop;\r\n    if (self.hasFocus) {\r\n      //BUG Issue 42: https://github.com/TonyGermaneri/canvas-datagrid/issues/42\r\n      //https://stackoverflow.com/questions/20110224/what-is-the-height-of-a-line-in-a-wheel-event-deltamode-dom-delta-line\r\n      if (deltaMode === 1) {\r\n        // line mode = 17 pixels per line\r\n        deltaY = deltaY * 17;\r\n      }\r\n      if (\r\n        (self.scrollBox.scrollTop < self.scrollBox.scrollHeight &&\r\n          deltaY > 0) ||\r\n        (self.scrollBox.scrollLeft < self.scrollBox.scrollWidth &&\r\n          deltaX > 0) ||\r\n        (self.scrollBox.scrollTop > 0 && deltaY < 0) ||\r\n        (self.scrollBox.scrollLeft > 0 && deltaX < 0)\r\n      ) {\r\n        ev.preventDefault(e);\r\n      }\r\n      wheeling = setTimeout(function () {\r\n        wheeling = undefined;\r\n        self.scrollBox.scrollTo(deltaX + l, deltaY + t);\r\n      }, 1);\r\n    }\r\n  };\r\n\r\n  self.pasteData = function (\r\n    pasteValue,\r\n    mimeType,\r\n    startRowIndex,\r\n    startColIndex,\r\n  ) {\r\n    var schema = self.getVisibleSchema();\r\n\r\n    const isSupportedHtmlTable = (htmlString) =>\r\n      /(?:^(<meta[^>]+>)?<table>)|(?:<!--StartFragment-->\\s*<table>)/.test(\r\n        htmlString,\r\n      );\r\n\r\n    // TODO: support pasting tables from Excel\r\n    if (\r\n      mimeType === 'text/html' &&\r\n      isSupportedHtmlTable(pasteValue) === false\r\n    ) {\r\n      console.warn(\r\n        'Unrecognized HTML format. HTML must be a simple table, e.g.: <table><tr><td>data</td></tr></table>.',\r\n      );\r\n      console.warn(\r\n        'Data with the mime type text/html not in this format will not be imported as row data.',\r\n      );\r\n\r\n      return;\r\n    }\r\n\r\n    function parseData(data, mimeType) {\r\n      // TODO: use DOMParser\r\n      if (mimeType === 'text/html') {\r\n        // strip table beginning and ending off, then split at rows\r\n        var cleanedHtmlData = data\r\n          .substring(\r\n            data.indexOf('<table><tr>') + 11,\r\n            data.indexOf('</tr></table>'),\r\n          )\r\n          .split('</tr><tr>')\r\n          .filter(\r\n            // ditch any headers on the table\r\n            (row) => !/^<th>|^<thead>/.test(row),\r\n          )\r\n          .map(\r\n            // split row into individual cells\r\n            (row) =>\r\n              row\r\n                .match(/<td>[^<]+/g)\r\n                .map((match) => match.replace(/^<td>/, '')),\r\n          );\r\n\r\n        return cleanedHtmlData;\r\n      }\r\n\r\n      // Default data format is string, so split on new line,\r\n      // and then enclose in an array (a row with one cell):\r\n      return data.split('\\n').map((value) => [value]);\r\n    }\r\n\r\n    var rows = parseData(pasteValue, mimeType);\r\n\r\n    // Special case: if rows.length = 1, we paste this value in each\r\n    // selected cell. This mimics Excel's paste functionality, and works\r\n    // as a poor-man's fill-down.\r\n    if (rows.length === 1) {\r\n      var cellData = rows[0][0];\r\n\r\n      self.forEachSelectedCell(function (data, rowIndex, colName) {\r\n        data[rowIndex][colName] = cellData;\r\n      });\r\n    } else {\r\n      var selections = [];\r\n      for (var rowIndex = 0; rowIndex < rows.length; rowIndex++) {\r\n        // Rows may have been moved by user, so get the actual row index\r\n        // (instead of the row index at which the row is rendered):\r\n        var realRowIndex = self.orders.rows[startRowIndex + rowIndex];\r\n        var cells = rows[rowIndex];\r\n\r\n        var existingRowData = self.viewData[realRowIndex];\r\n        var newRowData = Object.assign({}, existingRowData);\r\n\r\n        selections[realRowIndex] = [];\r\n\r\n        for (var colIndex = 0; colIndex < cells.length; colIndex++) {\r\n          var column = schema[startColIndex + colIndex];\r\n\r\n          if (!column) {\r\n            console.warn('Paste data exceeded grid bounds. Skipping.');\r\n            continue;\r\n          }\r\n\r\n          var columnName = column.name;\r\n          var cellData = cells[colIndex];\r\n\r\n          if (cellData === undefined || cellData === null) {\r\n            newRowData[columnName] = existingRowData[columnName];\r\n            continue;\r\n          }\r\n\r\n          selections[realRowIndex].push(startColIndex + colIndex);\r\n\r\n          newRowData[columnName] = cellData;\r\n        }\r\n\r\n        self.originalData[realRowIndex] = newRowData;\r\n      }\r\n      self.selections = selections;\r\n    }\r\n\r\n    // selections is a sparse array, so we condense:\r\n    var affectedCells = [];\r\n\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      if (rowIndex === undefined) return;\r\n\r\n      row.forEach(function (columnIndex) {\r\n        affectedCells.push([rowIndex, columnIndex]);\r\n      });\r\n    });\r\n\r\n    self.dispatchEvent('afterpaste', {\r\n      cells: affectedCells,\r\n    });\r\n\r\n    // Because originalData has been updated, we must refresh\r\n    // viewData to ensure the new cell values are rendered\r\n    self.refresh();\r\n\r\n    return rows.length;\r\n  };\r\n  self.getNextVisibleColumnIndex = function (visibleColumnIndex) {\r\n    var x,\r\n      s = self.getVisibleSchema();\r\n    for (x = 0; x < s.length; x += 1) {\r\n      if (s[x].columnIndex === visibleColumnIndex) {\r\n        return s[x + 1].columnIndex;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n  self.getVisibleColumnIndexOf = function (columnIndex) {\r\n    var x,\r\n      s = self.getVisibleSchema();\r\n    for (x = 0; x < s.length; x += 1) {\r\n      if (s[x].columnIndex === columnIndex) {\r\n        return x;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n  self.paste = function (event) {\r\n    if (!self.attributes.editable) {\r\n      return;\r\n    }\r\n\r\n    var defaultPrevented = self.dispatchEvent('beforepaste', {\r\n      NativeEvent: event,\r\n    });\r\n\r\n    if (defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    var clipboardItems = new Map(\r\n      Array.from(event.clipboardData.items).map((item) => [item.type, item]),\r\n    );\r\n\r\n    // Supported MIME types, in order of preference:\r\n    var supportedMimeTypes = ['text/html', 'text/csv', 'text/plain'];\r\n\r\n    // The clipboard will often contain the same data in multiple formats,\r\n    // which can be used depending on the context in which it's pasted. Here\r\n    // we'll prefere more structured (HTML/CSV) over less structured, when\r\n    // available, so we try to find those first:\r\n    var pasteableItems = supportedMimeTypes\r\n      .map((mimeType) => clipboardItems.get(mimeType))\r\n      .filter((item) => !!item); // filter out not-found MIME types (= undefined)\r\n\r\n    if (pasteableItems.length === 0) {\r\n      console.warn(\r\n        'Cannot find supported clipboard data type. Supported types are:',\r\n        supportedMimeTypes.join(', '),\r\n      );\r\n      return;\r\n    }\r\n\r\n    var itemToPaste = pasteableItems[0];\r\n\r\n    // itemToPaste is cleared once accessed (getData or getAsString),\r\n    // so we need to store the type here, before reading its value:\r\n    var pasteType = itemToPaste.type;\r\n\r\n    itemToPaste.getAsString(function (pasteValue) {\r\n      self.pasteData(\r\n        pasteValue,\r\n        pasteType,\r\n        self.activeCell.rowIndex,\r\n        self.getVisibleColumnIndexOf(self.activeCell.columnIndex),\r\n      );\r\n\r\n      self.draw();\r\n    });\r\n  };\r\n  self.cut = function (e) {\r\n    self.copy(e);\r\n    self.forEachSelectedCell(function (data, index, colName) {\r\n      data[index][colName] = '';\r\n    });\r\n  };\r\n  self.copy = function (e) {\r\n    if (self.dispatchEvent('copy', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    if (!self.hasFocus || !e.clipboardData) {\r\n      return;\r\n    }\r\n    var t,\r\n      d,\r\n      tableRows = [],\r\n      textRows = [],\r\n      outputHeaders = {},\r\n      outputHeaderKeys,\r\n      sData = self.getSelectedData(),\r\n      s = self.getSchema();\r\n    function htmlSafe(v) {\r\n      return v.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    function fCopyCell(v) {\r\n      v = v === null || v === undefined ? '' : v;\r\n      return '<td>' + (typeof v === 'string' ? htmlSafe(v) : v) + '</td>';\r\n    }\r\n    function addHeaders(headers, useHtml) {\r\n      if (!s.length || headers.length < 2) {\r\n        return '';\r\n      }\r\n      var h = [];\r\n      if (useHtml) {\r\n        h.push('<tr>');\r\n      }\r\n      s.forEach(function (column, columnIndex) {\r\n        // intentional redefinition of column\r\n        column = s[self.orders.columns[columnIndex]];\r\n        if (!column.hidden && headers.indexOf(column.name) !== -1) {\r\n          var ev = { NativeEvent: e, column: column };\r\n          if (self.dispatchEvent('copyonschema', ev)) {\r\n            column = ev.column;\r\n          }\r\n\r\n          var hVal = column.name || column.title || '';\r\n          if (useHtml) {\r\n            h.push('<th>' + htmlSafe(hVal) + '</th>');\r\n          } else {\r\n            h.push('\"' + hVal.replace(/\"/g, '\"\"') + '\"');\r\n          }\r\n        }\r\n      });\r\n      h.push(useHtml ? '</tr>' : '\\n');\r\n      return h.join(useHtml ? '' : ',');\r\n    }\r\n    function addCellValue(val, trRow, textRow, column) {\r\n      // escape strings\r\n      if (val !== null && val !== false && val !== undefined && val.replace) {\r\n        trRow.push(fCopyCell(val));\r\n        textRow.push('\"' + val.replace(/\"/g, '\"\"') + '\"');\r\n        return;\r\n      }\r\n      if (val !== undefined) {\r\n        textRow.push(val);\r\n        trRow.push(fCopyCell(val));\r\n        return;\r\n      }\r\n      // issue #66\r\n      textRow.push('');\r\n      trRow.push('<td>&nbsp;</td>');\r\n    }\r\n    if (sData.length > 0) {\r\n      sData.forEach(function (row) {\r\n        var rowKeys = Object.keys(row);\r\n        if (row) {\r\n          var trRow = [],\r\n            textRow = [],\r\n            sSorted = [];\r\n          // HACK: https://github.com/TonyGermaneri/canvas-datagrid/issues/181\r\n          // I can't use sort here or O(1), so hacks\r\n          s.forEach(function (column, columnIndex) {\r\n            sSorted.push(s[self.orders.columns[columnIndex]]);\r\n          });\r\n          sSorted.forEach(function (column, columnIndex) {\r\n            if (rowKeys.indexOf(column.name) !== -1) {\r\n              outputHeaders[column.name] = true;\r\n              // escape strings\r\n              addCellValue(row[column.name], trRow, textRow, column);\r\n            }\r\n          });\r\n          tableRows.push(trRow.join(''));\r\n          textRows.push(textRow.join(','));\r\n        }\r\n      });\r\n      outputHeaderKeys = Object.keys(outputHeaders);\r\n      t = addHeaders(outputHeaderKeys) + textRows.join('\\n');\r\n      d =\r\n        '<table>' +\r\n        addHeaders(outputHeaderKeys, true) +\r\n        '<tr>' +\r\n        tableRows.join('</tr><tr>') +\r\n        '</tr></table>';\r\n      if (outputHeaderKeys.length === 1) {\r\n        // if there was only one cell selected, remove the quotes from the string\r\n        t = t.substring(1, t.length - 1);\r\n      }\r\n      e.clipboardData.setData('text/html', d);\r\n      e.clipboardData.setData('text/plain', t);\r\n      e.clipboardData.setData('text/csv', t);\r\n      e.clipboardData.setData('application/json', JSON.stringify(sData));\r\n      e.preventDefault();\r\n    }\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, plusplus: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var touchTimerMs = 50,\r\n    debounceTouchMove,\r\n    touchMoving,\r\n    touchScrollTimeout;\r\n  self.scrollAnimation = {};\r\n  self.touchDelta = {};\r\n  self.touchAnimateTo = {};\r\n  self.animationFrames = 0;\r\n  self.getTouchPos = function (e, touchIndex) {\r\n    var t = touchIndex ? e.touches[touchIndex] : e.touches[0],\r\n      rect = self.canvas.getBoundingClientRect(),\r\n      pos;\r\n    if (!t) {\r\n      return;\r\n    }\r\n    pos = {\r\n      x: t.clientX - rect.left,\r\n      y: t.clientY - rect.top,\r\n    };\r\n    if (self.isChildGrid) {\r\n      pos.x -= self.canvasOffsetLeft;\r\n      pos.y -= self.canvasOffsetTop;\r\n    }\r\n    return {\r\n      x: pos.x,\r\n      y: pos.y,\r\n      rect: rect,\r\n    };\r\n  };\r\n  // shamelessly stolen from from https://gist.github.com/gre/1650294\r\n  self.easingFunctions = {\r\n    linear: function (t) {\r\n      return t;\r\n    },\r\n    easeInQuad: function (t) {\r\n      return t * t;\r\n    },\r\n    easeOutQuad: function (t) {\r\n      return t * (2 - t);\r\n    },\r\n    easeInOutQuad: function (t) {\r\n      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n    },\r\n    easeInCubic: function (t) {\r\n      return t * t * t;\r\n    },\r\n    easeOutCubic: function (t) {\r\n      return --t * t * t + 1;\r\n    },\r\n    easeInOutCubic: function (t) {\r\n      return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n    },\r\n    easeInQuart: function (t) {\r\n      return t * t * t * t;\r\n    },\r\n    easeOutQuart: function (t) {\r\n      return 1 - --t * t * t * t;\r\n    },\r\n    easeInOutQuart: function (t) {\r\n      return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\r\n    },\r\n    easeInQuint: function (t) {\r\n      return t * t * t * t * t;\r\n    },\r\n    easeOutQuint: function (t) {\r\n      return 1 + --t * t * t * t * t;\r\n    },\r\n    easeInOutQuint: function (t) {\r\n      return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\r\n    },\r\n  };\r\n  self.easing = function (t, b, c, d) {\r\n    return (\r\n      c * self.easingFunctions[self.attributes.touchEasingMethod](t / d) + b\r\n    );\r\n  };\r\n  self.calculatePPSTimed = function () {\r\n    self.xPPST = -(\r\n      (self.touchDelta.x - self.touchSigmaTimed.x) /\r\n      (self.touchDelta.t - self.touchSigmaTimed.t)\r\n    );\r\n    self.yPPST = -(\r\n      (self.touchDelta.y - self.touchSigmaTimed.y) /\r\n      (self.touchDelta.t - self.touchSigmaTimed.t)\r\n    );\r\n    self.touchSigmaTimed = {\r\n      x: self.touchDelta.x,\r\n      y: self.touchDelta.y,\r\n      t: performance.now(),\r\n    };\r\n  };\r\n  self.calculatePPS = function () {\r\n    self.xPPS = -(\r\n      (self.touchDelta.x - self.touchSigma.x) /\r\n      (self.touchDelta.t - self.touchSigma.t)\r\n    );\r\n    self.yPPS = -(\r\n      (self.touchDelta.y - self.touchSigma.y) /\r\n      (self.touchDelta.t - self.touchSigma.t)\r\n    );\r\n    self.touchSigma = {\r\n      x: self.touchDelta.x,\r\n      y: self.touchDelta.y,\r\n      t: performance.now(),\r\n    };\r\n  };\r\n  self.touchEndAnimation = function () {\r\n    if (!self.canvas || !self.scrollBox.scrollTo) {\r\n      return requestAnimationFrame(self.touchEndAnimation);\r\n    }\r\n    var n = performance.now(),\r\n      d = self.attributes.touchReleaseAnimationDurationMs,\r\n      t;\r\n    t = n - self.touchDelta.t;\r\n    self.animationFrames += 1;\r\n    self.scrollAnimation.x = self.easing(\r\n      t,\r\n      self.touchDelta.scrollLeft,\r\n      self.touchAnimateTo.x,\r\n      d,\r\n    );\r\n    self.scrollAnimation.y = self.easing(\r\n      t,\r\n      self.touchDelta.scrollTop,\r\n      self.touchAnimateTo.y,\r\n      d,\r\n    );\r\n    if (\r\n      t > d ||\r\n      (self.scrollAnimation.y === self.scrollBox.scrollTop &&\r\n        self.scrollAnimation.x === self.scrollBox.scrollLeft) ||\r\n      self.stopAnimation\r\n    ) {\r\n      return;\r\n    }\r\n    self.scrollBox.scrollTo(self.scrollAnimation.x, self.scrollAnimation.y);\r\n    requestAnimationFrame(self.touchEndAnimation);\r\n  };\r\n  self.touchEditCell = function (cell) {\r\n    self.beginEditAt(cell.columnIndex, cell.rowIndex);\r\n  };\r\n  self.touchCell = function (e) {\r\n    return function () {\r\n      clearInterval(self.calculatePPSTimer);\r\n      var i,\r\n        pos = self.getTouchPos(e);\r\n      if (\r\n        Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) <\r\n        self.attributes.touchDeadZone\r\n      ) {\r\n        i = self.getCellAt(pos.x, pos.y);\r\n        if (!i) {\r\n          return;\r\n        }\r\n        if (\r\n          self.touchingCell &&\r\n          self.touchingCell.rowIndex === i.rowIndex &&\r\n          self.touchingCell.columnIndex === i.columnIndex\r\n        ) {\r\n          self.touchEditCell(i);\r\n          return;\r\n        }\r\n        if (self.input && self.input.editCell) {\r\n          self.endEdit();\r\n        }\r\n        self.touchingCell = i;\r\n        self.selectArea({\r\n          top: i.rowIndex,\r\n          bottom: i.rowIndex,\r\n          left: i.columnIndex,\r\n          right: i.columnIndex,\r\n        });\r\n        self.draw(true);\r\n      }\r\n    };\r\n  };\r\n  self.touchstart = function (e) {\r\n    if (e.changedTouches[0]) {\r\n      self.touchStart = self.getTouchPos(e);\r\n      self.startingCell = self.getCellAt(\r\n        self.touchStart.x,\r\n        self.touchStart.y,\r\n        true,\r\n      );\r\n    }\r\n    if (\r\n      self.dispatchEvent('touchstart', {\r\n        NativeEvent: e,\r\n        cell: self.startingCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.disposeContextMenu();\r\n    clearInterval(self.calculatePPSTimer);\r\n    clearTimeout(self.touchContextTimeout);\r\n    self.touchStartEvent = e;\r\n    self.stopAnimation = true;\r\n    self.animationFrames = 0;\r\n    self.stopPropagation(e);\r\n    e.preventDefault();\r\n    if (e.touches.length === 1 && e.changedTouches[0] && !self.zoomAltered) {\r\n      self.touchLength = 1;\r\n      self.touchStart = self.touchStart || self.touchStart1;\r\n      self.touchScrollStart = {\r\n        x: self.scrollBox.scrollLeft,\r\n        y: self.scrollBox.scrollTop,\r\n        t: performance.now(),\r\n      };\r\n      self.touchDelta = {\r\n        x: 0,\r\n        y: 0,\r\n        scrollLeft: self.scrollBox.scrollLeft,\r\n        scrollTop: self.scrollBox.scrollTop,\r\n        t: self.touchScrollStart.t,\r\n      };\r\n      self.touchSigma = {\r\n        x: self.touchDelta.x,\r\n        y: self.touchDelta.y,\r\n        t: self.touchDelta.t,\r\n      };\r\n      self.touchSigmaTimed = {\r\n        x: self.touchDelta.x,\r\n        y: self.touchDelta.y,\r\n        t: self.touchDelta.t,\r\n      };\r\n      self.touchContextTimeout = setTimeout(function () {\r\n        self.contextmenuEvent(e, self.touchStart);\r\n      }, self.attributes.touchContextMenuTimeMs);\r\n      self.calculatePPSTimer = setInterval(\r\n        self.calculatePPSTimed,\r\n        touchTimerMs,\r\n      );\r\n      if (\r\n        self.startingCell &&\r\n        (self.startingCell.isGrid ||\r\n          ['tree', 'inherit'].indexOf(self.startingCell.context) !== -1)\r\n      ) {\r\n        self.hasFocus = false;\r\n        return;\r\n      }\r\n      self.hasFocus = true;\r\n      if (self.startingCell.isHeader) {\r\n        if (self.startingCell.isRowHeader) {\r\n          self.selectArea({\r\n            top: self.startingCell.rowIndex,\r\n            bottom: self.startingCell.rowIndex,\r\n            left: 0,\r\n            right: self.getVisibleSchema().length - 1,\r\n          });\r\n          self.draw(true);\r\n        } else if (self.startingCell.isColumnHeader) {\r\n          if (self.attributes.columnHeaderClickBehavior === 'sort') {\r\n            if (self.orderBy === self.startingCell.header.name) {\r\n              self.orderDirection =\r\n                self.orderDirection === 'asc' ? 'desc' : 'asc';\r\n            } else {\r\n              self.orderDirection = 'asc';\r\n            }\r\n            self.order(self.startingCell.header.name, self.orderDirection);\r\n          }\r\n          if (self.attributes.columnHeaderClickBehavior === 'select') {\r\n            self.selectArea({\r\n              top: 0,\r\n              bottom: self.viewData.length - 1,\r\n              left: self.startingCell.columnIndex,\r\n              right: self.startingCell.columnIndex,\r\n            });\r\n            self.draw(true);\r\n          }\r\n        }\r\n        self.touchEndEvents(e);\r\n        return;\r\n      }\r\n    }\r\n    if (self.zoomAltered) {\r\n      return;\r\n    }\r\n    document.body.addEventListener('touchmove', self.touchmove, {\r\n      passive: false,\r\n    });\r\n    document.body.addEventListener('touchend', self.touchend, false);\r\n    document.body.addEventListener('touchcancel', self.touchcancel, false);\r\n    self.draw(true);\r\n  };\r\n  self.touchSelect = function (cell, handleType) {\r\n    if (cell.rowIndex === undefined || cell.columnIndex === undefined) {\r\n      return;\r\n    }\r\n    self.touchSelecting = true;\r\n    var bounds = self.getSelectionBounds();\r\n    if (\r\n      handleType === 'selection-handle-bl' &&\r\n      cell.rowIndex >= bounds.top &&\r\n      cell.columnIndex <= bounds.right\r\n    ) {\r\n      bounds.bottom = cell.rowIndex;\r\n      bounds.left = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-tl' &&\r\n      cell.rowIndex <= bounds.bottom &&\r\n      cell.columnIndex <= bounds.right\r\n    ) {\r\n      bounds.top = cell.rowIndex;\r\n      bounds.left = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-tr' &&\r\n      cell.rowIndex <= bounds.bottom &&\r\n      cell.columnIndex >= bounds.left\r\n    ) {\r\n      bounds.top = cell.rowIndex;\r\n      bounds.right = cell.columnIndex;\r\n    } else if (\r\n      handleType === 'selection-handle-br' &&\r\n      cell.rowIndex >= bounds.top &&\r\n      cell.columnIndex >= bounds.left\r\n    ) {\r\n      bounds.bottom = cell.rowIndex;\r\n      bounds.right = cell.columnIndex;\r\n    }\r\n    if (self.attributes.selectionMode === 'row' || cell.rowIndex === -1) {\r\n      bounds.left = 0;\r\n      bounds.right = self.getSchema().length - 1;\r\n    } else {\r\n      bounds.left = Math.max(0, bounds.left);\r\n    }\r\n    self.selectArea(bounds);\r\n    self.draw(true);\r\n  };\r\n  function touchMove(e) {\r\n    var ch, rw, rScrollZone, lScrollZone, bScrollZone, tScrollZone, sbw, t1, t2;\r\n    if (self.dispatchEvent('beforetouchmove', { NativeEvent: e })) {\r\n      return;\r\n    }\r\n    clearTimeout(touchScrollTimeout);\r\n    if (e.changedTouches[0]) {\r\n      self.touchPosition = self.getTouchPos(e);\r\n    }\r\n    if (e.changedTouches[1]) {\r\n      self.touchPosition1 = self.getTouchPos(e, 1);\r\n    }\r\n    if (\r\n      Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) >\r\n      self.attributes.touchDeadZone\r\n    ) {\r\n      clearTimeout(self.touchContextTimeout);\r\n    }\r\n    if (e.touches.length === 2 && self.touchPosition && self.touchPosition1) {\r\n      t1 = self.touchPosition.y;\r\n      t2 = self.touchPosition1.y;\r\n      if (!self.zoomDeltaStart) {\r\n        self.zoomDeltaStart = Math.abs(t1 - t2);\r\n        self.startScale = self.scale;\r\n      }\r\n      self.touchLength = 2;\r\n      self.scaleDelta = self.zoomDeltaStart - Math.abs(t1 - t2);\r\n      self.scale =\r\n        self.startScale -\r\n        self.scaleDelta * self.attributes.touchZoomSensitivity;\r\n      self.scale = Math.min(\r\n        Math.max(self.scale, self.attributes.touchZoomMin),\r\n        self.attributes.touchZoomMax,\r\n      );\r\n      self.zoomAltered = true;\r\n      self.resize(true);\r\n      self.resizeChildGrids();\r\n      return;\r\n    }\r\n    if (self.zoomAltered) {\r\n      return;\r\n    }\r\n    self.touchLength = 1;\r\n    self.touchPosition = self.touchPosition || self.touchPosition1;\r\n    ch = self.getColumnHeaderCellHeight();\r\n    rw = self.getRowHeaderCellWidth();\r\n    rScrollZone =\r\n      self.width - self.style.scrollBarWidth - self.touchPosition.x <\r\n      self.attributes.selectionScrollZone;\r\n    lScrollZone =\r\n      self.touchPosition.x - rw < self.attributes.selectionScrollZone;\r\n    bScrollZone =\r\n      self.height - self.style.scrollBarWidth - self.touchPosition.y <\r\n      self.attributes.selectionScrollZone;\r\n    tScrollZone =\r\n      self.touchPosition.y - ch < self.attributes.selectionScrollZone;\r\n    sbw = self.style.scrollBarWidth;\r\n    function touchScroll() {\r\n      var x = self.scrollBox.scrollLeft,\r\n        y = self.scrollBox.scrollTop;\r\n      x += rScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      y += bScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      y -= tScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      x -= lScrollZone ? self.attributes.selectionScrollIncrement : 0;\r\n      self.scrollBox.scrollTo(x, y);\r\n      touchScrollTimeout = setTimeout(\r\n        touchScroll,\r\n        self.attributes.scrollRepeatRate,\r\n      );\r\n    }\r\n    e.stopPropagation();\r\n    self.touchDelta = {\r\n      x: self.touchPosition.x - self.touchStart.x,\r\n      y: self.touchPosition.y - self.touchStart.y,\r\n      scrollLeft: self.scrollBox.scrollLeft,\r\n      scrollTop: self.scrollBox.scrollTop,\r\n      t: performance.now(),\r\n    };\r\n    self.currentCell = self.getCellAt(\r\n      self.touchPosition.x,\r\n      self.touchPosition.y,\r\n    );\r\n    self.dispatchEvent('touchmove', { NativeEvent: e, cell: self.currentCell });\r\n    self.calculatePPS();\r\n    self.touchDuration = performance.now() - self.touchScrollStart.t;\r\n    self.stopAnimation = true;\r\n    self.animationFrames = 0;\r\n    if (\r\n      self.touchSelecting &&\r\n      (rScrollZone || lScrollZone || tScrollZone || bScrollZone)\r\n    ) {\r\n      touchScroll();\r\n    }\r\n    if (/vertical-scroll-/.test(self.startingCell.style)) {\r\n      self.scrollBox.scrollTop =\r\n        self.scrollBox.scrollHeight *\r\n        ((self.touchPosition.y - ch - sbw) /\r\n          (self.scrollBox.height - sbw - ch));\r\n      return;\r\n    }\r\n    if (/horizontal-scroll-/.test(self.startingCell.style)) {\r\n      self.scrollBox.scrollLeft =\r\n        self.scrollBox.scrollWidth *\r\n        ((self.touchPosition.x - rw - sbw) / (self.scrollBox.width - sbw - rw));\r\n      return;\r\n    }\r\n    if (/selection-handle-/.test(self.startingCell.style)) {\r\n      self.touchSelect(self.currentCell, self.startingCell.style);\r\n      return;\r\n    }\r\n    self.scrollBox.scrollTo(\r\n      self.touchScrollStart.x - self.touchDelta.x,\r\n      self.touchScrollStart.y - self.touchDelta.y,\r\n    );\r\n  }\r\n  self.touchmove = function (e) {\r\n    if (touchMoving) {\r\n      return;\r\n    }\r\n    requestAnimationFrame(function () {\r\n      touchMoving = true;\r\n      touchMove(e);\r\n      touchMoving = false;\r\n    });\r\n  };\r\n  self.touchEndEvents = function (e) {\r\n    self.zoomDeltaStart = undefined;\r\n    self.touchSelecting = false;\r\n    clearInterval(self.touchScrollTimeout);\r\n    clearInterval(self.touchContextTimeout);\r\n    clearInterval(self.calculatePPSTimer);\r\n    e.stopPropagation();\r\n    document.body.removeEventListener('touchmove', self.touchmove, {\r\n      passive: false,\r\n    });\r\n    document.body.removeEventListener('touchend', self.touchend, false);\r\n    document.body.removeEventListener('touchcancel', self.touchcancel, false);\r\n  };\r\n  self.touchend = function (e) {\r\n    if (\r\n      self.dispatchEvent('touchend', { NativeEvent: e, cell: self.currentCell })\r\n    ) {\r\n      return;\r\n    }\r\n    self.zoomDeltaStart = undefined;\r\n    if (e.changedTouches[0]) {\r\n      self.touchPosition = undefined;\r\n    }\r\n    if (e.changedTouches[1]) {\r\n      self.touchPosition1 = undefined;\r\n    }\r\n    if (self.zoomAltered) {\r\n      if (e.touches.length === 0) {\r\n        self.zoomAltered = false;\r\n      }\r\n      return;\r\n    }\r\n    var dz =\r\n      Math.abs(self.touchDelta.x) + Math.abs(self.touchDelta.y) <\r\n      self.attributes.touchDeadZone;\r\n    if (isNaN(self.xPPS)) {\r\n      self.xPPS = 0;\r\n    }\r\n    if (isNaN(self.yPPS)) {\r\n      self.yPPS = 0;\r\n    }\r\n    if (isNaN(self.xPPST)) {\r\n      self.xPPST = 0;\r\n    }\r\n    if (isNaN(self.yPPST)) {\r\n      self.yPPST = 0;\r\n    }\r\n    self.touchAnimateTo.x =\r\n      self.xPPS * self.attributes.touchReleaseAcceleration;\r\n    self.touchAnimateTo.y =\r\n      self.yPPS * self.attributes.touchReleaseAcceleration;\r\n    self.calculatePPSTimed();\r\n    if (dz && !self.contextMenu) {\r\n      self.touchCell(self.touchStartEvent)();\r\n    } else if (\r\n      self.animationFrames === 0 &&\r\n      (Math.abs(self.xPPST) > self.attributes.scrollAnimationPPSThreshold ||\r\n        Math.abs(self.yPPST) > self.attributes.scrollAnimationPPSThreshold) &&\r\n      !/-scroll-/.test(self.startingCell.style) &&\r\n      !dz\r\n    ) {\r\n      self.stopAnimation = false;\r\n      self.touchEndAnimation();\r\n    }\r\n    self.touchEndEvents(e);\r\n  };\r\n  self.touchcancel = function (e) {\r\n    if (\r\n      self.dispatchEvent('touchcancel', {\r\n        NativeEvent: e,\r\n        cell: self.currentCell,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.touchEndEvents(e);\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals HTMLElement: false, Reflect: false, define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self, ctor) {\r\n  self.scale = 1;\r\n  self.orders = {\r\n    rows: [],\r\n    columns: [],\r\n  };\r\n  self.appliedInlineStyles = {};\r\n  self.cellGridAttributes = {};\r\n  self.treeGridAttributes = {};\r\n  self.visibleRowHeights = [];\r\n  self.hasFocus = false;\r\n  self.activeCell = {\r\n    columnIndex: 0,\r\n    rowIndex: 0,\r\n  };\r\n  self.innerHTML = '';\r\n  self.storageName = 'canvasDataGrid';\r\n  self.invalidSearchExpClass = 'canvas-datagrid-invalid-search-regExp';\r\n  self.localStyleLibraryStorageKey = 'canvas-datagrid-user-style-library';\r\n  self.dataType = 'application/x-canvas-datagrid';\r\n  self.orderBy = null;\r\n  self.orderDirection = 'asc';\r\n  self.orderings = {\r\n    columns: [],\r\n    add: function (orderBy, orderDirection, sortFunction) {\r\n      self.orderings.columns = self.orderings.columns.filter(function (col) {\r\n        return col.orderBy !== orderBy;\r\n      });\r\n      self.orderings.columns.push({\r\n        orderBy: orderBy,\r\n        orderDirection: orderDirection,\r\n        sortFunction: sortFunction,\r\n      });\r\n    },\r\n    sort: function () {\r\n      console.warn(\r\n        'grid.orderings.sort has been deprecated. Please use grid.refresh().',\r\n      );\r\n\r\n      self.orderings.columns.forEach(function (col) {\r\n        self.viewData.sort(col.sortFunction(col.orderBy, col.orderDirection));\r\n      });\r\n    },\r\n  };\r\n  self.columnFilters = {};\r\n  self.filters = {};\r\n  self.frozenRow = 0;\r\n  self.frozenColumn = 0;\r\n  self.ellipsisCache = {};\r\n  self.scrollCache = { x: [], y: [] };\r\n  self.scrollBox = {};\r\n  self.visibleRows = [];\r\n  self.visibleCells = [];\r\n  self.sizes = {\r\n    rows: {},\r\n    columns: {},\r\n    trees: {},\r\n  };\r\n  self.selections = [];\r\n  self.hovers = {};\r\n  self.attributes = {};\r\n  self.style = {};\r\n  self.formatters = {};\r\n  self.sorters = {};\r\n  self.parsers = {};\r\n  self.schemaHashes = {};\r\n  self.events = {};\r\n  self.changes = [];\r\n  self.scrollIndexTop = 0;\r\n  self.scrollPixelTop = 0;\r\n  self.scrollIndexLeft = 0;\r\n  self.scrollPixelLeft = 0;\r\n  self.childGrids = {};\r\n  self.openChildren = {};\r\n  self.scrollModes = [\r\n    'vertical-scroll-box',\r\n    'vertical-scroll-top',\r\n    'vertical-scroll-bottom',\r\n    'horizontal-scroll-box',\r\n    'horizontal-scroll-right',\r\n    'horizontal-scroll-left',\r\n  ];\r\n  self.componentL1Events = {};\r\n  self.eventNames = [\r\n    'afterdraw',\r\n    'afterrendercell',\r\n    'attributechanged',\r\n    'beforebeginedit',\r\n    'beforecreatecellgrid',\r\n    'beforedraw',\r\n    'beforeendedit',\r\n    'beforerendercell',\r\n    'beforerendercellgrid',\r\n    'beginedit',\r\n    'cellmouseout',\r\n    'cellmouseover',\r\n    'click',\r\n    'collapsetree',\r\n    'contextmenu',\r\n    'copy',\r\n    'datachanged',\r\n    'dblclick',\r\n    'endedit',\r\n    'expandtree',\r\n    'formatcellvalue',\r\n    'keydown',\r\n    'keypress',\r\n    'keyup',\r\n    'mousedown',\r\n    'mousemove',\r\n    'mouseup',\r\n    'newrow',\r\n    'ordercolumn',\r\n    'rendercell',\r\n    'rendercellgrid',\r\n    'renderorderbyarrow',\r\n    'rendertext',\r\n    'rendertreearrow',\r\n    'reorder',\r\n    'reordering',\r\n    'resize',\r\n    'resizecolumn',\r\n    'resizerow',\r\n    'schemachanged',\r\n    'scroll',\r\n    'selectionchanged',\r\n    'stylechanged',\r\n    'touchcancel',\r\n    'touchend',\r\n    'touchmove',\r\n    'touchstart',\r\n    'wheel',\r\n  ];\r\n  self.mouse = { x: 0, y: 0 };\r\n  self.getSelectedData = function (expandToRow) {\r\n    const selectedData = [];\r\n    const schema = self.getSchema();\r\n    const viewDataLength = self.viewData.length;\r\n\r\n    if (viewDataLength === 0) {\r\n      return [];\r\n    }\r\n\r\n    // self.selections is a sparse array, so `viewRowIndex` here\r\n    // will equal the row index as where it's rendered,\r\n    // not as where it is in the original data array.\r\n    self.selections.forEach(function (row, viewRowIndex) {\r\n      if (!row) {\r\n        return;\r\n      }\r\n\r\n      if (viewRowIndex === viewDataLength) {\r\n        return;\r\n      }\r\n\r\n      if (row.length === 0) {\r\n        selectedData[viewRowIndex] = null;\r\n        return;\r\n      }\r\n\r\n      selectedData[viewRowIndex] = {};\r\n\r\n      row.forEach(function (col) {\r\n        if (col === -1 || !schema[col]) {\r\n          return;\r\n        }\r\n\r\n        const orderedIndex = self.orders.columns[col];\r\n\r\n        if (!expandToRow && schema[orderedIndex].hidden) {\r\n          return;\r\n        }\r\n\r\n        if (self.viewData[viewRowIndex]) {\r\n          selectedData[viewRowIndex][schema[orderedIndex].name] =\r\n            self.viewData[viewRowIndex][schema[orderedIndex].name];\r\n        }\r\n      });\r\n    });\r\n\r\n    return selectedData;\r\n  };\r\n  self.getBoundRowIndexFromViewRowIndex = function (viewRowIndex) {\r\n    if (self.boundRowIndexMap && self.boundRowIndexMap.has(viewRowIndex)) {\r\n      return self.boundRowIndexMap.get(viewRowIndex);\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n  self.getColumnHeaderCellHeight = function () {\r\n    if (!self.attributes.showColumnHeaders) {\r\n      return 0;\r\n    }\r\n    return (\r\n      (self.sizes.rows[-1] || self.style.columnHeaderCellHeight) * self.scale\r\n    );\r\n  };\r\n  self.getRowHeaderCellWidth = function () {\r\n    if (!self.attributes.showRowHeaders) {\r\n      return 0;\r\n    }\r\n    return (\r\n      (self.sizes.columns[-1] || self.style.rowHeaderCellWidth) * self.scale\r\n    );\r\n  };\r\n  self.setStorageData = function () {\r\n    if (!self.attributes.saveAppearance || !self.attributes.name) {\r\n      return;\r\n    }\r\n    var visibility = {};\r\n    self.getSchema().forEach(function (column) {\r\n      visibility[column.name] = !column.hidden;\r\n    });\r\n    localStorage.setItem(\r\n      self.storageName + '-' + self.attributes.name,\r\n      JSON.stringify({\r\n        sizes: {\r\n          rows: self.sizes.rows,\r\n          columns: self.sizes.columns,\r\n        },\r\n        orders: {\r\n          rows: self.orders.rows,\r\n          columns: self.orders.columns,\r\n        },\r\n        orderBy: self.orderBy,\r\n        orderDirection: self.orderDirection,\r\n        visibility: visibility,\r\n      }),\r\n    );\r\n  };\r\n  self.getSchema = function () {\r\n    return self.schema || self.tempSchema || [];\r\n  };\r\n  function fillArray(low, high) {\r\n    var i = [],\r\n      x;\r\n    for (x = low; x <= high; x += 1) {\r\n      i[x] = x;\r\n    }\r\n    return i;\r\n  }\r\n  self.createColumnOrders = function () {\r\n    var s = self.getSchema();\r\n    self.orders.columns = fillArray(0, s.length - 1);\r\n  };\r\n  self.createRowOrders = function () {\r\n    self.orders.rows = fillArray(0, self.originalData.length - 1);\r\n  };\r\n  self.getVisibleSchema = function () {\r\n    return self.getSchema().filter(function (col) {\r\n      return !col.hidden;\r\n    });\r\n  };\r\n  self.applyDefaultValue = function (row, header, rowIndex) {\r\n    var d = header.defaultValue || '';\r\n    if (typeof d === 'function') {\r\n      d = d.apply(self.intf, [header, rowIndex]);\r\n    }\r\n    row[header.name] = d;\r\n  };\r\n  self.createNewRowData = function () {\r\n    self.newRow = {};\r\n\r\n    // The third argument of applyDefaultValue is the row index\r\n    // of the row for which to apply the default value. In this\r\n    // case, we're creating a new row but not yet appending it\r\n    // to self.originalData, so no row index exists\r\n    const newRowIndex = undefined;\r\n\r\n    self.getSchema().forEach(function forEachHeader(header) {\r\n      self.applyDefaultValue(self.newRow, header, newRowIndex);\r\n    });\r\n  };\r\n  self.getSchemaNameHash = function (key) {\r\n    var n = 0;\r\n    while (self.schemaHashes[key]) {\r\n      n += 1;\r\n      key = key + n;\r\n    }\r\n    return key;\r\n  };\r\n  self.filter = function (type) {\r\n    var f = self.filters[type];\r\n    if (!f && type !== undefined) {\r\n      console.warn(\r\n        'Cannot find filter for type %s, falling back to substring match.',\r\n        type,\r\n      );\r\n      f = self.filters.string;\r\n    }\r\n    return f;\r\n  };\r\n  self.hasActiveFilters = function () {\r\n    return self.columnFilters && Object.keys(self.columnFilters).length > 0;\r\n  };\r\n  self.getFilteredAndSortedViewData = function (originalData) {\r\n    // We make a copy of originalData here in order be able to\r\n    // filter and sort rows without modifying the original array.\r\n    // Each row is turned into a (row, rowIndex) tuple\r\n    // so that when we apply filters, we can refer back to the\r\n    // row's original row number in originalData. This becomes\r\n    // useful when emitting cell events.\r\n    let newViewData = originalData.map((row, originalRowIndex) => [\r\n      row,\r\n      originalRowIndex,\r\n    ]);\r\n\r\n    // Apply filtering\r\n    for (const [headerName, filterText] of Object.entries(self.columnFilters)) {\r\n      const header = self.getHeaderByName(headerName);\r\n\r\n      if (!header) {\r\n        continue;\r\n      }\r\n\r\n      const currentFilterFunction =\r\n        header.filter || self.filter(header.type || 'string');\r\n\r\n      newViewData = newViewData.filter(function ([row]) {\r\n        const cellValue = row[headerName];\r\n        const shouldIncludeRow = currentFilterFunction(cellValue, filterText);\r\n\r\n        return shouldIncludeRow;\r\n      });\r\n    }\r\n\r\n    // Apply sorting\r\n    for (const column of self.orderings.columns) {\r\n      const sortFn = column.sortFunction(column.orderBy, column.orderDirection);\r\n\r\n      newViewData.sort(([rowA], [rowB]) => sortFn(rowA, rowB));\r\n    }\r\n\r\n    return {\r\n      viewData: newViewData.map(([row]) => row),\r\n      boundRowIndexMap: new Map(\r\n        newViewData.map(([_row, originalRowIndex], viewRowIndex) => [\r\n          viewRowIndex,\r\n          originalRowIndex,\r\n        ]),\r\n      ),\r\n    };\r\n  };\r\n  self.refresh = function () {\r\n    const { viewData, boundRowIndexMap } = self.getFilteredAndSortedViewData(\r\n      self.originalData,\r\n    );\r\n\r\n    self.viewData = viewData;\r\n    self.boundRowIndexMap = boundRowIndexMap;\r\n\r\n    self.resize();\r\n    self.draw(true);\r\n  };\r\n  self.getBestGuessDataType = function (columnName, data) {\r\n    var t,\r\n      x,\r\n      l = data.length;\r\n    for (x = 0; x < l; x += 1) {\r\n      if (\r\n        data[x] !== undefined &&\r\n        data[x] !== null &&\r\n        [null, undefined].indexOf(data[x][columnName]) !== -1\r\n      ) {\r\n        t = typeof data[x];\r\n        return t === 'object' ? 'string' : t;\r\n      }\r\n    }\r\n    return 'string';\r\n  };\r\n  self.drawChildGrids = function () {\r\n    Object.keys(self.childGrids).forEach(function (gridKey) {\r\n      self.childGrids[gridKey].draw();\r\n    });\r\n  };\r\n  self.resizeChildGrids = function () {\r\n    Object.keys(self.childGrids).forEach(function (gridKey) {\r\n      self.childGrids[gridKey].resize();\r\n    });\r\n  };\r\n  self.autoScrollZone = function (e, x, y, ctrl) {\r\n    var setTimer,\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth(),\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight();\r\n    if (y !== -1) {\r\n      if (\r\n        x > self.width - self.attributes.selectionScrollZone &&\r\n        x < self.width\r\n      ) {\r\n        self.scrollBox.scrollLeft += self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n      if (x - self.attributes.selectionScrollZone - rowHeaderCellWidth < 0) {\r\n        self.scrollBox.scrollLeft -= self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n    }\r\n    if (y !== -1) {\r\n      if (\r\n        y > self.height - self.attributes.selectionScrollZone &&\r\n        y < self.height\r\n      ) {\r\n        self.scrollBox.scrollTop += self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n      if (\r\n        y - self.attributes.selectionScrollZone - columnHeaderCellHeight <\r\n        0\r\n      ) {\r\n        self.scrollBox.scrollTop -= self.attributes.selectionScrollIncrement;\r\n        setTimer = true;\r\n      }\r\n    }\r\n    if (\r\n      setTimer &&\r\n      !ctrl &&\r\n      self.currentCell &&\r\n      self.currentCell.columnIndex !== -1\r\n    ) {\r\n      self.scrollTimer = setTimeout(\r\n        self.mousemove,\r\n        self.attributes.scrollRepeatRate,\r\n        e,\r\n      );\r\n    }\r\n  };\r\n  self.validateColumn = function (c, s) {\r\n    if (!c.name) {\r\n      throw new Error('A column must contain at least a name.');\r\n    }\r\n    if (\r\n      s.filter(function (i) {\r\n        return i.name === c.name;\r\n      }).length > 0\r\n    ) {\r\n      throw new Error(\r\n        'A column with the name ' +\r\n          c.name +\r\n          ' already exists and cannot be added again.',\r\n      );\r\n    }\r\n    return true;\r\n  };\r\n  self.setDefaults = function (obj1, obj2, key, def) {\r\n    obj1[key] = obj2[key] === undefined ? def : obj2[key];\r\n  };\r\n  self.setAttributes = function () {\r\n    self.defaults.attributes.forEach(function eachAttribute(i) {\r\n      self.setDefaults(self.attributes, self.args, i[0], i[1]);\r\n    });\r\n  };\r\n  self.setStyle = function () {\r\n    self.defaults.styles.forEach(function eachStyle(i) {\r\n      self.setDefaults(self.style, self.args.style || {}, i[0], i[1]);\r\n    });\r\n  };\r\n  self.autosize = function (colName) {\r\n    self.getVisibleSchema().forEach(function (col, colIndex) {\r\n      if (col.name === colName || colName === undefined) {\r\n        self.sizes.columns[colIndex] = Math.max(\r\n          self.findColumnMaxTextLength(col.name),\r\n          self.style.minColumnWidth,\r\n        );\r\n      }\r\n    });\r\n    self.sizes.columns[-1] = self.findColumnMaxTextLength('cornerCell');\r\n  };\r\n  self.dispose = function () {\r\n    if (!self.isChildGrid && self.canvas && self.canvas.parentNode) {\r\n      self.canvas.parentNode.removeChild(self.canvas);\r\n    }\r\n    if (!self.isChildGrid) {\r\n      document.body.removeChild(self.controlInput);\r\n    }\r\n    self.eventParent.removeEventListener('mouseup', self.mouseup, false);\r\n    self.eventParent.removeEventListener('mousedown', self.mousedown, false);\r\n    self.eventParent.removeEventListener('dblclick', self.dblclick, false);\r\n    self.eventParent.removeEventListener('click', self.click, false);\r\n    self.eventParent.removeEventListener('mousemove', self.mousemove);\r\n    self.eventParent.removeEventListener('wheel', self.scrollWheel, false);\r\n    self.canvas.removeEventListener('contextmenu', self.contextmenu, false);\r\n    self.canvas.removeEventListener('copy', self.copy);\r\n    self.controlInput.removeEventListener('copy', self.copy);\r\n    self.controlInput.removeEventListener('cut', self.cut);\r\n    self.controlInput.removeEventListener('paste', self.paste);\r\n    self.controlInput.removeEventListener('keypress', self.keypress, false);\r\n    self.controlInput.removeEventListener('keyup', self.keyup, false);\r\n    self.controlInput.removeEventListener('keydown', self.keydown, false);\r\n    window.removeEventListener('resize', self.resize);\r\n    if (self.observer && self.observer.disconnect) {\r\n      self.observer.disconnect();\r\n    }\r\n  };\r\n  self.tryLoadStoredSettings = function () {\r\n    var s;\r\n    self.reloadStoredValues();\r\n    if (\r\n      self.storedSettings &&\r\n      typeof self.storedSettings.orders === 'object' &&\r\n      self.storedSettings.orders !== null\r\n    ) {\r\n      if (\r\n        self.storedSettings.orders.rows.length >= (self.viewData || []).length\r\n      ) {\r\n        self.orders.rows = self.storedSettings.orders.rows;\r\n      }\r\n      s = self.getSchema();\r\n      if (self.storedSettings.orders.columns.length === s.length) {\r\n        self.orders.columns = self.storedSettings.orders.columns;\r\n      }\r\n      self.orderBy =\r\n        self.storedSettings.orderBy === undefined\r\n          ? s[0].name\r\n          : self.storedSettings.orderBy;\r\n      self.orderDirection =\r\n        self.storedSettings.orderDirection === undefined\r\n          ? 'asc'\r\n          : self.storedSettings.orderDirection;\r\n      if (\r\n        self.storedSettings.orderBy !== undefined &&\r\n        self.getHeaderByName(self.orderBy) &&\r\n        self.orderDirection\r\n      ) {\r\n        self.order(self.orderBy, self.orderDirection);\r\n      }\r\n    }\r\n  };\r\n  self.getDomRoot = function () {\r\n    return self.shadowRoot ? self.shadowRoot.host : self.parentNode;\r\n  };\r\n  self.getFontName = function (fontStyle) {\r\n    return fontStyle.replace(/\\d+\\.?\\d*px/, '');\r\n  };\r\n  self.getFontHeight = function (fontStyle) {\r\n    return parseFloat(fontStyle, 10);\r\n  };\r\n  self.parseStyleValue = function (key) {\r\n    if (/Font/.test(key)) {\r\n      self.style[key + 'Height'] = self.getFontHeight(self.style[key]);\r\n      self.style[key + 'Name'] = self.getFontName(self.style[key]);\r\n      return;\r\n    }\r\n    // when inheriting styles from already instantiated grids, don't parse already parsed values.\r\n    if (\r\n      key === 'moveOverlayBorderSegments' &&\r\n      typeof self.style[key] === 'string'\r\n    ) {\r\n      self.style[key] = self.style[key].split(',').map(function (i) {\r\n        return parseInt(i, 10);\r\n      });\r\n    }\r\n  };\r\n  self.initProp = function (propName) {\r\n    if (!self.args[propName]) {\r\n      return;\r\n    }\r\n    Object.keys(self.args[propName]).forEach(function (key) {\r\n      self[propName][key] = self.args[propName][key];\r\n    });\r\n  };\r\n  self.getStyleProperty = function (key) {\r\n    if (self.styleKeys.indexOf(key) === -1) {\r\n      return self.parentNodeStyle[key];\r\n    }\r\n    return self.style[key];\r\n  };\r\n  self.setStyleProperty = function (key, value, supressDrawAndEvent) {\r\n    var isDim =\r\n      [\r\n        'height',\r\n        'width',\r\n        'minHeight',\r\n        'minWidth',\r\n        'maxHeight',\r\n        'maxWidth',\r\n      ].indexOf(key) !== -1;\r\n    if (self.styleKeys.indexOf(key) === -1) {\r\n      self.parentNodeStyle[key] = value;\r\n    } else {\r\n      if (/-/.test(key)) {\r\n        key = self.dehyphenateProperty(key);\r\n      }\r\n      self.style[key] = value;\r\n      self.parseStyleValue(key);\r\n    }\r\n    if (isDim) {\r\n      self.resize();\r\n    }\r\n    if (!supressDrawAndEvent) {\r\n      self.draw(true);\r\n      self.dispatchEvent('stylechanged', { name: 'style', value: value });\r\n    }\r\n  };\r\n  self.reloadStoredValues = function () {\r\n    if (self.attributes.name && self.attributes.saveAppearance) {\r\n      try {\r\n        self.storedSettings = localStorage.getItem(\r\n          self.storageName + '-' + self.attributes.name,\r\n        );\r\n      } catch (e) {\r\n        console.warn('Error loading stored values. ' + e.message);\r\n        self.storedSettings = undefined;\r\n      }\r\n      if (self.storedSettings) {\r\n        try {\r\n          self.storedSettings = JSON.parse(self.storedSettings);\r\n        } catch (e) {\r\n          console.warn('could not read settings from localStore', e);\r\n          self.storedSettings = undefined;\r\n        }\r\n      }\r\n      if (self.storedSettings) {\r\n        if (\r\n          typeof self.storedSettings.sizes === 'object' &&\r\n          self.storedSettings.sizes !== null\r\n        ) {\r\n          self.sizes.rows = self.storedSettings.sizes.rows;\r\n          self.sizes.columns = self.storedSettings.sizes.columns;\r\n          ['trees', 'columns', 'rows'].forEach(function (i) {\r\n            if (!self.sizes[i]) {\r\n              self.sizes[i] = {};\r\n            }\r\n          });\r\n        }\r\n        if (typeof self.storedSettings.visibility === 'object') {\r\n          self.getSchema().forEach(function (column) {\r\n            if (\r\n              self.storedSettings.visibility &&\r\n              self.storedSettings.visibility[column.name] !== undefined\r\n            ) {\r\n              column.hidden = !self.storedSettings.visibility[column.name];\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n  self.init = function () {\r\n    if (self.initialized) {\r\n      return;\r\n    }\r\n    function addStyleKeyIfNoneExists(key) {\r\n      if (self.styleKeys.indexOf(key) === -1) {\r\n        self.styleKeys.push(key);\r\n      }\r\n    }\r\n    var publicStyleKeyIntf = {};\r\n    self.setAttributes();\r\n    self.setStyle();\r\n    self.initScrollBox();\r\n    self.setDom();\r\n    self.nodeType = 'canvas-datagrid';\r\n    self.ie = /Trident/.test(window.navigator.userAgent);\r\n    self.edge = /Edge/.test(window.navigator.userAgent);\r\n    self.webKit = /WebKit/.test(window.navigator.userAgent);\r\n    self.moz = /Gecko/.test(window.navigator.userAgent);\r\n    self.mobile = /Mobile/i.test(window.navigator.userAgent);\r\n    self.blankValues = [undefined, null, ''];\r\n    self.cursorGrab = 'grab';\r\n    self.cursorGrabing = 'grabbing';\r\n    self.cursorGrab = self.webKit ? '-webkit-grab' : self.cursorGrab;\r\n    self.cursorGrabing = self.moz ? '-webkit-grabbing' : self.cursorGrabbing;\r\n    self.pointerLockPosition = { x: 0, y: 0 };\r\n    Object.keys(self.style).forEach(self.parseStyleValue);\r\n    self.intf.moveSelection = self.moveSelection;\r\n    self.intf.moveTo = self.moveTo;\r\n    self.intf.addEventListener = self.addEventListener;\r\n    self.intf.removeEventListener = self.removeEventListener;\r\n    self.intf.dispatchEvent = self.dispatchEvent;\r\n    /**\r\n     * Releases grid resources and removes grid elements.\r\n     * @memberof canvasDatagrid\r\n     * @name dispose\r\n     * @method\r\n     */\r\n    self.intf.dispose = self.dispose;\r\n    /**\r\n     * Appends the grid to another element later.  Not implemented.\r\n     * @memberof canvasDatagrid\r\n     * @name appendTo\r\n     * @method\r\n     * @param {number} el The element to append the grid to.\r\n     */\r\n    self.intf.appendTo = self.appendTo;\r\n    self.intf.getVisibleCellByIndex = self.getVisibleCellByIndex;\r\n    self.intf.filters = self.filters;\r\n    self.intf.sorters = self.sorters;\r\n    self.intf.autosize = self.autosize;\r\n    self.intf.beginEditAt = self.beginEditAt;\r\n    self.intf.endEdit = self.endEdit;\r\n    self.intf.setActiveCell = self.setActiveCell;\r\n    self.intf.forEachSelectedCell = self.forEachSelectedCell;\r\n    self.intf.scrollIntoView = self.scrollIntoView;\r\n    self.intf.clearChangeLog = self.clearChangeLog;\r\n    self.intf.gotoCell = self.gotoCell;\r\n    self.intf.gotoRow = self.gotoRow;\r\n    self.intf.getHeaderByName = self.getHeaderByName;\r\n    self.intf.findColumnScrollLeft = self.findColumnScrollLeft;\r\n    self.intf.findRowScrollTop = self.findRowScrollTop;\r\n    self.intf.fitColumnToValues = self.fitColumnToValues;\r\n    self.intf.findColumnMaxTextLength = self.findColumnMaxTextLength;\r\n    self.intf.disposeContextMenu = self.disposeContextMenu;\r\n    self.intf.getCellAt = self.getCellAt;\r\n    self.intf.isCellVisible = self.isCellVisible;\r\n    self.intf.isRowVisible = self.isRowVisible;\r\n    self.intf.isColumnVisible = self.isColumnVisible;\r\n    self.intf.order = self.order;\r\n    self.intf.draw = self.draw;\r\n    self.intf.refresh = self.refresh;\r\n    self.intf.isComponent = self.isComponent;\r\n    self.intf.selectArea = self.selectArea;\r\n    self.intf.clipElement = self.clipElement;\r\n    self.intf.getSchemaFromData = self.getSchemaFromData;\r\n    self.intf.setFilter = self.setFilter;\r\n    self.intf.selectRow = self.selectRow;\r\n    self.intf.parentGrid = self.parentGrid;\r\n    self.intf.toggleTree = self.toggleTree;\r\n    self.intf.expandTree = self.expandTree;\r\n    self.intf.collapseTree = self.collapseTree;\r\n    self.intf.canvas = self.canvas;\r\n    self.intf.context = self.ctx;\r\n    self.intf.insertRow = self.insertRow;\r\n    self.intf.deleteRow = self.deleteRow;\r\n    self.intf.addRow = self.addRow;\r\n    self.intf.insertColumn = self.insertColumn;\r\n    self.intf.deleteColumn = self.deleteColumn;\r\n    self.intf.addColumn = self.addColumn;\r\n    self.intf.getClippingRect = self.getClippingRect;\r\n    self.intf.setRowHeight = self.setRowHeight;\r\n    self.intf.setColumnWidth = self.setColumnWidth;\r\n    self.intf.resetColumnWidths = self.resetColumnWidths;\r\n    self.intf.resetRowHeights = self.resetRowHeights;\r\n    self.intf.resize = self.resize;\r\n    self.intf.selectColumn = self.selectColumn;\r\n    self.intf.selectRow = self.selectRow;\r\n    self.intf.selectAll = self.selectAll;\r\n    self.intf.selectNone = self.selectNone;\r\n    self.intf.drawChildGrids = self.drawChildGrids;\r\n    self.intf.assertPxColor = self.assertPxColor;\r\n    self.intf.clearPxColorAssertions = self.clearPxColorAssertions;\r\n    self.intf.integerToAlpha = self.integerToAlpha;\r\n    self.intf.copy = self.copy;\r\n    self.intf.paste = self.paste;\r\n    self.intf.setStyleProperty = self.setStyleProperty;\r\n    Object.defineProperty(self.intf, 'defaults', {\r\n      get: function () {\r\n        return {\r\n          styles: self.defaults.styles.reduce(function (a, i) {\r\n            a[i[0]] = i[1];\r\n            return a;\r\n          }, {}),\r\n          attributes: self.defaults.attributes.reduce(function (a, i) {\r\n            a[i[0]] = i[1];\r\n            return a;\r\n          }, {}),\r\n        };\r\n      },\r\n    });\r\n    self.styleKeys = Object.keys(self.intf.defaults.styles);\r\n    self.styleKeys\r\n      .map(function (i) {\r\n        return self.hyphenateProperty(i, false);\r\n      })\r\n      .forEach(addStyleKeyIfNoneExists);\r\n    self.styleKeys\r\n      .map(function (i) {\r\n        return self.hyphenateProperty(i, true);\r\n      })\r\n      .forEach(addStyleKeyIfNoneExists);\r\n    self.DOMStyles = window.getComputedStyle(document.body, null);\r\n    self.styleKeys.concat(Object.keys(self.DOMStyles)).forEach(function (key) {\r\n      // unless this line is here, Object.keys() will not work on <instance>.style\r\n      publicStyleKeyIntf[key] = undefined;\r\n      Object.defineProperty(publicStyleKeyIntf, key, {\r\n        get: function () {\r\n          return self.getStyleProperty(key);\r\n        },\r\n        set: function (value) {\r\n          if (self.initialized) {\r\n            self.appliedInlineStyles[key] = value;\r\n          }\r\n          self.setStyleProperty(key, value);\r\n        },\r\n      });\r\n    });\r\n    Object.defineProperty(self.intf, 'shadowRoot', {\r\n      get: function () {\r\n        return self.shadowRoot;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'activeCell', {\r\n      get: function () {\r\n        return self.activeCell;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'hasFocus', {\r\n      get: function () {\r\n        return self.hasFocus;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'hasActiveFilters', {\r\n      get: function () {\r\n        return self.hasActiveFilters();\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'style', {\r\n      get: function () {\r\n        return publicStyleKeyIntf;\r\n      },\r\n      set: function (valueObject) {\r\n        Object.keys(valueObject).forEach(function (key) {\r\n          self.setStyleProperty(key, valueObject[key], true);\r\n        });\r\n        self.draw(true);\r\n        self.dispatchEvent('stylechanged', {\r\n          name: 'style',\r\n          value: valueObject,\r\n        });\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'attributes', { value: {} });\r\n    Object.keys(self.attributes).forEach(function (key) {\r\n      Object.defineProperty(self.intf.attributes, key, {\r\n        get: function () {\r\n          return self.attributes[key];\r\n        },\r\n        set: function (value) {\r\n          self.attributes[key] = value;\r\n          if (key === 'name') {\r\n            self.tryLoadStoredSettings();\r\n          }\r\n          self.draw(true);\r\n          self.dispatchEvent('attributechanged', {\r\n            name: key,\r\n            value: value[key],\r\n          });\r\n        },\r\n      });\r\n    });\r\n    self.filters.string = function (value, filterFor) {\r\n      if (filterFor === self.attributes.blanksText) {\r\n        return self.blankValues.includes(\r\n          value == null ? value : String(value).trim(),\r\n        );\r\n      }\r\n\r\n      value = String(value);\r\n      var filterRegExp,\r\n        regEnd = /\\/(i|g|m)*$/,\r\n        pattern = regEnd.exec(filterFor),\r\n        flags = pattern ? pattern[0].substring(1) : '',\r\n        flagLength = flags.length;\r\n      self.invalidFilterRegEx = undefined;\r\n      if (filterFor.substring(0, 1) === '/' && pattern) {\r\n        try {\r\n          filterRegExp = new RegExp(\r\n            filterFor.substring(1, filterFor.length - (flagLength + 1)),\r\n            flags,\r\n          );\r\n        } catch (e) {\r\n          self.invalidFilterRegEx = e;\r\n          return;\r\n        }\r\n        return filterRegExp.test(value);\r\n      }\r\n      return value.toString\r\n        ? value\r\n            .toString()\r\n            .toLocaleUpperCase()\r\n            .indexOf(filterFor.toLocaleUpperCase()) !== -1\r\n        : false;\r\n    };\r\n    self.filters.number = function (value, filterFor) {\r\n      if (filterFor === self.attributes.blanksText) {\r\n        return self.blankValues.includes(\r\n          value == null ? value : String(value).trim(),\r\n        );\r\n      }\r\n\r\n      if (!filterFor) {\r\n        return true;\r\n      }\r\n      return value === filterFor;\r\n    };\r\n    ['formatters', 'filters', 'sorters'].forEach(self.initProp);\r\n    self.applyComponentStyle(false, self.intf);\r\n    self.reloadStoredValues();\r\n    if (self.args.data) {\r\n      self.intf.data = self.args.data;\r\n    }\r\n    if (self.intf.innerText || self.intf.textContent) {\r\n      if (self.intf.dataType === 'application/x-canvas-datagrid') {\r\n        self.intf.dataType = 'application/json+x-canvas-datagrid';\r\n      }\r\n      self.intf.data = self.intf.innerText || self.intf.textContent;\r\n    }\r\n    if (self.args.schema) {\r\n      self.intf.schema = self.args.schema;\r\n    }\r\n    if (self.isChildGrid || !self.isComponent) {\r\n      requestAnimationFrame(function () {\r\n        self.resize(true);\r\n      });\r\n    } else {\r\n      self.resize(true);\r\n    }\r\n    self.initialized = true;\r\n    return self;\r\n  };\r\n  /**\r\n   * Removes focus from the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name blur\r\n   * @method\r\n   */\r\n  self.intf.blur = function (e) {\r\n    self.hasFocus = false;\r\n  };\r\n  /**\r\n   * Focuses on the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name focus\r\n   * @method\r\n   */\r\n  self.intf.focus = function () {\r\n    self.hasFocus = true;\r\n    self.controlInput.focus();\r\n  };\r\n  if (self.shadowRoot || self.isChildGrid) {\r\n    Object.defineProperty(self.intf, 'height', {\r\n      get: function () {\r\n        if (self.shadowRoot) {\r\n          return self.shadowRoot.height;\r\n        }\r\n        return self.parentNode.height;\r\n      },\r\n      set: function (value) {\r\n        if (self.shadowRoot) {\r\n          self.shadowRoot.height = value;\r\n        } else {\r\n          self.parentNode.height = value;\r\n        }\r\n        self.resize(true);\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'width', {\r\n      get: function () {\r\n        if (self.shadowRoot) {\r\n          return self.shadowRoot.width;\r\n        }\r\n        return self.parentNode.width;\r\n      },\r\n      set: function (value) {\r\n        if (self.shadowRoot) {\r\n          self.shadowRoot.width = value;\r\n        } else {\r\n          self.parentNode.width = value;\r\n        }\r\n        self.resize(true);\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'parentNode', {\r\n      get: function () {\r\n        return self.parentNode;\r\n      },\r\n      set: function (value) {\r\n        if (!self.isChildGrid) {\r\n          throw new TypeError(\r\n            'Cannot set property parentNode which has only a getter',\r\n          );\r\n        }\r\n        self.parentNode = value;\r\n      },\r\n    });\r\n  }\r\n  Object.defineProperty(self.intf, 'visibleRowHeights', {\r\n    get: function () {\r\n      return self.visibleRowHeights;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'openChildren', {\r\n    get: function () {\r\n      return self.openChildren;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'childGrids', {\r\n    get: function () {\r\n      return Object.keys(self.childGrids).map(function (gridId) {\r\n        return self.childGrids[gridId];\r\n      });\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'isChildGrid', {\r\n    get: function () {\r\n      return self.isChildGrid;\r\n    },\r\n  });\r\n  Object.defineProperty(self, 'cursor', {\r\n    get: function () {\r\n      return self.parentNodeStyle.cursor;\r\n    },\r\n    set: function (value) {\r\n      if (value === 'cell') {\r\n        value = 'default';\r\n      }\r\n      if (self.currentCursor !== value) {\r\n        self.parentNodeStyle.cursor = value;\r\n        self.currentCursor = value;\r\n      }\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'orderDirection', {\r\n    get: function () {\r\n      return self.orderDirection;\r\n    },\r\n    set: function (value) {\r\n      if (value !== 'desc') {\r\n        value = 'asc';\r\n      }\r\n      self.orderDirection = value;\r\n      self.order(self.orderBy, self.orderDirection);\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'orderBy', {\r\n    get: function () {\r\n      return self.orderBy;\r\n    },\r\n    set: function (value) {\r\n      if (\r\n        self.getSchema().find(function (col) {\r\n          return col.name === value;\r\n        }) === undefined\r\n      ) {\r\n        throw new Error('Cannot sort by unknown column name.');\r\n      }\r\n      self.orderBy = value;\r\n      self.order(self.orderBy, self.orderDirection);\r\n    },\r\n  });\r\n  if (self.isComponent) {\r\n    Object.defineProperty(self.intf, 'offsetHeight', {\r\n      get: function () {\r\n        return self.canvas.offsetHeight;\r\n      },\r\n    });\r\n    Object.defineProperty(self.intf, 'offsetWidth', {\r\n      get: function () {\r\n        return self.canvas.offsetWidth;\r\n      },\r\n    });\r\n  }\r\n  Object.defineProperty(self.intf, 'scrollHeight', {\r\n    get: function () {\r\n      return self.scrollBox.scrollHeight;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollWidth', {\r\n    get: function () {\r\n      return self.scrollBox.scrollWidth;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollTop', {\r\n    get: function () {\r\n      return self.scrollBox.scrollTop;\r\n    },\r\n    set: function (value) {\r\n      self.scrollBox.scrollTop = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollLeft', {\r\n    get: function () {\r\n      return self.scrollBox.scrollLeft;\r\n    },\r\n    set: function (value) {\r\n      self.scrollBox.scrollLeft = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'sizes', {\r\n    get: function () {\r\n      return self.sizes;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'parentDOMNode', {\r\n    get: function () {\r\n      return self.parentDOMNode;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'input', {\r\n    get: function () {\r\n      return self.input;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'controlInput', {\r\n    get: function () {\r\n      return self.controlInput;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'currentCell', {\r\n    get: function () {\r\n      return self.currentCell;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleCells', {\r\n    get: function () {\r\n      return self.visibleCells;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleRows', {\r\n    get: function () {\r\n      return self.visibleRows;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selections', {\r\n    get: function () {\r\n      return self.selections;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'dragMode', {\r\n    get: function () {\r\n      return self.dragMode;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'changes', {\r\n    get: function () {\r\n      return self.changes;\r\n    },\r\n  });\r\n  self.intf.formatters = self.formatters;\r\n  Object.defineProperty(self.intf, 'dataType', {\r\n    get: function () {\r\n      return self.dataType;\r\n    },\r\n    set: function (value) {\r\n      if (!self.parsers[value]) {\r\n        throw new Error('No parser for MIME type ' + value);\r\n      }\r\n      self.dataType = value;\r\n    },\r\n  });\r\n  self.eventNames.forEach(function (eventName) {\r\n    Object.defineProperty(self.intf, 'on' + eventName, {\r\n      get: function () {\r\n        return self.componentL1Events[eventName];\r\n      },\r\n      set: function (value) {\r\n        self.events[eventName] = [];\r\n        self.componentL1Events[eventName] = value;\r\n        if (!value) {\r\n          return;\r\n        }\r\n        self.addEventListener(eventName, value);\r\n      },\r\n    });\r\n  });\r\n  Object.defineProperty(self.intf, 'frozenRow', {\r\n    get: function () {\r\n      return self.frozenRow;\r\n    },\r\n    set: function (val) {\r\n      if (isNaN(val)) {\r\n        throw new TypeError('Expected value for frozenRow to be a number.');\r\n      }\r\n      if (self.visibleRows.length < val) {\r\n        throw new RangeError(\r\n          'Cannot set a value larger than the number of visible rows.',\r\n        );\r\n      }\r\n      self.frozenRow = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'frozenColumn', {\r\n    get: function () {\r\n      return self.frozenColumn;\r\n    },\r\n    set: function (val) {\r\n      if (isNaN(val)) {\r\n        throw new TypeError('Expected value for frozenRow to be a number.');\r\n      }\r\n      if (self.getVisibleSchema().length < val) {\r\n        throw new RangeError(\r\n          'Cannot set a value larger than the number of visible columns.',\r\n        );\r\n      }\r\n      self.frozenColumn = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollIndexRect', {\r\n    get: function () {\r\n      return {\r\n        top: self.scrollIndexTop,\r\n        right: self.scrollIndexRight,\r\n        bottom: self.scrollIndexBottom,\r\n        left: self.scrollIndexLeft,\r\n      };\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'scrollPixelRect', {\r\n    get: function () {\r\n      return {\r\n        top: self.scrollPixelTop,\r\n        right: self.scrollPixelRight,\r\n        bottom: self.scrollPixelBottom,\r\n        left: self.scrollPixelLeft,\r\n      };\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'rowOrder', {\r\n    get: function () {\r\n      return self.orders.rows;\r\n    },\r\n    set: function (val) {\r\n      if (!Array.isArray(val)) {\r\n        throw new TypeError('Value must be an array.');\r\n      }\r\n      if (!self.originalData || val.length < self.originalData.length) {\r\n        throw new RangeError(\r\n          'Array length must be equal to or greater than number of rows.',\r\n        );\r\n      }\r\n      self.orders.rows = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'columnOrder', {\r\n    get: function () {\r\n      return self.orders.columns;\r\n    },\r\n    set: function (val) {\r\n      if (!Array.isArray(val)) {\r\n        throw new TypeError('Value must be an array.');\r\n      }\r\n      if (val.length < self.getSchema().length) {\r\n        throw new RangeError(\r\n          'Array length must be equal to or greater than number of columns.',\r\n        );\r\n      }\r\n      self.orders.columns = val;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectionBounds', {\r\n    get: function () {\r\n      return self.getSelectionBounds();\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectedRows', {\r\n    get: function () {\r\n      return self.getSelectedData(true);\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'selectedCells', {\r\n    get: function () {\r\n      return self.getSelectedData();\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'visibleSchema', {\r\n    get: function () {\r\n      return self.getVisibleSchema().map(function eachDataRow(col) {\r\n        return col;\r\n      });\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'treeGridAttributes', {\r\n    get: function () {\r\n      return self.treeGridAttributes;\r\n    },\r\n    set: function setTreeGridAttributes(value) {\r\n      self.treeGridAttributes = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'cellGridAttributes', {\r\n    get: function () {\r\n      return self.cellGridAttributes;\r\n    },\r\n    set: function setCellGridAttributes(value) {\r\n      self.cellGridAttributes = value;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'ctx', {\r\n    get: function () {\r\n      return self.ctx;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'schema', {\r\n    get: function schemaGetter() {\r\n      return self.getSchema();\r\n    },\r\n    set: function schemaSetter(value) {\r\n      if (value === undefined) {\r\n        // Issue #89 - allow schema to be set to initialized state\r\n        self.schema = undefined;\r\n        self.tempSchema = undefined;\r\n        self.dispatchEvent('schemachanged', { schema: undefined });\r\n        return;\r\n      }\r\n      if (!Array.isArray(value) || typeof value[0] !== 'object') {\r\n        throw new Error('Schema must be an array of objects.');\r\n      }\r\n      if (value[0].name === undefined) {\r\n        throw new Error(\r\n          'Expected schema to contain an object with at least a name property.',\r\n        );\r\n      }\r\n      self.schema = value.map(function eachSchemaColumn(column, index) {\r\n        column.width = column.width || self.style.cellWidth;\r\n        column.filter = column.filter || self.filter(column.type);\r\n        column.type = column.type || 'string';\r\n        column.index = index;\r\n        column.columnIndex = index;\r\n        column.rowIndex = -1;\r\n        return column;\r\n      });\r\n      self.tempSchema = undefined;\r\n      self.createNewRowData();\r\n      self.createColumnOrders();\r\n      self.tryLoadStoredSettings();\r\n      if (\r\n        self.storedSettings &&\r\n        typeof self.storedSettings.visibility === 'object'\r\n      ) {\r\n        self.schema.forEach(function hideEachSchemaColumn(column, index) {\r\n          if (\r\n            self.storedSettings &&\r\n            self.storedSettings.visibility[column.name] !== undefined\r\n          ) {\r\n            column.hidden = !self.storedSettings.visibility[column.name];\r\n          }\r\n        });\r\n      }\r\n      self.resize(true);\r\n      self.dispatchEvent('schemachanged', { schema: self.schema });\r\n    },\r\n  });\r\n  /**\r\n   * Gets an array of currently registered MIME types.\r\n   * @memberof canvasDatagrid\r\n   * @name getDataTypes\r\n   * @method\r\n   */\r\n  self.intf.getTypes = function () {\r\n    return Object.keys(self.parsers);\r\n  };\r\n  self.parseInnerHtml = function (data) {\r\n    if (!data || /^ +$/.test(data)) {\r\n      return [];\r\n    }\r\n    try {\r\n      data = JSON.parse(data);\r\n    } catch (e) {\r\n      console.warn(\r\n        Error(\r\n          'Cannot parse application/json+x-canvas-datagrid formated data. ' +\r\n            e.message +\r\n            '  \\nNote: canvas-datagrid.innerHTML is for string data only.  ' +\r\n            'Use the canvas-datagrid.data property to set object data.',\r\n        ),\r\n      );\r\n    }\r\n    return data;\r\n  };\r\n  self.parsers['application/json+x-canvas-datagrid'] = function (\r\n    data,\r\n    callback,\r\n  ) {\r\n    self.parsers['application/x-canvas-datagrid'](\r\n      self.parseInnerHtml(data),\r\n      function (data, schema) {\r\n        return callback(data, schema);\r\n      },\r\n    );\r\n  };\r\n  self.parsers['application/x-canvas-datagrid'] = function (data, callback) {\r\n    return callback(data);\r\n  };\r\n  self.intf.parsers = self.parsers;\r\n  // send to dataType ETL function to extract from input data\r\n  // and transform into native [{}, {}] format\r\n  self.etl = function (data, callback) {\r\n    if (!self.intf.parsers[self.dataType]) {\r\n      throw new Error('Unsupported data type.');\r\n    }\r\n    self.intf.parsers[self.dataType](data, function (data, schema) {\r\n      // set the unfiltered/sorted data array\r\n      self.originalData = data;\r\n      self.viewData = Array.from(self.originalData);\r\n\r\n      if (Array.isArray(schema)) {\r\n        self.schema = schema;\r\n      }\r\n      // Issue #89 - allow schema to be auto-created every time data is set\r\n      if (self.attributes.autoGenerateSchema) {\r\n        self.schema = self.getSchemaFromData(data);\r\n      }\r\n      if (!self.schema) {\r\n        self.tempSchema = self.getSchemaFromData(data);\r\n      }\r\n      if (self.getSchema()) {\r\n        self.createColumnOrders();\r\n      }\r\n      // apply filter, sort, etc to incoming dataset, set viewData:\r\n      self.refresh();\r\n      // empty data was set\r\n      if (!self.schema && (self.originalData || []).length === 0) {\r\n        self.tempSchema = [{ name: '' }];\r\n      }\r\n      self.fitColumnToValues('cornerCell', true);\r\n      if (\r\n        (self.tempSchema && !self.schema) ||\r\n        self.attributes.autoGenerateSchema\r\n      ) {\r\n        self.createColumnOrders();\r\n        self.dispatchEvent('schemachanged', { schema: self.tempSchema });\r\n      }\r\n      callback();\r\n    });\r\n  };\r\n  Object.defineProperty(self.intf, 'viewData', {\r\n    get: function () {\r\n      return self.viewData;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'boundData', {\r\n    get: function () {\r\n      return self.originalData;\r\n    },\r\n  });\r\n  Object.defineProperty(self.intf, 'data', {\r\n    get: function dataGetter() {\r\n      return self.originalData;\r\n    },\r\n    set: function dataSetter(value) {\r\n      self.etl(value, function () {\r\n        self.changes = [];\r\n        self.createNewRowData();\r\n        if (\r\n          self.attributes.autoResizeColumns &&\r\n          self.originalData.length > 0 &&\r\n          self.storedSettings === undefined\r\n        ) {\r\n          self.autosize();\r\n        }\r\n        // set the header column to fit the numbers in it\r\n        self.fitColumnToValues('cornerCell', true);\r\n        self.createRowOrders();\r\n        self.tryLoadStoredSettings();\r\n        self.dispatchEvent('datachanged', { data: self.originalData });\r\n        self.resize(true);\r\n      });\r\n    },\r\n  });\r\n  self.initScrollBox = function () {\r\n    var sHeight = 0,\r\n      sWidth = 0,\r\n      scrollTop = 0,\r\n      scrollLeft = 0,\r\n      scrollHeight = 0,\r\n      scrollWidth = 0,\r\n      scrollBoxHeight = 20,\r\n      scrollBoxWidth = 20;\r\n    function setScrollTop(value, preventScrollEvent) {\r\n      if (isNaN(value)) {\r\n        throw new Error('ScrollTop value must be a number');\r\n      }\r\n      if (value < 0) {\r\n        value = 0;\r\n      }\r\n      if (value > scrollHeight) {\r\n        value = scrollHeight;\r\n      }\r\n      if (scrollHeight < 0) {\r\n        value = 0;\r\n      }\r\n      scrollTop = value;\r\n      if (!preventScrollEvent) {\r\n        self.scroll();\r\n      }\r\n    }\r\n    function setScrollLeft(value, preventScrollEvent) {\r\n      if (isNaN(value)) {\r\n        throw new Error('ScrollLeft value must be a number');\r\n      }\r\n      if (value < 0) {\r\n        value = 0;\r\n      }\r\n      if (value > scrollWidth) {\r\n        value = scrollWidth;\r\n      }\r\n      if (scrollWidth < 0) {\r\n        value = 0;\r\n      }\r\n      scrollLeft = value;\r\n      if (!preventScrollEvent) {\r\n        self.scroll();\r\n      }\r\n    }\r\n    self.scrollBox.toString = function () {\r\n      return (\r\n        '{\"width\": ' +\r\n        scrollWidth.toFixed(2) +\r\n        ', \"height\": ' +\r\n        scrollHeight.toFixed(2) +\r\n        ', \"left\": ' +\r\n        scrollLeft.toFixed(2) +\r\n        ', \"top\": ' +\r\n        scrollTop.toFixed(2) +\r\n        ', \"widthRatio\": ' +\r\n        self.scrollBox.widthBoxRatio.toFixed(5) +\r\n        ', \"heightRatio\": ' +\r\n        self.scrollBox.heightBoxRatio.toFixed(5) +\r\n        '}'\r\n      );\r\n    };\r\n    self.scrollBox.scrollTo = function (x, y, supressDrawEvent) {\r\n      setScrollLeft(x, true);\r\n      setScrollTop(y, supressDrawEvent);\r\n    };\r\n    Object.defineProperty(self.scrollBox, 'scrollBoxHeight', {\r\n      get: function () {\r\n        return scrollBoxHeight;\r\n      },\r\n      set: function (value) {\r\n        scrollBoxHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollBoxWidth', {\r\n      get: function () {\r\n        return scrollBoxWidth;\r\n      },\r\n      set: function (value) {\r\n        scrollBoxWidth = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'height', {\r\n      get: function () {\r\n        return sHeight;\r\n      },\r\n      set: function (value) {\r\n        sHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'width', {\r\n      get: function () {\r\n        return sWidth;\r\n      },\r\n      set: function (value) {\r\n        sWidth = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollTop', {\r\n      get: function () {\r\n        return scrollTop;\r\n      },\r\n      set: setScrollTop,\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollLeft', {\r\n      get: function () {\r\n        return scrollLeft;\r\n      },\r\n      set: setScrollLeft,\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollHeight', {\r\n      get: function () {\r\n        return scrollHeight;\r\n      },\r\n      set: function (value) {\r\n        if (scrollTop > value) {\r\n          scrollTop = Math.max(value, 0);\r\n        }\r\n        scrollHeight = value;\r\n      },\r\n    });\r\n    Object.defineProperty(self.scrollBox, 'scrollWidth', {\r\n      get: function () {\r\n        return scrollWidth;\r\n      },\r\n      set: function (value) {\r\n        if (scrollLeft > value) {\r\n          scrollLeft = Math.max(value, 0);\r\n        }\r\n        scrollWidth = value;\r\n      },\r\n    });\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false, Event: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  var zIndexTop, hoverScrollTimeout, autoCompleteContext;\r\n  function applyContextItemStyle(contextItemContainer) {\r\n    self.createInlineStyle(\r\n      contextItemContainer,\r\n      'canvas-datagrid-context-menu-item' + (self.mobile ? '-mobile' : ''),\r\n    );\r\n    contextItemContainer.addEventListener('mouseover', function () {\r\n      self.createInlineStyle(\r\n        contextItemContainer,\r\n        'canvas-datagrid-context-menu-item:hover',\r\n      );\r\n    });\r\n    contextItemContainer.addEventListener('mouseout', function () {\r\n      self.createInlineStyle(\r\n        contextItemContainer,\r\n        'canvas-datagrid-context-menu-item',\r\n      );\r\n    });\r\n  }\r\n  function createContextMenu(ev, pos, items, parentContextMenu) {\r\n    var container = document.createElement('div'),\r\n      upArrow = document.createElement('div'),\r\n      downArrow = document.createElement('div'),\r\n      children = [],\r\n      selectedIndex = -1,\r\n      intf = {},\r\n      rect;\r\n    if (!Array.isArray(items)) {\r\n      throw new Error('createContextMenu expects an array.');\r\n    }\r\n    function createItems() {\r\n      items.forEach(function (item) {\r\n        var contextItemContainer = document.createElement('div'),\r\n          childMenuArrow;\r\n        function removeChildContext(e) {\r\n          if (\r\n            e.relatedTarget === container ||\r\n            item.contextMenu.container === e.relatedTarget ||\r\n            childMenuArrow === e.relatedTarget ||\r\n            contextItemContainer === e.relatedTarget ||\r\n            item.contextMenu.container.contains(e.relatedTarget)\r\n          ) {\r\n            return;\r\n          }\r\n          item.contextMenu.dispose();\r\n          children.splice(children.indexOf(item.contextMenu), 1);\r\n          item.contextMenu = undefined;\r\n          contextItemContainer.removeEventListener(\r\n            'mouseout',\r\n            removeChildContext,\r\n          );\r\n          container.removeEventListener('mouseout', removeChildContext);\r\n          contextItemContainer.setAttribute('contextOpen', '0');\r\n          contextItemContainer.setAttribute('opening', '0');\r\n        }\r\n        function contextAddCallback(items) {\r\n          // check yet again if the user hasn't moved off\r\n          if (\r\n            contextItemContainer.getAttribute('opening') !== '1' ||\r\n            contextItemContainer.getAttribute('contextOpen') === '1'\r\n          ) {\r\n            return;\r\n          }\r\n          var cPos = contextItemContainer.getBoundingClientRect();\r\n          cPos = {\r\n            left:\r\n              cPos.left +\r\n              self.style.childContextMenuMarginLeft +\r\n              container.offsetWidth,\r\n            top: cPos.top + self.style.childContextMenuMarginTop,\r\n            bottom: cPos.bottom,\r\n            right: cPos.right,\r\n          };\r\n          item.contextMenu = createContextMenu(ev, cPos, items, intf);\r\n          contextItemContainer.setAttribute('contextOpen', '1');\r\n          contextItemContainer.addEventListener('mouseout', removeChildContext);\r\n          container.addEventListener('mouseout', removeChildContext);\r\n          children.push(item.contextMenu);\r\n        }\r\n        function createChildContext() {\r\n          var i;\r\n          if (contextItemContainer.getAttribute('contextOpen') === '1') {\r\n            return;\r\n          }\r\n          contextItemContainer.setAttribute('opening', '1');\r\n          if (typeof item.items === 'function') {\r\n            i = item.items.apply(intf, [\r\n              function (items) {\r\n                contextAddCallback(items);\r\n              },\r\n            ]);\r\n            if (i !== undefined && Array.isArray(i)) {\r\n              contextAddCallback(i);\r\n            }\r\n            return;\r\n          }\r\n          contextAddCallback(item.items);\r\n        }\r\n        function addItem(item) {\r\n          function addContent(content) {\r\n            if (content === null) {\r\n              return;\r\n            }\r\n            if (typeof content === 'function') {\r\n              return addContent(content(ev));\r\n            }\r\n            if (typeof content === 'object') {\r\n              contextItemContainer.appendChild(content);\r\n              return;\r\n            }\r\n            applyContextItemStyle(contextItemContainer);\r\n            contextItemContainer.innerHTML = content;\r\n            return;\r\n          }\r\n          addContent(item.title);\r\n          item.contextItemContainer = contextItemContainer;\r\n          if (\r\n            (item.items && item.items.length > 0) ||\r\n            typeof item.items === 'function'\r\n          ) {\r\n            childMenuArrow = document.createElement('div');\r\n            self.createInlineStyle(\r\n              childMenuArrow,\r\n              'canvas-datagrid-context-child-arrow',\r\n            );\r\n            childMenuArrow.innerHTML = self.style.childContextMenuArrowHTML;\r\n            contextItemContainer.appendChild(childMenuArrow);\r\n            contextItemContainer.addEventListener(\r\n              'mouseover',\r\n              createChildContext,\r\n            );\r\n            contextItemContainer.addEventListener('mouseout', function () {\r\n              contextItemContainer.setAttribute('opening', '0');\r\n            });\r\n          }\r\n          if (item.click) {\r\n            contextItemContainer.addEventListener('click', function (ev) {\r\n              item.click.apply(self, [ev]);\r\n            });\r\n          }\r\n        }\r\n        addItem(item);\r\n        container.appendChild(contextItemContainer);\r\n      });\r\n    }\r\n    function clickIndex(idx) {\r\n      items[idx].contextItemContainer.dispatchEvent(new Event('click'));\r\n    }\r\n    function checkArrowVisibility() {\r\n      if (container.scrollTop > 0) {\r\n        self.parentDOMNode.appendChild(upArrow);\r\n      } else if (upArrow.parentNode) {\r\n        upArrow.parentNode.removeChild(upArrow);\r\n      }\r\n      if (\r\n        container.scrollTop >=\r\n          container.scrollHeight - container.offsetHeight &&\r\n        downArrow.parentNode\r\n      ) {\r\n        downArrow.parentNode.removeChild(downArrow);\r\n      } else if (\r\n        container.scrollHeight - container.offsetHeight > 0 &&\r\n        !(\r\n          container.scrollTop >=\r\n          container.scrollHeight - container.offsetHeight\r\n        )\r\n      ) {\r\n        self.parentDOMNode.appendChild(downArrow);\r\n      }\r\n    }\r\n    function startHoverScroll(type) {\r\n      return function t() {\r\n        var a = self.attributes.contextHoverScrollAmount;\r\n        if (type === 'up' && container.scrollTop === 0) {\r\n          return;\r\n        }\r\n        if (type === 'down' && container.scrollTop === container.scrollHeight) {\r\n          return;\r\n        }\r\n        container.scrollTop += type === 'up' ? -a : a;\r\n        hoverScrollTimeout = setTimeout(\r\n          t,\r\n          self.attributes.contextHoverScrollRateMs,\r\n          type,\r\n        );\r\n      };\r\n    }\r\n    function endHoverScroll(type) {\r\n      return function () {\r\n        clearTimeout(hoverScrollTimeout);\r\n      };\r\n    }\r\n    function init() {\r\n      var loc = {},\r\n        s = self.scrollOffset(self.canvas);\r\n      if (zIndexTop === undefined) {\r\n        zIndexTop = self.style.contextMenuZIndex;\r\n      }\r\n      createItems();\r\n      self.createInlineStyle(\r\n        container,\r\n        'canvas-datagrid-context-menu' + (self.mobile ? '-mobile' : ''),\r\n      );\r\n      loc.x = pos.left - s.left;\r\n      loc.y = pos.top - s.top;\r\n      loc.height = 0;\r\n      zIndexTop += 1;\r\n      container.style.position = 'absolute';\r\n      upArrow.style.color = self.style.contextMenuArrowColor;\r\n      downArrow.style.color = self.style.contextMenuArrowColor;\r\n      [upArrow, downArrow].forEach(function (el) {\r\n        el.style.textAlign = 'center';\r\n        el.style.position = 'absolute';\r\n        el.style.zIndex = zIndexTop + 1;\r\n      });\r\n      container.style.zIndex = zIndexTop;\r\n      if (parentContextMenu && parentContextMenu.inputDropdown) {\r\n        container.style.maxHeight =\r\n          window.innerHeight -\r\n          loc.y -\r\n          self.style.autocompleteBottomMargin +\r\n          'px';\r\n        container.style.minWidth = pos.width + 'px';\r\n        loc.y += pos.height;\r\n      }\r\n      if (self.mobile) {\r\n        container.style.width = pos.width + 'px';\r\n      }\r\n      container.style.left = loc.x + 'px';\r\n      container.style.top = loc.y + 'px';\r\n      container.addEventListener('scroll', checkArrowVisibility);\r\n      container.addEventListener('wheel', function (e) {\r\n        if (self.hasFocus) {\r\n          container.scrollTop += e.deltaY;\r\n          container.scrollLeft += e.deltaX;\r\n        }\r\n        checkArrowVisibility();\r\n      });\r\n      upArrow.innerHTML = self.style.contextMenuArrowUpHTML;\r\n      downArrow.innerHTML = self.style.contextMenuArrowDownHTML;\r\n      container.appendChild(upArrow);\r\n      document.body.appendChild(downArrow);\r\n      document.body.appendChild(container);\r\n      rect = container.getBoundingClientRect();\r\n      // TODO: fix !(parentContextMenu && parentContextMenu.inputDropdown) state (autocomplete)\r\n      if (rect.bottom > window.innerHeight) {\r\n        if (!(parentContextMenu && parentContextMenu.inputDropdown)) {\r\n          loc.y -=\r\n            rect.bottom +\r\n            self.style.contextMenuWindowMargin -\r\n            window.innerHeight;\r\n        }\r\n        if (loc.y < 0) {\r\n          loc.y = self.style.contextMenuWindowMargin;\r\n        }\r\n        if (\r\n          container.offsetHeight >\r\n          window.innerHeight - self.style.contextMenuWindowMargin\r\n        ) {\r\n          container.style.height =\r\n            window.innerHeight - self.style.contextMenuWindowMargin * 2 + 'px';\r\n        }\r\n      }\r\n      if (rect.right > window.innerWidth) {\r\n        loc.x -=\r\n          rect.right - window.innerWidth + self.style.contextMenuWindowMargin;\r\n      }\r\n      if (loc.x < 0) {\r\n        loc.x = self.style.contextMenuWindowMargin;\r\n      }\r\n      if (loc.y < 0) {\r\n        loc.y = self.style.contextMenuWindowMargin;\r\n      }\r\n      container.style.left = loc.x + 'px';\r\n      container.style.top = loc.y + 'px';\r\n      rect = container.getBoundingClientRect();\r\n      upArrow.style.top = rect.top + 'px';\r\n      downArrow.style.top =\r\n        rect.top + rect.height - downArrow.offsetHeight + 'px';\r\n      upArrow.style.left = rect.left + 'px';\r\n      downArrow.style.left = rect.left + 'px';\r\n      downArrow.style.width = container.offsetWidth + 'px';\r\n      upArrow.style.width = container.offsetWidth + 'px';\r\n      downArrow.addEventListener('mouseover', startHoverScroll('down'));\r\n      downArrow.addEventListener('mouseout', endHoverScroll('down'));\r\n      upArrow.addEventListener('mouseover', startHoverScroll('up'));\r\n      upArrow.addEventListener('mouseout', endHoverScroll('up'));\r\n      checkArrowVisibility();\r\n    }\r\n    intf.parentGrid = self.intf;\r\n    intf.parentContextMenu = parentContextMenu;\r\n    intf.container = container;\r\n    init();\r\n    intf.clickIndex = clickIndex;\r\n    intf.rect = rect;\r\n    intf.items = items;\r\n    intf.upArrow = upArrow;\r\n    intf.downArrow = downArrow;\r\n    intf.dispose = function () {\r\n      clearTimeout(hoverScrollTimeout);\r\n      children.forEach(function (c) {\r\n        c.dispose();\r\n      });\r\n      [downArrow, upArrow, container].forEach(function (el) {\r\n        if (el.parentNode) {\r\n          el.parentNode.removeChild(el);\r\n        }\r\n      });\r\n    };\r\n    Object.defineProperty(intf, 'selectedIndex', {\r\n      get: function () {\r\n        return selectedIndex;\r\n      },\r\n      set: function (value) {\r\n        if (typeof value !== 'number' || isNaN(value || !isFinite(value))) {\r\n          throw new Error('Context menu selected index must be a sane number.');\r\n        }\r\n        selectedIndex = value;\r\n        if (selectedIndex > items.length - 1) {\r\n          selectedIndex = items.length - 1;\r\n        }\r\n        if (selectedIndex < 0) {\r\n          selectedIndex = 0;\r\n        }\r\n        items.forEach(function (item, index) {\r\n          if (index === selectedIndex) {\r\n            return self.createInlineStyle(\r\n              item.contextItemContainer,\r\n              'canvas-datagrid-context-menu-item:hover',\r\n            );\r\n          }\r\n          self.createInlineStyle(\r\n            item.contextItemContainer,\r\n            'canvas-datagrid-context-menu-item',\r\n          );\r\n        });\r\n      },\r\n    });\r\n    return intf;\r\n  }\r\n  function createFilterContextMenuItems(e) {\r\n    var filterContainer = document.createElement('div'),\r\n      filterLabel = document.createElement('div'),\r\n      filterAutoCompleteButton = document.createElement('button'),\r\n      filterInput = document.createElement('input'),\r\n      n =\r\n        e.cell && e.cell.header\r\n          ? e.cell.header.title || e.cell.header.name\r\n          : '',\r\n      iRect;\r\n    function checkRegExpErrorState() {\r\n      filterInput.style.background = self.style.contextFilterInputBackground;\r\n      filterInput.style.color = self.style.contextFilterInputColor;\r\n      if (self.invalidFilterRegEx) {\r\n        filterInput.style.background =\r\n          self.style.contextFilterInvalidRegExpBackground;\r\n        filterInput.style.color = self.style.contextFilterInvalidRegExpColor;\r\n      }\r\n    }\r\n    function fillAutoComplete() {\r\n      var count = 0;\r\n      var items = {};\r\n      var blanksItem = [];\r\n\r\n      self.viewData.forEach(function (row) {\r\n        var cellValue =\r\n          row[e.cell.header.name] == null\r\n            ? row[e.cell.header.name]\r\n            : String(row[e.cell.header.name]).trim();\r\n        var value = self.blankValues.includes(cellValue)\r\n          ? self.attributes.blanksText\r\n          : cellValue;\r\n\r\n        if (items[value] || count > self.attributes.maxAutoCompleteItems) {\r\n          return;\r\n        }\r\n        count += 1;\r\n        items[value] = {\r\n          title: self.formatters[e.cell.header.type || 'string']({\r\n            cell: { value: value },\r\n          }),\r\n          click: function (e) {\r\n            filterInput.value = value;\r\n            e.stopPropagation();\r\n            filterInput.dispatchEvent(new Event('keyup'));\r\n            self.disposeAutocomplete();\r\n            return;\r\n          },\r\n        };\r\n      });\r\n\r\n      if (Object.keys(items).indexOf(self.attributes.blanksText) !== -1) {\r\n        blanksItem.push(items[self.attributes.blanksText]);\r\n        delete items[self.attributes.blanksText];\r\n      }\r\n\r\n      return blanksItem.concat(\r\n        Object.keys(items).map(function (key) {\r\n          return items[key];\r\n        }),\r\n      );\r\n    }\r\n\r\n    function createAutoCompleteContext(ev) {\r\n      if (ev && ['ArrowDown', 'ArrowUp', 'Enter', 'Tab'].includes(ev.key)) {\r\n        return;\r\n      }\r\n\r\n      var autoCompleteItems = fillAutoComplete();\r\n\r\n      iRect = filterInput.getBoundingClientRect();\r\n      if (autoCompleteContext) {\r\n        autoCompleteContext.dispose();\r\n        autoCompleteContext = undefined;\r\n      }\r\n      autoCompleteContext = createContextMenu(\r\n        e,\r\n        {\r\n          left: iRect.left,\r\n          top: iRect.top,\r\n          right: iRect.right,\r\n          bottom: iRect.bottom,\r\n          height: iRect.height,\r\n          width: iRect.width,\r\n        },\r\n        autoCompleteItems,\r\n        { inputDropdown: true },\r\n      );\r\n      autoCompleteContext.selectedIndex = 0;\r\n    }\r\n    self.createInlineStyle(filterLabel, 'canvas-datagrid-context-menu-label');\r\n    self.createInlineStyle(\r\n      filterAutoCompleteButton,\r\n      'canvas-datagrid-context-menu-filter-button',\r\n    );\r\n    self.createInlineStyle(\r\n      filterInput,\r\n      'canvas-datagrid-context-menu-filter-input',\r\n    );\r\n    checkRegExpErrorState();\r\n    filterInput.onclick = self.disposeAutocomplete;\r\n    filterInput.addEventListener('keydown', function (e) {\r\n      if (e.key === 'ArrowDown') {\r\n        autoCompleteContext.selectedIndex += 1;\r\n      }\r\n\r\n      if (e.key === 'ArrowUp') {\r\n        autoCompleteContext.selectedIndex -= 1;\r\n      }\r\n\r\n      if (e.key === 'Enter') {\r\n        autoCompleteContext.clickIndex(autoCompleteContext.selectedIndex);\r\n        self.disposeContextMenu();\r\n      }\r\n\r\n      if (e.key === 'Tab') {\r\n        autoCompleteContext.clickIndex(autoCompleteContext.selectedIndex);\r\n        e.preventDefault();\r\n      }\r\n\r\n      if (e.key === 'Escape') {\r\n        self.disposeContextMenu();\r\n      }\r\n    });\r\n    filterInput.addEventListener('keyup', function () {\r\n      self.setFilter(e.cell.header.name, filterInput.value);\r\n    });\r\n    filterInput.addEventListener('keyup', createAutoCompleteContext);\r\n    ['focus', 'blur', 'keydown', 'keyup', 'change'].forEach(function (en) {\r\n      filterInput.addEventListener(en, checkRegExpErrorState);\r\n    });\r\n    filterInput.value = e.cell.header\r\n      ? self.columnFilters[e.cell.header.name] || ''\r\n      : '';\r\n    filterLabel.innerHTML = self.attributes.filterOptionText.replace(/%s/g, n);\r\n    filterAutoCompleteButton.onclick = function () {\r\n      if (autoCompleteContext) {\r\n        return self.disposeAutocomplete();\r\n      }\r\n      createAutoCompleteContext();\r\n    };\r\n    filterAutoCompleteButton.innerHTML = self.style.contextFilterButtonHTML;\r\n    filterContainer.addEventListener('click', function (e) {\r\n      return e.stopPropagation();\r\n    });\r\n    filterContainer.appendChild(filterLabel);\r\n    filterContainer.appendChild(filterInput);\r\n    filterContainer.appendChild(filterAutoCompleteButton);\r\n    e.items.push({\r\n      title: filterContainer,\r\n    });\r\n    if (Object.keys(self.columnFilters).length) {\r\n      Object.keys(self.columnFilters).forEach(function (cf) {\r\n        var h = self.getHeaderByName(cf);\r\n        e.items.push({\r\n          title: self.attributes.removeFilterOptionText.replace(\r\n            /%s/g,\r\n            h.title || h.name,\r\n          ),\r\n          click: function removeFilterClick(e) {\r\n            e.preventDefault();\r\n            self.setFilter(cf, '');\r\n            self.controlInput.focus();\r\n          },\r\n        });\r\n      });\r\n    }\r\n  }\r\n  function addDefaultContextMenuItem(e) {\r\n    var isNormalCell =\r\n      !(\r\n        e.cell.isBackground ||\r\n        e.cell.isColumnHeaderCellCap ||\r\n        e.cell.isScrollBar ||\r\n        e.cell.isCorner ||\r\n        e.cell.isRowHeader\r\n      ) && e.cell.header;\r\n    if (self.attributes.showFilter && isNormalCell) {\r\n      createFilterContextMenuItems(e);\r\n    }\r\n    if (\r\n      self.attributes.showCopy &&\r\n      self.selections.reduce(function (p, r) {\r\n        return p + r.length;\r\n      }, 0) > 0\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.copyText,\r\n        click: function () {\r\n          document.execCommand('copy');\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n    if (self.attributes.showPaste && self.clipBoardData) {\r\n      e.items.push({\r\n        title: self.attributes.pasteText,\r\n        click: function () {\r\n          self.paste(self.clipBoardData, e.cell.columnIndex, e.cell.rowIndex);\r\n          self.draw();\r\n        },\r\n      });\r\n    }\r\n    if (self.attributes.showColumnSelector) {\r\n      e.items.push({\r\n        title: self.attributes.columnSelectorText,\r\n        items: function () {\r\n          var d = [];\r\n          self.getSchema().forEach(function (column) {\r\n            function toggleColumnVisibility(e) {\r\n              column.hidden = !column.hidden;\r\n              self.dispatchEvent('togglecolumn', {\r\n                column: column,\r\n                hidden: column.hidden,\r\n              });\r\n              e.preventDefault();\r\n              self.stopPropagation(e);\r\n              self.disposeContextMenu();\r\n              self.resize(true);\r\n              self.setStorageData();\r\n            }\r\n            var el = document.createElement('div');\r\n            applyContextItemStyle(el);\r\n            el.addEventListener('touchstart', toggleColumnVisibility);\r\n            el.addEventListener('click', toggleColumnVisibility);\r\n            el.innerHTML =\r\n              (column.hidden\r\n                ? self.attributes.columnSelectorHiddenText\r\n                : self.attributes.columnSelectorVisibleText) +\r\n              (column.title || column.name);\r\n            d.push({\r\n              title: el,\r\n            });\r\n          });\r\n          return d;\r\n        },\r\n      });\r\n      if (e.cell && e.cell.header && e.cell.columnIndex > -1) {\r\n        e.items.push({\r\n          title: self.attributes.hideColumnText.replace(\r\n            /%s/gi,\r\n            e.cell.header.title || e.cell.header.name,\r\n          ),\r\n          click: function (ev) {\r\n            self.getSchema()[e.cell.columnIndex].hidden = true;\r\n            ev.preventDefault();\r\n            self.stopPropagation(ev);\r\n            self.disposeContextMenu();\r\n            self.setStorageData();\r\n            setTimeout(function () {\r\n              self.resize(true);\r\n            }, 10);\r\n          },\r\n        });\r\n      }\r\n    }\r\n    if (\r\n      self.attributes.saveAppearance &&\r\n      self.attributes.showClearSettingsOption &&\r\n      (Object.keys(self.sizes.rows).length > 0 ||\r\n        Object.keys(self.sizes.columns).length > 0)\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.clearSettingsOptionText,\r\n        click: function (e) {\r\n          e.preventDefault();\r\n          self.sizes.rows = {};\r\n          self.sizes.columns = {};\r\n          self.createRowOrders();\r\n          self.createColumnOrders();\r\n          self.storedSettings = undefined;\r\n          self.dispatchEvent('resizecolumn', {\r\n            columnWidth: self.style.cellWidth,\r\n          });\r\n          self.dispatchEvent('resizerow', {\r\n            cellHeight: self.style.cellHeight,\r\n          });\r\n          self.setStorageData();\r\n          self.resize(true);\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n    if (\r\n      self.attributes.allowSorting &&\r\n      self.attributes.showOrderByOption &&\r\n      isNormalCell\r\n    ) {\r\n      e.items.push({\r\n        title: self.attributes.showOrderByOptionTextAsc.replace(\r\n          '%s',\r\n          e.cell.header.title || e.cell.header.name,\r\n        ),\r\n        click: function (ev) {\r\n          ev.preventDefault();\r\n          self.order(e.cell.header.name, 'asc');\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n      e.items.push({\r\n        title: self.attributes.showOrderByOptionTextDesc.replace(\r\n          '%s',\r\n          e.cell.header.title || e.cell.header.name,\r\n        ),\r\n        click: function (ev) {\r\n          ev.preventDefault();\r\n          self.order(e.cell.header.name, 'desc');\r\n          self.disposeContextMenu();\r\n          self.controlInput.focus();\r\n        },\r\n      });\r\n    }\r\n  }\r\n  self.disposeAutocomplete = function () {\r\n    if (autoCompleteContext) {\r\n      autoCompleteContext.dispose();\r\n      autoCompleteContext = undefined;\r\n    }\r\n  };\r\n  self.disposeContextMenu = function () {\r\n    document.removeEventListener('click', self.disposeContextMenu);\r\n    zIndexTop = self.style.contextMenuZIndex;\r\n    self.disposeAutocomplete();\r\n    if (self.contextMenu) {\r\n      self.contextMenu.dispose();\r\n    }\r\n    self.contextMenu = undefined;\r\n  };\r\n  self.contextmenuEvent = function (e, overridePos) {\r\n    if (!self.hasFocus && e.target !== self.canvas) {\r\n      return;\r\n    }\r\n    function createDiposeEvent() {\r\n      requestAnimationFrame(function () {\r\n        document.addEventListener('click', self.disposeContextMenu);\r\n        document.removeEventListener('mouseup', createDiposeEvent);\r\n      });\r\n    }\r\n    var contextPosition,\r\n      items = [],\r\n      pos = overridePos || self.getLayerPos(e),\r\n      ev = {\r\n        NativeEvent: e,\r\n        cell: self.getCellAt(pos.x, pos.y),\r\n        items: items,\r\n      };\r\n    if (!ev.cell.isGrid) {\r\n      addDefaultContextMenuItem(ev);\r\n    }\r\n    if (self.dispatchEvent('contextmenu', ev)) {\r\n      return;\r\n    }\r\n    if (!ev.cell.isGrid) {\r\n      if (self.contextMenu) {\r\n        self.disposeContextMenu();\r\n      }\r\n      contextPosition = {\r\n        left:\r\n          pos.x +\r\n          pos.rect.left +\r\n          self.style.contextMenuMarginLeft +\r\n          self.canvasOffsetLeft,\r\n        top:\r\n          pos.y +\r\n          pos.rect.top +\r\n          self.style.contextMenuMarginTop +\r\n          self.canvasOffsetTop,\r\n        right: ev.cell.width + ev.cell.x + pos.rect.left,\r\n        bottom: ev.cell.height + ev.cell.y + pos.rect.top,\r\n        height: ev.cell.height,\r\n        width: ev.cell.width,\r\n      };\r\n      if (self.mobile) {\r\n        contextPosition.left = self.style.mobileContextMenuMargin + 'px';\r\n        contextPosition.width =\r\n          self.width - self.style.mobileContextMenuMargin * 2 + 'px';\r\n      }\r\n      self.contextMenu = createContextMenu(ev, contextPosition, items);\r\n      document.addEventListener('mouseup', createDiposeEvent);\r\n      e.preventDefault();\r\n    }\r\n  };\r\n  return;\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  self.getClippingRect = function (ele) {\r\n    var boundingRect = self.position(self.parentNode),\r\n      eleRect = self.position(ele),\r\n      s = self.scrollOffset(self.canvas),\r\n      clipRect = {\r\n        x: 0,\r\n        y: 0,\r\n        h: 0,\r\n        w: 0,\r\n      },\r\n      parentRect = {\r\n        x: -Infinity,\r\n        y: -Infinity,\r\n        h: Infinity,\r\n        w: Infinity,\r\n      },\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth = self.getRowHeaderCellWidth();\r\n    boundingRect.top -= s.top;\r\n    boundingRect.left -= s.left;\r\n    eleRect.top -= s.top;\r\n    eleRect.left -= s.left;\r\n    clipRect.h =\r\n      boundingRect.top +\r\n      boundingRect.height -\r\n      ele.offsetTop -\r\n      self.style.scrollBarWidth;\r\n    clipRect.w =\r\n      boundingRect.left +\r\n      boundingRect.width -\r\n      ele.offsetLeft -\r\n      self.style.scrollBarWidth;\r\n    clipRect.x = boundingRect.left + eleRect.left * -1 + rowHeaderCellWidth;\r\n    clipRect.y = boundingRect.top + eleRect.top * -1 + columnHeaderCellHeight;\r\n    return {\r\n      x: clipRect.x > parentRect.x ? clipRect.x : parentRect.x,\r\n      y: clipRect.y > parentRect.y ? clipRect.y : parentRect.y,\r\n      h: clipRect.h < parentRect.h ? clipRect.h : parentRect.h,\r\n      w: clipRect.w < parentRect.w ? clipRect.w : parentRect.w,\r\n    };\r\n  };\r\n  self.clipElement = function (ele) {\r\n    var clipRect = self.getClippingRect(ele);\r\n    if (clipRect.w < 0) {\r\n      clipRect.w = 0;\r\n    }\r\n    if (clipRect.h < 0) {\r\n      clipRect.h = 0;\r\n    }\r\n    ele.style.clip =\r\n      'rect(' +\r\n      clipRect.y +\r\n      'px,' +\r\n      clipRect.w +\r\n      'px,' +\r\n      clipRect.h +\r\n      'px,' +\r\n      clipRect.x +\r\n      'px' +\r\n      ')';\r\n    // INFO https://developer.mozilla.org/en-US/docs/Web/CSS/clip\r\n    // clip has been \"deprecated\" for clipPath.  Of course nothing but chrome\r\n    // supports clip path, so we'll keep using clip until someday clipPath becomes\r\n    // more widely support.  The code below works correctly, but setting clipPath and clip\r\n    // at the same time has undesirable results.\r\n    // ele.style.clipPath = 'polygon('\r\n    //     + clipRect.x + 'px ' + clipRect.y + 'px,'\r\n    //     + clipRect.x + 'px ' + clipRect.h + 'px,'\r\n    //     + clipRect.w + 'px ' + clipRect.h + 'px,'\r\n    //     + clipRect.w + 'px ' + clipRect.y + 'px'\r\n    //     + ')';\r\n  };\r\n  self.scrollOffset = function (e) {\r\n    var x = 0,\r\n      y = 0,\r\n      scrollingElement = document.scrollingElement || {\r\n        scrollLeft: 0,\r\n        scrollTop: 0,\r\n      };\r\n    while (\r\n      e.parentNode &&\r\n      e.nodeName !== 'CANVAS-DATAGRID' &&\r\n      e !== self.intf\r\n    ) {\r\n      if (\r\n        e.nodeType !== 'canvas-datagrid-tree' &&\r\n        e.nodeType !== 'canvas-datagrid-cell'\r\n      ) {\r\n        x -= e.scrollLeft;\r\n        y -= e.scrollTop;\r\n      }\r\n      e = e.parentNode;\r\n    }\r\n    return {\r\n      left: x - scrollingElement.scrollLeft,\r\n      top: y - scrollingElement.scrollTop,\r\n    };\r\n  };\r\n  self.resizeEditInput = function () {\r\n    if (self.input && self.input.editCell) {\r\n      var pos = self.canvas.getBoundingClientRect(),\r\n        s = self.scrollOffset(self.intf),\r\n        bm = self.style.gridBorderCollapse === 'collapse' ? 1 : 2,\r\n        borderWidth = self.style.cellBorderWidth * bm,\r\n        cell = self.getVisibleCellByIndex(\r\n          self.input.editCell.columnIndex,\r\n          self.input.editCell.rowIndex,\r\n        ) || { x: -100, y: -100, height: 0, width: 0 };\r\n      if (self.mobile) {\r\n        self.input.style.left = '0';\r\n        self.input.style.top =\r\n          self.height -\r\n          self.style.mobileEditInputHeight -\r\n          borderWidth -\r\n          1 +\r\n          'px';\r\n        self.input.style.height = self.style.mobileEditInputHeight + 'px';\r\n        self.input.style.width = self.width - borderWidth - 1 + 'px';\r\n        return;\r\n      }\r\n      self.input.style.left =\r\n        pos.left + cell.x + self.canvasOffsetLeft - s.left + 'px';\r\n      self.input.style.top =\r\n        pos.top +\r\n        cell.y -\r\n        self.style.cellBorderWidth +\r\n        self.canvasOffsetTop -\r\n        s.top +\r\n        'px';\r\n      self.input.style.height = cell.height - borderWidth + 'px';\r\n      self.input.style.width = cell.width - self.style.cellPaddingLeft + 'px';\r\n      self.clipElement(self.input);\r\n    }\r\n  };\r\n  self.position = function (e, ignoreScrollOffset) {\r\n    var x = 0,\r\n      y = 0,\r\n      s = e,\r\n      h,\r\n      w;\r\n    while (e.offsetParent && e.nodeName !== 'CANVAS-DATAGRID') {\r\n      x += e.offsetLeft;\r\n      y += e.offsetTop;\r\n      h = e.offsetHeight;\r\n      w = e.offsetWidth;\r\n      e = e.offsetParent;\r\n    }\r\n    if (ignoreScrollOffset) {\r\n      return { left: x, top: y, height: h, width: w };\r\n    }\r\n    e = s;\r\n    s = self.scrollOffset(e);\r\n    return { left: x + s.left, top: y + s.top, height: h, width: w };\r\n  };\r\n  self.getLayerPos = function (e) {\r\n    var rect = self.canvas.getBoundingClientRect(),\r\n      pos = {\r\n        x: e.clientX - rect.left,\r\n        y: e.clientY - rect.top,\r\n      };\r\n    if (self.isChildGrid) {\r\n      pos.x -= self.canvasOffsetLeft;\r\n      pos.y -= self.canvasOffsetTop;\r\n    }\r\n    return {\r\n      x: pos.x,\r\n      y: pos.y,\r\n      rect: rect,\r\n    };\r\n  };\r\n  /**\r\n   * Ends editing, optionally aborting the edit.\r\n   * @memberof canvasDatagrid\r\n   * @name endEdit\r\n   * @method\r\n   * @param {boolean} abort When true, abort the edit.\r\n   */\r\n  self.endEdit = function (abort) {\r\n    var cell = self.input.editCell,\r\n      y = cell.rowIndex;\r\n    function abortEdit() {\r\n      abort = true;\r\n    }\r\n    if (\r\n      self.dispatchEvent('beforeendedit', {\r\n        cell: cell,\r\n        newValue: self.input.value,\r\n        oldValue: cell.value,\r\n        abort: abortEdit,\r\n        input: self.input,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    if (self.input.value !== cell.value && !abort) {\r\n      self.changes[y] = self.changes[y] || {};\r\n      self.changes[y][cell.header.name] = self.input.value;\r\n      if (!cell.data) {\r\n        self.originalData[cell.boundRowIndex] = {};\r\n        cell.data = self.originalData[cell.boundRowIndex];\r\n      }\r\n      cell.data[cell.header.name] = self.input.value;\r\n      if (y === self.viewData.length) {\r\n        if (\r\n          self.dispatchEvent('newrow', {\r\n            value: self.input.value,\r\n            defaultValue: cell.value,\r\n            aborted: abort,\r\n            cell: cell,\r\n            input: self.input,\r\n          })\r\n        ) {\r\n          return false;\r\n        }\r\n        self.addRow(cell.data);\r\n        self.createNewRowData();\r\n      }\r\n      self.draw(true);\r\n    }\r\n    if (self.input.parentNode) {\r\n      self.input.parentNode.removeChild(self.input);\r\n    }\r\n    self.intf.focus();\r\n    self.dispatchEvent('endedit', {\r\n      cell: cell,\r\n      value: self.input.value,\r\n      aborted: abort,\r\n      input: self.input,\r\n    });\r\n    self.input = undefined;\r\n    return true;\r\n  };\r\n  /**\r\n   * Begins editing at cell x, row y.\r\n   * @memberof canvasDatagrid\r\n   * @name beginEditAt\r\n   * @method\r\n   * @param {number} x The column index of the cell to edit.\r\n   * @param {number} y The row index of the cell to edit.\r\n   * @param {boolean} inEnterMode If true, starting to type in cell will replace the\r\n   * cell's previous value instead of appending, and using the arrow keys will allow\r\n   * the user to navigate to adjacent cells instead of moving the text cursor around\r\n   * (default is false, and means user is in 'edit' mode).\r\n   */\r\n  self.beginEditAt = function (x, y, NativeEvent, inEnterMode = false) {\r\n    if (!self.attributes.editable) {\r\n      return;\r\n    }\r\n    if (self.input) {\r\n      self.endEdit();\r\n    }\r\n    var cell = self.getVisibleCellByIndex(x, y),\r\n      s = self.getSchema(),\r\n      adjacentCells,\r\n      enumItems,\r\n      enu,\r\n      option,\r\n      valueInEnum;\r\n    if (!(cell && cell.header)) {\r\n      return;\r\n    }\r\n    //HACK for IE10, does not like literal enum\r\n    enu = cell.header['enum'];\r\n    if (\r\n      self.dispatchEvent('beforebeginedit', {\r\n        cell: cell,\r\n        NativeEvent: NativeEvent,\r\n      })\r\n    ) {\r\n      return false;\r\n    }\r\n    self.scrollIntoView(x, y);\r\n    self.setActiveCell(x, y);\r\n    adjacentCells = self.getAdjacentCells();\r\n    if (enu) {\r\n      self.input = document.createElement('select');\r\n    } else {\r\n      self.input = document.createElement(\r\n        self.attributes.multiLine ? 'textarea' : 'input',\r\n      );\r\n    }\r\n    cell = self.getVisibleCellByIndex(x, y);\r\n    //HACK on mobile devices sometimes edit can begin without the cell being in view, I don't know how.\r\n    if (!cell) {\r\n      return;\r\n    }\r\n    if (enu) {\r\n      // add enums\r\n      if (typeof enu === 'function') {\r\n        enumItems = enu.apply(self.intf, [{ cell: cell }]);\r\n      } else if (Array.isArray(enu)) {\r\n        enumItems = enu;\r\n      }\r\n      enumItems.forEach(function (e) {\r\n        var i = document.createElement('option'),\r\n          val,\r\n          title;\r\n        if (Array.isArray(e)) {\r\n          val = e[0];\r\n          title = e[1];\r\n        } else {\r\n          val = e;\r\n          title = e;\r\n        }\r\n        if (val === cell.value) {\r\n          valueInEnum = true;\r\n        }\r\n        i.value = val;\r\n        i.innerHTML = title;\r\n        self.input.appendChild(i);\r\n      });\r\n      if (!valueInEnum) {\r\n        option = document.createElement('option');\r\n        option.value = cell.value;\r\n        option.innerHTML = cell.value;\r\n        self.input.appendChild(option);\r\n      }\r\n      self.input.addEventListener('change', function () {\r\n        self.endEdit();\r\n        self.draw(true);\r\n      });\r\n    }\r\n    // if the user has not prevented the default action, append to the body\r\n    if (\r\n      !self.dispatchEvent('appendeditinput', { cell: cell, input: self.input })\r\n    ) {\r\n      document.body.appendChild(self.input);\r\n    }\r\n    self.createInlineStyle(\r\n      self.input,\r\n      self.mobile\r\n        ? 'canvas-datagrid-edit-mobile-input'\r\n        : 'canvas-datagrid-edit-input',\r\n    );\r\n    self.input.style.position = 'absolute';\r\n    self.input.editCell = cell;\r\n    self.resizeEditInput();\r\n    self.input.style.zIndex = self.style.editCellZIndex;\r\n    self.input.style.fontSize =\r\n      parseInt(self.style.editCellFontSize, 10) * self.scale + 'px';\r\n\r\n    var cellValueIsEmpty = [null, undefined].indexOf(cell.value) !== -1;\r\n    var shouldClearCellValue = cellValueIsEmpty || inEnterMode;\r\n\r\n    self.input.value = shouldClearCellValue ? '000' : cell.value;\r\n    self.input.focus();\r\n    self.input.addEventListener('click', self.stopPropagation);\r\n    self.input.addEventListener('dblclick', self.stopPropagation);\r\n    self.input.addEventListener('mouseup', self.stopPropagation);\r\n    self.input.addEventListener('mousedown', self.stopPropagation);\r\n    self.input.addEventListener('keydown', function (e) {\r\n      var nx = cell.columnIndex,\r\n        ny = cell.rowIndex;\r\n\r\n      if (e.key === 'Escape') {\r\n        self.endEdit(true); // end edit and abort the value change\r\n        self.draw(true);\r\n      } else if (e.key === 'Enter' && self.attributes.multiLine && e.altKey) {\r\n        self.input.value = self.input.value + '\\n';\r\n        self.input.scrollTop = self.input.scrollHeight;\r\n      } else if (e.key === 'Enter') {\r\n        self.endEdit();\r\n\r\n        // Move to cell in next or previous row\r\n        var nextRowIndex = e.shiftKey\r\n          ? Math.max(0, ny - 1)\r\n          : Math.min(ny + 1, self.viewData.length - 1);\r\n\r\n        if (nextRowIndex !== ny) {\r\n          self.scrollIntoView(nx, nextRowIndex);\r\n          self.setActiveCell(nx, nextRowIndex);\r\n        }\r\n\r\n        self.draw(true);\r\n      } else if (\r\n        ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key) &&\r\n        inEnterMode\r\n      ) {\r\n        switch (e.key) {\r\n          case 'ArrowUp':\r\n            ny = Math.max(0, ny - 1);\r\n            break;\r\n          case 'ArrowDown':\r\n            ny = Math.min(ny + 1, self.viewData.length - 1);\r\n            break;\r\n          case 'ArrowLeft':\r\n            nx = Math.max(nx - 1, 0);\r\n            break;\r\n          case 'ArrowRight':\r\n            nx = adjacentCells.right;\r\n            break;\r\n        }\r\n\r\n        self.endEdit();\r\n\r\n        self.scrollIntoView(nx, ny);\r\n        self.setActiveCell(nx, ny);\r\n\r\n        self.draw(true);\r\n      } else if (e.key === 'Tab') {\r\n        e.preventDefault();\r\n        if (!self.endEdit()) {\r\n          return;\r\n        }\r\n        if (e.shiftKey) {\r\n          nx = adjacentCells.left;\r\n        } else {\r\n          nx = adjacentCells.right;\r\n        }\r\n        if (adjacentCells.left === x && e.shiftKey) {\r\n          nx = adjacentCells.last;\r\n          ny -= 1;\r\n        }\r\n        if (adjacentCells.right === x && !e.shiftKey) {\r\n          nx = adjacentCells.first;\r\n          ny += 1;\r\n        }\r\n        if (ny < 0) {\r\n          ny = self.viewData.length - 1;\r\n        }\r\n        if (ny > self.viewData.length - 1) {\r\n          ny = 0;\r\n        }\r\n        self.scrollIntoView(nx, ny);\r\n        self.beginEditAt(nx, ny, e);\r\n      }\r\n    });\r\n\r\n    self.dispatchEvent('beginedit', { cell: cell, input: self.input });\r\n  };\r\n  self.createInlineStyle = function (el, className) {\r\n    var css = {\r\n      'canvas-datagrid-context-menu-filter-input': {\r\n        height: '19px',\r\n        verticalAlign: 'bottom',\r\n        marginLeft: '2px',\r\n        padding: '0',\r\n        background: self.style.contextFilterInputBackground,\r\n        color: self.style.contextFilterInputColor,\r\n        border: self.style.contextFilterInputBorder,\r\n        borderRadius: self.style.contextFilterInputBorderRadius,\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextFilterInputFontFamily,\r\n        fontSize: self.style.contextFilterInputFontSize,\r\n      },\r\n      'canvas-datagrid-context-menu-filter-button': {\r\n        height: '19px',\r\n        verticalAlign: 'bottom',\r\n        marginLeft: '2px',\r\n        padding: '0',\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextFilterButtonBorder,\r\n        borderRadius: self.style.contextFilterButtonBorderRadius,\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFilterButtonFontFamily,\r\n        fontSize: self.style.contextMenuFilterButtonFontSize,\r\n      },\r\n      'canvas-datagrid-context-child-arrow': {\r\n        cssFloat: 'right',\r\n        color: self.style.childContextMenuArrowColor,\r\n        fontSize: self.style.contextMenuChildArrowFontSize,\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-autocomplete': {\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        position: 'absolute',\r\n        zIndex: 9999,\r\n        overflow: 'hidden',\r\n      },\r\n      'canvas-datagrid-autocomplete-item': {\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n      },\r\n      'canvas-datagrid-autocomplete-item:hover': {\r\n        background: self.style.contextMenuHoverBackground,\r\n        color: self.style.contextMenuHoverColor,\r\n      },\r\n      'canvas-datagrid-canvas': {\r\n        position: 'absolute',\r\n        zIndex: '-1',\r\n      },\r\n      'canvas-datagrid': {\r\n        display: 'block',\r\n      },\r\n      'canvas-datagrid-control-input': {\r\n        position: 'fixed',\r\n        top: '-5px',\r\n        left: '-5px',\r\n        border: 'none',\r\n        opacity: '0',\r\n        cursor: 'pointer',\r\n        width: '1px',\r\n        height: '1px',\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n      },\r\n      'canvas-datagrid-edit-mobile-input': {\r\n        boxSizing: 'content-box',\r\n        outline: 'none',\r\n        margin: '0',\r\n        padding: '0 0 0 0',\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.mobileEditFontFamily,\r\n        fontSize: self.style.mobileEditFontSize,\r\n        border: self.style.editCellBorder,\r\n        color: self.style.editCellColor,\r\n        background: self.style.editCellBackgroundColor,\r\n        appearance: 'none',\r\n        webkitAppearance: 'none',\r\n        mozAppearance: 'none',\r\n        borderRadius: '0',\r\n      },\r\n      'canvas-datagrid-edit-input': {\r\n        boxSizing: 'content-box',\r\n        outline: 'none',\r\n        margin: '0',\r\n        padding: '0 0 0 ' + self.style.editCellPaddingLeft + 'px',\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.editCellFontFamily,\r\n        fontSize: self.style.editCellFontSize,\r\n        boxShadow: self.style.editCellBoxShadow,\r\n        border: self.style.editCellBorder,\r\n        color: self.style.editCellColor,\r\n        background: self.style.editCellBackgroundColor,\r\n        appearance: 'none',\r\n        webkitAppearance: 'none',\r\n        mozAppearance: 'none',\r\n        borderRadius: '0',\r\n      },\r\n      'canvas-datagrid-context-menu-item-mobile': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        color: 'inherit',\r\n        background: 'inherit',\r\n        margin: self.style.contextMenuItemMargin,\r\n        borderRadius: self.style.contextMenuItemBorderRadius,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-context-menu-item': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        color: 'inherit',\r\n        background: 'inherit',\r\n        margin: self.style.contextMenuItemMargin,\r\n        borderRadius: self.style.contextMenuItemBorderRadius,\r\n        verticalAlign: 'middle',\r\n      },\r\n      'canvas-datagrid-context-menu-item:hover': {\r\n        background: self.style.contextMenuHoverBackground,\r\n        color: self.style.contextMenuHoverColor,\r\n      },\r\n      'canvas-datagrid-context-menu-label': {\r\n        margin: self.style.contextMenuLabelMargin,\r\n        display: self.style.contextMenuLabelDisplay,\r\n        minWidth: self.style.contextMenuLabelMinWidth,\r\n        maxWidth: self.style.contextMenuLabelMaxWidth,\r\n      },\r\n      'canvas-datagrid-context-menu-mobile': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n      },\r\n      'canvas-datagrid-context-menu': {\r\n        lineHeight: 'normal',\r\n        fontWeight: 'normal',\r\n        fontFamily: self.style.contextMenuFontFamily,\r\n        fontSize: self.style.contextMenuFontSize,\r\n        background: self.style.contextMenuBackground,\r\n        color: self.style.contextMenuColor,\r\n        border: self.style.contextMenuBorder,\r\n        padding: self.style.contextMenuPadding,\r\n        borderRadius: self.style.contextMenuBorderRadius,\r\n        opacity: self.style.contextMenuOpacity,\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n        cursor: self.style.contextMenuCursor,\r\n      },\r\n      'canvas-datagrid-invalid-search-regExp': {\r\n        background: self.style.contextMenuFilterInvalidExpresion,\r\n      },\r\n    };\r\n    if (css[className]) {\r\n      Object.keys(css[className]).map(function (prop) {\r\n        el.style[prop] = css[className][prop];\r\n      });\r\n    }\r\n    return;\r\n  };\r\n  self.appendTo = function (e) {\r\n    self.parentNode = e;\r\n    self.setDom();\r\n  };\r\n  self.setDom = function () {\r\n    if (self.isChildGrid) {\r\n      self.parentGrid = self.parentNode.parentGrid;\r\n      self.ctx = self.parentGrid.context;\r\n      self.canvas = self.parentGrid.canvas;\r\n      self.controlInput = self.parentGrid.controlInput;\r\n      self.eventParent = self.canvas;\r\n    } else {\r\n      self.controlInput = self.controlInput || document.createElement('input');\r\n      self.controlInput.onblur = self.intf.blur;\r\n      self.createInlineStyle(\r\n        self.controlInput,\r\n        'canvas-datagrid-control-input',\r\n      );\r\n      self.isChildGrid = false;\r\n      self.parentDOMNode = self.parentNode;\r\n      self.parentIsCanvas = /^canvas$/i.test(self.parentDOMNode.tagName);\r\n      if (self.parentIsCanvas) {\r\n        self.canvas = self.parentDOMNode;\r\n      } else {\r\n        self.canvas = document.createElement('canvas');\r\n        self.parentDOMNode.appendChild(self.canvas);\r\n      }\r\n      document.body.appendChild(self.controlInput);\r\n      self.createInlineStyle(self.canvas, 'canvas-datagrid');\r\n      self.ctx = self.canvas.getContext('2d');\r\n      self.ctx.textBaseline = 'alphabetic';\r\n      self.eventParent = self.canvas;\r\n    }\r\n    self.parentNodeStyle = self.canvas.style;\r\n    self.controlInput.setAttribute('readonly', true);\r\n    self.controlInput.addEventListener('blur', function (e) {\r\n      if (e.target !== self.canvas) {\r\n        self.hasFocus = false;\r\n      }\r\n    });\r\n    self.eventParent.addEventListener('scroll', self.resize, false);\r\n    self.eventParent.addEventListener('touchstart', self.touchstart, false);\r\n    self.eventParent.addEventListener('mouseup', self.mouseup, false);\r\n    self.eventParent.addEventListener('mousedown', self.mousedown, false);\r\n    self.eventParent.addEventListener('dblclick', self.dblclick, false);\r\n    self.eventParent.addEventListener('click', self.click, false);\r\n    self.eventParent.addEventListener('mousemove', self.mousemove);\r\n    self[self.isChildGrid ? 'parentGrid' : 'eventParent'].addEventListener(\r\n      'wheel',\r\n      self.scrollWheel,\r\n      false,\r\n    );\r\n    self.canvas.addEventListener('contextmenu', self.contextmenuEvent, false);\r\n    self.controlInput.addEventListener('copy', self.copy);\r\n    self.controlInput.addEventListener('cut', self.cut);\r\n    self.controlInput.addEventListener('paste', self.paste);\r\n    self.controlInput.addEventListener('keypress', self.keypress, false);\r\n    self.controlInput.addEventListener('keyup', self.keyup, false);\r\n    self.controlInput.addEventListener('keydown', self.keydown, false);\r\n    window.addEventListener('resize', self.resize);\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true*/\r\n/*globals define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nexport default function (self) {\r\n  /**\r\n   * Converts a integer into a letter A - ZZZZZ...\r\n   * @memberof canvasDatagrid\r\n   * @name integerToAlpha\r\n   * @method\r\n   * @param {column} n The number to convert.\r\n   */\r\n  self.integerToAlpha = function (n) {\r\n    var ordA = 'a'.charCodeAt(0),\r\n      ordZ = 'z'.charCodeAt(0),\r\n      len = ordZ - ordA + 1,\r\n      s = '';\r\n    while (n >= 0) {\r\n      s = String.fromCharCode((n % len) + ordA) + s;\r\n      n = Math.floor(n / len) - 1;\r\n    }\r\n    return s;\r\n  };\r\n  /**\r\n   * Inserts a new column before the specified index into the schema.\r\n   * @tutorial schema\r\n   * @memberof canvasDatagrid\r\n   * @name insertColumn\r\n   * @method\r\n   * @param {column} c The column to insert into the schema.\r\n   * @param {number} index The index of the column to insert before.\r\n   */\r\n  self.insertColumn = function (c, index) {\r\n    var s = self.getSchema();\r\n    if (s.length < index) {\r\n      throw new Error('Index is beyond the length of the schema.');\r\n    }\r\n    self.validateColumn(c, s);\r\n    s.splice(index, 0, c);\r\n\r\n    self.originalData.forEach(function (row, rowIndex) {\r\n      self.applyDefaultValue(row, c, rowIndex);\r\n    });\r\n    self.intf.schema = s;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Deletes a column from the schema at the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteColumn\r\n   * @tutorial schema\r\n   * @method\r\n   * @param {number} index The index of the column to delete.\r\n   */\r\n  self.deleteColumn = function (index) {\r\n    var schema = self.getSchema();\r\n\r\n    // remove data matching this column name from data\r\n    self.originalData.forEach(function (row) {\r\n      delete row[schema[index].name];\r\n    });\r\n\r\n    schema.splice(index, 1);\r\n    self.intf.schema = schema;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Adds a new column into the schema.\r\n   * @tutorial schema\r\n   * @memberof canvasDatagrid\r\n   * @name addColumn\r\n   * @method\r\n   * @param {column} c The column to add to the schema.\r\n   */\r\n  self.addColumn = function (c) {\r\n    var s = self.getSchema();\r\n    self.validateColumn(c, s);\r\n    s.push(c);\r\n    self.originalData.forEach(function (row, rowIndex) {\r\n      self.applyDefaultValue(row, c, rowIndex);\r\n    });\r\n    self.intf.schema = s;\r\n\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Deletes a row from the dataset at the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name deleteRow\r\n   * @method\r\n   * @param {number} index The index of the row to delete.\r\n   */\r\n  self.deleteRow = function (index) {\r\n    self.originalData.splice(index, 1);\r\n    self.setFilter();\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Inserts a new row into the dataset before the specified index.\r\n   * @memberof canvasDatagrid\r\n   * @name insertRow\r\n   * @method\r\n   * @param {object} d data.\r\n   * @param {number} index The index of the row to insert before.\r\n   */\r\n  self.insertRow = function (d, index) {\r\n    if (self.originalData.length < index) {\r\n      throw new Error('Index is beyond the length of the dataset.');\r\n    }\r\n    self.originalData.splice(index, 0, d);\r\n    self.getSchema().forEach(function (c) {\r\n      if (d[c.name] === undefined) {\r\n        self.applyDefaultValue(self.originalData[index], c, index);\r\n      }\r\n    });\r\n\r\n    // setFilter calls .refresh(), so we need not call it again:\r\n    self.setFilter();\r\n\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Adds a new row into the dataset.\r\n   * @memberof canvasDatagrid\r\n   * @name addRow\r\n   * @method\r\n   * @param {object} d data.\r\n   */\r\n  self.addRow = function (d) {\r\n    self.originalData.push(d);\r\n    self.getSchema().forEach(function (c) {\r\n      if (d[c.name] === undefined) {\r\n        self.applyDefaultValue(\r\n          self.originalData[self.originalData.length - 1],\r\n          c,\r\n          self.originalData.length - 1,\r\n        );\r\n      }\r\n    });\r\n\r\n    // setFilter calls .refresh(), so we need not call it again:\r\n    self.setFilter();\r\n\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Sets the height of a given row by index number.\r\n   * @memberof canvasDatagrid\r\n   * @name setRowHeight\r\n   * @method\r\n   * @param {number} rowIndex The index of the row to set.\r\n   * @param {number} height Height to set the row to.\r\n   */\r\n  self.setRowHeight = function (rowIndex, height) {\r\n    self.sizes.rows[rowIndex] = height;\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Sets the width of a given column by index number.\r\n   * @memberof canvasDatagrid\r\n   * @name setColumnWidth\r\n   * @method\r\n   * @param {number} colIndex The index of the column to set.\r\n   * @param {number} width Width to set the column to.\r\n   */\r\n  self.setColumnWidth = function (colIndex, width) {\r\n    self.sizes.columns[colIndex] = width;\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Removes any changes to the width of the columns due to user or api interaction, setting them back to the schema or style default.\r\n   * @memberof canvasDatagrid\r\n   * @name resetColumnWidths\r\n   * @tutorial schema\r\n   * @method\r\n   */\r\n  self.resetColumnWidths = function () {\r\n    self.sizes.columns = {};\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Removes any changes to the height of the rows due to user or api interaction, setting them back to the schema or style default.\r\n   * @memberof canvasDatagrid\r\n   * @name resetRowHeights\r\n   * @tutorial schema\r\n   * @method\r\n   */\r\n  self.resetRowHeights = function () {\r\n    self.sizes.rows = {};\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Sets the value of the filter.\r\n   * @memberof canvasDatagrid\r\n   * @name setFilter\r\n   * @method\r\n   * @param {string} column Name of the column to filter.\r\n   * @param {string} value The value to filter for.\r\n   */\r\n  self.setFilter = function (column, value) {\r\n    if (column === undefined && value === undefined) {\r\n      self.columnFilters = {};\r\n    } else if (column && (value === '' || value === undefined)) {\r\n      delete self.columnFilters[column];\r\n    } else {\r\n      self.columnFilters[column] = value;\r\n    }\r\n    self.refresh();\r\n  };\r\n  /**\r\n   * Returns the number of pixels to scroll down to line up with row rowIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name findRowScrollTop\r\n   * @method\r\n   * @param {number} rowIndex The row index of the row to scroll find.\r\n   */\r\n  self.findRowScrollTop = function (rowIndex) {\r\n    if (self.scrollCache.y[rowIndex] === undefined) {\r\n      throw new RangeError(\r\n        `Row index ${rowIndex} out of range: ${self.scrollCache.y.length}.`,\r\n      );\r\n    }\r\n    return self.scrollCache.y[rowIndex];\r\n  };\r\n  /**\r\n   * Returns the number of pixels to scroll to the left to line up with column columnIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name findColumnScrollLeft\r\n   * @method\r\n   * @param {number} columnIndex The column index of the column to find.\r\n   */\r\n  self.findColumnScrollLeft = function (columnIndex) {\r\n    var i = Math.max(columnIndex - 1, 0);\r\n    if (self.scrollCache.x[i] === undefined) {\r\n      throw new Error('Column index out of range.');\r\n    }\r\n    return (\r\n      self.scrollCache.x[i] -\r\n      self.getColumnWidth(self.orders.columns[columnIndex])\r\n    );\r\n  };\r\n  /**\r\n   * Scrolls to the cell at columnIndex x, and rowIndex y.  If you define both rowIndex and columnIndex additional calculations can be made to center the cell using the target cell's height and width.  Defining only one rowIndex or only columnIndex will result in simpler calculations.\r\n   * @memberof canvasDatagrid\r\n   * @name gotoCell\r\n   * @method\r\n   * @param {number} x The column index of the cell to scroll to.\r\n   * @param {number} y The row index of the cell to scroll to.\r\n   * @param {number} [offsetX=0] Percentage offset the cell should be from the left edge (not including headers).  The default is 0, meaning the cell will appear at the left edge. Valid values are 0 through 1. 1 = Left, 0 = Right, 0.5 = Center.\r\n   * @param {number} [offsetY=0] Percentage offset the cell should be from the top edge (not including headers).  The default is 0, meaning the cell will appear at the top edge. Valid values are 0 through 1. 1 = Bottom, 0 = Top, 0.5 = Center.\r\n   */\r\n  self.gotoCell = function (x, y, offsetX, offsetY) {\r\n    var targetX = x === undefined ? undefined : self.findColumnScrollLeft(x),\r\n      targetY = y === undefined ? undefined : self.findRowScrollTop(y),\r\n      cell,\r\n      sbw =\r\n        self.scrollBox.width -\r\n        (self.scrollBox.verticalBarVisible ? self.style.scrollBarWidth : 0),\r\n      sbh =\r\n        self.scrollBox.height -\r\n        (self.scrollBox.horizontalBarVisible ? self.style.scrollBarWidth : 0);\r\n    offsetX = offsetX === undefined ? 0 : offsetX;\r\n    offsetY = offsetY === undefined ? 0 : offsetY;\r\n    targetX -= sbw * offsetX;\r\n    targetY -= sbh * offsetY;\r\n    if (x !== undefined && y !== undefined) {\r\n      self.scrollBox.scrollTo(targetX, targetY);\r\n      requestAnimationFrame(function () {\r\n        cell = self.getVisibleCellByIndex(x, y);\r\n        // HACK: just don't offset if the target cell cannot be seen\r\n        // TODO: offset does not work on very small grids, not sure why\r\n        if (!cell) {\r\n          return;\r\n        }\r\n        targetX += cell.width * offsetX;\r\n        targetY += cell.height * offsetY;\r\n        self.scrollBox.scrollTo(targetX, targetY);\r\n      });\r\n    } else if (x !== undefined) {\r\n      self.scrollBox.scrollLeft = targetX;\r\n    } else if (y !== undefined) {\r\n      self.scrollBox.scrollTop = targetY;\r\n    }\r\n  };\r\n  /**\r\n   * Scrolls the row y.\r\n   * @memberof canvasDatagrid\r\n   * @name gotoRow\r\n   * @method\r\n   * @param {number} y The row index of the cell to scroll to.\r\n   */\r\n  self.gotoRow = function (y) {\r\n    self.gotoCell(0, y);\r\n  };\r\n  /**\r\n   * Scrolls the cell at cell x, row y into view if it is not already.\r\n   * @memberof canvasDatagrid\r\n   * @name scrollIntoView\r\n   * @method\r\n   * @param {number} x The column index of the cell to scroll into view.\r\n   * @param {number} y The row index of the cell to scroll into view.\r\n   * @param {number} [offsetX=0] Percentage offset the cell should be from the left edge (not including headers).  The default is 0, meaning the cell will appear at the left edge. Valid values are 0 through 1. 1 = Left, 0 = Right, 0.5 = Center.\r\n   * @param {number} [offsetY=0] Percentage offset the cell should be from the top edge (not including headers).  The default is 0, meaning the cell will appear at the top edge. Valid values are 0 through 1. 1 = Bottom, 0 = Top, 0.5 = Center.\r\n   */\r\n  self.scrollIntoView = function (x, y, offsetX, offsetY) {\r\n    if (\r\n      self.visibleCells.filter(function (cell) {\r\n        return (\r\n          (cell.rowIndex === y || y === undefined) &&\r\n          (cell.columnIndex === x || x === undefined) &&\r\n          cell.x > 0 &&\r\n          cell.y > 0 &&\r\n          cell.x + cell.width < self.width &&\r\n          cell.y + cell.height < self.height\r\n        );\r\n      }).length === 0\r\n    ) {\r\n      self.gotoCell(x, y, offsetX, offsetY);\r\n    }\r\n  };\r\n  /**\r\n   * Sets the active cell. Requires redrawing.\r\n   * @memberof canvasDatagrid\r\n   * @name setActiveCell\r\n   * @method\r\n   * @param {number} x The column index of the cell to set active.\r\n   * @param {number} y The row index of the cell to set active.\r\n   */\r\n  self.setActiveCell = function (x, y) {\r\n    if (x < 0) {\r\n      x = 0;\r\n    }\r\n    if (y < 0) {\r\n      y = 0;\r\n    }\r\n    self.activeCell = {\r\n      rowIndex: y,\r\n      columnIndex: x,\r\n    };\r\n  };\r\n  /**\r\n   * Removes the selection.\r\n   * @memberof canvasDatagrid\r\n   * @name selectNone\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   * @method\r\n   */\r\n  self.selectNone = function (dontDraw) {\r\n    self.selections = [];\r\n    self.dispatchEvent('selectionchanged', {\r\n      selectedData: self.getSelectedData(),\r\n      selections: self.selections,\r\n      selectionBounds: self.selectionBounds,\r\n    });\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n    self.draw();\r\n  };\r\n  /**\r\n   * Selects every visible cell.\r\n   * @memberof canvasDatagrid\r\n   * @name selectAll\r\n   * @param {boolean} dontDraw Suppress the draw method after the selection change.\r\n   * @method\r\n   */\r\n  self.selectAll = function (dontDraw) {\r\n    self.selectArea({\r\n      top: 0,\r\n      left: -1,\r\n      right: self.getSchema().length - 1,\r\n      bottom: self.viewData.length - 1,\r\n    });\r\n    if (dontDraw) {\r\n      return;\r\n    }\r\n    self.draw();\r\n  };\r\n  /**\r\n   * Returns true if the selected columnIndex is selected on every row.\r\n   * @memberof canvasDatagrid\r\n   * @name isColumnSelected\r\n   * @method\r\n   * @param {number} columnIndex The column index to check.\r\n   */\r\n  self.isColumnSelected = function (columnIndex) {\r\n    var colIsSelected = true;\r\n    self.viewData.forEach(function (row, rowIndex) {\r\n      if (\r\n        !self.selections[rowIndex] ||\r\n        self.selections[rowIndex].indexOf(self.orders.columns[columnIndex]) ===\r\n          -1\r\n      ) {\r\n        colIsSelected = false;\r\n      }\r\n    });\r\n    return colIsSelected;\r\n  };\r\n  /**\r\n   * Runs the defined method on each selected cell.\r\n   * @memberof canvasDatagrid\r\n   * @name forEachSelectedCell\r\n   * @method\r\n   * @param {number} fn The function to execute.  The signature of the function is: (data, rowIndex, columnName).\r\n   * @param {number} expandToRow When true the data in the array is expanded to the entire row.\r\n   */\r\n  self.forEachSelectedCell = function (fn, expandToRow) {\r\n    var d = [],\r\n      s = expandToRow ? self.getSchema() : self.getVisibleSchema(),\r\n      l = self.viewData.length;\r\n    self.selections.forEach(function (row, index) {\r\n      if (index === l) {\r\n        return;\r\n      }\r\n      if (row.length === 0) {\r\n        d[index] = null;\r\n        return;\r\n      }\r\n      d[index] = {};\r\n      row.forEach(function (col) {\r\n        if (col === -1 || !s[col]) {\r\n          return;\r\n        }\r\n        fn(self.viewData, index, s[col].name);\r\n      });\r\n    });\r\n  };\r\n  /**\r\n   * Selects a column.\r\n   * @memberof canvasDatagrid\r\n   * @name selectColumn\r\n   * @method\r\n   * @param {number} columnIndex The column index to select.\r\n   * @param {boolean} toggleSelectMode When true, behaves as if you were holding control/command when you clicked the column.\r\n   * @param {boolean} shift When true, behaves as if you were holding shift when you clicked the column.\r\n   * @param {boolean} supressSelectionchangedEvent When true, prevents the selectionchanged event from firing.\r\n   */\r\n  self.selectColumn = function (columnIndex, ctrl, shift, supressEvent) {\r\n    var s, e, x;\r\n    function addCol(i) {\r\n      self.viewData.forEach(function (row, rowIndex) {\r\n        self.selections[rowIndex] = self.selections[rowIndex] || [];\r\n        if (self.selections[rowIndex].indexOf(i) === -1) {\r\n          self.selections[rowIndex].push(i);\r\n        }\r\n      });\r\n    }\r\n    function removeCol(i) {\r\n      self.viewData.forEach(function (row, rowIndex) {\r\n        self.selections[rowIndex] = self.selections[rowIndex] || [];\r\n        if (self.selections[rowIndex].indexOf(i) !== -1) {\r\n          self.selections[rowIndex].splice(\r\n            self.selections[rowIndex].indexOf(i),\r\n            1,\r\n          );\r\n        }\r\n      });\r\n    }\r\n    if (shift) {\r\n      if (!self.activeCell) {\r\n        return;\r\n      }\r\n      s = Math.min(self.activeCell.columnIndex, columnIndex);\r\n      e = Math.max(self.activeCell.columnIndex, columnIndex);\r\n      for (x = s; e > x; x += 1) {\r\n        addCol(x);\r\n      }\r\n    }\r\n    if (!ctrl && !shift) {\r\n      self.selections = [];\r\n      self.activeCell.columnIndex = columnIndex;\r\n      self.activeCell.rowIndex = self.scrollIndexTop;\r\n    }\r\n    if (ctrl && self.isColumnSelected(columnIndex)) {\r\n      removeCol(columnIndex);\r\n    } else {\r\n      addCol(columnIndex);\r\n    }\r\n    if (supressEvent) {\r\n      return;\r\n    }\r\n    self.dispatchEvent('selectionchanged', {\r\n      selectedData: self.getSelectedData(),\r\n      selections: self.selections,\r\n      selectionBounds: self.getSelectionBounds(),\r\n    });\r\n  };\r\n  /**\r\n   * Selects a row.\r\n   * @memberof canvasDatagrid\r\n   * @name selectRow\r\n   * @method\r\n   * @param {number} rowIndex The row index to select.\r\n   * @param {boolean} ctrl When true, behaves as if you were holding control/command when you clicked the row.\r\n   * @param {boolean} shift When true, behaves as if you were holding shift when you clicked the row.\r\n   * @param {boolean} supressSelectionchangedEvent When true, prevents the selectionchanged event from firing.\r\n   */\r\n  self.selectRow = function (rowIndex, ctrl, shift, supressEvent) {\r\n    var x,\r\n      st,\r\n      en,\r\n      s = self.getVisibleSchema();\r\n    function de() {\r\n      if (supressEvent) {\r\n        return;\r\n      }\r\n      self.dispatchEvent('selectionchanged', {\r\n        selectedData: self.getSelectedData(),\r\n        selections: self.selections,\r\n        selectionBounds: self.selectionBounds,\r\n      });\r\n    }\r\n    function addRow(ri) {\r\n      self.selections[ri] = [];\r\n      self.selections[ri].push(-1);\r\n      s.forEach(function (col, index) {\r\n        self.selections[ri].push(self.orders.columns.indexOf(col.index));\r\n      });\r\n    }\r\n    if (self.dragAddToSelection === false || self.dragObject === undefined) {\r\n      if (\r\n        self.selections[rowIndex] &&\r\n        self.selections[rowIndex].length - 1 === s.length\r\n      ) {\r\n        if (ctrl) {\r\n          self.selections[rowIndex] = [];\r\n          de();\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (self.dragAddToSelection === true || self.dragObject === undefined) {\r\n      if (shift && self.dragObject === undefined) {\r\n        if (!self.activeCell) {\r\n          return;\r\n        }\r\n        st = Math.min(self.activeCell.rowIndex, rowIndex);\r\n        en = Math.max(self.activeCell.rowIndex, rowIndex);\r\n        for (x = st; en >= x; x += 1) {\r\n          addRow(x);\r\n        }\r\n      } else {\r\n        addRow(rowIndex);\r\n      }\r\n    }\r\n    de();\r\n  };\r\n  /**\r\n   * Collapse a tree grid by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name collapseTree\r\n   * @method\r\n   * @param {number} index The index of the row to collapse.\r\n   */\r\n  self.collapseTree = function (rowIndex) {\r\n    self.dispatchEvent('collapsetree', {\r\n      childGrid: self.childGrids[rowIndex],\r\n      data: self.viewData[rowIndex],\r\n      rowIndex: rowIndex,\r\n    });\r\n    self.openChildren[rowIndex].blur();\r\n    self.openChildren[rowIndex].dispose();\r\n    delete self.openChildren[rowIndex];\r\n    delete self.sizes.trees[rowIndex];\r\n    delete self.childGrids[rowIndex];\r\n    self.dispatchEvent('resizerow', {\r\n      cellHeight: self.style.cellHeight,\r\n    });\r\n    self.resize(true);\r\n    self.draw(true);\r\n  };\r\n  /**\r\n   * Expands a tree grid by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name expandTree\r\n   * @method\r\n   * @param {number} index The index of the row to expand.\r\n   */\r\n  self.expandTree = function (rowIndex) {\r\n    var trArgs = self.args.treeGridAttributes || {},\r\n      columnHeaderCellHeight = self.getColumnHeaderCellHeight(),\r\n      rowHeaderCellWidth =\r\n        self.sizes.columns.cornerCell || self.style.rowHeaderCellWidth,\r\n      h = self.sizes.trees[rowIndex] || self.style.treeGridHeight,\r\n      treeGrid;\r\n    if (!self.childGrids[rowIndex]) {\r\n      trArgs.debug = self.attributes.debug;\r\n      trArgs.name = self.attributes.saveAppearance\r\n        ? self.attributes.name + 'tree' + rowIndex\r\n        : undefined;\r\n      trArgs.style = trArgs.style || self.style;\r\n      trArgs.parentNode = {\r\n        parentGrid: self.intf,\r\n        nodeType: 'canvas-datagrid-tree',\r\n        offsetHeight: h,\r\n        offsetWidth: self.width - rowHeaderCellWidth,\r\n        header: { width: self.width - rowHeaderCellWidth },\r\n        offsetLeft: rowHeaderCellWidth,\r\n        offsetTop: columnHeaderCellHeight,\r\n        offsetParent: self.intf.parentNode,\r\n        parentNode: self.intf.parentNode,\r\n        style: 'tree',\r\n        data: self.viewData[rowIndex],\r\n      };\r\n      treeGrid = self.createGrid(trArgs);\r\n      self.childGrids[rowIndex] = treeGrid;\r\n    }\r\n    treeGrid = self.childGrids[rowIndex];\r\n    treeGrid.visible = true;\r\n    self.dispatchEvent('expandtree', {\r\n      treeGrid: treeGrid,\r\n      data: self.viewData[rowIndex],\r\n      rowIndex: rowIndex,\r\n    });\r\n    self.openChildren[rowIndex] = treeGrid;\r\n    self.sizes.trees[rowIndex] = h;\r\n    self.dispatchEvent('resizerow', { height: self.style.cellHeight });\r\n    self.resize(true);\r\n  };\r\n  /**\r\n   * Toggles tree grid open and close by row index.\r\n   * @memberof canvasDatagrid\r\n   * @name toggleTree\r\n   * @method\r\n   * @param {number} index The index of the row to toggle.\r\n   */\r\n  self.toggleTree = function (rowIndex) {\r\n    var i = self.openChildren[rowIndex];\r\n    if (i) {\r\n      return self.collapseTree(rowIndex);\r\n    }\r\n    self.expandTree(rowIndex);\r\n  };\r\n  /**\r\n   * Returns a header from the schema by name.\r\n   * @memberof canvasDatagrid\r\n   * @name getHeaderByName\r\n   * @tutorial schema\r\n   * @method\r\n   * @returns {header} header with the selected name, or undefined.\r\n   * @param {string} name The name of the column to resize.\r\n   */\r\n  self.getHeaderByName = function (name) {\r\n    var x,\r\n      i = self.getSchema();\r\n    for (x = 0; x < i.length; x += 1) {\r\n      if (i[x].name === name) {\r\n        return i[x];\r\n      }\r\n    }\r\n  };\r\n  /**\r\n   * Resizes a column to fit the longest value in the column. Call without a value to resize all columns.\r\n   * Warning, can be slow on very large record sets (1m records ~3-5 seconds on an i7).\r\n   * @memberof canvasDatagrid\r\n   * @name fitColumnToValues\r\n   * @method\r\n   * @param {string} name The name of the column to resize.\r\n   */\r\n  self.fitColumnToValues = function (name, internal) {\r\n    if (!self.canvas) {\r\n      return;\r\n    }\r\n    self.sizes.columns[\r\n      name === 'cornerCell' ? -1 : self.getHeaderByName(name).index\r\n    ] = Math.max(self.findColumnMaxTextLength(name), self.style.minColumnWidth);\r\n    if (!internal) {\r\n      self.resize();\r\n      self.draw(true);\r\n    }\r\n  };\r\n  /**\r\n   * Checks if a cell is currently visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isCellVisible\r\n   * @overload\r\n   * @method\r\n   * @returns {boolean} when true, the cell is visible, when false the cell is not currently drawn.\r\n   * @param {number} columnIndex The column index of the cell to check.\r\n   * @param {number} rowIndex The row index of the cell to check.\r\n   */\r\n  self.isCellVisible = function (cell, rowIndex) {\r\n    // overload\r\n    if (rowIndex !== undefined) {\r\n      return (\r\n        self.visibleCells.filter(function (c) {\r\n          return c.columnIndex === cell && c.rowIndex === rowIndex;\r\n        }).length > 0\r\n      );\r\n    }\r\n    var x,\r\n      l = self.visibleCells.length;\r\n    for (x = 0; x < l; x += 1) {\r\n      if (\r\n        cell.x === self.visibleCells[x].x &&\r\n        cell.y === self.visibleCells[x].y\r\n      ) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n  /**\r\n   * Sets the order of the data.\r\n   * @memberof canvasDatagrid\r\n   * @name order\r\n   * @method\r\n   * @param {number} columnName Name of the column to be sorted.\r\n   * @param {string} direction `asc` for ascending or `desc` for descending.\r\n   * @param {function} [sortFunction] When defined, override the default sorting method defined in the column's schema and use this one.\r\n   * @param {bool} [dontSetStorageData] Don't store this setting for future use.\r\n   */\r\n  self.order = function (\r\n    columnName,\r\n    direction,\r\n    sortFunction,\r\n    dontSetStorageData,\r\n  ) {\r\n    var f,\r\n      c = self.getSchema().filter(function (col) {\r\n        return col.name === columnName;\r\n      });\r\n    if (\r\n      self.dispatchEvent('beforesortcolumn', {\r\n        name: columnName,\r\n        direction: direction,\r\n      })\r\n    ) {\r\n      return;\r\n    }\r\n    self.orderBy = columnName;\r\n    self.orderDirection = direction;\r\n    if (!self.viewData || self.viewData.length === 0) {\r\n      return;\r\n    }\r\n    if (c.length === 0) {\r\n      throw new Error('Cannot sort.  No such column name');\r\n    }\r\n    f = sortFunction || c[0].sorter || self.sorters[c[0].type];\r\n    if (!f && c[0].type !== undefined) {\r\n      console.warn(\r\n        'Cannot sort type \"%s\" falling back to string sort.',\r\n        c[0].type,\r\n      );\r\n    }\r\n    self.orderings.add(\r\n      columnName,\r\n      direction,\r\n      typeof f === 'function' ? f : self.sorters.string,\r\n    );\r\n    self.refresh();\r\n    self.dispatchEvent('sortcolumn', {\r\n      name: columnName,\r\n      direction: direction,\r\n    });\r\n\r\n    if (dontSetStorageData) {\r\n      return;\r\n    }\r\n    self.setStorageData();\r\n  };\r\n  self.isInGrid = function (e) {\r\n    if (e.x < 0 || e.x > self.width || e.y < 0 || e.y > self.height) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  /**\r\n   * Moves the current selection relative to the its current position.  Note: this method does not move the selected data, just the selection itself.\r\n   * @memberof canvasDatagrid\r\n   * @name moveSelection\r\n   * @method\r\n   * @param {number} offsetX The number of columns to offset the selection.\r\n   * @param {number} offsetY The number of rows to offset the selection.\r\n   */\r\n  self.moveSelection = function (offsetX, offsetY) {\r\n    var sel = [];\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      sel[rowIndex + offsetY] = [];\r\n      row.forEach(function (colIndex) {\r\n        sel[rowIndex + offsetY].push(colIndex + offsetX);\r\n      });\r\n    });\r\n    self.selections = sel;\r\n  };\r\n  /**\r\n   * Moves data in the provided selection to another position in the grid.  Moving data off the edge of the schema (columns/x) will truncate data.\r\n   * @memberof canvasDatagrid\r\n   * @name moveTo\r\n   * @method\r\n   * @param {array} sel 2D array representing selected rows and columns.  `canvasDatagrid.selections` is in this format and can be used here.\r\n   * @param {number} x The column index to start inserting the selection at.\r\n   * @param {number} y The row index to start inserting the selection at.\r\n   */\r\n  self.moveTo = function (sel, x, y) {\r\n    var selectedData = self.getSelectedData(),\r\n      visibleSchema = self.getVisibleSchema(),\r\n      selectionLength = sel.length,\r\n      xi,\r\n      maxRowLength = -Infinity,\r\n      minXi = Infinity,\r\n      yi = y - 1;\r\n\r\n    sel.forEach(function (row, rowIndex) {\r\n      if (rowIndex === selectionLength) {\r\n        return;\r\n      }\r\n      if (row.length === 0) {\r\n        return;\r\n      }\r\n      minXi = Math.min(self.getVisibleColumnIndexOf(x), minXi);\r\n      maxRowLength = Math.max(maxRowLength, row.length);\r\n      row.forEach(function (colIndex) {\r\n        // intentional redef of colIndex\r\n        colIndex = self.getVisibleColumnIndexOf(colIndex);\r\n        if (!visibleSchema[colIndex]) {\r\n          return;\r\n        }\r\n        // TODO:\r\n        if (!self.data[rowIndex]) {\r\n          self.data[rowIndex] = {};\r\n        }\r\n        // TODO:\r\n        self.data[rowIndex][visibleSchema[colIndex].name] = null;\r\n      });\r\n    });\r\n\r\n    sel.forEach(function (row, index) {\r\n      var lastSourceIndex;\r\n      yi += 1;\r\n      xi = self.getVisibleColumnIndexOf(x);\r\n      row.forEach(function (colIndex, cidx) {\r\n        colIndex = self.getVisibleColumnIndexOf(colIndex);\r\n        if (cidx > 0) {\r\n          // this confusing bit of nonsense figures out\r\n          // if the selection has skipped cells\r\n          xi += colIndex - lastSourceIndex;\r\n        }\r\n        lastSourceIndex = colIndex;\r\n        if (\r\n          colIndex === -1 ||\r\n          !visibleSchema[xi] ||\r\n          !visibleSchema[colIndex] ||\r\n          // TODO:\r\n          self.data.length - 1 < yi ||\r\n          yi < 0\r\n        ) {\r\n          return;\r\n        }\r\n        // TODO:\r\n        if (!self.data[yi]) {\r\n          self.data[yi] = {};\r\n        }\r\n        // TODO:\r\n        self.data[yi][visibleSchema[xi].name] =\r\n          selectedData[index][visibleSchema[colIndex].name];\r\n      });\r\n    });\r\n  };\r\n  /**\r\n   * Checks if a given column is visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isColumnVisible\r\n   * @method\r\n   * @returns {boolean} When true, the column is visible.\r\n   * @param {number} columnIndex Column index.\r\n   */\r\n  self.isColumnVisible = function (columnIndex) {\r\n    return (\r\n      self.visibleCells.filter(function (c) {\r\n        return c.columnIndex === columnIndex;\r\n      }).length > 0\r\n    );\r\n  };\r\n  /**\r\n   * Checks if a given row is visible.\r\n   * @memberof canvasDatagrid\r\n   * @name isRowVisible\r\n   * @method\r\n   * @returns {boolean} When true, the row is visible.\r\n   * @param {number} rowIndex Row index.\r\n   */\r\n  self.isRowVisible = function (rowIndex) {\r\n    return (\r\n      self.visibleCells.filter(function (c) {\r\n        return c.rowIndex === rowIndex;\r\n      }).length > 0\r\n    );\r\n  };\r\n  /**\r\n   * Gets the cell at columnIndex and rowIndex.\r\n   * @memberof canvasDatagrid\r\n   * @name getVisibleCellByIndex\r\n   * @method\r\n   * @returns {cell} cell at the selected location.\r\n   * @param {number} x Column index.\r\n   * @param {number} y Row index.\r\n   */\r\n  self.getVisibleCellByIndex = function (x, y) {\r\n    return self.visibleCells.filter(function (c) {\r\n      return c.columnIndex === x && c.rowIndex === y;\r\n    })[0];\r\n  };\r\n  /**\r\n   * Gets the cell at grid pixel coordinate x and y.  Author's note.  This function ties drawing and events together.  This is a very complex function and is core to the component.\r\n   * @memberof canvasDatagrid\r\n   * @name getCellAt\r\n   * @method\r\n   * @returns {cell} cell at the selected location.\r\n   * @param {number} x Number of pixels from the left.\r\n   * @param {number} y Number of pixels from the top.\r\n   */\r\n  self.getCellAt = function (x, y, useTouchScrollZones) {\r\n    function getBorder(entitiy) {\r\n      if (\r\n        entitiy.x + entitiy.width - self.attributes.borderResizeZone * 0.4 <\r\n          x &&\r\n        entitiy.x + entitiy.width + self.attributes.borderResizeZone * 0.6 > x\r\n      ) {\r\n        return 'r';\r\n      }\r\n      if (\r\n        entitiy.x - self.attributes.borderResizeZone * 0.4 < x &&\r\n        entitiy.x + self.attributes.borderResizeZone * 0.6 > x\r\n      ) {\r\n        return 'l';\r\n      }\r\n      if (\r\n        entitiy.y + entitiy.height - self.attributes.borderResizeZone * 0.4 <\r\n          y &&\r\n        entitiy.y + entitiy.height + self.attributes.borderResizeZone * 0.6 > y\r\n      ) {\r\n        return 'b';\r\n      }\r\n      if (\r\n        entitiy.y - self.attributes.borderResizeZone * 0.4 < y &&\r\n        entitiy.y + self.attributes.borderResizeZone * 0.6 > y\r\n      ) {\r\n        return 't';\r\n      }\r\n    }\r\n    if (!self.visibleCells) {\r\n      return;\r\n    }\r\n    var border,\r\n      tsz = useTouchScrollZones ? self.attributes.touchScrollZone : 0,\r\n      moveMode = self.attributes.borderDragBehavior === 'move',\r\n      i,\r\n      l = self.visibleCells.length,\r\n      moveBorder,\r\n      xBorderBehavior = moveMode ? self.cursorGrab : 'ew-resize',\r\n      yBorderBehavior = moveMode ? self.cursorGrab : 'ns-resize',\r\n      cell,\r\n      entitiy;\r\n    if (!self.visibleCells || !self.visibleCells.length) {\r\n      return;\r\n    }\r\n    self.hasFocus = true;\r\n    if (!(y < self.height && y > 0 && x < self.width && x > 0)) {\r\n      self.hasFocus = false;\r\n      return {\r\n        dragContext: 'inherit',\r\n        context: 'inherit',\r\n      };\r\n    }\r\n    for (i = 0; i < l; i += 1) {\r\n      cell = self.visibleCells[i];\r\n      // interactive dimensions of the cell.  used for touch \"over size\" zones\r\n      entitiy = {\r\n        x: cell.x,\r\n        y: cell.y,\r\n        height: cell.height,\r\n        width: cell.width,\r\n      };\r\n      if (\r\n        useTouchScrollZones &&\r\n        /(vertical|horizontal)-scroll-/.test(cell.style)\r\n      ) {\r\n        entitiy.x -= tsz;\r\n        entitiy.y -= tsz;\r\n        entitiy.height += tsz;\r\n        entitiy.width += tsz;\r\n      }\r\n      if (\r\n        entitiy.x - self.style.cellBorderWidth < x &&\r\n        entitiy.x + entitiy.width + self.style.cellBorderWidth > x &&\r\n        entitiy.y - self.style.cellBorderWidth < y &&\r\n        entitiy.y + entitiy.height + self.style.cellBorderWidth > y\r\n      ) {\r\n        if (/frozen-row-marker/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'row-resize';\r\n          return cell;\r\n        }\r\n        if (/frozen-column-marker/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'col-resize';\r\n          return cell;\r\n        }\r\n        if (/selection-handle-/.test(cell.style)) {\r\n          cell.dragContext = cell.style;\r\n          cell.context = 'crosshair';\r\n          return cell;\r\n        }\r\n        if (/vertical-scroll-(bar|box)/.test(cell.style)) {\r\n          cell.dragContext = 'vertical-scroll-box';\r\n          cell.context = 'vertical-scroll-box';\r\n          cell.isScrollBar = true;\r\n          cell.isVerticalScrollBar = true;\r\n          if (y > self.scrollBox.box.v.y + self.scrollBox.scrollBoxHeight) {\r\n            cell.dragContext = 'vertical-scroll-bottom';\r\n            cell.context = 'vertical-scroll-bottom';\r\n          } else if (y < self.scrollBox.box.v.y) {\r\n            cell.dragContext = 'vertical-scroll-top';\r\n            cell.context = 'vertical-scroll-top';\r\n          }\r\n          self.cursor = 'default';\r\n          return cell;\r\n        }\r\n        if (/horizontal-scroll-(bar|box)/.test(cell.style)) {\r\n          cell.dragContext = 'horizontal-scroll-box';\r\n          cell.context = 'horizontal-scroll-box';\r\n          cell.isScrollBar = true;\r\n          cell.isHorizontalScrollBar = true;\r\n          if (x > self.scrollBox.box.h.x + self.scrollBox.scrollBoxWidth) {\r\n            cell.dragContext = 'horizontal-scroll-right';\r\n            cell.context = 'horizontal-scroll-right';\r\n          } else if (x < self.scrollBox.box.h.x) {\r\n            cell.dragContext = 'horizontal-scroll-left';\r\n            cell.context = 'horizontal-scroll-left';\r\n          }\r\n          self.cursor = 'default';\r\n          return cell;\r\n        }\r\n        border = getBorder(entitiy);\r\n        // check if the border of this cell is the border of the selection and if so show move cursor in move mode\r\n        moveBorder =\r\n          moveMode &&\r\n          cell.selectionBorder &&\r\n          cell.selectionBorder.indexOf(border) !== -1;\r\n        if (\r\n          ['l', 'r'].indexOf(border) !== -1 &&\r\n          (self.attributes.allowColumnResize || moveBorder) &&\r\n          ((self.attributes.allowColumnResizeFromCell && cell.isNormal) ||\r\n            !cell.isNormal ||\r\n            moveBorder) &&\r\n          ((self.attributes.allowRowHeaderResize &&\r\n            (cell.isRowHeader || cell.isCorner)) ||\r\n            !(cell.isRowHeader && cell.isCorner))\r\n        ) {\r\n          if (\r\n            (cell.isColumnHeader ||\r\n              cell.isCorner ||\r\n              (self.attributes.allowColumnResizeFromCell && cell.isNormal)) &&\r\n            border === 'r'\r\n          ) {\r\n            cell.context = 'ew-resize';\r\n            cell.dragContext = 'ew-resize';\r\n            return cell;\r\n          }\r\n          if (!(cell.isColumnHeader || cell.isCorner) && moveBorder) {\r\n            cell.context = xBorderBehavior;\r\n            cell.dragContext = border + '-move';\r\n            return cell;\r\n          }\r\n        }\r\n        if (\r\n          ['t', 'b'].indexOf(border) !== -1 &&\r\n          cell.rowIndex > -1 &&\r\n          (self.attributes.allowRowResize || moveBorder) &&\r\n          ((self.attributes.allowRowResizeFromCell && cell.isNormal) ||\r\n            !cell.isNormal ||\r\n            moveBorder) &&\r\n          !cell.isColumnHeader\r\n        ) {\r\n          if (\r\n            (cell.isRowHeader ||\r\n              cell.isCorner ||\r\n              (self.attributes.allowRowResizeFromCell && cell.isNormal)) &&\r\n            border === 'b'\r\n          ) {\r\n            cell.context = 'ns-resize';\r\n            cell.dragContext = 'ns-resize';\r\n            return cell;\r\n          }\r\n          if (!(cell.isRowHeader || cell.isCorner) && moveBorder) {\r\n            cell.context = yBorderBehavior;\r\n            cell.dragContext = border + '-move';\r\n            return cell;\r\n          }\r\n        }\r\n        if (cell.style === 'columnHeaderCell') {\r\n          cell.context = 'cell';\r\n          cell.dragContext = 'column-reorder';\r\n          return cell;\r\n        }\r\n        if (cell.style === 'rowHeaderCell') {\r\n          if (\r\n            self.attributes.rowGrabZoneSize +\r\n              (cell.y - self.style.cellBorderWidth) <\r\n              y ||\r\n            !self.attributes.allowRowReordering\r\n          ) {\r\n            cell.dragContext = 'cell';\r\n            cell.context = 'cell';\r\n          } else {\r\n            cell.context = self.cursorGrab;\r\n            cell.dragContext = 'row-reorder';\r\n          }\r\n          return cell;\r\n        }\r\n        if (cell.isGrid) {\r\n          self.hasFocus = false;\r\n          cell.dragContext = 'cell-grid';\r\n          cell.context = 'cell-grid';\r\n          return cell;\r\n        }\r\n        if (cell.style === 'tree-grid') {\r\n          self.hasFocus = false;\r\n          cell.dragContext = 'tree';\r\n          cell.context = 'tree';\r\n          return cell;\r\n        }\r\n        cell.dragContext = 'cell';\r\n        cell.context = 'cell';\r\n        return cell;\r\n      }\r\n    }\r\n    self.hasFocus = true;\r\n    self.cursor = 'default';\r\n    return {\r\n      dragContext: 'background',\r\n      context: 'background',\r\n      style: 'background',\r\n      isBackground: true,\r\n    };\r\n  };\r\n  /**\r\n   * Gets the bounds of current selection.\r\n   * @returns {rect} selection.\r\n   * @memberof canvasDatagrid\r\n   * @name getSelectionBounds\r\n   * @method\r\n   */\r\n  self.getSelectionBounds = function () {\r\n    var low = { x: Infinity, y: Infinity },\r\n      high = { x: -Infinity, y: -Infinity };\r\n    self.selections.forEach(function (row, rowIndex) {\r\n      var maxCol, minCol;\r\n      low.y = rowIndex < low.y ? rowIndex : low.y;\r\n      high.y = rowIndex > high.y ? rowIndex : high.y;\r\n      maxCol = Math.max.apply(null, row);\r\n      minCol = Math.min.apply(null, row);\r\n      low.x = minCol < low.x ? minCol : low.x;\r\n      high.x = maxCol > high.x ? maxCol : high.x;\r\n    });\r\n    return {\r\n      top: low.y,\r\n      left: low.x,\r\n      bottom: high.y,\r\n      right: high.x,\r\n    };\r\n  };\r\n  /**\r\n   * Returns an auto generated schema based on data structure.\r\n   * @memberof canvasDatagrid\r\n   * @name getSchemaFromData\r\n   * @method\r\n   * @tutorial schema\r\n   * @returns {schema} schema A schema based on the first item in the data array.\r\n   */\r\n  self.getSchemaFromData = function (d) {\r\n    d = d || self.originalData;\r\n    return Object.keys(d[0] || { ' ': '' }).map(function mapEachSchemaColumn(\r\n      key,\r\n      index,\r\n    ) {\r\n      var type = self.getBestGuessDataType(key, d),\r\n        i = {\r\n          name: key,\r\n          title: isNaN(parseInt(key, 10))\r\n            ? key\r\n            : self.integerToAlpha(key).toUpperCase(),\r\n          index: index,\r\n          columnIndex: index,\r\n          type: type,\r\n          filter: self.filter(type),\r\n        };\r\n      if (\r\n        self.storedSettings &&\r\n        self.storedSettings.visibility &&\r\n        self.storedSettings.visibility[i.name] !== undefined\r\n      ) {\r\n        i.hidden = !self.storedSettings.visibility[i.name];\r\n      }\r\n      return i;\r\n    });\r\n  };\r\n  /**\r\n   * Clears the change log grid.changes that keeps track of changes to the data set.\r\n   * This does not undo changes or alter data it is simply a convince array to keep\r\n   * track of changes made to the data since last this method was called.\r\n   * @memberof canvasDatagrid\r\n   * @name clearChangeLog\r\n   * @method\r\n   */\r\n  self.clearChangeLog = function () {\r\n    self.changes = [];\r\n  };\r\n  /**\r\n   * Selects an area of the grid.\r\n   * @memberof canvasDatagrid\r\n   * @name selectArea\r\n   * @method\r\n   * @param {rect} bounds A rect object representing the selected values.\r\n   */\r\n  self.selectArea = function (bounds, ctrl) {\r\n    self.selectionBounds = bounds || self.selectionBounds;\r\n    var ev,\r\n      x,\r\n      y,\r\n      s = self.getSchema();\r\n    if (!ctrl) {\r\n      self.selections = [];\r\n    }\r\n    if (\r\n      self.selectionBounds.top < -1 ||\r\n      self.selectionBounds.bottom > self.viewData.length ||\r\n      self.selectionBounds.left < -1 ||\r\n      self.selectionBounds.right > s.length\r\n    ) {\r\n      throw new Error('Impossible selection area');\r\n    }\r\n    for (\r\n      x = self.selectionBounds.top;\r\n      x <= self.selectionBounds.bottom;\r\n      x += 1\r\n    ) {\r\n      self.selections[x] = [];\r\n      for (\r\n        y = self.selectionBounds.left;\r\n        y <= self.selectionBounds.right;\r\n        y += 1\r\n      ) {\r\n        if (self.selections[x].indexOf(y) === -1) {\r\n          self.selections[x].push(y);\r\n        }\r\n      }\r\n    }\r\n    ev = {\r\n      selections: self.selections,\r\n      selectionBounds: self.selectionBounds,\r\n    };\r\n    Object.defineProperty(ev, 'selectedData', {\r\n      get: function () {\r\n        return self.getSelectedData();\r\n      },\r\n    });\r\n    self.dispatchEvent('selectionchanged', ev);\r\n  };\r\n  /**\r\n   * Returns the maximum text width for a given column by column name.\r\n   * @memberof canvasDatagrid\r\n   * @name findColumnMaxTextLength\r\n   * @method\r\n   * @returns {number} The number of pixels wide the maximum width value in the selected column.\r\n   * @param {string} name The name of the column to calculate the value's width of.\r\n   */\r\n  self.findColumnMaxTextLength = function (name) {\r\n    var m = -Infinity;\r\n    if (name === 'cornerCell') {\r\n      self.ctx.font = self.style.rowHeaderCellFont;\r\n      return (\r\n        self.ctx.measureText(\r\n          (\r\n            self.viewData.length + (self.attributes.showNewRow ? 1 : 0)\r\n          ).toString(),\r\n        ).width +\r\n        self.style.autosizePadding +\r\n        self.style.autosizeHeaderCellPadding +\r\n        self.style.rowHeaderCellPaddingRight +\r\n        self.style.rowHeaderCellPaddingLeft +\r\n        (self.attributes.tree\r\n          ? self.style.treeArrowWidth +\r\n            self.style.treeArrowMarginLeft +\r\n            self.style.treeArrowMarginRight\r\n          : 0)\r\n      );\r\n    }\r\n    var formatter = null;\r\n    self.getSchema().forEach(function (col) {\r\n      if (col.name !== name) {\r\n        return;\r\n      }\r\n      self.ctx.font = self.style.columnHeaderCellFont;\r\n      var t =\r\n        self.ctx.measureText(col.title || col.name).width +\r\n        self.style.headerCellPaddingRight +\r\n        self.style.headerCellPaddingLeft;\r\n      m = t > m ? t : m;\r\n      formatter = self.formatters[col.type];\r\n    });\r\n    self.viewData.forEach(function (row) {\r\n      var text = row[name];\r\n      if (formatter) {\r\n        text = formatter({ cell: { value: text } });\r\n      }\r\n      self.ctx.font = self.style.cellFont;\r\n      var t =\r\n        self.ctx.measureText(text).width +\r\n        self.style.cellPaddingRight +\r\n        self.style.cellPaddingLeft +\r\n        self.style.cellAutoResizePadding;\r\n      m = t > m ? t : m;\r\n    });\r\n    return m;\r\n  };\r\n  /**\r\n   * Gets the total width of all header columns.\r\n   * @memberof canvasDatagrid\r\n   * @name getHeaderWidth\r\n   * @method\r\n   */\r\n  self.getHeaderWidth = function () {\r\n    return self.getVisibleSchema().reduce(function (total, header) {\r\n      return total + parseInt(header.width || self.style.cellWidth, 10);\r\n    }, 0);\r\n  };\r\n  /**\r\n   * Gets the height of a row by index.\r\n   * @memberof canvasDatagrid\r\n   * @name getRowHeight\r\n   * @method\r\n   * @param {number} rowIndex The row index to lookup.\r\n   */\r\n  self.getRowHeight = function (rowIndex) {\r\n    return (self.sizes.rows[rowIndex] || self.style.cellHeight) * self.scale;\r\n  };\r\n  /**\r\n   * Gets the width of a column by index.\r\n   * @memberof canvasDatagrid\r\n   * @name getColumnWidth\r\n   * @method\r\n   * @param {number} columnIndex The column index to lookup.\r\n   */\r\n  self.getColumnWidth = function (columnIndex) {\r\n    return (\r\n      (self.sizes.columns[columnIndex] ||\r\n        self.getSchema()[columnIndex].width ||\r\n        self.style.cellWidth) * self.scale\r\n    );\r\n  };\r\n  self.formatters.string = function cellFormatterString(e) {\r\n    return e.cell.value !== undefined ? e.cell.value : '';\r\n  };\r\n  self.formatters.rowHeaderCell = self.formatters.string;\r\n  self.formatters.headerCell = self.formatters.string;\r\n  self.formatters.number = self.formatters.string;\r\n  self.formatters.int = self.formatters.string;\r\n  self.formatters.html = self.formatters.string;\r\n  self.sorters.string = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (a[columnName] === undefined || a[columnName] === null) {\r\n        return 1;\r\n      }\r\n      if (b[columnName] === undefined || b[columnName] === null) {\r\n        return 0;\r\n      }\r\n      if (asc) {\r\n        if (!a[columnName].localeCompare) {\r\n          return 1;\r\n        }\r\n        return a[columnName].localeCompare(b[columnName]);\r\n      }\r\n      if (!b[columnName].localeCompare) {\r\n        return 1;\r\n      }\r\n      return b[columnName].localeCompare(a[columnName]);\r\n    };\r\n  };\r\n  self.sorters.number = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (asc) {\r\n        return a[columnName] - b[columnName];\r\n      }\r\n      return b[columnName] - a[columnName];\r\n    };\r\n  };\r\n  self.sorters.date = function (columnName, direction) {\r\n    var asc = direction === 'asc';\r\n    return function (a, b) {\r\n      if (asc) {\r\n        return (\r\n          new Date(a[columnName]).getTime() - new Date(b[columnName]).getTime()\r\n        );\r\n      }\r\n      return (\r\n        new Date(b[columnName]).getTime() - new Date(a[columnName]).getTime()\r\n      );\r\n    };\r\n  };\r\n}\r\n","/*jslint browser: true, unparam: true, todo: true, evil: true*/\r\n/*globals Reflect: false, HTMLElement: true, define: true, MutationObserver: false, requestAnimationFrame: false, performance: false, btoa: false*/\r\n'use strict';\r\n\r\nimport component from './component';\r\nimport defaults from './defaults';\r\nimport draw from './draw';\r\nimport events from './events';\r\nimport touch from './touch';\r\nimport intf from './intf';\r\nimport contextMenu from './contextMenu';\r\nimport dom from './dom';\r\nimport publicMethods from './publicMethods';\r\n\r\nvar webComponent = component();\r\n\r\nvar modules = [\r\n  defaults,\r\n  draw,\r\n  events,\r\n  touch,\r\n  intf,\r\n  contextMenu,\r\n  dom,\r\n  publicMethods,\r\n];\r\n\r\nfunction Grid(args) {\r\n  args = args || {};\r\n  var self = {};\r\n  self.isComponent = args.component === undefined;\r\n  self.isChildGrid =\r\n    args.parentNode &&\r\n    /canvas-datagrid-(cell|tree)/.test(args.parentNode.nodeType);\r\n  if (self.isChildGrid) {\r\n    self.intf = {};\r\n  } else {\r\n    self.intf = self.isComponent\r\n      ? eval('Reflect.construct(HTMLElement, [], new.target)')\r\n      : document.createElement('canvas');\r\n  }\r\n  self.args = args;\r\n  self.intf.args = args;\r\n  self.applyComponentStyle = webComponent.applyComponentStyle;\r\n  self.hyphenateProperty = webComponent.hyphenateProperty;\r\n  self.dehyphenateProperty = webComponent.dehyphenateProperty;\r\n  self.createGrid = function grid(args) {\r\n    args.component = false;\r\n    return new Grid(args);\r\n  };\r\n\r\n  modules.forEach(function (module) {\r\n    module(self);\r\n  });\r\n\r\n  if (self.isChildGrid) {\r\n    self.shadowRoot = args.parentNode.shadowRoot;\r\n    self.parentNode = args.parentNode;\r\n  } else {\r\n    self.shadowRoot = self.intf.attachShadow({ mode: 'open' });\r\n    self.parentNode = self.shadowRoot;\r\n  }\r\n  self.init();\r\n  return self.intf;\r\n}\r\nif (window.HTMLElement) {\r\n  Grid.prototype = Object.create(window.HTMLElement.prototype);\r\n}\r\n// export web component\r\nif (window.customElements) {\r\n  Grid.observedAttributes = webComponent.getObservableAttributes();\r\n  Grid.prototype.disconnectedCallback = webComponent.disconnectedCallback;\r\n  Grid.prototype.attributeChangedCallback =\r\n    webComponent.attributeChangedCallback;\r\n  Grid.prototype.connectedCallback = webComponent.connectedCallback;\r\n  Grid.prototype.adoptedCallback = webComponent.adoptedCallback;\r\n  window.customElements.define('canvas-datagrid', Grid);\r\n}\r\n\r\n// export global\r\nif (\r\n  window &&\r\n  !window.canvasDatagrid &&\r\n  !window.require &&\r\n  // Present to exclude global declarations from ES Module bundles\r\n  !window.EXCLUDE_GLOBAL\r\n) {\r\n  window.canvasDatagrid = function (args) {\r\n    return new Grid(args);\r\n  };\r\n}\r\n\r\n// export amd loader\r\nexport default function canvasDatagrid(args) {\r\n  args = args || {};\r\n  var i,\r\n    tKeys = [\r\n      'style',\r\n      'formatters',\r\n      'sorters',\r\n      'filters',\r\n      'treeGridAttributes',\r\n      'cellGridAttributes',\r\n      'data',\r\n      'schema',\r\n    ];\r\n  if (window.customElements) {\r\n    i = document.createElement('canvas-datagrid');\r\n    Object.keys(args).forEach(function (argKey) {\r\n      // set data and parentNode after everything else\r\n      if (argKey === 'data') {\r\n        return;\r\n      }\r\n      if (argKey === 'parentNode') {\r\n        return;\r\n      }\r\n      // top level keys in args\r\n      if (tKeys.indexOf(argKey) !== -1) {\r\n        tKeys.forEach(function (tKey) {\r\n          if (args[tKey] === undefined || tKey !== argKey) {\r\n            return;\r\n          }\r\n          if (['formatters', 'sorters', 'filters'].indexOf(argKey) !== -1) {\r\n            if (typeof args[tKey] === 'object' && args[tKey] !== null) {\r\n              Object.keys(args[tKey]).forEach(function (sKey) {\r\n                i[tKey][sKey] = args[tKey][sKey];\r\n              });\r\n            }\r\n          } else {\r\n            i[tKey] = args[tKey];\r\n          }\r\n        });\r\n        return;\r\n      }\r\n      // all others are attribute level keys\r\n      i.attributes[argKey] = args[argKey];\r\n    });\r\n    if (args.data) {\r\n      i.data = args.data;\r\n    }\r\n    // add to the dom very last to avoid redraws\r\n    if (args.parentNode) {\r\n      args.parentNode.appendChild(i);\r\n    }\r\n    return i;\r\n  }\r\n  args.component = false;\r\n  i = new Grid(args);\r\n  if (args.parentNode && args.parentNode.appendChild) {\r\n    args.parentNode.appendChild(i);\r\n  }\r\n  return i;\r\n}\r\n"],"names":["self","defaults","attributes","styles","typeMap","component","dehyphenateProperty","prop","replace","nextLetterCap","p","Array","prototype","forEach","call","char","toUpperCase","hyphenateProperty","cust","toLowerCase","applyComponentStyle","supressChangeAndDrawEvents","intf","isComponent","cStyle","window","getComputedStyle","tagName","canvas","defs","computedStyle","def","val","getPropertyValue","setStyleProperty","dispatchEvent","requestAnimationFrame","resize","style","data","strData","JSON","parse","e","Error","schema","strSchema","number","strNum","n","parseInt","isNaN","boolean","strBool","test","string","str","getObservableAttributes","i","attrs","attr","push","disconnectedCallback","connected","connectedCallback","this","parentDOMNode","innerHTML","appendChild","observe","adoptedCallback","attributeChangedCallback","attrName","oldVal","newVal","tfn","dataType","base","item","filter","addEventListener","Function","name","observer","MutationObserver","mutations","checkInnerHTML","checkStyle","mutation","attributeName","target","nodeName","parentNode","addedNodes","length","type","characterData","childList","subtree","document","querySelectorAll","el","perfCounters","cachedImagesDrawn","drawCount","perfWindowSize","entityCount","scrollDebugCounters","touchPPSCounters","fillArray","low","high","step","x","undefined","drawHtml","cell","img","v","formattedValue","cacheKey","toString","rowIndex","columnIndex","Math","round","canvasOffsetLeft","y","canvasOffsetTop","htmlImageCache","height","width","complete","ctx","drawImage","Image","onload","loaded","Object","keys","html","draw","src","btoa","radiusRect","w","h","radius","r","b","beginPath","moveTo","lineTo","quadraticCurveTo","fillRect","strokeRect","fillText","text","clipFrozenArea","mode","lastFrozenColumnPixel","lastFrozenRowPixel","clip","fillHandle","selectionHandleType","arc","PI","fill","fillCircle","strokeHandle","stroke","strokeCircle","addBorderLine","c","pos","t","l","internal","isChildGrid","parentGrid","visible","checkScrollHeight","cx","cy","treeGrid","rowOpen","rowHeight","cornerCell","rowData","aCell","my","mx","xHover","yHover","drawCorner","en","m","d","viewData","bc","gridBorderCollapse","selectionBorders","moveBorders","selectionHandles","rowHeaders","u","currentCell","columnHeaderCellHeight","getColumnHeaderCellHeight","rowHeaderCellWidth","getRowHeaderCellWidth","cellHeight","performance","now","visibleRowHeights","orders","rows","createRowOrders","save","visibleRows","getSchema","visibleCells","offsetTop","offsetLeft","fillStyle","gridBackgroundColor","ln","min","frozenRow","scrollBox","scrollLeft","scrollPixelLeft","cellBorderWidth","drawRow","allowFreezingRows","frozenMarkerBorderWidth","frozenMarkerWidth","drawFrozenRows","columnOrderIndex","rowOrderIndex","headerIndex","g","snapToRow","scrollTop","scrollPixelTop","scrollIndexTop","scrollIndexBottom","scrollPixelBottom","showNewRow","showRowHeaders","scrollIndexLeft","columns","drawCell","newRow","restore","drawRows","cl","activeCell","frozenColumn","selectionMode","lineWidth","activeCellOverlayBorderWidth","strokeStyle","activeCellOverlayBorderColor","getHeaderWidth","drawActiveCell","o","columnHeaderCell","header","nonFrozenHeaderWidth","drawHeaderColumnRange","start","end","hidden","title","cellWidth","index","order","rArgs","rhIndex","filteredRowNumber","getBoundRowIndexFromViewRowIndex","originalData","rowHeaderValue","hasActiveFilters","rowHeaderCell","headerDescription","sizes","openChildren","drawRowHeader","showColumnHeaders","columnHeaderCellBorderWidth","scrollBarWidth","isColumnHeaderCell","isColumnHeaderCellCap","endCap","drawHeaders","allowFreezingColumns","frozenMarkerHoverColor","frozenMarkerColor","frozenMarkerHoverBorderColor","frozenMarkerBorderColor","unshift","freezeMarkerPosition","frozenMarkerActiveColor","frozenMarkerActiveBorderColor","dragMode","mobile","allowMovingSelection","selectionHandleBorderWidth","selectionHandleBorderColor","selectionHandleColor","hw","selectionHandleSize","tr","br","tl","bl","addselectionHandle","az","touchSelectHandleZone","ax","ay","reorderObject","dragOffset","reorderMarkerBackgroundColor","reorderMarkerBorderWidth","reorderMarkerBorderColor","reorderMarkerIndexBorderWidth","reorderMarkerIndexBorderColor","reorderTarget","sortRowIndex","sortColumnIndex","drawReorderMarkers","movingSelection","moveOverlayBorderWidth","moveOverlayBorderColor","setLineDash","moveOverlayBorderSegments","gridBorderWidth","gridBorderColor","dsb","selectionOverlayBorderWidth","selectionOverlayBorderColor","drawSelectionBorders","entities","scrollBarBoxMargin","scrollBarBorderColor","scrollBarBorderWidth","horizontalBox","horizontalBar","scrollBoxWidth","scrollWidth","verticalBox","verticalBar","scrollBoxHeight","scrollHeight","horizontalBarVisible","scrollBarBackgroundColor","scrollBarBoxColor","horizontalBoxVisible","context","scrollBarActiveColor","scrollBarBoxBorderRadius","verticalBarVisible","verticalBoxVisible","scrollBarCornerBorderColor","scrollBarCornerBackgroundColor","corner","showPerformance","debug","pop","font","debugFont","perf","reduce","a","toFixed","perfDelta","frozenColumnsWidth","s","getColumnWidth","getFrozenColumnsWidth","htmlImages","scale","startScale","scaleDelta","zoomDeltaStart","touchLength","touches","touchPosition","touchPosition1","scrollIndex","scrollPixel","canvasOffset","touchDelta","touchAnimateTo","scrollAnimation","touchPPS","xPPS","yPPS","touchPPST","xPPST","yPPST","touchDuration","pointerLockPosition","size","mouse","touch","touchStart","hasFocus","dragContext","textAlign","debugBackgroundColor","key","debugColor","px","py","debugPerfChartBackground","debugScrollHeightColor","debugScrollWidthColor","debugPerformanceColor","debugEntitiesColor","debugTouchPPSXColor","debugTouchPPSYColor","dpl","apply","perfArr","arrIndex","max","color","useAbs","abs","drawPerfLine","debugPerfChartTextColor","drawPerfLines","createBorderOverlayArray","drawArray","propPrefix","offsetPoint","selectionBorder","isRowHeader","selections","indexOf","isHeader","cellGridAttributes","cellStyle","isCorner","isColumnHeader","wrap","cellWhiteSpace","selected","hovered","hovers","hoverMode","active","rawValue","isGrid","activeHeader","f","formatters","orderByArrowSize","treeArrowSize","ev","value","row","nodeType","fontHeight","horizontalAlignment","verticalAlignment","paddingLeft","paddingTop","paddingRight","paddingBottom","whiteSpace","lineHeight","cellLineHeight","lineSpacing","cellLineSpacing","offsetWidth","offsetHeight","offsetParent","viewRowIndex","viewColumnIndex","boundRowIndex","boundColumnIndex","isNormal","gridId","calculatedLineHeight","paddedWidth","paddedHeight","userHeight","userWidth","cellHeightWithChildGrid","cellWidthWithChildGrid","tree","mt","treeArrowMarginTop","mr","treeArrowMarginRight","ml","treeArrowMarginLeft","aw","treeArrowWidth","ah","treeArrowHeight","treeArrowColor","treeArrowBorderColor","drawTreeArrow","showRowNumbers","childGrids","saveAppearance","createGrid","cellGridHeight","grid","orderBy","columnHeaderOrderByArrowMarginTop","columnHeaderOrderByArrowMarginLeft","columnHeaderOrderByArrowMarginRight","columnHeaderOrderByArrowWidth","columnHeaderOrderByArrowHeight","columnHeaderOrderByArrowColor","columnHeaderOrderByArrowBorderColor","orderDirection","drawOrderByArrow","orderByArrowWidth","console","warn","columnFilters","filterTextPrefix","splitChar","lines","word","elWidth","plWidth","clippedVal","previousLine","words","split","textHeight","autoResize","autoResizeRows","et","ellipsisText","line","cHeight","measureText","measure","splice","originText","stepLength","direction","substr","wrapText","vPos","hPos","stringify","pw","idx","idx_ord","map","drawText","selectionBorderTop","selectionBorderRight","selectionHandle","selectionBorderLeft","selectionBorderBottom","selectionHandleBehavior","createHandlesOverlayArray","moveOffset","showRowNumberGaps","previousRowNumber","barHeight","rowHeaderCellRowNumberGapHeight","barColor","rowHeaderCellRowNumberGapColor","treeHeight","rowSansTreeHeight","trees","scrollIndexRight","scrollPixelRight","module","exports","defineProperty","enumerable","get","Symbol","toStringTag","__esModule","create","bind","default","hasOwnProperty","concat","modifier","legacyModifier","navigation","editing","ui","device","imeCompositionKeys","koreanSpecific","japaneseSpecific","commonFunction","multimedia","multimediaNumpad","audio","speech","application","browser","mobilePhone","tv","mediaControls","wheeling","stopPropagation","fn","events","removeEventListener","sfn","defaultPrevented","preventDefault","getRatio","maxPixelRatio","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","drawAfterResize","dims","vb","nb","co","isScrollBoxCorner","sbw","ratio","bm","cellBorder","columnHeaderCellBorder","dataHeight","dataWidth","ch","scrollCache","accumulator","column","va","setCanvasSize","args","top","left","setScrollBoxSize","checkScrollBoxVisibility","widthBoxRatio","heightBoxRatio","scrollBarBoxMinSize","scrollBarBoxWidth","bar","box","page","pageUpDownOverlap","resizeEditInput","scroll","overflowX","overflowY","dim","appliedInlineStyles","parentNodeStyle","dontDraw","floor","ellipsisCache","mousemove","overridePos","contextMenu","input","getLayerPos","dragBounds","sBounds","delta","ctrl","ctrlKey","metaKey","persistantSelectionMode","singleSelectionMode","getCellAt","NativeEvent","previousCell","clearTimeout","scrollTimer","isInGrid","rowBoundaryCrossed","columnBoundaryCrossed","cellBoundaryCrossed","prefix","draggingItem","scrollModes","dragItem","cursor","selecting","dragStart","dragStartObject","shiftKey","bottom","right","getSelectionBounds","ignoreNextClick","dragAddToSelection","event","selectedData","getSelectedData","selectionBounds","selectRow","selectArea","autoScrollZone","click","startingBounds","endEdit","setActiveCell","selectAll","checkSelectionChange","columnHeaderClickBehavior","selectColumn","treeArrowClickRadius","toggleTree","sb","dragResizeColumn","resizingStartingWidth","resizingStartingHeight","minColumnWidth","minRowHeight","resizeScrollZone","resizeChildGrids","globalRowResize","stopDragResize","body","setStorageData","scrollGrid","scrollPointerLock","scrollStartMode","movementX","movementY","scrollMode","scrollStart","setTimeout","scrollRepeatRate","selectionScrollIncrement","stopScrollGrid","exitPointerLock","dragReorder","columReorder","rowReorder","allowColumnReordering","allowRowReordering","source","reorderDeadZone","stopDragReorder","oIndex","tIndex","cr","dragMove","stopDragMove","moveSelection","freezeMove","stopFreezeMove","startFreezeMove","mousedown","lastMouseDownTarget","button","move","freeze","requestPointerLock","dragging","mouseup","controlInput","focus","getAdjacentCells","first","last","keydown","adjacentCells","cols","isPrintableKeyEvent","beginEditAt","selectNone","Number","isArrowKey","includes","scrollIntoView","selectionFollowsActiveCell","keyup","keypress","dblclick","fitColumnToValues","autosize","scrollWheel","deltaX","deltaY","deltaMode","touchHaltAnimation","scrollTo","pasteData","pasteValue","mimeType","startRowIndex","startColIndex","getVisibleSchema","isSupportedHtmlTable","htmlString","substring","match","parseData","cellData","forEachSelectedCell","colName","realRowIndex","cells","existingRowData","newRowData","assign","colIndex","columnName","affectedCells","refresh","getNextVisibleColumnIndex","visibleColumnIndex","getVisibleColumnIndexOf","paste","editable","clipboardItems","Map","from","clipboardData","items","supportedMimeTypes","pasteableItems","itemToPaste","pasteType","getAsString","join","cut","copy","outputHeaderKeys","tableRows","textRows","outputHeaders","sData","rowKeys","trRow","textRow","sSorted","fCopyCell","addCellValue","addHeaders","setData","htmlSafe","headers","useHtml","hVal","touchMoving","touchScrollTimeout","animationFrames","getTouchPos","touchIndex","rect","getBoundingClientRect","clientX","clientY","easingFunctions","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easing","touchEasingMethod","calculatePPSTimed","touchSigmaTimed","calculatePPS","touchSigma","touchEndAnimation","touchReleaseAnimationDurationMs","stopAnimation","touchEditCell","touchCell","clearInterval","calculatePPSTimer","touchDeadZone","touchingCell","editCell","touchstart","changedTouches","startingCell","disposeContextMenu","touchContextTimeout","touchStartEvent","zoomAltered","touchStart1","touchScrollStart","contextmenuEvent","touchContextMenuTimeMs","setInterval","touchEndEvents","touchmove","passive","touchend","touchcancel","touchSelect","handleType","touchSelecting","bounds","rw","rScrollZone","lScrollZone","bScrollZone","tScrollZone","t1","t2","touchZoomSensitivity","touchZoomMin","touchZoomMax","selectionScrollZone","touchScroll","touchMove","dz","touchReleaseAcceleration","scrollAnimationPPSThreshold","ctor","treeGridAttributes","storageName","invalidSearchExpClass","localStyleLibraryStorageKey","orderings","add","sortFunction","col","sort","filters","sorters","parsers","schemaHashes","changes","componentL1Events","eventNames","expandToRow","viewDataLength","orderedIndex","boundRowIndexMap","has","visibility","localStorage","setItem","tempSchema","createColumnOrders","applyDefaultValue","defaultValue","createNewRowData","getSchemaNameHash","getFilteredAndSortedViewData","newViewData","originalRowIndex","headerName","filterText","getHeaderByName","currentFilterFunction","cellValue","entries","sortFn","rowA","rowB","getBestGuessDataType","drawChildGrids","gridKey","setTimer","validateColumn","setDefaults","obj1","obj2","setAttributes","setStyle","findColumnMaxTextLength","dispose","removeChild","eventParent","contextmenu","disconnect","tryLoadStoredSettings","reloadStoredValues","storedSettings","_typeof","getDomRoot","shadowRoot","host","getFontName","fontStyle","getFontHeight","parseFloat","parseStyleValue","initProp","propName","getStyleProperty","styleKeys","supressDrawAndEvent","isDim","getItem","message","init","initialized","publicStyleKeyIntf","initScrollBox","setDom","ie","navigator","userAgent","edge","webKit","moz","blankValues","cursorGrab","cursorGrabing","cursorGrabbing","appendTo","getVisibleCellByIndex","clearChangeLog","gotoCell","gotoRow","findColumnScrollLeft","findRowScrollTop","isCellVisible","isRowVisible","isColumnVisible","clipElement","getSchemaFromData","setFilter","expandTree","collapseTree","insertRow","deleteRow","addRow","insertColumn","deleteColumn","addColumn","getClippingRect","setRowHeight","setColumnWidth","resetColumnWidths","resetRowHeights","assertPxColor","clearPxColorAssertions","integerToAlpha","addStyleKeyIfNoneExists","DOMStyles","set","valueObject","filterFor","blanksText","String","trim","filterRegExp","pattern","exec","flags","flagLength","invalidFilterRegEx","RegExp","toLocaleUpperCase","innerText","textContent","blur","TypeError","currentCursor","find","eventName","RangeError","isArray","getTypes","parseInnerHtml","callback","etl","autoGenerateSchema","autoResizeColumns","sHeight","sWidth","setScrollTop","preventScrollEvent","setScrollLeft","supressDrawEvent","zIndexTop","hoverScrollTimeout","autoCompleteContext","applyContextItemStyle","contextItemContainer","createInlineStyle","createContextMenu","parentContextMenu","loc","container","createElement","upArrow","downArrow","children","selectedIndex","checkArrowVisibility","startHoverScroll","contextHoverScrollAmount","contextHoverScrollRateMs","endHoverScroll","scrollOffset","contextMenuZIndex","childMenuArrow","removeChildContext","relatedTarget","contains","setAttribute","contextAddCallback","getAttribute","cPos","childContextMenuMarginLeft","childContextMenuMarginTop","createChildContext","addContent","content","childContextMenuArrowHTML","addItem","position","contextMenuArrowColor","zIndex","inputDropdown","maxHeight","innerHeight","autocompleteBottomMargin","minWidth","contextMenuArrowUpHTML","contextMenuArrowDownHTML","contextMenuWindowMargin","innerWidth","clickIndex","Event","isFinite","createFilterContextMenuItems","iRect","filterContainer","filterLabel","filterAutoCompleteButton","filterInput","checkRegExpErrorState","background","contextFilterInputBackground","contextFilterInputColor","contextFilterInvalidRegExpBackground","contextFilterInvalidRegExpColor","createAutoCompleteContext","count","blanksItem","autoCompleteItems","maxAutoCompleteItems","disposeAutocomplete","onclick","filterOptionText","contextFilterButtonHTML","cf","removeFilterOptionText","contextPosition","isNormalCell","isBackground","isScrollBar","showFilter","showCopy","copyText","execCommand","showPaste","clipBoardData","pasteText","showColumnSelector","columnSelectorText","toggleColumnVisibility","columnSelectorHiddenText","columnSelectorVisibleText","hideColumnText","showClearSettingsOption","clearSettingsOptionText","columnWidth","allowSorting","showOrderByOption","showOrderByOptionTextAsc","showOrderByOptionTextDesc","addDefaultContextMenuItem","contextMenuMarginLeft","contextMenuMarginTop","mobileContextMenuMargin","createDiposeEvent","ele","boundingRect","eleRect","clipRect","parentRect","Infinity","scrollingElement","borderWidth","mobileEditInputHeight","cellPaddingLeft","ignoreScrollOffset","abort","newValue","oldValue","aborted","inEnterMode","enumItems","enu","option","valueInEnum","multiLine","editCellZIndex","fontSize","editCellFontSize","cellValueIsEmpty","shouldClearCellValue","nx","ny","altKey","nextRowIndex","className","css","verticalAlign","marginLeft","padding","border","contextFilterInputBorder","borderRadius","contextFilterInputBorderRadius","fontWeight","fontFamily","contextFilterInputFontFamily","contextFilterInputFontSize","contextMenuBackground","contextMenuColor","contextFilterButtonBorder","contextFilterButtonBorderRadius","contextMenuFilterButtonFontFamily","contextMenuFilterButtonFontSize","cssFloat","childContextMenuArrowColor","contextMenuChildArrowFontSize","contextMenuFontFamily","contextMenuFontSize","contextMenuBorder","contextMenuPadding","contextMenuBorderRadius","opacity","contextMenuOpacity","overflow","contextMenuHoverBackground","contextMenuHoverColor","display","boxSizing","outline","margin","mobileEditFontFamily","mobileEditFontSize","editCellBorder","editCellColor","editCellBackgroundColor","appearance","webkitAppearance","mozAppearance","editCellPaddingLeft","editCellFontFamily","boxShadow","editCellBoxShadow","contextMenuItemMargin","contextMenuItemBorderRadius","contextMenuLabelMargin","contextMenuLabelDisplay","contextMenuLabelMinWidth","maxWidth","contextMenuLabelMaxWidth","contextMenuCursor","contextMenuFilterInvalidExpresion","onblur","parentIsCanvas","getContext","textBaseline","ordA","charCodeAt","len","fromCharCode","offsetX","offsetY","targetX","targetY","sbh","isColumnSelected","colIsSelected","shift","supressEvent","addCol","st","de","ri","dragObject","childGrid","trArgs","treeGridHeight","dontSetStorageData","sorter","sel","xi","visibleSchema","selectionLength","maxRowLength","minXi","yi","lastSourceIndex","cidx","useTouchScrollZones","getBorder","entitiy","borderResizeZone","moveBorder","tsz","touchScrollZone","moveMode","borderDragBehavior","xBorderBehavior","yBorderBehavior","isVerticalScrollBar","isHorizontalScrollBar","allowColumnResize","allowColumnResizeFromCell","allowRowHeaderResize","allowRowResize","allowRowResizeFromCell","rowGrabZoneSize","maxCol","minCol","rowHeaderCellFont","autosizePadding","autosizeHeaderCellPadding","rowHeaderCellPaddingRight","rowHeaderCellPaddingLeft","formatter","columnHeaderCellFont","headerCellPaddingRight","headerCellPaddingLeft","cellFont","cellPaddingRight","cellAutoResizePadding","total","getRowHeight","headerCell","int","asc","localeCompare","date","Date","getTime","webComponent","modules","dom","publicMethods","Grid","eval","attachShadow","canvasDatagrid","tKeys","customElements","argKey","tKey","sKey","HTMLElement","observedAttributes","define","require"],"mappings":"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"}